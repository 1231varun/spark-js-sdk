<a name"0.5.105"></a>
### 0.5.105 (2016-07-21)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **Search:**
  * Update integration test to have correct error string (91844d34)
  * Allow queryString in #people and refactor params -> options (8e99c170)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:**
  * remove duplicate data property (ae5f5550)
  * put correct title on video control button (bbd42ab0)
  * enable tests in build pipeline (cd1c3741)
  * correctly render incoming media stream (845c7c3c)
  * fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **jsdoctrinetest:**
  * disable tests (ada6ff5d)
  * fix missing dependency (4cd3d117)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:**
  * assume media in a closed PeerConnection is closed (again) (5ce1eddc)
  * assume media in a closed PeerConnection is closed (c93de436)
  * workaround bug in Chrome sdp handling (8da486de)
  * prevent mediaDirection from failing when the pc doesn't yet have a localDescript (80aff84b)
  * update locus and linus correctly on media change (62628ad7)
  * do one-direction audio/video correctly. (79a47f29)
* **plugin-wdm:**
  * suppress requiresClientCredentials warning (f01de3dd)
  * fix missing dependency due to npm 3 (a7873fdc)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * fix incorrect log statement in response-logger wherein the request was logged in (1996a03e)
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-automation:** make login work for apps with grant pages (761dc860)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Search:** Allow includeRobots param in directory search (37a69259)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * add media to single-media call mid-call (e73bd8fe, closes #882, #883)
  * add support for starting a calling with only audio or video (7204b5fd, closes #878, #879)
  * answer call with limited media (43a2559a)
  * make call answer controls prettier (2f0f026b)
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **jsdoctrinetest:**
  * generate a mocha test suite from source comments (84e7632c)
  * implement comment parsing and assertion generation (3df8c53e)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * coalesce media updates via oneFlight/process.nextTick (9e25294d)
  * implement toggleReceivingAudio and toggleReceivingVideo (85ecaf05, closes #892, #893)
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.104"></a>
### 0.5.104 (2016-07-21)


<a name"0.5.103"></a>
### 0.5.103 (2016-07-18)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **Search:**
  * Update integration test to have correct error string (91844d34)
  * Allow queryString in #people and refactor params -> options (8e99c170)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:**
  * remove duplicate data property (ae5f5550)
  * put correct title on video control button (bbd42ab0)
  * enable tests in build pipeline (cd1c3741)
  * correctly render incoming media stream (845c7c3c)
  * fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **jsdoctrinetest:**
  * disable tests (ada6ff5d)
  * fix missing dependency (4cd3d117)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:**
  * assume media in a closed PeerConnection is closed (again) (5ce1eddc)
  * assume media in a closed PeerConnection is closed (c93de436)
  * workaround bug in Chrome sdp handling (8da486de)
  * prevent mediaDirection from failing when the pc doesn't yet have a localDescript (80aff84b)
  * update locus and linus correctly on media change (62628ad7)
  * do one-direction audio/video correctly. (79a47f29)
* **plugin-wdm:** fix missing dependency due to npm 3 (a7873fdc)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * fix incorrect log statement in response-logger wherein the request was logged in (1996a03e)
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-automation:** make login work for apps with grant pages (761dc860)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Search:** Allow includeRobots param in directory search (37a69259)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * add media to single-media call mid-call (e73bd8fe, closes #882, #883)
  * add support for starting a calling with only audio or video (7204b5fd, closes #878, #879)
  * answer call with limited media (43a2559a)
  * make call answer controls prettier (2f0f026b)
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **jsdoctrinetest:**
  * generate a mocha test suite from source comments (84e7632c)
  * implement comment parsing and assertion generation (3df8c53e)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * coalesce media updates via oneFlight/process.nextTick (9e25294d)
  * implement toggleReceivingAudio and toggleReceivingVideo (85ecaf05, closes #892, #893)
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.102"></a>
### 0.5.102 (2016-07-15)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **Search:**
  * Update integration test to have correct error string (91844d34)
  * Allow queryString in #people and refactor params -> options (8e99c170)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:**
  * remove duplicate data property (ae5f5550)
  * put correct title on video control button (bbd42ab0)
  * enable tests in build pipeline (cd1c3741)
  * correctly render incoming media stream (845c7c3c)
  * fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **jsdoctrinetest:**
  * disable tests (ada6ff5d)
  * fix missing dependency (4cd3d117)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:**
  * assume media in a closed PeerConnection is closed (again) (5ce1eddc)
  * assume media in a closed PeerConnection is closed (c93de436)
  * workaround bug in Chrome sdp handling (8da486de)
  * prevent mediaDirection from failing when the pc doesn't yet have a localDescript (80aff84b)
  * update locus and linus correctly on media change (62628ad7)
  * do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * fix incorrect log statement in response-logger wherein the request was logged in (1996a03e)
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-automation:** make login work for apps with grant pages (761dc860)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Search:** Allow includeRobots param in directory search (37a69259)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * add media to single-media call mid-call (e73bd8fe, closes #882, #883)
  * add support for starting a calling with only audio or video (7204b5fd, closes #878, #879)
  * answer call with limited media (43a2559a)
  * make call answer controls prettier (2f0f026b)
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **jsdoctrinetest:**
  * generate a mocha test suite from source comments (84e7632c)
  * implement comment parsing and assertion generation (3df8c53e)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * coalesce media updates via oneFlight/process.nextTick (9e25294d)
  * implement toggleReceivingAudio and toggleReceivingVideo (85ecaf05, closes #892, #893)
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.101"></a>
### 0.5.101 (2016-07-15)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **Search:**
  * Update integration test to have correct error string (91844d34)
  * Allow queryString in #people and refactor params -> options (8e99c170)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:**
  * remove duplicate data property (ae5f5550)
  * put correct title on video control button (bbd42ab0)
  * enable tests in build pipeline (cd1c3741)
  * correctly render incoming media stream (845c7c3c)
  * fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **jsdoctrinetest:**
  * disable tests (ada6ff5d)
  * fix missing dependency (4cd3d117)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:**
  * assume media in a closed PeerConnection is closed (again) (5ce1eddc)
  * assume media in a closed PeerConnection is closed (c93de436)
  * workaround bug in Chrome sdp handling (8da486de)
  * prevent mediaDirection from failing when the pc doesn't yet have a localDescript (80aff84b)
  * update locus and linus correctly on media change (62628ad7)
  * do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * fix incorrect log statement in response-logger wherein the request was logged in (1996a03e)
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-automation:** make login work for apps with grant pages (761dc860)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Search:** Allow includeRobots param in directory search (37a69259)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * add media to single-media call mid-call (e73bd8fe, closes #882, #883)
  * add support for starting a calling with only audio or video (7204b5fd, closes #878, #879)
  * answer call with limited media (43a2559a)
  * make call answer controls prettier (2f0f026b)
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **jsdoctrinetest:**
  * generate a mocha test suite from source comments (84e7632c)
  * implement comment parsing and assertion generation (3df8c53e)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * coalesce media updates via oneFlight/process.nextTick (9e25294d)
  * implement toggleReceivingAudio and toggleReceivingVideo (85ecaf05, closes #892, #893)
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.100"></a>
### 0.5.100 (2016-07-14)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **Search:**
  * Update integration test to have correct error string (91844d34)
  * Allow queryString in #people and refactor params -> options (8e99c170)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:**
  * remove duplicate data property (ae5f5550)
  * put correct title on video control button (bbd42ab0)
  * enable tests in build pipeline (cd1c3741)
  * correctly render incoming media stream (845c7c3c)
  * fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **jsdoctrinetest:**
  * disable tests (ada6ff5d)
  * fix missing dependency (4cd3d117)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:**
  * assume media in a closed PeerConnection is closed (again) (5ce1eddc)
  * assume media in a closed PeerConnection is closed (c93de436)
  * workaround bug in Chrome sdp handling (8da486de)
  * prevent mediaDirection from failing when the pc doesn't yet have a localDescript (80aff84b)
  * update locus and linus correctly on media change (62628ad7)
  * do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * fix incorrect log statement in response-logger wherein the request was logged in (1996a03e)
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-automation:** make login work for apps with grant pages (761dc860)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Search:** Allow includeRobots param in directory search (37a69259)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * add media to single-media call mid-call (e73bd8fe, closes #882, #883)
  * add support for starting a calling with only audio or video (7204b5fd, closes #878, #879)
  * answer call with limited media (43a2559a)
  * make call answer controls prettier (2f0f026b)
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **jsdoctrinetest:**
  * generate a mocha test suite from source comments (84e7632c)
  * implement comment parsing and assertion generation (3df8c53e)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * coalesce media updates via oneFlight/process.nextTick (9e25294d)
  * implement toggleReceivingAudio and toggleReceivingVideo (85ecaf05, closes #892, #893)
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.99"></a>
### 0.5.99 (2016-07-12)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **Search:**
  * Update integration test to have correct error string (91844d34)
  * Allow queryString in #people and refactor params -> options (8e99c170)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:**
  * remove duplicate data property (ae5f5550)
  * put correct title on video control button (bbd42ab0)
  * enable tests in build pipeline (cd1c3741)
  * correctly render incoming media stream (845c7c3c)
  * fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **jsdoctrinetest:**
  * disable tests (ada6ff5d)
  * fix missing dependency (4cd3d117)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:**
  * assume media in a closed PeerConnection is closed (again) (5ce1eddc)
  * assume media in a closed PeerConnection is closed (c93de436)
  * workaround bug in Chrome sdp handling (8da486de)
  * prevent mediaDirection from failing when the pc doesn't yet have a localDescript (80aff84b)
  * update locus and linus correctly on media change (62628ad7)
  * do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * fix incorrect log statement in response-logger wherein the request was logged in (1996a03e)
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-automation:** make login work for apps with grant pages (761dc860)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Search:** Allow includeRobots param in directory search (37a69259)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * add media to single-media call mid-call (e73bd8fe, closes #882, #883)
  * add support for starting a calling with only audio or video (7204b5fd, closes #878, #879)
  * answer call with limited media (43a2559a)
  * make call answer controls prettier (2f0f026b)
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **jsdoctrinetest:**
  * generate a mocha test suite from source comments (84e7632c)
  * implement comment parsing and assertion generation (3df8c53e)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * coalesce media updates via oneFlight/process.nextTick (9e25294d)
  * implement toggleReceivingAudio and toggleReceivingVideo (85ecaf05, closes #892, #893)
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.98"></a>
### 0.5.98 (2016-07-12)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **Search:**
  * Update integration test to have correct error string (91844d34)
  * Allow queryString in #people and refactor params -> options (8e99c170)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:**
  * remove duplicate data property (ae5f5550)
  * put correct title on video control button (bbd42ab0)
  * enable tests in build pipeline (cd1c3741)
  * correctly render incoming media stream (845c7c3c)
  * fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **jsdoctrinetest:**
  * disable tests (ada6ff5d)
  * fix missing dependency (4cd3d117)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:**
  * assume media in a closed PeerConnection is closed (again) (5ce1eddc)
  * assume media in a closed PeerConnection is closed (c93de436)
  * workaround bug in Chrome sdp handling (8da486de)
  * prevent mediaDirection from failing when the pc doesn't yet have a localDescript (80aff84b)
  * update locus and linus correctly on media change (62628ad7)
  * do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * fix incorrect log statement in response-logger wherein the request was logged in (1996a03e)
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-automation:** make login work for apps with grant pages (761dc860)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Search:** Allow includeRobots param in directory search (37a69259)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * add media to single-media call mid-call (e73bd8fe, closes #882, #883)
  * add support for starting a calling with only audio or video (7204b5fd, closes #878, #879)
  * answer call with limited media (43a2559a)
  * make call answer controls prettier (2f0f026b)
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **jsdoctrinetest:**
  * generate a mocha test suite from source comments (84e7632c)
  * implement comment parsing and assertion generation (3df8c53e)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * coalesce media updates via oneFlight/process.nextTick (9e25294d)
  * implement toggleReceivingAudio and toggleReceivingVideo (85ecaf05, closes #892, #893)
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.97"></a>
### 0.5.97 (2016-07-12)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **Search:**
  * Update integration test to have correct error string (91844d34)
  * Allow queryString in #people and refactor params -> options (8e99c170)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:**
  * remove duplicate data property (ae5f5550)
  * put correct title on video control button (bbd42ab0)
  * enable tests in build pipeline (cd1c3741)
  * correctly render incoming media stream (845c7c3c)
  * fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **jsdoctrinetest:**
  * disable tests (ada6ff5d)
  * fix missing dependency (4cd3d117)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:**
  * assume media in a closed PeerConnection is closed (again) (5ce1eddc)
  * assume media in a closed PeerConnection is closed (c93de436)
  * workaround bug in Chrome sdp handling (8da486de)
  * prevent mediaDirection from failing when the pc doesn't yet have a localDescript (80aff84b)
  * update locus and linus correctly on media change (62628ad7)
  * do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * fix incorrect log statement in response-logger wherein the request was logged in (1996a03e)
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-automation:** make login work for apps with grant pages (761dc860)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Search:** Allow includeRobots param in directory search (37a69259)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * add media to single-media call mid-call (e73bd8fe, closes #882, #883)
  * add support for starting a calling with only audio or video (7204b5fd, closes #878, #879)
  * answer call with limited media (43a2559a)
  * make call answer controls prettier (2f0f026b)
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **jsdoctrinetest:**
  * generate a mocha test suite from source comments (84e7632c)
  * implement comment parsing and assertion generation (3df8c53e)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * coalesce media updates via oneFlight/process.nextTick (9e25294d)
  * implement toggleReceivingAudio and toggleReceivingVideo (85ecaf05, closes #892, #893)
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.96"></a>
### 0.5.96 (2016-07-11)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **Search:**
  * Update integration test to have correct error string (91844d34)
  * Allow queryString in #people and refactor params -> options (8e99c170)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:**
  * put correct title on video control button (bbd42ab0)
  * enable tests in build pipeline (cd1c3741)
  * correctly render incoming media stream (845c7c3c)
  * fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:**
  * workaround bug in Chrome sdp handling (8da486de)
  * prevent mediaDirection from failing when the pc doesn't yet have a localDescript (80aff84b)
  * update locus and linus correctly on media change (62628ad7)
  * do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-automation:** make login work for apps with grant pages (761dc860)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Search:** Allow includeRobots param in directory search (37a69259)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * add media to single-media call mid-call (e73bd8fe, closes #882, #883)
  * add support for starting a calling with only audio or video (7204b5fd, closes #878, #879)
  * answer call with limited media (43a2559a)
  * make call answer controls prettier (2f0f026b)
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * coalesce media updates via oneFlight/process.nextTick (9e25294d)
  * implement toggleReceivingAudio and toggleReceivingVideo (85ecaf05, closes #892, #893)
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.95"></a>
### 0.5.95 (2016-07-08)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **Search:**
  * Update integration test to have correct error string (91844d34)
  * Allow queryString in #people and refactor params -> options (8e99c170)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:** fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Search:** Allow includeRobots param in directory search (37a69259)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.94"></a>
### 0.5.94 (2016-07-07)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:** fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.93"></a>
### 0.5.93 (2016-07-06)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:** fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **split-token:** setting supertoken by default for all interactions when the client misses the km (8af3db53)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.92"></a>
### 0.5.92 (2016-07-02)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:** fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.91"></a>
### 0.5.91 (2016-06-30)


#### Bug Fixes

* adding semicolons (b4d389f1)
* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:** fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (d227e2fb)
* fixing conversation untag typo (f1329d2c)
* refactor tag/untag and mute/unmute (5499a139)
* add mute/unmute for messages and mentions (866fe13c)
* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.90"></a>
### 0.5.90 (2016-06-30)


#### Bug Fixes

* adding semicolons (5bd87937)
* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:** fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* fixing conversation mute typo (138ff4a8)
* fixing conversation untag typo (65a36462)
* refactor tag/untag and mute/unmute (de997f24)
* add mute/unmute for messages and mentions (282c536d)
* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.89"></a>
### 0.5.89 (2016-06-29)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **example-phone:** fix duplicate call to getUserMedia (ea1193c2)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.88"></a>
### 0.5.88 (2016-06-29)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.87"></a>
### 0.5.87 (2016-06-27)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.86"></a>
### 0.5.86 (2016-06-25)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.85"></a>
### 0.5.85 (2016-06-25)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.84"></a>
### 0.5.84 (2016-06-24)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * only override the auth interceptor if the wdm plugin has not been loaded (5a004362)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **example-one-on-one-calling:** mute local video tag to avoid feedback (4581feab)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **packages:** add es6-promise to test helpers because the pipeline still runs on node 0.10 (e0e7451a)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-idm:** correctly authorize (or not) auth urls (19bf7284)
* **plugin-locus:** add missing dependency (e5a06b45)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **plugin-metrics:** fix bugs in metrics plugin (d2d69184)
* **plugin-phone:** do one-direction audio/video correctly. (79a47f29)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * implement noop since lodash removed it (1e687799)
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **test-helper-file:** remove es5-invalid object shorthand (671ec0eb)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-one-on-one-calling:**
  * implement calling? (b602bc59)
  * mostly implement outbound calling (bd6b2967)
  * add persistent login (cc095307)
  * implement login (ba36d115)
* **example-phone:**
  * test login flow (4a921c6f)
  * start building a new phone example with hot-module-reloading (111d0198)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-locus:** add locus sequencing comparator (ae523e3e)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-metrics:** add basic metrics service support (0148b5ff)
* **plugin-phone:**
  * add media to call (abfa1751)
  * fix and test stopSendingAudio in Firefox and Chrome (456ed7b9)
  * add call.on(`error`) for handling errors while dialing (477a9477)
  * add calling! (11514d1e)
  * start adding webrtc (1fe38c93)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add SparkPlugin2 - a variant of SparkPlugin that doesn't have to be initialized  (dce5110b)
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.83"></a>
### 0.5.83 (2016-06-21)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.82"></a>
### 0.5.82 (2016-06-21)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * remove membership equality assertion due to mild create date mismatch (f38c0197)
  * fix typo in documentation (54c6968c)
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for team memberships (464c4a26)
  * add Teams resource (945cd9f3)
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.81"></a>
### 0.5.81 (2016-06-20)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * correctly store spark instance for Page objects (34aeca84)
  * correctly include config property when calling ciscospark.init() (383e1900)
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.80"></a>
### 0.5.80 (2016-06-13)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.79"></a>
### 0.5.79 (2016-06-11)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.78"></a>
### 0.5.78 (2016-06-10)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.77"></a>
### 0.5.77 (2016-06-10)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * remove a .only that lint did not catch (d4869976)
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.76"></a>
### 0.5.76 (2016-06-09)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * prevent false postives in cloudapps pipeline (9aa4b45f)
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.75"></a>
### 0.5.75 (2016-06-03)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.74"></a>
### 0.5.74 (2016-06-02)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **html:** escape instead of remove disallowed html tags (a0b8efbb)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.73"></a>
### 0.5.73 (2016-05-14)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.72"></a>
### 0.5.72 (2016-05-14)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.71"></a>
### 0.5.71 (2016-05-10)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove no-longer-valid settable toggle (3cfb2380)
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.70"></a>
### 0.5.70 (2016-05-04)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.69"></a>
### 0.5.69 (2016-04-27)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.68"></a>
### 0.5.68 (2016-04-26)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:**
  * contributing.md update for where to find the Jenkins remote url (4a6309ac)
  * update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Include target attribute when posting archive and unarchive activities (403c4a3f)
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.67"></a>
### 0.5.67 (2016-04-24)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.66"></a>
### 0.5.66 (2016-04-22)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:**
  * upgrade to ws 1.1.0 (8656cbb5)
  * upgrade to ws 1.1.0 (4a684591)
  * add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.65"></a>
### 0.5.65 (2016-04-21)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **socket:** add error handler to socket connection (8f562386)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.64"></a>
### 0.5.64 (2016-04-21)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.63"></a>
### 0.5.63 (2016-04-21)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.62"></a>
### 0.5.62 (2016-04-20)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.61"></a>
### 0.5.61 (2016-04-20)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * remove plaintext filenames (51796743, closes #740)
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.60"></a>
### 0.5.60 (2016-04-14)


<a name"0.5.60-0"></a>
### 0.5.60-0 (2016-04-14)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-html:** handle blank strings (1d898570)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.59"></a>
### 0.5.59 (2016-04-13)


<a name"0.5.58"></a>
### 0.5.58 (2016-04-08)


<a name"0.5.58-2"></a>
### 0.5.58-2 (2016-04-08)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **helper-http:** address some browser-specific issues with the http filter (d25dd396)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.58-1"></a>
### 0.5.58-1 (2016-04-07)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **generator-ciscospark:** fix author email address (d4e25fbd)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **generator-ciscospark:**
  * add plugin generator (7ff21c61)
  * add `yo ciscospark:package` for scaffolding new sdk components (12d1875e)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.58-0"></a>
### 0.5.58-0 (2016-03-29)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **phone:** Scaffold on the calling SDK (af635317)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.57"></a>
### 0.5.57 (2016-03-28)


<a name"0.5.57-7"></a>
### 0.5.57-7 (2016-03-28)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.57-6"></a>
### 0.5.57-6 (2016-03-28)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **plugin-mercury:** point main at dist instead of src (5abc4b65)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * make trackingId available on the spark object (69509d30)
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **plugin-mercury:** implement Socket (34c75625)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.57-5"></a>
### 0.5.57-5 (2016-03-22)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.57-4"></a>
### 0.5.57-4 (2016-03-22)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **plugin-wdm:**
  * add embargo interceptor (c92465fe)
  * add WDM plugin (22a9ed52)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.57-3"></a>
### 0.5.57-3 (2016-03-16)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.57-2"></a>
### 0.5.57-2 (2016-03-15)


#### Bug Fixes

* **Auth:**
  * recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)
  * use correct SAML API (728af5cf)
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
  * force Auth header for first-party cookie call (dbd84d75, closes #378)
  * refactor auth processor to whitelist rather than blacklist (be56a96c, closes #353)
  * do not attempt to reauthenticate if the first-party-cookie call fails (cadc6470)
* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or (2d888fa8, closes #323)
* **Avatar:**
  * look for email address in `emailAddress` also (20f5c2fc)
  * invalidate current user's cached avatar after uploading a new one (708985e1)
  * handle error response when requesting avatar URLs (8b591da6, closes #264)
* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **Bot:** add tries to machine account authentication (f4e244c6)
* **Client:**
  * add support for options.auth to client shim (df79ec4a)
  * Only add upload.onprogress to requests that can have upload progress events (ace97319)
  * ensure all results in Client#_request have the same shape (b7bcb81f, closes #329)
  * don't treat statusCode === 0 differently from any other status code at low level (5ad50933)
  * fix a bug where request error handlers weren't invoked properly (41d514fe)
  * do not add device url to CI requests because CORS (356f7fd3)
  * correct typo; actually use asyncRequestTimeout config parameter (18bae1a1)
  * Raise async request timeout; make timeout configurable (c8e4bd1b)
* **Content:** handle decryption of share and conversation updates correctly (46a877ce)
* **ConverationService:** prevent sending plaintext when posting activities (3d3db04e, closes #267)
* **Conversation:**
  * Update ack test for new ackFilter default of noack (35dc44f6)
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
  * Add params to getPersonalConvo call (b3c0ee16)
  * accept full user objects as conversation participants (e3c9f77c, closes #559)
  * Store blobs in FileCache and correctly return objectURL (89003b0a)
  * adds an option to create conversation with compact param (a9764825)
  * assign encryption key when creating 1:1 (6dbefd50)
  * bind to the right `this` to show decryption failure message (6204d338)
* **ConversationServer:** correctly cache space urls on the conversation object instead of the Conversatio (e68bbe5a)
* **ConversationService:**
  * adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)
  * remove 'title-encryption' feature toggle and encrypt all titles (6a96b6d2, closes #227)
  * fix blink in web-client caused by suppression of published date (1280cc25)
  * fallback to email when `leave`ing deleted users (aab48d1d, closes #184)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * don't try to authenticate if already authenticated (4c80f3f0)
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **DRY:**
  * do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
  * Disable ECDH and DRY tests (8b21f260)
* **Decryption:** apply decrypter to activities retrieved by PUT when possibly creating a 1:1 (1274ccd5)
* **Device:**
  * don't send features when refreshing device (f75b3deb)
  * remove assertions around country code because we can't guarantee the country wil (29308c90)
* **Docs:** update doc url with current version (386414ce)
* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser (f927a287)
* **Encrypter:** prevent encryption of non-encryptable activities (d0fc1f67, closes #251)
* **Encryption:**
  * Enable v2 if teams is enabled (b32442c0)
  * correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)
  * Fix typo in method name (ef4aee7f)
  * Fix decryption of share activities received via mercury (f5dd5a84)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)
* **EncryptionMigrationTest:** remove luck from test (617f118a)
* **EncryptionService:**
  * add metric for nearly-bound-key collisions (388b70e0)
  * prevent reuse of unused keys that haven't quite been fully used yet (f0314db0)
  * stop removing unused keys from the unused list once they've been added to the ma (9377f4ae)
  * put all keys in keystone so they never get refetched when moving from `keystore. (27ce041d, closes #220)
  * Do not refetch unused key right before using it (8109086b)
* **Feature:** respond to code review (0ca211cf)
* **FeatureService:** fail if FeatureService is used incorrectly. (0e8cd25b)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)
  * parse features correctly (56445bcf)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KMS:**
  * inject token into kms context on every request (2b16426c, closes #570)
  * use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)
* **KeyRequestBatcher:**
  * fix missed method rename (2db00988)
  * fix type checking in batched request store; fix incomplete key retrieval retries (7c77cc8f)
* **KeyStore:** add KeyStore#clear for API compatibility with KeyStore#clear() in WebExSquared/w (f011b2f3, closes #156)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **ListUnreadTest:** attempt to stabilize listUnread() test (b5a4d3fd)
* **Logger:**
  * configure logger methods at call time so they can use the most up-to-date featur (c249ded1)
  * add fallback to _.noop in environments that don't support all log levels (5f1fceb6)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)
* **Mashups:** Allow options.roomId on get() (5b7f6f0d)
* **Mentions:** correctly put mentions property on comment object instead of activity object (5687d4b2)
* **Mercury:**
  * handle newly added close reasons (91547003)
  * handle a situation where mercury errors may be completely suppressed and ignored (719ec651)
  * emit socket events consistently (ea882a4c)
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
  * use correct close code used when intentionally closing the socket from the clien (b9b79ebe)
  * fix mistyped timer names (85e2218c, closes #305)
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( (ac4c1c81)
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e (7371f210, closes #346)
  * fallback to reason checking when IE drops the close code (0d0e5aec, closes #279, #212)
* **Mercury5:**
  * fix force close delay (fddc97fa)
  * emit 'unknown' events when the event payload does not have a `data` property (67128597)
  * add missing "*" event (e2600fc7)
* **MercuryTests:** separate user creation from dynamic logging token retrieval (fa578d72)
* **MercuryV6:** actually start ping/pong (c1326e01)
* **Metric:** fix bad merge which broke metrics reporting (b37028fc)
* **Metrics:**
  * Add requests directly to queue when using DummyBatchedRequestStore (5595232c)
  * Circonus Metrics use DummyBatchedRequestStore (f048b30a)
  * prevent exception if NODE_ENV is undefined (56004b28, closes #226)
* **Normalizer:**
  * fix bug when looking up UUIDs (6cce86fe)
  * adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e (1114b428)
  * prevent situations where a user does not have a uuid (d6a338e4, closes #284)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **RegionService:** add "/" to url due to current config on region service (6fd98de5)
* **ShareActivity:**
  * Exclude erroneous encryptedSCR from payload (bfddebcf)
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)
  * Add suffix on thumbnail upload path (4e483b80)
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)
  * Team Conversations also require a displayName (b809b669)
  * Require displayName in team.create and team.update payloads (380323f3)
  * use Kirk instead of mccoy in Team moderator tests (325204a3)
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)
* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness (c9eeb52e)
* **TestLogger:**
  * correctly omit body when stringifying request options (9b858d8b)
  * correctly format verbose log output (7391a638)
* **TestService:**
  * don't treat HTTP failures as successes (86f606c1)
  * exclude test service from production bundles until the endpoint is secured (49715be6, closes #301)
* **TestUsers:**
  * add additional test entitlements (747abb40)
  * add required entitlement to test-users for room moderation (9992642d)
* **Tests:** Update tests to use converation#download (eb7a8805)
* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests (84452b4c)
* **UUID:**
  * convert email address and UUIDs to lowercase (39e94dad, closes #150)
  * only allow lowercase letters in UUIDs (07790b2e)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **User:** only cache user's id and email address (b156cfde)
* **XunitLogger:** fallback to log for console methods that do not exist (d0484db4)
* **avatar:** Add missing parameter check to retrieveAvatarUrl() (3b997bd0)
* **avatar test:** use it instead of describe correctly (6117a614)
* **build:**
  * lockdown version of babel-plugin-lodash (868bc3f7)
  * disable coverage correctly in gating pipelines (33588939)
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
  * fix typo in Reflect.deleteProperty (e2f191de, closes #742)
  * adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)
* **client:** Provide empty payload for IE (f68e8507)
* **conversation:**
  * add key rotation test (33d05154, closes #682)
  * suppress locally-created published date in new activity (unless explicitly desir (9f0fd498, closes #209)
* **core:** add missing return (80f81f18)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)
* **decryption:**
  * fix keypath for decryptionFailureMessage (1fe05bba)
  * add missing `.bind` (ddbc11cd)
* **dependencies:**
  * add missing dependency to dep list (f7d310ad)
  * change lodash to ^ operators to match ampersand dependencies (fd81bf9c)
* **deps:**
  * remove reference to internal registry because it doesn't support scoped modules (1775f87a)
  * update to latest node-jose to avoid breakage in safari 7 (a273cacd)
* **encryption:**
  * add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)
  * correctly handle key rotation in v2 environments (cb80671f)
  * do not cache unbound keys (51f10cc1)
  * don't hang forever if ecdhe times out (cf50bd9b, closes #641)
  * Add shim for ArrayBuffer#slice (030b30e0)
* **html:** use lodash.assign instead of Object.assign (4d0c20a0)
* **http-core:**
  * don't reverse interceptors on each request (9b0c91f1)
  * replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **landingparty:** handle spock: `false` scenario better (27e41542)
* **lint:**
  * fixed lint error (6ecd207d)
  * clean lint (fa0de2ce)
  * clean lint (02b5cf33)
* **logger:**
  * fallback to log only errors if nothing else sets a log level (fa489188)
  * fix use of log-level feature toggle for logger (b3e0eb3a)
  * make sure `this` is bound in callbacks (1cad0fc3)
  * remove this.logger from as it's not available (e7c95761)
* **logging:** stringify error messages in log uploads (73516a4d, closes #676)
* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)
  * fix message type for mercury acknowledgements (c115340a)
  * Change method of deallocating a dead socket since `delete` can't be used on defi (af674530)
* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)
* **patterns:** add start/end matchers to patterns so they do a match instead of a contains (b9f7e773, closes #252)
* **pipeline:**
  * remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)
  * correctly point at local .tmp directory (4ffaf5ec)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)
* **redirect:** handle no headers case in redirect processor (79213527)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)
* **request:** Prepare form data better in browsers (4109e78d, closes #174)
* **retry:**
  * retries with options.maxDelay if given (8cb27ea8)
  * fix incorrect context in retry method (fbc93505)
* **security:** sanitize inbound and outbound html (cd62e2e1)
* **share:** Content with characters fail to upload (d5dba307)
* **sideboarding:**
  * fix sideboarding in all the places (cb01d458)
  * do not lookup uuids during add() (d630fd33)
* **spark-core:**
  * stop caching the plugin config object (3cb1ba69)
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **support:**
  * adds test to unsure unknown key is not added to metadata (5481533d)
  * uses feedbackId if provided when retrieving desk.com url (5471211a)
  * adds tracking id to metadata when uploading logs and adds tests (383c4226)
* **test:**
  * fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
  * modifies more tests to accommodate for creating compact conversation by default (a0a1c349)
  * make _prepareActivity tests call the function directly (d51292d9)
  * fix missing include (19293866)
  * fix minor issues in file-equality assertions. (b99fb18a)
  * adjust Client#Test to support IE. (fca7fb7b)
  * remove configuration that may have prevented most of the test suite from running (a7b90222)
* **test readability:** add helpers to aid readability for node- and browser-only tests (e89c51e8, closes #215)
* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)
* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)
  * reenable atlas log upload tests (d56d86a6, closes #516)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)
* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)
* **xhr:** remove 30000ms timeout from all requests (thus leaving it up to the browser to t (b54a5b90)
* **xunit:** output xunit reports to proper location (795d1a6a)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)
* **Client:** Adds XHR upload progress events for request() (bfc51dab)
* **Conversation:**
  * add mentions endpoint and test (406ca61b)
  * create 1:1 via /conversations (08e029ef)
  * add midDate parameter to activity queries (aba9f355)
  * have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)
  * allows participantAckFilter query param when creating 1:1 room (bbe99ee6)
  * adds participantAckFilter query param to valid param list (516c4fc0)
  * deletes content (085dac95)
  * getSqurl (797c8fec)
* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request (90f1ce29)
* **Core:** implement each service as a plugin (f4720e3b)
* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Embargo:** add region data to WDM registration (66e8b53a)
* **Encryption:**
  * increment the encryption v2 feature toggle (8c6f7d83)
  * support side boarding via DRY (250fe3b8, closes #502)
  * Implement DRY method calls for add, create, and updateKey (357c33cb)
* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object (0e4f5b5a, closes #162)
* **Event:** add ability to decrypt events (e39e13fb, closes #410)
* **Features:** add support for user features (80131ecb, closes #594)
* **Fetcher:** start implementing generalized fethcer (fcf62d52)
* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)
* **KMS:**
  * timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval (0a200492, closes #358, #359, #360, #361)
  * add initial KMS integration with a ping test (226cfb96)
* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)
* **Mashups:** Allow option to fetch mashups for single room (810ee711)
* **Mercury:** emits offline replaced events (16e1966c)
* **Mercury5:** add metric for missed mercury sequence number (a5ff59ab, closes #234)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)
* **Spark:** add `refresh()` method to Spark (04546320)
* **Team:**
  * Archive teams and team conversations (05eb5ad5)
  * Add/remove Moderator for a team (9fae776d)
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)
* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users (3a11ffed, closes #384)
* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)
* **UserService:** Add support for changing display name (c7c7853c)
* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)
* **build:**
  * start adding docker parallelization (6dcd91fd)
  * add jscs-jsdoc to statis analysis (a85decbe)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **client:** Add Cisco-Device-URL to all requests (b0ad7ed9, closes #173)
* **common:** create @ciscospark/common (15a39ef6)
* **conversation:**
  * adds ability to lock/unlock, assignModerator/unassignModerator (8cc2035e)
  * add ability to hide/unhide conversations (592c4009)
* **dependencies:** update dependencies (cc348496)
* **documentation:** generate docs with external examples (4807dbba, closes #656)
* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)
* **example-postman:** Create Postman-like example (bdce765a)
* **feature toggle:** Set values on the features endpoint (b97c837a)
* **github-todos:** add github-todos to auto-generate github issues on successful builds (7fd1e2c7)
* **helper-html:** implement es6 html filter (eca591e7)
* **http-core:** add http-core sub project (6dd0068f)
* **logger:** make logger overridable via config (412b6b9a)
* **logging:** Improve log level granularity #161 - Add log level granularity #163 - Add initia (5af814b3)
* **mentions:** add support for `activity.object.content` and `activity.mentions` (12af8fe0)
* **mercury:**
  * parse 'headers' field into event. (0cdcc731)
  * replace mercury v5 with mercury v6 (43b3fe5f, closes #560)
  * clean lint (5a923637)
  * clear lint (55c73c36)
  * add pass through method for mercury4 ping compatibility (846ca1af)
  * add background retries (3aa8d6aa)
  * added test, max retries (90efe226)
  * add tests, implement reconnect triggers; add watch for unit tests (92d76997)
  * prevent multiple inflight mercury connections (52421946)
* **mercury5:**
  * fix bugs discovered by tests (3b2133b8)
  * added exponential backoff (4e2e6a4d)
* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)
* **sanitize-html:** add html sanitizer utility (f227452b)
* **share:** Create conversations beginning with a share (3c62d94c)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)
* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)
* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.57-1"></a>
### 0.5.57-1 (2016-03-11)


#### Bug Fixes

* **ciscospark:**
  * enable remaining integration tests (c24cfda9)
  * enable all ciscospark api tests (cbaee3af, closes #724)


<a name"0.5.57-0"></a>
### 0.5.57-0 (2016-03-10)


<a name"0.5.56"></a>
### 0.5.56 (2016-03-08)


<a name"0.5.56-2"></a>
### 0.5.56-2 (2016-03-08)


#### Bug Fixes

* **build:** lockdown version of babel-plugin-lodash (868bc3f7)
* **ciscospark:**
  * don't require ".default" when using es5 (ccbd5685)
  * correctly include babel-polyfill when needed (8a97fcc3, closes #749)
* **coverage:** load the appropriate source path during tests based on a test helper instead of  (da4f5149)


<a name"0.5.56-1"></a>
### 0.5.56-1 (2016-03-01)


#### Bug Fixes

* **ciscospark:** fix typo in Reflect.deleteProperty (e2f191de, closes #742)


<a name"0.5.56-0"></a>
### 0.5.56-0 (2016-02-29)


#### Bug Fixes

* **build:** disable coverage correctly in gating pipelines (33588939)


#### Features

* **helper-html:** implement es6 html filter (eca591e7)


<a name"0.5.55"></a>
### 0.5.55 (2016-02-25)


<a name"0.5.55-0"></a>
### 0.5.55-0 (2016-02-25)


<a name"0.5.54"></a>
### 0.5.54 (2016-02-25)


<a name"0.5.54-0"></a>
### 0.5.54-0 (2016-02-25)


#### Bug Fixes

* **html:** use lodash.assign instead of Object.assign (4d0c20a0)


<a name"0.5.53"></a>
### 0.5.53 (2016-02-24)


<a name"0.5.53-4"></a>
### 0.5.53-4 (2016-02-24)


#### Bug Fixes

* **security:** sanitize inbound and outbound html (cd62e2e1)


#### Features

* **sanitize-html:** add html sanitizer utility (f227452b)


<a name"0.5.53-3"></a>
### 0.5.53-3 (2016-02-22)


#### Bug Fixes

* **parse headers:** Remove outside 'data' parameter before parsing 'headers' parameter (23fbf992)


<a name"0.5.53-2"></a>
### 0.5.53-2 (2016-02-19)


#### Bug Fixes

* **ciscospark:** adjust exports to make es5 requires slightly prettier (2d8098e1, closes #727)


<a name"0.5.53-1"></a>
### 0.5.53-1 (2016-02-17)


#### Bug Fixes

* **http-core:** don't reverse interceptors on each request (9b0c91f1)


#### Features

* **documentation:** generate docs with external examples (4807dbba, closes #656)


<a name"0.5.53-0"></a>
### 0.5.53-0 (2016-02-11)


#### Bug Fixes

* **build:**
  * make sure grunt-cli is globally installed before trying to use it (880f297e)
  * add missing dependencies; change build phase from postinstall to prepublish (f379eeed)
* **build-tools:**
  * use is-ciscospark-module inside link-local (5133e497)
  * correctly parse package.json in isCiscosparkModule (a02a466a)
  * fix is-ciscospark-module (794da4ae)
  * add support for custom scopes (25fea8fb)
  * fix typo (3f6a0fab)
  * collect coverage correctly (b99a68bf)
* **deps:** remove reference to internal registry because it doesn't support scoped modules (1775f87a)
* **http-core:** replace magic with file-type to remove native dependency (09954450, closes #668)
* **karma:** fix local karma browser selection (748665ee)
* **spark-core:**
  * fix missing dependency (faa46f40)
  * use Reflect.apply correctly (according to Firefox) (ecaf4d47)
  * fix warning generated by ampersand-state (a8c6dc8e)
  * reposition checks for required variables so they only fail when needed (52ff1f13)
  * don't do infinite recursion (c12bd080)
* **spark-js-sdk:** add eslint-plugin-mocha-only to all modules to make editors happy (189369d6)
* **test:** fix the issue where testing with the xunit outputter hangs randomly (0ad2bc52)
* **unit-tests:**
  * require correct retry module (f137c2f4)
  * add retries to clock-sensitive unit tests (b51409dc)


#### Features

* **build:** start adding docker parallelization (6dcd91fd)
* **build-tools:**
  * add script for printing junit output (5232e051)
  * Implement test users helper (281c64c5)
  * centralize grunt, karma config (09bdeb8b)
  * Move sauce scripts to build-tools and ensure multiple test suites can share a si (4515c99d)
  * Create link-local for ensuring all sdk modules are linked to local versions of e (d4eda39f)
* **ciscospark:**
  * add support for pagination (d3230f52)
  * change default clientType (for third parties) to confidential (fbe391df)
  * add #webhooks (a1b82bc7)
  * add support for max and includeSipAddress query parameters for /rooms (b490fe75)
  * add /people (1bc429a3)
  * begin messages (a217a52d)
  * start memberships (a0241dac)
  * implement applications resource (1aff2cd3)
  * Implement rooms api (b7e8b46f)
* **common:** create @ciscospark/common (15a39ef6)
* **example-postman:** Create Postman-like example (bdce765a)
* **http-core:** add http-core sub project (6dd0068f)
* **spark-core:**
  * add browser support for credentials plugin (fbfa2ab8)
  * add redirect interceptor (ab468215)
  * implement auth interceptor with built-in token refresh (1a07c61e)
  * add authorization/authentication to spark-core (0eeeb794)
  * Begin implementation of spark-core (61bc1c69)


<a name"0.5.52"></a>
### 0.5.52 (2016-02-02)


<a name"0.5.52-0"></a>
### 0.5.52-0 (2016-02-02)


<a name"0.5.51"></a>
### 0.5.51 (2016-02-02)


<a name"0.5.51-1"></a>
### 0.5.51-1 (2016-02-02)


#### Bug Fixes

* **Conversation:** Update ack test for new ackFilter default of noack (35dc44f6)


<a name"0.5.51-0"></a>
### 0.5.51-0 (2016-01-28)


#### Bug Fixes

* **mercury:**
  * Implement comments from PR #688 (a77cf4c0)
  * Implement comments in PR #686 (381a43d0)


#### Features

* **mercury:** parse 'headers' field into event. (0cdcc731)


<a name"0.5.50"></a>
### 0.5.50 (2016-01-20)


<a name"0.5.50-1"></a>
### 0.5.50-1 (2016-01-20)


#### Bug Fixes

* **Credentials:** don't try to authenticate if already authenticated (4c80f3f0)
* **core:** add missing return (80f81f18)


<a name"0.5.50-0"></a>
### 0.5.50-0 (2016-01-20)


<a name"0.5.49"></a>
### 0.5.49 (2016-01-19)


<a name"0.5.49-1"></a>
### 0.5.49-1 (2016-01-15)


#### Bug Fixes

* **conversation:** add key rotation test (33d05154, closes #682)
* **encryption:** correctly handle key rotation in v2 environments (cb80671f)


<a name"0.5.49-0"></a>
### 0.5.49-0 (2016-01-14)


#### Bug Fixes

* **Team:**
  * Decrypt properties on update activity (bb274559)
  * Remove unnecessary checks for displayname on team and team convo creation (ebe67cec)


#### Features

* **Team:** Archive teams and team conversations (05eb5ad5)


<a name"0.5.48"></a>
### 0.5.48 (2016-01-13)


<a name"0.5.48-0"></a>
### 0.5.48-0 (2016-01-12)


<a name"0.5.47"></a>
### 0.5.47 (2016-01-12)


<a name"0.5.47-1"></a>
### 0.5.47-1 (2016-01-12)


#### Bug Fixes

* **logging:** stringify error messages in log uploads (73516a4d, closes #676)


<a name"0.5.47-0"></a>
### 0.5.47-0 (2016-01-08)


<a name"0.5.46"></a>
### 0.5.46 (2015-12-24)


<a name"0.5.46-0"></a>
### 0.5.46-0 (2015-12-24)


#### Bug Fixes

* **encryption:** add cappedDebounce to keep key request batches small enough to prevent 500s (de13c988)


<a name"0.5.45"></a>
### 0.5.45 (2015-12-16)


<a name"0.5.45-0"></a>
### 0.5.45-0 (2015-12-16)


#### Bug Fixes

* **Encryption:** Enable v2 if teams is enabled (b32442c0)


<a name"0.5.44"></a>
### 0.5.44 (2015-12-15)


<a name"0.5.44-0"></a>
### 0.5.44-0 (2015-12-15)


#### Features

* **wdm:** point DEVICE_REGISTRATION_URL at wdm microservice (bfd29743, closes #644)


<a name"0.5.43"></a>
### 0.5.43 (2015-12-15)


<a name"0.5.43-2"></a>
### 0.5.43-2 (2015-12-15)


<a name"0.5.43-1"></a>
### 0.5.43-1 (2015-12-14)


#### Features

* **sticker:**
  * fixing style (d7800fe8)
  * add encryption and decryption for sticker url (imageURI) (c5e910c4)
  * add encryption and decryption for sticker url (97aced08)


<a name"0.5.43-0"></a>
### 0.5.43-0 (2015-12-07)


#### Bug Fixes

* **xunit:** output xunit reports to proper location (795d1a6a)


<a name"0.5.42"></a>
### 0.5.42 (2015-12-05)


<a name"0.5.42-0"></a>
### 0.5.42-0 (2015-12-05)


#### Bug Fixes

* **encryption:** do not cache unbound keys (51f10cc1)


<a name"0.5.41"></a>
### 0.5.41 (2015-12-03)


<a name"0.5.41-0"></a>
### 0.5.41-0 (2015-12-03)


#### Bug Fixes

* **Team:** Team Conversations also require a displayName (b809b669)


<a name"0.5.40"></a>
### 0.5.40 (2015-12-02)


<a name"0.5.40-0"></a>
### 0.5.40-0 (2015-12-02)


#### Bug Fixes

* **encryption:** don't hang forever if ecdhe times out (cf50bd9b, closes #641)


<a name"0.5.39"></a>
### 0.5.39 (2015-12-02)


<a name"0.5.39-0"></a>
### 0.5.39-0 (2015-12-02)


#### Bug Fixes

* **Team:** Require displayName in team.create and team.update payloads (380323f3)


<a name"0.5.38"></a>
### 0.5.38 (2015-12-01)


<a name"0.5.38-2"></a>
### 0.5.38-2 (2015-12-01)


#### Bug Fixes

* **Team:** use Kirk instead of mccoy in Team moderator tests (325204a3)


#### Features

* **Team:** Add/remove Moderator for a team (9fae776d)


<a name"0.5.38-1"></a>
### 0.5.38-1 (2015-12-01)


<a name"0.5.38-0"></a>
### 0.5.38-0 (2015-12-01)


#### Bug Fixes

* **Team:**
  * remove collisions of forceECDH for characters used in multiple tests (3f7ec7b2)
  * Make team#prepareTeamConversation return promise (594d7474)
  * Update addMember and removeMember encryption (ea14e9c6)
  * Fix Teams for enc v2 (0b298f87)


<a name"0.5.37"></a>
### 0.5.37 (2015-11-18)


<a name"0.5.37-0"></a>
### 0.5.37-0 (2015-11-18)


<a name"0.5.36"></a>
### 0.5.36 (2015-11-16)


<a name"0.5.36-1"></a>
### 0.5.36-1 (2015-11-12)


#### Bug Fixes

* **MercuryV6:** actually start ping/pong (c1326e01)


#### Features

* **mercury:** replace mercury v5 with mercury v6 (43b3fe5f, closes #560)


<a name"0.5.36-0"></a>
### 0.5.36-0 (2015-11-11)


#### Features

* **encryption:** Support federated kms public keys (9c34e1b5, closes #618)


<a name"0.5.35"></a>
### 0.5.35 (2015-11-11)


<a name"0.5.35-0"></a>
### 0.5.35-0 (2015-11-11)


#### Bug Fixes

* **Team:**
  * Don't allow Uhura to be beamed up and have her access token deleted during tests (cd72dfb2)
  * Allow get to accept a team-like object (0b3f3bad)
  * Use the encrypter, decrypter, and normalizer from conversation (b77c4a06)


#### Features

* **Team:**
  * Add removeMember functionality (45ac4961)
  * Add update for team summary and adjust function defns (79cec17e)
  * Add support for adding teammates and updating team title (2c1b6a3e)
  * Add participant to team skeleton (c0040fd8)
  * Add API calls and integration tests for teams (70793e7e)
  * Add TeamService skeleton (0b84318e)


<a name"0.5.34"></a>
### 0.5.34 (2015-11-06)


<a name"0.5.34-2"></a>
### 0.5.34-2 (2015-11-06)


#### Bug Fixes

* **Mashups:** Allow options.roomId on get() (5b7f6f0d)


#### Features

* **Mashups:** Allow option to fetch mashups for single room (810ee711)


<a name"0.5.34-1"></a>
### 0.5.34-1 (2015-11-06)


#### Bug Fixes

* **pipeline:** remove encryption-disabled tests which break other tests on failure (f6c4385b, closes #614)


<a name"0.5.34-0"></a>
### 0.5.34-0 (2015-10-30)


<a name"0.5.33"></a>
### 0.5.33 (2015-10-26)


<a name"0.5.33-0"></a>
### 0.5.33-0 (2015-10-26)


#### Features

* **Features:** add support for user features (80131ecb, closes #594)


<a name"0.5.32"></a>
### 0.5.32 (2015-10-23)


<a name"0.5.32-0"></a>
### 0.5.32-0 (2015-10-22)


<a name"0.5.31"></a>
### 0.5.31 (2015-10-20)


<a name"0.5.31-2"></a>
### 0.5.31-2 (2015-10-20)


#### Features

* **Signed Tokens:** enable signed tokens for all auth schemes (3b74cec3)


<a name"0.5.31-1"></a>
### 0.5.31-1 (2015-10-14)


<a name"0.5.31-0"></a>
### 0.5.31-0 (2015-10-14)


<a name"0.5.30"></a>
### 0.5.30 (2015-10-13)


<a name"0.5.30-0"></a>
### 0.5.30-0 (2015-10-13)


#### Bug Fixes

* **pipeline:** correctly point at local .tmp directory (4ffaf5ec)


<a name"0.5.29"></a>
### 0.5.29 (2015-10-13)


<a name"0.5.29-1"></a>
### 0.5.29-1 (2015-10-13)


#### Bug Fixes

* **KMS:** inject token into kms context on every request (2b16426c, closes #570)


<a name"0.5.29-0"></a>
### 0.5.29-0 (2015-10-13)


#### Bug Fixes

* **tests:**
  * only store logs for failing tests (0bf208ba, closes #573)
  * don't write log files to /tmp (7976712a, closes #574)


<a name"0.5.28"></a>
### 0.5.28 (2015-10-12)


<a name"0.5.28-3"></a>
### 0.5.28-3 (2015-10-12)


#### Bug Fixes

* **Conversation:**
  * incorrect parameter format (630102b9)
  * use PUT in encryption v1 (d7c4783c)
* **ConversationTest:** 1:1 Sideboard test fix) (793c9615)


<a name"0.5.28-2"></a>
### 0.5.28-2 (2015-10-10)


#### Bug Fixes

* **ShareActivity:** Exclude erroneous encryptedSCR from payload (bfddebcf)


<a name"0.5.28-1"></a>
### 0.5.28-1 (2015-10-07)


#### Features

* **Conversation:** add mentions endpoint and test (406ca61b)


<a name"0.5.28-0"></a>
### 0.5.28-0 (2015-10-07)


<a name"0.5.27"></a>
### 0.5.27 (2015-10-01)


<a name"0.5.27-0"></a>
### 0.5.27-0 (2015-10-01)


#### Bug Fixes

* **Conversation:** Add params to getPersonalConvo call (b3c0ee16)


<a name"0.5.26"></a>
### 0.5.26 (2015-09-25)


<a name"0.5.26-0"></a>
### 0.5.26-0 (2015-09-25)


#### Bug Fixes

* **Conversation:** accept full user objects as conversation participants (e3c9f77c, closes #559)


<a name"0.5.25"></a>
### 0.5.25 (2015-09-23)


<a name"0.5.25-0"></a>
### 0.5.25-0 (2015-09-23)


<a name"0.5.24"></a>
### 0.5.24 (2015-09-22)


<a name"0.5.24-0"></a>
### 0.5.24-0 (2015-09-22)


<a name"0.5.23"></a>
### 0.5.23 (2015-09-21)


<a name"0.5.23-1"></a>
### 0.5.23-1 (2015-09-21)


#### Bug Fixes

* **tests:** reenable atlas log upload tests (d56d86a6, closes #516)


<a name"0.5.23-0"></a>
### 0.5.23-0 (2015-09-21)


#### Features

* **Conversation:** create 1:1 via /conversations (08e029ef)


<a name"0.5.22"></a>
### 0.5.22 (2015-09-15)


<a name"0.5.22-1"></a>
### 0.5.22-1 (2015-09-15)


<a name"0.5.22-0"></a>
### 0.5.22-0 (2015-09-15)


#### Bug Fixes

* **KMS:** use separate code paths for decrypting ECDH messages, normal kms messages (0408f0fe, closes #524)


#### Features

* **Encryption:** increment the encryption v2 feature toggle (8c6f7d83)


<a name"0.5.21"></a>
### 0.5.21 (2015-09-11)


<a name"0.5.21-0"></a>
### 0.5.21-0 (2015-09-11)


#### Features

* **LICENSE:** license the project under the Apache 2.0 license (38a7397b)


<a name"0.5.20"></a>
### 0.5.20 (2015-09-08)


<a name"0.5.20-0"></a>
### 0.5.20-0 (2015-09-08)


#### Bug Fixes

* **ShareActivity:**
  * Include clientTempIds on files in prepared ShareActivity (fa26490f)
  * Fire progress events from file uploads (8356e1d0)


<a name"0.5.19"></a>
### 0.5.19 (2015-09-08)


<a name"0.5.19-3"></a>
### 0.5.19-3 (2015-09-08)


#### Bug Fixes

* **Mercury:** handle newly added close reasons (91547003)


<a name"0.5.19-2"></a>
### 0.5.19-2 (2015-09-04)


<a name"0.5.19-1"></a>
### 0.5.19-1 (2015-09-04)


#### Bug Fixes

* **Mercury:** handle a situation where mercury errors may be completely suppressed and ignored (719ec651)


<a name"0.5.19-0"></a>
### 0.5.19-0 (2015-09-02)


#### Bug Fixes

* **Normalizer:** fix bug when looking up UUIDs (6cce86fe)


#### Features

* **Conversation:** add midDate parameter to activity queries (aba9f355)


<a name"0.5.18"></a>
### 0.5.18 (2015-08-29)


<a name"0.5.18-0"></a>
### 0.5.18-0 (2015-08-29)


#### Bug Fixes

* **sideboarding:** fix sideboarding in all the places (cb01d458)


<a name"0.5.17"></a>
### 0.5.17 (2015-08-29)


<a name"0.5.17-1"></a>
### 0.5.17-1 (2015-08-29)


#### Bug Fixes

* **sideboarding:** do not lookup uuids during add() (d630fd33)


<a name"0.5.17-0"></a>
### 0.5.17-0 (2015-08-28)


<a name"0.5.16"></a>
### 0.5.16 (2015-08-28)


<a name"0.5.16-7"></a>
### 0.5.16-7 (2015-08-28)


#### Bug Fixes

* **Mercury:** use correct close code used when intentionally closing the socket from the clien (b9b79ebe)


<a name"0.5.16-6"></a>
### 0.5.16-6 (2015-08-27)


#### Features

* **Encryption:** support side boarding via DRY (250fe3b8, closes #502)


<a name"0.5.16-5"></a>
### 0.5.16-5 (2015-08-27)


#### Bug Fixes

* **upload:** add x-trans-id header to direct-to-swift uploads (d1b5f8d0, closes #525)


<a name"0.5.16-4"></a>
### 0.5.16-4 (2015-08-27)


<a name"0.5.16-3"></a>
### 0.5.16-3 (2015-08-27)


<a name"0.5.16-2"></a>
### 0.5.16-2 (2015-08-27)


#### Bug Fixes

* **ShareActivity:** Add suffix on thumbnail upload path (4e483b80)


<a name"0.5.16-1"></a>
### 0.5.16-1 (2015-08-27)


<a name"0.5.16-0"></a>
### 0.5.16-0 (2015-08-27)


<a name"0.5.15"></a>
### 0.5.15 (2015-08-26)


<a name"0.5.15-4"></a>
### 0.5.15-4 (2015-08-26)


<a name"0.5.15-3"></a>
### 0.5.15-3 (2015-08-26)


<a name"0.5.15-2"></a>
### 0.5.15-2 (2015-08-26)


#### Bug Fixes

* **TestLogger:** correctly omit body when stringifying request options (9b858d8b)
* **rally:** attempt to stabilize rallyOn/rallyOff tests (d0794a06)


<a name"0.5.15-1"></a>
### 0.5.15-1 (2015-08-21)


<a name"0.5.15-0"></a>
### 0.5.15-0 (2015-08-21)


#### Bug Fixes

* **deps:** update to latest node-jose to avoid breakage in safari 7 (a273cacd)


<a name"0.5.14"></a>
### 0.5.14 (2015-08-15)


<a name"0.5.14-4"></a>
### 0.5.14-4 (2015-08-15)


<a name"0.5.14-3"></a>
### 0.5.14-3 (2015-08-14)


#### Bug Fixes

* **Conversation:** Store blobs in FileCache and correctly return objectURL (89003b0a)
* **Tests:** Update tests to use converation#download (eb7a8805)


<a name"0.5.14-2"></a>
### 0.5.14-2 (2015-08-14)


<a name"0.5.14-1"></a>
### 0.5.14-1 (2015-08-11)


#### Bug Fixes

* **TestLogger:** correctly format verbose log output (7391a638)


#### Features

* **User:** keep track of user existence and create new users via the uuid endpoint (cb43fcb7)


<a name"0.5.14-0"></a>
### 0.5.14-0 (2015-08-11)


#### Bug Fixes

* **Bot:** add tries to machine account authentication (f4e244c6)


<a name"0.5.13"></a>
### 0.5.13 (2015-08-11)


<a name"0.5.13-0"></a>
### 0.5.13-0 (2015-08-11)


#### Bug Fixes

* **Metrics:** Add requests directly to queue when using DummyBatchedRequestStore (5595232c)


<a name"0.5.12"></a>
### 0.5.12 (2015-08-09)


<a name"0.5.12-0"></a>
### 0.5.12-0 (2015-08-09)


#### Features

* **Files:**
  * generate thumbnails, process image data in nodeland (8e45150a, closes #447)
  * Separate getBinary() into Conversation#download() and Encryption#download() (5740db06, closes #154, #157)


<a name"0.5.11"></a>
### 0.5.11 (2015-08-05)


<a name"0.5.11-1"></a>
### 0.5.11-1 (2015-08-05)


<a name"0.5.11-0"></a>
### 0.5.11-0 (2015-08-05)


#### Bug Fixes

* **Metrics:** Circonus Metrics use DummyBatchedRequestStore (f048b30a)


<a name"0.5.10"></a>
### 0.5.10 (2015-08-04)


<a name"0.5.10-2"></a>
### 0.5.10-2 (2015-08-04)


<a name"0.5.10-1"></a>
### 0.5.10-1 (2015-08-04)


<a name"0.5.10-0"></a>
### 0.5.10-0 (2015-08-03)


<a name"0.5.9"></a>
### 0.5.9 (2015-07-31)


<a name"0.5.9-1"></a>
### 0.5.9-1 (2015-07-31)


#### Bug Fixes

* **Conversation:** adds an option to create conversation with compact param (a9764825)
* **test:** modifies more tests to accommodate for creating compact conversation by default (a0a1c349)


<a name"0.5.9-0"></a>
### 0.5.9-0 (2015-07-31)


<a name"0.5.8"></a>
### 0.5.8 (2015-07-30)


<a name"0.5.8-0"></a>
### 0.5.8-0 (2015-07-30)


#### Bug Fixes

* **ConversationService:** adds an option to request unmuted unread conversations to unread endpoint (c10cc50d)


<a name"0.5.7"></a>
### 0.5.7 (2015-07-28)


<a name"0.5.7-5"></a>
### 0.5.7-5 (2015-07-24)


<a name"0.5.7-4"></a>
### 0.5.7-4 (2015-07-24)


#### Bug Fixes

* **Conversation:** assign encryption key when creating 1:1 (6dbefd50)
* **DRY:** do not include "Bearer" string in KMS "bearer" property (4c0ce739, closes #467)
* **Encryption:** correctly escalate key retrieval if too all retrieved keys are nearly bound (b70016c5)


<a name"0.5.7-3"></a>
### 0.5.7-3 (2015-07-24)


#### Bug Fixes

* **lint:** fixed lint error (6ecd207d)
* **relevant:**
  * Use unique users in get module so feature toggle cache doesn't affect relevant t (d44d7e7e)
  * instrument a test to see why relevant test fails on build but passes locally (e006fa26)
  * Use the lastRelevantActivityDate to filter original conversations to account for (8d51b6e8)


<a name"0.5.7-2"></a>
### 0.5.7-2 (2015-07-23)


<a name"0.5.7-1"></a>
### 0.5.7-1 (2015-07-23)


#### Bug Fixes

* **test stability:** disable listUnread test due to extreme endpoint latency (1685a7ee)


<a name"0.5.7-0"></a>
### 0.5.7-0 (2015-07-23)


<a name"0.5.6"></a>
### 0.5.6 (2015-07-21)


<a name"0.5.6-2"></a>
### 0.5.6-2 (2015-07-20)


#### Bug Fixes

* **Feature:** respond to code review (0ca211cf)
* **Features:**
  * add device.features event and test for device refresh (65c6f25d)
  * Make Features-model propagate events from collection children (68232ac3)


<a name"0.5.6-1"></a>
### 0.5.6-1 (2015-07-20)


#### Bug Fixes

* **ShareActivity:**
  * respond to review comments (3b409b84)
  * Only add file if not present (39c23d3d)


<a name"0.5.6-0"></a>
### 0.5.6-0 (2015-07-10)


#### Bug Fixes

* **ShareActivity:**
  * Rename initShareActivity (be1c76dd)
  * OneFlight for SpaceUrls (5ac2f33b)
  * Respond to review comments (7a24748e)
  * Maintain order of files after uploading (814bff25)
  * Merge pending files (fb9fe66d)
  * activity.object.* are no longer lost (6c7c7e43)
  * Respond to review comments (8f609a7a)
  * Allow other properties (ee2bb764)
* **UnitTests:** Update Conversation Unit tests for new prepareActivity (71610961)
* **lint:** clean lint (fa0de2ce)
* **test:** make _prepareActivity tests call the function directly (d51292d9)


<a name"0.5.5"></a>
### 0.5.5 (2015-07-10)


<a name"0.5.5-0"></a>
### 0.5.5-0 (2015-07-10)


#### Bug Fixes

* **Batching:** make sure request id never stringifies to [Object object] (a6be3919)
* **EncryptionMetrics:** move async metrics computation from start to submit so we don't try to submit be (6b003f69)


<a name"0.5.4"></a>
### 0.5.4 (2015-07-10)


<a name"0.5.4-0"></a>
### 0.5.4-0 (2015-07-10)


#### Bug Fixes

* **DRY:** Disable ECDH and DRY tests (8b21f260)
* **Machine Auth:** retry machine account auth to deal with server race condition (7b777b41)


<a name"0.5.3"></a>
### 0.5.3 (2015-07-06)


<a name"0.5.3-1"></a>
### 0.5.3-1 (2015-07-04)


<a name"0.5.3-0"></a>
### 0.5.3-0 (2015-07-04)


#### Bug Fixes

* **Features:** parse features correctly (56445bcf)


<a name"0.5.2"></a>
### 0.5.2 (2015-07-01)


<a name"0.5.2-2"></a>
### 0.5.2-2 (2015-07-01)


<a name"0.5.2-1"></a>
### 0.5.2-1 (2015-07-01)


#### Bug Fixes

* **Metric:** fix bad merge which broke metrics reporting (b37028fc)


<a name"0.5.2-0"></a>
### 0.5.2-0 (2015-06-30)


#### Bug Fixes

* **Device:** don't send features when refreshing device (f75b3deb)


#### Features

* **Core:** implement each service as a plugin (f4720e3b)


<a name"0.5.1"></a>
### 0.5.1 (2015-06-29)


<a name"0.5.1-7"></a>
### 0.5.1-7 (2015-06-29)


<a name"0.5.1-6"></a>
### 0.5.1-6 (2015-06-29)


<a name"0.5.1-5"></a>
### 0.5.1-5 (2015-06-29)


#### Bug Fixes

* **dependencies:** add missing dependency to dep list (f7d310ad)


<a name"0.5.1-4"></a>
### 0.5.1-4 (2015-06-23)


#### Bug Fixes

* **Mercury:** emit socket events consistently (ea882a4c)


<a name"0.5.1-3"></a>
### 0.5.1-3 (2015-06-19)


<a name"0.5.1-2"></a>
### 0.5.1-2 (2015-06-18)


#### Features

* **DRY:**
  * adjust `leave` tests to prove DRY leave (09b98ee0)
  * implement leave; correctly parse kms error blobs (4efe1c9d)
* **Encryption:** Implement DRY method calls for add, create, and updateKey (357c33cb)
* **KMS:** timeout KMS requests; retry timed-out requests; refresh ephemeral key (790e976e, closes #362, #363)


<a name"0.5.1-1"></a>
### 0.5.1-1 (2015-06-17)


<a name"0.5.1-0"></a>
### 0.5.1-0 (2015-06-12)


#### Features

* **Conversation:** have #getPersonalConversation accept `participantAckFilter` as one of the query  (104a1fbc)


<a name"0.5.0"></a>
## 0.5.0 (2015-06-12)


<a name"0.5.0-6"></a>
### 0.5.0-6 (2015-06-12)


<a name"0.5.0-5"></a>
### 0.5.0-5 (2015-06-10)


#### Features

* **Util:** export Utility methods on the Spark object (bcd8181a, closes #393)


<a name"0.5.0-4"></a>
### 0.5.0-4 (2015-06-10)


#### Bug Fixes

* **redirect:** handle no headers case in redirect processor (79213527)


#### Features

* **AppLevelRedirect:** add support for application-level redirect (87330afa, closes #387)


<a name"0.5.0-3"></a>
### 0.5.0-3 (2015-06-10)


#### Bug Fixes

* **Auth:** recover from 401 from WDM while authenticate() is in flight (d9a6bf1b)


#### Features

* **oneFlight:** add debug logging when a oneFlight method is reinvoked (be37b700)


<a name"0.5.0-2"></a>
### 0.5.0-2 (2015-06-10)


#### Bug Fixes

* **Auth:** use correct SAML API (728af5cf)
* **landingparty:** handle spock: `false` scenario better (27e41542)


<a name"0.5.0-1"></a>
### 0.5.0-1 (2015-06-04)


#### Bug Fixes

* **Auth:**
  * use force:true when reauthenticating via the auth processor (924619f3)
  * prevent authentication deadlock by marking Authentication related requests as no (164ce206, closes #231)
* **Client:** add support for options.auth to client shim (df79ec4a)
* **Core:** adjust ampersand state hierarchy so change events bubble correctly (4c04bb88)
* **Credentials:**
  * handle query and hash OAuth responses in a consistent manner (a5b836d7)
  * handle query and hash OAuth responses in a consistent manner (b30cfb69)
* **Docs:** update doc url with current version (386414ce)
* **Gruntfile:** fix order of release tasks to create docs at correctly versioned path (059cc7ba)
* **KeyRequestBatcher:** fix missed method rename (2db00988)
* **LandingParty:** ensure beamup erases all users so it can safely be used in the next stage of tes (11902ded)
* **Mercury:**
  * ensure Mercury does not connect while authentication is in flight (eee49ee4)
  * make sure spark.listening updates correctly when socket.readyState changes (88c0dff4)
* **Refresh:** add test to confirm automatic token refresh occurs (0f81a484)
* **Socket:** change Socket so its readyState is observable so Mercury reconnects correctly. (fa5c144f)
* **Spark:** ensure required config parameters are defined (ec90f296, closes #214, #344)
* **trackingId:** proxy trackingId to trackingID because case is hard (1a15e63e)


#### Features

* **Credentials:** support making direct calls to CI in the browser for confidential clients using  (825add06)
* **OAuth:**
  * Implement implicit grant (17a8b4c2)
  * Reimplement authentication for nodejs clients (including Machine accounts) (ef609e4b)
* **Spark:** add `refresh()` method to Spark (04546320)
* **dependencies:** update dependencies (cc348496)


<a name="0.4.129"></a>
### 0.4.129 (2015-05-28)


<a name="0.4.129-0"></a>
### 0.4.129-0 (2015-05-28)


<a name="0.4.128"></a>
### 0.4.128 (2015-05-27)


<a name="0.4.128-0"></a>
### 0.4.128-0 (2015-05-27)


#### Features

* **Conversation:**
  * allows participantAckFilter query param when creating 1:1 room ([bbe99ee6](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/bbe99ee654a0c8729dd1931c2a892b6a3cf16836))
  * adds participantAckFilter query param to valid param list ([516c4fc0](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/516c4fc04b84f335881b115132fa39da67fa9ac7))


<a name="0.4.127"></a>
### 0.4.127 (2015-05-26)


<a name="0.4.127-0"></a>
### 0.4.127-0 (2015-05-22)


<a name="0.4.126"></a>
### 0.4.126 (2015-05-21)


<a name="0.4.126-1"></a>
### 0.4.126-1 (2015-05-21)


#### Bug Fixes

* **support:**
  * adds test to unsure unknown key is not added to metadata ([5481533d](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/5481533da04716665a1c99a11b6e07b697b2a8bf))
  * uses feedbackId if provided when retrieving desk.com url ([5471211a](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/5471211aa6ec777899181ae8b7b4e294274d81f0))
  * adds tracking id to metadata when uploading logs and adds tests ([383c4226](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/383c42268182c4a2fb443cd42f5a472c91c5fe46))


<a name="0.4.126-0"></a>
### 0.4.126-0 (2015-05-21)


<a name="0.4.125"></a>
### 0.4.125 (2015-05-19)


<a name="0.4.125-2"></a>
### 0.4.125-2 (2015-05-15)


#### Bug Fixes

* **Mentions:** correctly put mentions property on comment object instead of activity object ([5687d4b2](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/5687d4b26e6a05e792427382529f2b57721b72b2))


<a name="0.4.125-1"></a>
### 0.4.125-1 (2015-05-15)


<a name="0.4.125-0"></a>
### 0.4.125-0 (2015-05-13)


#### Features

* **Event:** add ability to decrypt events ([e39e13fb](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/e39e13fb6321b87df6be1403b301e3102da8bcd7), closes [#410](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/410))
* **mentions:** add support for `activity.object.content` and `activity.mentions` ([12af8fe0](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/12af8fe0c547ab9ecc85c7fce170949179493cc6))


<a name="0.4.124"></a>
### 0.4.124 (2015-05-08)


<a name="0.4.124-1"></a>
### 0.4.124-1 (2015-05-08)


<a name="0.4.124-0"></a>
### 0.4.124-0 (2015-05-06)


<a name="0.4.123"></a>
### 0.4.123 (2015-05-04)


<a name="0.4.123-0"></a>
### 0.4.123-0 (2015-05-02)


#### Features

* **KMS:**
  * Implement KMS ping, KMS unbound key creation, KMS identified key retrieval ([0a200492](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/0a20049295bfa5952fb10d66aaad17cc7294502b), closes [#358](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/358), [#359](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/359), [#360](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/360), [#361](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/361))
  * add initial KMS integration with a ping test ([226cfb96](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/226cfb96d3958b55f4fc22b595514c8386a3d1e5))


<a name="0.4.122"></a>
### 0.4.122 (2015-05-01)


<a name="0.4.122-2"></a>
### 0.4.122-2 (2015-05-01)


<a name="0.4.122-1"></a>
### 0.4.122-1 (2015-05-01)


#### Features

* **Errors:** wrap responses of failed HTTP requests in subclasses of Error object ([0e4f5b5a](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/0e4f5b5ad065085368b8cbc76d9cbe848f7098b8), closes [#162](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/162))


<a name="0.4.122-0"></a>
### 0.4.122-0 (2015-05-01)


<a name="0.4.121"></a>
### 0.4.121 (2015-05-01)


<a name="0.4.121-3"></a>
### 0.4.121-3 (2015-04-30)


#### Features

* **TestUsers:** move to secure test_users endpoint via spark-js-sdk--test-users ([3a11ffed](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/3a11ffed204896892bcec5a7199bdf59ed5fdd50), closes [#384](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/384))


<a name="0.4.121-2"></a>
### 0.4.121-2 (2015-04-29)


#### Bug Fixes

* **Authorization:** add `shouldRefreshAccessToken` option to Client#request() to indicate whether or ([2d888fa8](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/2d888fa860ea96a88e37ed02a41fe0218924c13d), closes [#323](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/323))


<a name="0.4.121-1"></a>
### 0.4.121-1 (2015-04-29)


<a name="0.4.121-0"></a>
### 0.4.121-0 (2015-04-29)


<a name="0.4.120"></a>
### 0.4.120 (2015-04-27)


<a name="0.4.120-0"></a>
### 0.4.120-0 (2015-04-26)


#### Bug Fixes

* **MercuryTests:** separate user creation from dynamic logging token retrieval ([fa578d72](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/fa578d72db5d85857727cef8ad298623e6c5f9c9))


<a name="0.4.119"></a>
### 0.4.119 (2015-04-23)


<a name="0.4.119-1"></a>
### 0.4.119-1 (2015-04-23)


<a name="0.4.119-0"></a>
### 0.4.119-0 (2015-04-23)


#### Bug Fixes

* **dependencies:** change lodash to ^ operators to match ampersand dependencies ([fd81bf9c](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/fd81bf9c37f5be3df5b7a579a1a9ada3a2ea1bac))


<a name="0.4.118"></a>
### 0.4.118 (2015-04-21)


<a name="0.4.118-0"></a>
### 0.4.118-0 (2015-04-21)


#### Features

* **Conversation:** deletes content ([085dac95](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/085dac9510a13b746e3231c68b0ef5d80de5b43b))


<a name="0.4.117"></a>
### 0.4.117 (2015-04-16)


<a name="0.4.117-0"></a>
### 0.4.117-0 (2015-04-16)


<a name="0.4.116"></a>
### 0.4.116 (2015-04-15)


<a name="0.4.116-0"></a>
### 0.4.116-0 (2015-04-15)


#### Bug Fixes

* **Client:** Only add upload.onprogress to requests that can have upload progress events ([ace97319](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/ace9731906a1d108205144e9e194c8fcd1dea1f8))


<a name="0.4.115"></a>
### 0.4.115 (2015-04-14)


<a name="0.4.115-0"></a>
### 0.4.115-0 (2015-04-14)


#### Bug Fixes

* **Auth:** force Auth header for first-party cookie call ([dbd84d75](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/dbd84d755a691ffbc35ec8e47ac1a1284b091e60), closes [#378](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/378))


<a name="0.4.114"></a>
### 0.4.114 (2015-04-14)


<a name="0.4.114-9"></a>
### 0.4.114-9 (2015-04-14)


#### Bug Fixes

* **retry:** retries with options.maxDelay if given ([8cb27ea8](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/8cb27ea8068b93e6da2121304748dc8a906c0a48))


<a name="0.4.114-8"></a>
### 0.4.114-8 (2015-04-13)


#### Bug Fixes

* **Auth:** refactor auth processor to whitelist rather than blacklist ([be56a96c](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/be56a96c892563cb2e6dde2e5e5dedac829608f2), closes [#353](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/353))


<a name="0.4.114-7"></a>
### 0.4.114-7 (2015-04-13)


#### Features

* **Client:** Adds XHR upload progress events for request() ([bfc51dab](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/bfc51dab862e06d837fcd413a4b06142466d9dae))


<a name="0.4.114-6"></a>
### 0.4.114-6 (2015-04-10)


<a name="0.4.114-5"></a>
### 0.4.114-5 (2015-04-10)


<a name="0.4.114-4"></a>
### 0.4.114-4 (2015-04-08)


#### Bug Fixes

* **Mercury:**
  * fix mistyped timer names ([85e2218c](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/85e2218c255c27048708e79ee96f38f5c4b222fe), closes [#305](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/305))
  * properly handle 'Done' as the reason when locally closing a Mercury connection ( ([ac4c1c81](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/ac4c1c8162b579043127e4364ce5a52d9e924959))
  * return a Promise from `Mercury#stopListening()`; use `Mercury_#emit()` for all e ([7371f210](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/7371f210caaab75f9d6291825234c8b7c5a548f0), closes [#346](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/346))


<a name="0.4.114-3"></a>
### 0.4.114-3 (2015-04-07)


<a name="0.4.114-2"></a>
### 0.4.114-2 (2015-04-07)


<a name="0.4.114-1"></a>
### 0.4.114-1 (2015-04-07)


#### Bug Fixes

* **ListUnreadTest:** attempt to stabilize listUnread() test ([b5a4d3fd](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/b5a4d3fd933d245c33543a003d515792ea986c6c))


<a name="0.4.114-0"></a>
### 0.4.114-0 (2015-04-06)


<a name="0.4.113"></a>
### 0.4.113 (2015-04-06)


<a name="0.4.113-2"></a>
### 0.4.113-2 (2015-04-06)


<a name="0.4.113-1"></a>
### 0.4.113-1 (2015-04-06)


#### Bug Fixes

* **Test:** adjust timings in Socket tests to (hopefully) reduce flakiness ([c9eeb52e](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/c9eeb52eee392a0c3281f6977dd3ae0adf150662))


<a name="0.4.113-0"></a>
### 0.4.113-0 (2015-04-03)


<a name="0.4.112"></a>
### 0.4.112 (2015-04-02)


<a name="0.4.112-1"></a>
### 0.4.112-1 (2015-04-02)


#### Bug Fixes

* **KeyRequestBatcher:** fix type checking in batched request store; fix incomplete key retrieval retries ([7c77cc8f](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/7c77cc8f52ccb68dac1596365a3d78d583729384))


<a name="0.4.112-0"></a>
### 0.4.112-0 (2015-04-02)


<a name="0.4.111"></a>
### 0.4.111 (2015-04-01)


<a name="0.4.111-0"></a>
### 0.4.111-0 (2015-04-01)


#### Bug Fixes

* **Avatar:** look for email address in `emailAddress` also ([20f5c2fc](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/20f5c2fc521c448ce4aa12083f19833059778c59))
* **User:** only cache user's id and email address ([b156cfde](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/b156cfde00e90128570c67d546abf59c6b7b65da))


<a name="0.4.110"></a>
### 0.4.110 (2015-04-01)


<a name="0.4.110-0"></a>
### 0.4.110-0 (2015-04-01)


<a name="0.4.109"></a>
### 0.4.109 (2015-04-01)


<a name="0.4.109-1"></a>
### 0.4.109-1 (2015-03-31)


#### Features

* **Conversation:** getSqurl ([797c8fec](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/797c8fecfdc4b91c1517cbe2391c4dcf543b4d96))


<a name="0.4.109-0"></a>
### 0.4.109-0 (2015-03-31)


#### Features

* **Fetcher:** start implementing generalized fethcer ([fcf62d52](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/fcf62d52b3a728e699f13b2742ed54e8bd8eb0ef))


<a name="0.4.108"></a>
### 0.4.108 (2015-03-31)


<a name="0.4.108-2"></a>
### 0.4.108-2 (2015-03-31)


#### Bug Fixes

* **Normalizer:** adjust user#getUUID so it doesn't break Normalizer#_nromalize if a server-side e ([1114b428](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/1114b4280841bcae073f22f4d8ac6164cf76970f))


<a name="0.4.108-1"></a>
### 0.4.108-1 (2015-03-30)


#### Bug Fixes

* **share:** Content with characters fail to upload ([d5dba307](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/d5dba307b9cdf4898913f59e4447f850f6003f31))


<a name="0.4.108-0"></a>
### 0.4.108-0 (2015-03-28)


<a name="0.4.107"></a>
### 0.4.107 (2015-03-28)


<a name="0.4.107-1"></a>
### 0.4.107-1 (2015-03-28)


<a name="0.4.107-0"></a>
### 0.4.107-0 (2015-03-27)


<a name="0.4.106"></a>
### 0.4.106 (2015-03-26)


<a name="0.4.106-0"></a>
### 0.4.106-0 (2015-03-25)


<a name="0.4.105"></a>
### 0.4.105 (2015-03-23)


<a name="0.4.105-0"></a>
### 0.4.105-0 (2015-03-23)


<a name="0.4.104"></a>
### 0.4.104 (2015-03-22)


<a name="0.4.104-0"></a>
### 0.4.104-0 (2015-03-22)


<a name="0.4.103"></a>
### 0.4.103 (2015-03-22)


<a name="0.4.103-2"></a>
### 0.4.103-2 (2015-03-21)


#### Bug Fixes

* **Logger:** configure logger methods at call time so they can use the most up-to-date featur ([c249ded1](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/c249ded110c1c0d4bceb32708d92c7e14e714050))


<a name="0.4.103-1"></a>
### 0.4.103-1 (2015-03-20)


#### Bug Fixes

* **Client:**
  * ensure all results in Client#_request have the same shape ([b7bcb81f](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/b7bcb81f286b1274590459934b6f81b8e3a86d61), closes [#329](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/329))
  * don't treat statusCode === 0 differently from any other status code at low level ([5ad50933](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/5ad50933a083c1fd74ed9cfeb3e29af486142e29))
* **Conversation:** bind to the right `this` to show decryption failure message ([6204d338](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/6204d338b9763b2955acaee51dbbf9b45e00d50e))


<a name="0.4.103-0"></a>
### 0.4.103-0 (2015-03-18)


<a name="0.4.102"></a>
### 0.4.102 (2015-03-17)


<a name="0.4.102-2"></a>
### 0.4.102-2 (2015-03-17)


#### Features

* **ConversationService:** add lastActivityFirst Param to 1:1 PUT request ([90f1ce29](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/90f1ce29dc086d4786170843e424d0112d0078fc))


<a name="0.4.102-1"></a>
### 0.4.102-1 (2015-03-17)


<a name="0.4.102-0"></a>
### 0.4.102-0 (2015-03-17)


#### Bug Fixes

* **TrackingID:** properly add tracking IDs to Atlas, Discovery, and CI requests ([84452b4c](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/84452b4cb7591eb5870fae68e92bedb6147b650e))


<a name="0.4.101"></a>
### 0.4.101 (2015-03-14)


<a name="0.4.101-1"></a>
### 0.4.101-1 (2015-03-14)


<a name="0.4.101-0"></a>
### 0.4.101-0 (2015-03-14)


#### Bug Fixes

* **Device:** remove assertions around country code because we can't guarantee the country wil ([29308c90](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/29308c90e81e3562aea0b70f3efd6a97df9d8035))


<a name="0.4.100"></a>
### 0.4.100 (2015-03-13)


<a name="0.4.100-2"></a>
### 0.4.100-2 (2015-03-13)


#### Features

* **Mercury:** emits offline replaced events ([16e1966c](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/16e1966c4b2da6745bfa84b111bdc5d60c5274db))


<a name="0.4.100-1"></a>
### 0.4.100-1 (2015-03-13)


#### Bug Fixes

* **Auth:** do not attempt to reauthenticate if the first-party-cookie call fails ([cadc6470](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/cadc6470948a3cec67dcaa89127cf47ec9659c23))


<a name="0.4.100-0"></a>
### 0.4.100-0 (2015-03-13)


#### Bug Fixes

* **Embargo:** change to final discovery endpoint; don't fail if no response from discovery ser ([f927a287](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/f927a2873efc6e56e85039362ad58b18b0cd604c))
* **RegionService:** add "/" to url due to current config on region service ([6fd98de5](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/6fd98de5fd7bd4dc62db6324c2706c7203d0ef23))


<a name="0.4.99"></a>
### 0.4.99 (2015-03-12)


<a name="0.4.99-0"></a>
### 0.4.99-0 (2015-03-12)


<a name="0.4.98"></a>
### 0.4.98 (2015-03-12)


<a name="0.4.98-1"></a>
### 0.4.98-1 (2015-03-12)


<a name="0.4.98-0"></a>
### 0.4.98-0 (2015-03-12)


<a name="0.4.97"></a>
### 0.4.97 (2015-03-12)


<a name="0.4.97-1"></a>
### 0.4.97-1 (2015-03-12)


<a name="0.4.97-0"></a>
### 0.4.97-0 (2015-03-11)


<a name="0.4.96"></a>
### 0.4.96 (2015-03-10)


<a name="0.4.96-0"></a>
### 0.4.96-0 (2015-03-09)


<a name="0.4.95"></a>
### 0.4.95 (2015-03-07)


<a name="0.4.95-0"></a>
### 0.4.95-0 (2015-03-07)


#### Bug Fixes

* **XunitLogger:** fallback to log for console methods that do not exist ([d0484db4](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/d0484db4c2081ed4f6bb30c9fb00d3dc5a1f0e96))


#### Features

* **Embargo:** add region data to WDM registration ([66e8b53a](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/66e8b53a51fd3fce3f1f337931d160fa144d2e62))


<a name="0.4.94"></a>
### 0.4.94 (2015-03-06)


<a name="0.4.94-0"></a>
### 0.4.94-0 (2015-03-06)


<a name="0.4.93"></a>
### 0.4.93 (2015-03-06)


<a name="0.4.93-0"></a>
### 0.4.93-0 (2015-03-06)


#### Bug Fixes

* **EncryptionMigrationTest:** remove luck from test ([617f118a](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/617f118ad415e8ba4fd6383139c63a8242ec2034))


<a name="0.4.92"></a>
### 0.4.92 (2015-03-05)


<a name="0.4.92-0"></a>
### 0.4.92-0 (2015-03-05)


<a name="0.4.91"></a>
### 0.4.91 (2015-03-05)


<a name="0.4.91-0"></a>
### 0.4.91-0 (2015-03-05)


#### Bug Fixes

* **TestService:** don't treat HTTP failures as successes ([86f606c1](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/86f606c1324d885e466a67722696d0ac31bcda6d))


<a name="0.4.90"></a>
### 0.4.90 (2015-03-04)


<a name="0.4.90-2"></a>
### 0.4.90-2 (2015-03-04)


<a name="0.4.90-1"></a>
### 0.4.90-1 (2015-03-03)


#### Bug Fixes

* **Avatar:** invalidate current user's cached avatar after uploading a new one ([708985e1](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/708985e1250230980c6990bd0cec63f84fa759a5))


<a name="0.4.90-0"></a>
### 0.4.90-0 (2015-03-02)


<a name="0.4.89"></a>
### 0.4.89 (2015-03-02)


<a name="0.4.89-0"></a>
### 0.4.89-0 (2015-03-02)


#### Bug Fixes

* **TestService:** exclude test service from production bundles until the endpoint is secured ([49715be6](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/49715be6bb7ef2f4e661aa8d0c4b20e431f20648), closes [#301](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/301))
* **TestUsers:**
  * add additional test entitlements ([747abb40](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/747abb4060060516c007fc7a4449cdc44195ce83))
  * add required entitlement to test-users for room moderation ([9992642d](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/9992642de0a646cafb30ae7a5ecb5a54f35071cb))


<a name="0.4.88"></a>
### 0.4.88 (2015-02-27)


<a name="0.4.88-0"></a>
### 0.4.88-0 (2015-02-27)


<a name="0.4.87"></a>
### 0.4.87 (2015-02-27)


<a name="0.4.87-0"></a>
### 0.4.87-0 (2015-02-27)


<a name="0.4.86"></a>
### 0.4.86 (2015-02-27)


<a name="0.4.86-0"></a>
### 0.4.86-0 (2015-02-27)


<a name="0.4.85"></a>
### 0.4.85 (2015-02-24)


<a name="0.4.85-24"></a>
### 0.4.85-24 (2015-02-24)


<a name="0.4.85-23"></a>
### 0.4.85-23 (2015-02-24)


<a name="0.4.85-22"></a>
### 0.4.85-22 (2015-02-24)


<a name="0.4.85-21"></a>
### 0.4.85-21 (2015-02-24)


<a name="0.4.85-20"></a>
### 0.4.85-20 (2015-02-24)


<a name="0.4.85-19"></a>
### 0.4.85-19 (2015-02-24)


<a name="0.4.85-18"></a>
### 0.4.85-18 (2015-02-24)


<a name="0.4.85-17"></a>
### 0.4.85-17 (2015-02-24)


<a name="0.4.85-16"></a>
### 0.4.85-16 (2015-02-24)


<a name="0.4.85-15"></a>
### 0.4.85-15 (2015-02-24)


<a name="0.4.85-14"></a>
### 0.4.85-14 (2015-02-24)


<a name="0.4.85-13"></a>
### 0.4.85-13 (2015-02-24)


<a name="0.4.85-12"></a>
### 0.4.85-12 (2015-02-24)


<a name="0.4.85-11"></a>
### 0.4.85-11 (2015-02-24)


<a name="0.4.85-10"></a>
### 0.4.85-10 (2015-02-24)


<a name="0.4.85-9"></a>
### 0.4.85-9 (2015-02-24)


<a name="0.4.85-8"></a>
### 0.4.85-8 (2015-02-24)


<a name="0.4.85-7"></a>
### 0.4.85-7 (2015-02-24)


<a name="0.4.85-6"></a>
### 0.4.85-6 (2015-02-24)


<a name="0.4.85-5"></a>
### 0.4.85-5 (2015-02-24)


<a name="0.4.85-4"></a>
### 0.4.85-4 (2015-02-23)


<a name="0.4.85-3"></a>
### 0.4.85-3 (2015-02-23)


<a name="0.4.85-2"></a>
### 0.4.85-2 (2015-02-21)


<a name="0.4.85-1"></a>
### 0.4.85-1 (2015-02-21)


<a name="0.4.85-0"></a>
### 0.4.85-0 (2015-02-21)


<a name="0.4.84"></a>
### 0.4.84 (2015-02-20)


<a name="0.4.84-4"></a>
### 0.4.84-4 (2015-02-20)


<a name="0.4.84-3"></a>
### 0.4.84-3 (2015-02-19)


<a name="0.4.84-2"></a>
### 0.4.84-2 (2015-02-19)


<a name="0.4.84-1"></a>
### 0.4.84-1 (2015-02-18)


<a name="0.4.84-0"></a>
### 0.4.84-0 (2015-02-18)


<a name="0.4.83"></a>
### 0.4.83 (2015-02-18)


<a name="0.4.83-2"></a>
### 0.4.83-2 (2015-02-18)


<a name="0.4.83-1"></a>
### 0.4.83-1 (2015-02-12)


<a name="0.4.83-0"></a>
### 0.4.83-0 (2015-02-12)


<a name="0.4.82"></a>
### 0.4.82 (2015-02-12)


<a name="0.4.82-2"></a>
### 0.4.82-2 (2015-02-12)


<a name="0.4.82-1"></a>
### 0.4.82-1 (2015-02-12)


<a name="0.4.82-0"></a>
### 0.4.82-0 (2015-02-05)


<a name="0.4.81"></a>
### 0.4.81 (2015-02-04)


<a name="0.4.81-0"></a>
### 0.4.81-0 (2015-02-04)


<a name="0.4.80"></a>
### 0.4.80 (2015-01-28)


<a name="0.4.80-1"></a>
### 0.4.80-1 (2015-01-28)


<a name="0.4.80-0"></a>
### 0.4.80-0 (2015-01-26)


<a name="0.4.79"></a>
### 0.4.79 (2015-01-26)


<a name="0.4.79-4"></a>
### 0.4.79-4 (2015-01-26)


<a name="0.4.79-3"></a>
### 0.4.79-3 (2015-01-26)


<a name="0.4.79-2"></a>
### 0.4.79-2 (2015-01-26)


<a name="0.4.79-1"></a>
### 0.4.79-1 (2015-01-26)


<a name="0.4.79-0"></a>
### 0.4.79-0 (2015-01-24)


<a name="0.4.78"></a>
### 0.4.78 (2015-01-23)


<a name="0.4.78-0"></a>
### 0.4.78-0 (2015-01-23)


<a name="0.4.77"></a>
### 0.4.77 (2015-01-22)


<a name="0.4.77-0"></a>
### 0.4.77-0 (2015-01-22)


<a name="0.4.76"></a>
### 0.4.76 (2015-01-22)


<a name="0.4.75"></a>
### 0.4.75 (2015-01-22)


<a name="0.4.74"></a>
### 0.4.74 (2015-01-22)


<a name="0.4.74-1"></a>
### 0.4.74-1 (2015-01-22)


<a name="0.4.74-0"></a>
### 0.4.74-0 (2015-01-22)


<a name="0.4.73"></a>
### 0.4.73 (2015-01-22)


<a name="0.4.72"></a>
### 0.4.72 (2015-01-22)


<a name="0.4.72-1"></a>
### 0.4.72-1 (2015-01-22)


<a name="0.4.72-0"></a>
### 0.4.72-0 (2015-01-22)


<a name="0.4.71"></a>
### 0.4.71 (2015-01-22)


<a name="0.4.71-0"></a>
### 0.4.71-0 (2015-01-21)


<a name="0.4.70"></a>
### 0.4.70 (2015-01-21)


<a name="0.4.70-3"></a>
### 0.4.70-3 (2015-01-21)


<a name="0.4.70-2"></a>
### 0.4.70-2 (2015-01-21)


<a name="0.4.70-1"></a>
### 0.4.70-1 (2015-01-21)


<a name="0.4.70-0"></a>
### 0.4.70-0 (2015-01-21)


<a name="0.4.69"></a>
### 0.4.69 (2015-01-20)


<a name="0.4.69-0"></a>
### 0.4.69-0 (2015-01-20)


<a name="0.4.68"></a>
### 0.4.68 (2015-01-20)


<a name="0.4.67"></a>
### 0.4.67 (2015-01-20)


<a name="0.4.67-6"></a>
### 0.4.67-6 (2015-01-20)


<a name="0.4.67-5"></a>
### 0.4.67-5 (2015-01-20)


<a name="0.4.67-4"></a>
### 0.4.67-4 (2015-01-20)


<a name="0.4.67-3"></a>
### 0.4.67-3 (2015-01-17)


<a name="0.4.66"></a>
### 0.4.66 (2015-01-15)


#### Bug Fixes

* **Mercury5:**
  * fix force close delay ([fddc97fa](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/fddc97fa4f7af9664db4292d6162afb36f80afa4))
  * emit 'unknown' events when the event payload does not have a `data` property ([67128597](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/671285978a735f42c33918298fa755eca6e13d26))
  * add missing "*" event ([e2600fc7](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/e2600fc77910d5693919b213bf2585a4623404f7))


<a name="0.4.66-0"></a>
### 0.4.66-0 (2015-01-15)


<a name="0.4.65"></a>
### 0.4.65 (2015-01-12)


<a name="0.4.65-0"></a>
### 0.4.65-0 (2015-01-13)


<a name="0.4.64"></a>
### 0.4.64 (2015-01-12)


<a name="0.4.64-0"></a>
### 0.4.64-0 (2015-01-11)


<a name="0.4.63"></a>
### 0.4.63 (2015-01-09)


#### Bug Fixes

* **Client:** do not add device url to CI requests because CORS ([356f7fd3](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/356f7fd33d0b72ff2366af179c3095622d444aae))


<a name="0.4.63-0"></a>
### 0.4.63-0 (2015-01-09)


<a name="0.4.62"></a>
### 0.4.62 (2015-01-09)


#### Bug Fixes

* **EncryptionService:**
  * add metric for nearly-bound-key collisions ([388b70e0](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/388b70e0f70786875fcb80653a9d0c85c786e520))
  * prevent reuse of unused keys that haven't quite been fully used yet ([f0314db0](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/f0314db0381cdd018a72af6800ecb0e0f28ef5ea))
  * stop removing unused keys from the unused list once they've been added to the ma ([9377f4ae](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/9377f4aec66d1027abf1521c435ec1c7fa85665c))
  * put all keys in keystone so they never get refetched when moving from `keystore. ([27ce041d](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/27ce041d6d292f9b58fb36749f5f78f54b2cf2ea), closes [#220](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/220))
  * Do not refetch unused key right before using it ([8109086b](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/8109086bc97710cf080d1cd6fc666470169bc477))
* **decryption:** fix keypath for decryptionFailureMessage ([1fe05bba](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/1fe05bba70a68cd7c4ec5274fbd07e275729e312))
* **logger:**
  * fallback to log only errors if nothing else sets a log level ([fa489188](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/fa489188389896880afc7b97e2f753321073e48c))
  * fix use of log-level feature toggle for logger ([b3e0eb3a](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/b3e0eb3adc65dff333883f990961a3f1738a7dc0))


#### Features

* **client:** Add Cisco-Device-URL to all requests ([b0ad7ed9](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/b0ad7ed98e2f9e61850bcdf25583de1ea7f8bb22), closes [#173](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/173))


<a name="0.4.62-4"></a>
### 0.4.62-4 (2015-01-09)


<a name="0.4.62-3"></a>
### 0.4.62-3 (2015-01-08)


<a name="0.4.62-2"></a>
### 0.4.62-2 (2015-01-07)


<a name="0.4.62-1"></a>
### 0.4.62-1 (2015-01-07)


<a name="0.4.62-0"></a>
### 0.4.62-0 (2015-01-07)


<a name="0.4.61"></a>
### 0.4.61 (2015-01-06)


#### Bug Fixes

* **ConversationService:** fix blink in web-client caused by suppression of published date ([1280cc25](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/1280cc2511c3ba22a716153ac488d95925cbeea2))


<a name="0.4.61-1"></a>
### 0.4.61-1 (2015-01-07)


<a name="0.4.61-0"></a>
### 0.4.61-0 (2015-01-06)


<a name="0.4.60"></a>
### 0.4.60 (2015-01-06)


#### Bug Fixes

* **FeatureService:** fail if FeatureService is used incorrectly. ([0e8cd25b](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/0e8cd25b9eddbca24a73654ead6a53dfb854d85e))


<a name="0.4.60-0"></a>
### 0.4.60-0 (2015-01-06)


<a name="0.4.59"></a>
### 0.4.59 (2015-01-06)


#### Bug Fixes

* **conversation:** suppress locally-created published date in new activity (unless explicitly desir ([9f0fd498](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/9f0fd49834848e3164649ee5336dc9b2d1990896), closes [#209](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/209))


#### Features

* **mercury:**
  * clean lint ([5a923637](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/5a923637a4eae8e91d2cabcfdc29fb1fb3fdfef1))
  * clear lint ([55c73c36](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/55c73c3651aba345155d974cd4a3cdd53bb8b238))
  * add pass through method for mercury4 ping compatibility ([846ca1af](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/846ca1af51bd039d5b0e3cc1d09814f6c2785e7a))
  * add background retries ([3aa8d6aa](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/3aa8d6aaacef8bde46ff224adb435336f2d71248))
  * added test, max retries ([90efe226](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/90efe22619dcc7a94b1bc59da3dbf6eb99c662a7))
  * add tests, implement reconnect triggers; add watch for unit tests ([92d76997](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/92d76997b5a9bced67d476e69c52e415d65ce4eb))
  * prevent multiple inflight mercury connections ([52421946](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/52421946520774f96c62360c8bd0d3fa7168640f))
* **mercury5:**
  * fix bugs discovered by tests ([3b2133b8](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/3b2133b81eb3413acebbe65771ee1e9d6d84cf7e))
  * added exponential backoff ([4e2e6a4d](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/4e2e6a4db4aa54d640fd53867b55aed15a615a27))
* **share:** Create conversations beginning with a share ([3c62d94c](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/3c62d94cd73c375b42c587fd20c6cb2ee6d316c1))


<a name="0.4.59-6"></a>
### 0.4.59-6 (2015-01-06)


<a name="0.4.59-5"></a>
### 0.4.59-5 (2015-01-06)


<a name="0.4.59-4"></a>
### 0.4.59-4 (2015-01-06)


<a name="0.4.59-3"></a>
### 0.4.59-3 (2015-01-05)


<a name="0.4.59-2"></a>
### 0.4.59-2 (2015-01-05)


<a name="0.4.59-1"></a>
### 0.4.59-1 (2015-01-05)


<a name="0.4.59-0"></a>
### 0.4.59-0 (2014-12-24)


<a name="0.4.58"></a>
### 0.4.58 (2014-12-18)


#### Bug Fixes

* **logger:** make sure `this` is bound in callbacks ([1cad0fc3](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/1cad0fc344c31a576833c2bd1bf8b2b9b754cdbf))


<a name="0.4.58-0"></a>
### 0.4.58-0 (2014-12-19)


<a name="0.4.57"></a>
### 0.4.57 (2014-12-17)


<a name="0.4.57-0"></a>
### 0.4.57-0 (2014-12-17)


<a name="0.4.56"></a>
### 0.4.56 (2014-12-16)


<a name="0.4.56-0"></a>
### 0.4.56-0 (2014-12-16)


<a name="0.4.55"></a>
### 0.4.55 (2014-12-12)


<a name="0.4.55-0"></a>
### 0.4.55-0 (2014-12-13)


<a name="0.4.54"></a>
### 0.4.54 (2014-12-12)


<a name="0.4.54-3"></a>
### 0.4.54-3 (2014-12-13)


<a name="0.4.54-2"></a>
### 0.4.54-2 (2014-12-11)


<a name="0.4.54-1"></a>
### 0.4.54-1 (2014-12-09)


<a name="0.4.54-0"></a>
### 0.4.54-0 (2014-12-09)


<a name="0.4.53"></a>
### 0.4.53 (2014-12-09)


<a name="0.4.53-2"></a>
### 0.4.53-2 (2014-12-09)


<a name="0.4.53-1"></a>
### 0.4.53-1 (2014-12-09)


<a name="0.4.53-0"></a>
### 0.4.53-0 (2014-12-08)


<a name="0.4.52-1"></a>
### 0.4.52-1 (2014-12-05)


<a name="0.4.52-0"></a>
### 0.4.52-0 (2014-12-04)


<a name="0.4.51-1"></a>
### 0.4.51-1 (2014-12-02)


<a name="0.4.51-0"></a>
### 0.4.51-0 (2014-11-26)


<a name="0.4.50"></a>
### 0.4.50 (2014-11-25)


#### Bug Fixes

* **mercury:** Change method of deallocating a dead socket since `delete` can't be used on defi ([af674530](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/af6745300972187b506a8553fa5842972edbb755))


<a name="0.4.50-0"></a>
### 0.4.50-0 (2014-11-25)


<a name="0.4.49"></a>
### 0.4.49 (2014-11-24)


#### Bug Fixes

* **request:** Prepare form data better in browsers ([4109e78d](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/4109e78deb66402a335f7d3e3785e20c4734d0f1), closes [#174](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/issues/174))


<a name="0.4.49-0"></a>
### 0.4.49-0 (2014-11-25)


<a name="0.4.48"></a>
### 0.4.48 (2014-11-24)


<a name="0.4.48-0"></a>
### 0.4.48-0 (2014-11-24)


<a name="0.4.47"></a>
### 0.4.47 (2014-11-24)


<a name="0.4.47-1"></a>
### 0.4.47-1 (2014-11-24)


<a name="0.4.47-0"></a>
### 0.4.47-0 (2014-11-21)


<a name="0.4.46"></a>
### 0.4.46 (2014-11-21)


<a name="0.4.46-0"></a>
### 0.4.46-0 (2014-11-21)


<a name="0.4.45"></a>
### 0.4.45 (2014-11-21)


#### Features

* **UserService:** Add support for changing display name ([c7c7853c](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/c7c7853c4327dbe2024975bb86b5242bd979e5c1))


<a name="0.4.45-2"></a>
### 0.4.45-2 (2014-11-21)


<a name="0.4.45-1"></a>
### 0.4.45-1 (2014-11-21)


<a name="0.4.45-0"></a>
### 0.4.45-0 (2014-11-21)


<a name="0.4.44"></a>
### 0.4.44 (2014-11-20)


#### Bug Fixes

* **Encryption:** Fix decryption of share activities received via mercury ([f5dd5a84](http://sqbu-github.cisco.com:WebExSquared/squared-js-sdk/commit/f5dd5a844eb68e39422ea5d69352b84fd1969e5a))


<a name="0.4.15"></a>
### 0.4.15


  - updated dependencies
  - improved mercury ping/pong logic
  - fixed bug in call loggins
  - tweaked build.sh for pipeline
  - #43 Prioritize mercury events
  - #48 optionally suppress encryption
  - #55 Autoupgrade unencrypted conversations
  - #57 Prevent encrypted text from render while HTTP is inflight
  - #56 Suppress metrics while testing
  - #61 Fetch keys in bulk


<a name="0.4.14"></a>
### 0.4.14


  - reduced non-prototype methods
  - flattened directories that didn't need to be shimmed
  - added documentation
  - integrated browserstack
  - add gh-pages
  - Fixed #33 - switched from `http-browserify` to raw `XMLHttpRequests`


<a name="0.4.13"></a>
### 0.4.13


  - ensured current user is part of grouped conversation participants list
  - merged PR to fix misplaced paren in conversation.update


<a name="0.4.12"></a>
### 0.4.12


  - reverted temporary change to use email instead of uuid
  - added automatic cancelation of ux timers


<a name="0.4.11"></a>
### 0.4.11


  - fixed incorrect method usage
  - fixed incorrect querytring for transcoding


<a name="0.4.10"></a>
### 0.4.10


  - tagged by accident


<a name="0.4.9"></a>
### 0.4.9


  - added an example project
  - fixed bugs with credentials retrieval


<a name="0.4.8 "></a>
### 0.4.8 


  - added additional encryption metrics


<a name="0.4.7"></a>
### 0.4.7


  - added encryption metrics
  - now decrypting transcodedCollection


<a name="0.4.6"></a>
### 0.4.6


  - Hacked around lack of CORS support in submitCallLogs


<a name="0.4.5"></a>
### 0.4.5


  - fixed empty targets
  - added test to ensure Buffer doesn't get browserified


<a name="0.4.4"></a>
### 0.4.4


  - added user.find
  - added ackFilter support
  - added hack to bypass cloudapps regression
  - reenabled some node tests
  - added missing objectTypes
  - added defensive code to survive cloudapps regressions


<a name="0.4.3"></a>
### 0.4.3


  - Renamed to `squared-js-sdk`


<a name="0.4.2"></a>
### 0.4.2


  - Added `clientTempId`
  - Completed User Service
  - Added Support Service
  - Added Conversation#share


<a name="0.4.1"></a>
### 0.4.1


  - Added 1:1 support
  - Changed Auth processor handle DR scenarios
<a name="0.4.0 - The 0.4.0 is WIP release, but should relatively stable until 0.5.0"></a>
### 
  

  - Encryption Service (Missing binary download support)
  - Conversation Service (Missing `share` support,binary download su missing 1:1 

  support)
  - User Service (incomplete)
  - Removed [bluebird](https://github.com/petkaantonov/bluebird) in favor of native promises (polyfilled by [es6-promise](https://github.com/jakearchibald/es6-promise))


<a name="0.3.0"></a>
### 0.3.0


  - Metrics API


<a name="0.2.0"></a>
### 0.2.0


  - Breaking change: mercury events are emitted by `client.mercury` instead of `client`.
  - Mercury emits `connected`, `disconnected` events
  - Mercury event processing can be buffered. 
  - Added constants for mercury events
  - `client` emits `refresh:credentials` and `refresh:device` each time credentials or device is updated, respectively
  - added oauth helpers (browser only): `client.credentials.buildOAuthUrl`, `client.credentials.parseRedirectUri`.


<a name="0.1.3"></a>
### 0.1.3


  - Reorganized the `Client` constructor so that all defaults are configurable


<a name="0.1.2"></a>
### 0.1.2


  - Removed browserify-shim dependency
  - Updated WebexFiles support to use service catalog instead of hardcoded url
  - Bug fixes
    - Tracking ID processor wasn't adding `trackingId` to device registrations
    - Disabled SauceLabs tests since they don't support WebSockets yet


<a name="0.1.1"></a>
### 0.1.1


  - Bug fixes
    - `client.stopped` did not resolve
  - `Client.reconnect` moved to `Client.prototype.reconnect`


<a name="0.1.0"></a>
### 0.1.0


  - Renamed project to `squared-sdk`
  - Moved APIs to separate modules.


<a name="0.0.13"></a>
### 0.0.13


  - Significant Refactor
  - Removed endpoints.js - now relying exlusively on WDM for service URLs
  - Created a ConversationAPI for verbs that were previously on Client.
  - Fixed file uploads in both browser and node (Not only does `share` work in browser, but dimensions are also included on thumbnails now)


<a name="0.0.10 - 0.0.12"></a>
### 0.0.12


  - nothing that matters


<a name="0.0.9"></a>
### 0.0.9


  - added createTestUsers to sdk.test


<a name="0.0.8"></a>
### 0.0.8


  - minor changes to fix mocha dependency, added fallback mimeType for non-images.


<a name="0.0.7"></a>
### 0.0.7


  - `share` activity (node)
  - more control over test users


<a name="0.0.6"></a>
### 0.0.6


  - Removed ActivityStream abstraction


<a name="0.0.5"></a>
### 0.0.5


  - Maintenance release


<a name="0.0.4:"></a>
### 0.0.4:


  - API Implementations
  - Code coverage and in-browser testing
  - Added hybrid nodeback and promise support
  - Added proper browser support


<a name="0.0.3:"></a>
### 0.0.3:


  - Minor tweaks


<a name="0.0.2:"></a>
### 0.0.2:


  - Moved to CI for test users
  - Added support for dynamic endpoints
  - Added WebSocket support


<a name="0.0.1: Initial release"></a>
### 1: Initial release


