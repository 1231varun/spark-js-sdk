/*!
 * Copyright (c) 2015-2017 Cisco Systems, Inc. See LICENSE file.
 */

import AmpCollection from 'ampersand-collection';
import Call from './call';

const Calls = AmpCollection.extend({
  model: Call,

  mainIndex: `internalCallId`,

  indexes: [
    `correlationId`
  ],

  initialize(...args) {
    Reflect.apply(AmpCollection.prototype.initialize, this, args);

    this.on(`add`, (call) => {
      this.listenTo(call, `change:state`, () => {
        if (call.status === `disconnected`) {
          this.remove(call);
        }
      });
    });
  }
});

export default Calls;
