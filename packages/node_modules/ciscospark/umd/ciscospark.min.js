/*! Cisco Spark SDK v1.50.3 */
var CiscoSpark=function(){"use strict";var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t){return e(t={exports:{}},t.exports),t.exports}var n=r(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),i={}.hasOwnProperty,o=function(e,t){return i.call(e,t)},a=function(e){try{return!!e()}catch(e){return!0}},s=!a(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),u=r(function(e){var t=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=t)}),c=(u.version,function(e){return"object"==typeof e?null!==e:"function"==typeof e}),l=function(e){if(!c(e))throw TypeError(e+" is not an object!");return e},f=n.document,d=c(f)&&c(f.createElement),p=function(e){return d?f.createElement(e):{}},h=!s&&!a(function(){return 7!=Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a}),v=function(e,t){if(!c(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!c(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!c(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!c(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},g=Object.defineProperty,m={f:s?Object.defineProperty:function(e,t,r){if(l(e),t=v(t,!0),l(r),h)try{return g(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},y=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},_=s?function(e,t,r){return m.f(e,t,y(1,r))}:function(e,t,r){return e[t]=r,e},E=0,b=Math.random(),S=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++E+b).toString(36))},T=r(function(e){var t=S("src"),r=Function.toString,i=(""+r).split("toString");u.inspectSource=function(e){return r.call(e)},(e.exports=function(e,r,a,s){var u="function"==typeof a;u&&(o(a,"name")||_(a,"name",r)),e[r]!==a&&(u&&(o(a,t)||_(a,t,e[r]?""+e[r]:i.join(String(r)))),e===n?e[r]=a:s?e[r]?e[r]=a:_(e,r,a):(delete e[r],_(e,r,a)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[t]||r.call(this)})}),w=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},O=function(e,t,r){if(w(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}},k=function(e,t,r){var i,o,a,s,c=e&k.F,l=e&k.G,f=e&k.S,d=e&k.P,p=e&k.B,h=l?n:f?n[t]||(n[t]={}):(n[t]||{}).prototype,v=l?u:u[t]||(u[t]={}),g=v.prototype||(v.prototype={});for(i in l&&(r=t),r)a=((o=!c&&h&&void 0!==h[i])?h:r)[i],s=p&&o?O(a,n):d&&"function"==typeof a?O(Function.call,a):a,h&&T(h,i,a,e&k.U),v[i]!=a&&_(v,i,s),d&&g[i]!=a&&(g[i]=a)};n.core=u,k.F=1,k.G=2,k.S=4,k.P=8,k.B=16,k.W=32,k.U=64,k.R=128;var R=k,A=r(function(e){var t=S("meta"),r=m.f,n=0,i=Object.isExtensible||function(){return!0},s=!a(function(){return i(Object.preventExtensions({}))}),u=function(e){r(e,t,{value:{i:"O"+ ++n,w:{}}})},l=e.exports={KEY:t,NEED:!1,fastKey:function(e,r){if(!c(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,t)){if(!i(e))return"F";if(!r)return"E";u(e)}return e[t].i},getWeak:function(e,r){if(!o(e,t)){if(!i(e))return!0;if(!r)return!1;u(e)}return e[t].w},onFreeze:function(e){return s&&l.NEED&&i(e)&&!o(e,t)&&u(e),e}}}),I=(A.KEY,A.NEED,A.fastKey,A.getWeak,A.onFreeze,r(function(e){var t=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(e.exports=function(e,r){return t[e]||(t[e]=void 0!==r?r:{})})("versions",[]).push({version:u.version,mode:"global",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})})),P=r(function(e){var t=I("wks"),r=n.Symbol,i="function"==typeof r;(e.exports=function(e){return t[e]||(t[e]=i&&r[e]||(i?r:S)("Symbol."+e))}).store=t}),C=m.f,M=P("toStringTag"),N=function(e,t,r){e&&!o(e=r?e:e.prototype,M)&&C(e,M,{configurable:!0,value:t})},D={f:P},j=m.f,x=function(e){var t=u.Symbol||(u.Symbol=n.Symbol||{});"_"==e.charAt(0)||e in t||j(t,e,{value:D.f(e)})},L={}.toString,U=function(e){return L.call(e).slice(8,-1)},F=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==U(e)?e.split(""):Object(e)},G=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},q=function(e){return F(G(e))},V=Math.ceil,B=Math.floor,z=function(e){return isNaN(e=+e)?0:(e>0?B:V)(e)},H=Math.min,W=function(e){return e>0?H(z(e),9007199254740991):0},Y=Math.max,X=Math.min,J=function(e,t){return(e=z(e))<0?Y(e+t,0):X(e,t)},K=function(e){return function(t,r,n){var i,o=q(t),a=W(o.length),s=J(n,a);if(e&&r!=r){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===r)return e||s||0;return!e&&-1}},$=I("keys"),Q=function(e){return $[e]||($[e]=S(e))},Z=K(!1),ee=Q("IE_PROTO"),te=function(e,t){var r,n=q(e),i=0,a=[];for(r in n)r!=ee&&o(n,r)&&a.push(r);for(;t.length>i;)o(n,r=t[i++])&&(~Z(a,r)||a.push(r));return a},re="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ne=Object.keys||function(e){return te(e,re)},ie={f:Object.getOwnPropertySymbols},oe={f:{}.propertyIsEnumerable},ae=Array.isArray||function(e){return"Array"==U(e)},se=s?Object.defineProperties:function(e,t){l(e);for(var r,n=ne(t),i=n.length,o=0;i>o;)m.f(e,r=n[o++],t[r]);return e},ue=n.document,ce=ue&&ue.documentElement,le=Q("IE_PROTO"),fe=function(){},de=function(){var e,t=p("iframe"),r=re.length;for(t.style.display="none",ce.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),de=e.F;r--;)delete de.prototype[re[r]];return de()},pe=Object.create||function(e,t){var r;return null!==e?(fe.prototype=l(e),r=new fe,fe.prototype=null,r[le]=e):r=de(),void 0===t?r:se(r,t)},he=re.concat("length","prototype"),ve={f:Object.getOwnPropertyNames||function(e){return te(e,he)}},ge=ve.f,me={}.toString,ye="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],_e={f:function(e){return ye&&"[object Window]"==me.call(e)?function(e){try{return ge(e)}catch(e){return ye.slice()}}(e):ge(q(e))}},Ee=Object.getOwnPropertyDescriptor,be={f:s?Ee:function(e,t){if(e=q(e),t=v(t,!0),h)try{return Ee(e,t)}catch(e){}if(o(e,t))return y(!oe.f.call(e,t),e[t])}},Se=A.KEY,Te=be.f,we=m.f,Oe=_e.f,ke=n.Symbol,Re=n.JSON,Ae=Re&&Re.stringify,Ie=P("_hidden"),Pe=P("toPrimitive"),Ce={}.propertyIsEnumerable,Me=I("symbol-registry"),Ne=I("symbols"),De=I("op-symbols"),je=Object.prototype,xe="function"==typeof ke,Le=n.QObject,Ue=!Le||!Le.prototype||!Le.prototype.findChild,Fe=s&&a(function(){return 7!=pe(we({},"a",{get:function(){return we(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=Te(je,t);n&&delete je[t],we(e,t,r),n&&e!==je&&we(je,t,n)}:we,Ge=function(e){var t=Ne[e]=pe(ke.prototype);return t._k=e,t},qe=xe&&"symbol"==typeof ke.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof ke},Ve=function(e,t,r){return e===je&&Ve(De,t,r),l(e),t=v(t,!0),l(r),o(Ne,t)?(r.enumerable?(o(e,Ie)&&e[Ie][t]&&(e[Ie][t]=!1),r=pe(r,{enumerable:y(0,!1)})):(o(e,Ie)||we(e,Ie,y(1,{})),e[Ie][t]=!0),Fe(e,t,r)):we(e,t,r)},Be=function(e,t){l(e);for(var r,n=function(e){var t=ne(e),r=ie.f;if(r)for(var n,i=r(e),o=oe.f,a=0;i.length>a;)o.call(e,n=i[a++])&&t.push(n);return t}(t=q(t)),i=0,o=n.length;o>i;)Ve(e,r=n[i++],t[r]);return e},ze=function(e){var t=Ce.call(this,e=v(e,!0));return!(this===je&&o(Ne,e)&&!o(De,e))&&(!(t||!o(this,e)||!o(Ne,e)||o(this,Ie)&&this[Ie][e])||t)},He=function(e,t){if(e=q(e),t=v(t,!0),e!==je||!o(Ne,t)||o(De,t)){var r=Te(e,t);return!r||!o(Ne,t)||o(e,Ie)&&e[Ie][t]||(r.enumerable=!0),r}},We=function(e){for(var t,r=Oe(q(e)),n=[],i=0;r.length>i;)o(Ne,t=r[i++])||t==Ie||t==Se||n.push(t);return n},Ye=function(e){for(var t,r=e===je,n=Oe(r?De:q(e)),i=[],a=0;n.length>a;)!o(Ne,t=n[a++])||r&&!o(je,t)||i.push(Ne[t]);return i};xe||(T((ke=function(){if(this instanceof ke)throw TypeError("Symbol is not a constructor!");var e=S(arguments.length>0?arguments[0]:void 0),t=function(r){this===je&&t.call(De,r),o(this,Ie)&&o(this[Ie],e)&&(this[Ie][e]=!1),Fe(this,e,y(1,r))};return s&&Ue&&Fe(je,e,{configurable:!0,set:t}),Ge(e)}).prototype,"toString",function(){return this._k}),be.f=He,m.f=Ve,ve.f=_e.f=We,oe.f=ze,ie.f=Ye,s&&T(je,"propertyIsEnumerable",ze,!0),D.f=function(e){return Ge(P(e))}),R(R.G+R.W+R.F*!xe,{Symbol:ke});for(var Xe="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Je=0;Xe.length>Je;)P(Xe[Je++]);for(var Ke=ne(P.store),$e=0;Ke.length>$e;)x(Ke[$e++]);R(R.S+R.F*!xe,"Symbol",{for:function(e){return o(Me,e+="")?Me[e]:Me[e]=ke(e)},keyFor:function(e){if(!qe(e))throw TypeError(e+" is not a symbol!");for(var t in Me)if(Me[t]===e)return t},useSetter:function(){Ue=!0},useSimple:function(){Ue=!1}}),R(R.S+R.F*!xe,"Object",{create:function(e,t){return void 0===t?pe(e):Be(pe(e),t)},defineProperty:Ve,defineProperties:Be,getOwnPropertyDescriptor:He,getOwnPropertyNames:We,getOwnPropertySymbols:Ye}),Re&&R(R.S+R.F*(!xe||a(function(){var e=ke();return"[null]"!=Ae([e])||"{}"!=Ae({a:e})||"{}"!=Ae(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(c(t)||void 0!==e)&&!qe(e))return ae(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!qe(t))return t}),n[1]=t,Ae.apply(Re,n)}}),ke.prototype[Pe]||_(ke.prototype,Pe,ke.prototype.valueOf),N(ke,"Symbol"),N(Math,"Math",!0),N(n.JSON,"JSON",!0),R(R.S,"Object",{create:pe}),R(R.S+R.F*!s,"Object",{defineProperty:m.f}),R(R.S+R.F*!s,"Object",{defineProperties:se});var Qe=function(e,t){var r=(u.Object||{})[e]||Object[e],n={};n[e]=t(r),R(R.S+R.F*a(function(){r(1)}),"Object",n)},Ze=be.f;Qe("getOwnPropertyDescriptor",function(){return function(e,t){return Ze(q(e),t)}});var et=function(e){return Object(G(e))},tt=Q("IE_PROTO"),rt=Object.prototype,nt=Object.getPrototypeOf||function(e){return e=et(e),o(e,tt)?e[tt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?rt:null};Qe("getPrototypeOf",function(){return function(e){return nt(et(e))}}),Qe("keys",function(){return function(e){return ne(et(e))}}),Qe("getOwnPropertyNames",function(){return _e.f});var it=A.onFreeze;Qe("freeze",function(e){return function(t){return e&&c(t)?e(it(t)):t}});var ot=A.onFreeze;Qe("seal",function(e){return function(t){return e&&c(t)?e(ot(t)):t}});var at=A.onFreeze;Qe("preventExtensions",function(e){return function(t){return e&&c(t)?e(at(t)):t}}),Qe("isFrozen",function(e){return function(t){return!c(t)||!!e&&e(t)}}),Qe("isSealed",function(e){return function(t){return!c(t)||!!e&&e(t)}}),Qe("isExtensible",function(e){return function(t){return!!c(t)&&(!e||e(t))}});var st=Object.assign,ut=!st||a(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=st({},e)[r]||Object.keys(st({},t)).join("")!=n})?function(e,t){for(var r=et(e),n=arguments.length,i=1,o=ie.f,a=oe.f;n>i;)for(var s,u=F(arguments[i++]),c=o?ne(u).concat(o(u)):ne(u),l=c.length,f=0;l>f;)a.call(u,s=c[f++])&&(r[s]=u[s]);return r}:st;R(R.S+R.F,"Object",{assign:ut});var ct=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};R(R.S,"Object",{is:ct});var lt=function(e,t){if(l(e),!c(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},ft={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=O(Function.call,be.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return lt(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:lt};R(R.S,"Object",{setPrototypeOf:ft.set});var dt=P("toStringTag"),pt="Arguments"==U(function(){return arguments}()),ht=function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),dt))?r:pt?U(t):"Object"==(n=U(t))&&"function"==typeof t.callee?"Arguments":n},vt={};vt[P("toStringTag")]="z",vt+""!="[object z]"&&T(Object.prototype,"toString",function(){return"[object "+ht(this)+"]"},!0);var gt=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)},mt=[].slice,yt={},_t=Function.bind||function(e){var t=w(this),r=mt.call(arguments,1),n=function(){var i=r.concat(mt.call(arguments));return this instanceof n?function(e,t,r){if(!(t in yt)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";yt[t]=Function("F,a","return new F("+n.join(",")+")")}return yt[t](e,r)}(t,i.length,i):gt(t,i,e)};return c(t.prototype)&&(n.prototype=t.prototype),n};R(R.P,"Function",{bind:_t});var Et=m.f,bt=Function.prototype,St=/^\s*function ([^ (]*)/;"name"in bt||s&&Et(bt,"name",{configurable:!0,get:function(){try{return(""+this).match(St)[1]}catch(e){return""}}});var Tt=P("hasInstance"),wt=Function.prototype;Tt in wt||m.f(wt,Tt,{value:function(e){if("function"!=typeof this||!c(e))return!1;if(!c(this.prototype))return e instanceof this;for(;e=nt(e);)if(this.prototype===e)return!0;return!1}});var Ot="\t\n\v\f\r Â áá ââââââââââââ¯âã\u2028\u2029\ufeff",kt="["+Ot+"]",Rt=RegExp("^"+kt+kt+"*"),At=RegExp(kt+kt+"*$"),It=function(e,t,r){var n={},i=a(function(){return!!Ot[e]()||"âÂ"!="âÂ"[e]()}),o=n[e]=i?t(Pt):Ot[e];r&&(n[r]=o),R(R.P+R.F*i,"String",n)},Pt=It.trim=function(e,t){return e=String(G(e)),1&t&&(e=e.replace(Rt,"")),2&t&&(e=e.replace(At,"")),e},Ct=It,Mt=n.parseInt,Nt=Ct.trim,Dt=/^[-+]?0[xX]/,jt=8!==Mt(Ot+"08")||22!==Mt(Ot+"0x16")?function(e,t){var r=Nt(String(e),3);return Mt(r,t>>>0||(Dt.test(r)?16:10))}:Mt;R(R.G+R.F*(parseInt!=jt),{parseInt:jt});var xt=n.parseFloat,Lt=Ct.trim,Ut=1/xt(Ot+"-0")!=-1/0?function(e){var t=Lt(String(e),3),r=xt(t);return 0===r&&"-"==t.charAt(0)?-0:r}:xt;R(R.G+R.F*(parseFloat!=Ut),{parseFloat:Ut});var Ft=ft.set,Gt=function(e,t,r){var n,i=t.constructor;return i!==r&&"function"==typeof i&&(n=i.prototype)!==r.prototype&&c(n)&&Ft&&Ft(e,n),e},qt=ve.f,Vt=be.f,Bt=m.f,zt=Ct.trim,Ht=n.Number,Wt=Ht,Yt=Ht.prototype,Xt="Number"==U(pe(Yt)),Jt="trim"in String.prototype,Kt=function(e){var t=v(e,!1);if("string"==typeof t&&t.length>2){var r,n,i,o=(t=Jt?t.trim():zt(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(r=t.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+t}for(var a,s=t.slice(2),u=0,c=s.length;u<c;u++)if((a=s.charCodeAt(u))<48||a>i)return NaN;return parseInt(s,n)}}return+t};if(!Ht(" 0o1")||!Ht("0b1")||Ht("+0x1")){Ht=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof Ht&&(Xt?a(function(){Yt.valueOf.call(r)}):"Number"!=U(r))?Gt(new Wt(Kt(t)),r,Ht):Kt(t)};for(var $t,Qt=s?qt(Wt):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),Zt=0;Qt.length>Zt;Zt++)o(Wt,$t=Qt[Zt])&&!o(Ht,$t)&&Bt(Ht,$t,Vt(Wt,$t));Ht.prototype=Yt,Yt.constructor=Ht,T(n,"Number",Ht)}var er=function(e,t){if("number"!=typeof e&&"Number"!=U(e))throw TypeError(t);return+e},tr=function(e){var t=String(G(this)),r="",n=z(e);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},rr=1..toFixed,nr=Math.floor,ir=[0,0,0,0,0,0],or="Number.toFixed: incorrect invocation!",ar=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*ir[r],ir[r]=n%1e7,n=nr(n/1e7)},sr=function(e){for(var t=6,r=0;--t>=0;)r+=ir[t],ir[t]=nr(r/e),r=r%e*1e7},ur=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==ir[e]){var r=String(ir[e]);t=""===t?r:t+tr.call("0",7-r.length)+r}return t},cr=function(e,t,r){return 0===t?r:t%2==1?cr(e,t-1,r*e):cr(e*e,t/2,r)};R(R.P+R.F*(!!rr&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!a(function(){rr.call({})})),"Number",{toFixed:function(e){var t,r,n,i,o=er(this,or),a=z(e),s="",u="0";if(a<0||a>20)throw RangeError(or);if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return String(o);if(o<0&&(s="-",o=-o),o>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(o*cr(2,69,1))-69)<0?o*cr(2,-t,1):o/cr(2,t,1),r*=4503599627370496,(t=52-t)>0){for(ar(0,r),n=a;n>=7;)ar(1e7,0),n-=7;for(ar(cr(10,n,1),0),n=t-1;n>=23;)sr(1<<23),n-=23;sr(1<<n),ar(1,1),sr(2),u=ur()}else ar(0,r),ar(1<<-t,0),u=ur()+tr.call("0",a);return u=a>0?s+((i=u.length)<=a?"0."+tr.call("0",a-i)+u:u.slice(0,i-a)+"."+u.slice(i-a)):s+u}});var lr=1..toPrecision;R(R.P+R.F*(a(function(){return"1"!==lr.call(1,void 0)})||!a(function(){lr.call({})})),"Number",{toPrecision:function(e){var t=er(this,"Number#toPrecision: incorrect invocation!");return void 0===e?lr.call(t):lr.call(t,e)}}),R(R.S,"Number",{EPSILON:Math.pow(2,-52)});var fr=n.isFinite;R(R.S,"Number",{isFinite:function(e){return"number"==typeof e&&fr(e)}});var dr=Math.floor,pr=function(e){return!c(e)&&isFinite(e)&&dr(e)===e};R(R.S,"Number",{isInteger:pr}),R(R.S,"Number",{isNaN:function(e){return e!=e}});var hr=Math.abs;R(R.S,"Number",{isSafeInteger:function(e){return pr(e)&&hr(e)<=9007199254740991}}),R(R.S,"Number",{MAX_SAFE_INTEGER:9007199254740991}),R(R.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991}),R(R.S+R.F*(Number.parseFloat!=Ut),"Number",{parseFloat:Ut}),R(R.S+R.F*(Number.parseInt!=jt),"Number",{parseInt:jt});var vr=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)},gr=Math.sqrt,mr=Math.acosh;R(R.S+R.F*!(mr&&710==Math.floor(mr(Number.MAX_VALUE))&&mr(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:vr(e-1+gr(e-1)*gr(e+1))}});var yr=Math.asinh;R(R.S+R.F*!(yr&&1/yr(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}});var _r=Math.atanh;R(R.S+R.F*!(_r&&1/_r(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}});var Er=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1};R(R.S,"Math",{cbrt:function(e){return Er(e=+e)*Math.pow(Math.abs(e),1/3)}}),R(R.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}});var br=Math.exp;R(R.S,"Math",{cosh:function(e){return(br(e=+e)+br(-e))/2}});var Sr=Math.expm1,Tr=!Sr||Sr(10)>22025.465794806718||Sr(10)<22025.465794806718||-2e-17!=Sr(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:Sr;R(R.S+R.F*(Tr!=Math.expm1),"Math",{expm1:Tr});var wr=Math.pow,Or=wr(2,-52),kr=wr(2,-23),Rr=wr(2,127)*(2-kr),Ar=wr(2,-126),Ir=Math.fround||function(e){var t,r,n=Math.abs(e),i=Er(e);return n<Ar?i*(n/Ar/kr+1/Or-1/Or)*Ar*kr:(r=(t=(1+kr/Or)*n)-(t-n))>Rr||r!=r?i*(1/0):i*r};R(R.S,"Math",{fround:Ir});var Pr=Math.abs;R(R.S,"Math",{hypot:function(e,t){for(var r,n,i=0,o=0,a=arguments.length,s=0;o<a;)s<(r=Pr(arguments[o++]))?(i=i*(n=s/r)*n+1,s=r):i+=r>0?(n=r/s)*n:r;return s===1/0?1/0:s*Math.sqrt(i)}});var Cr=Math.imul;R(R.S+R.F*a(function(){return-5!=Cr(4294967295,5)||2!=Cr.length}),"Math",{imul:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n;return 0|i*o+((65535&r>>>16)*o+i*(65535&n>>>16)<<16>>>0)}}),R(R.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}}),R(R.S,"Math",{log1p:vr}),R(R.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}}),R(R.S,"Math",{sign:Er});var Mr=Math.exp;R(R.S+R.F*a(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(Tr(e)-Tr(-e))/2:(Mr(e-1)-Mr(-e-1))*(Math.E/2)}});var Nr=Math.exp;R(R.S,"Math",{tanh:function(e){var t=Tr(e=+e),r=Tr(-e);return t==1/0?1:r==1/0?-1:(t-r)/(Nr(e)+Nr(-e))}}),R(R.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}});var Dr=String.fromCharCode,jr=String.fromCodePoint;R(R.S+R.F*(!!jr&&1!=jr.length),"String",{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,i=0;n>i;){if(t=+arguments[i++],J(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?Dr(t):Dr(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}}),R(R.S,"String",{raw:function(e){for(var t=q(e.raw),r=W(t.length),n=arguments.length,i=[],o=0;r>o;)i.push(String(t[o++])),o<n&&i.push(String(arguments[o]));return i.join("")}}),Ct("trim",function(e){return function(){return e(this,3)}});var xr=function(e){return function(t,r){var n,i,o=String(G(t)),a=z(r),s=o.length;return a<0||a>=s?e?"":void 0:(n=o.charCodeAt(a))<55296||n>56319||a+1===s||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):n:e?o.slice(a,a+2):i-56320+(n-55296<<10)+65536}},Lr={},Ur={};_(Ur,P("iterator"),function(){return this});var Fr=function(e,t,r){e.prototype=pe(Ur,{next:y(1,r)}),N(e,t+" Iterator")},Gr=P("iterator"),qr=!([].keys&&"next"in[].keys()),Vr=function(){return this},Br=function(e,t,r,n,i,o,a){Fr(r,t,n);var s,u,c,l=function(e){if(!qr&&e in h)return h[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},f=t+" Iterator",d="values"==i,p=!1,h=e.prototype,v=h[Gr]||h["@@iterator"]||i&&h[i],g=v||l(i),m=i?d?l("entries"):g:void 0,y="Array"==t&&h.entries||v;if(y&&(c=nt(y.call(new e)))!==Object.prototype&&c.next&&(N(c,f,!0),"function"!=typeof c[Gr]&&_(c,Gr,Vr)),d&&v&&"values"!==v.name&&(p=!0,g=function(){return v.call(this)}),(qr||p||!h[Gr])&&_(h,Gr,g),Lr[t]=g,Lr[f]=Vr,i)if(s={values:d?g:l("values"),keys:o?g:l("keys"),entries:m},a)for(u in s)u in h||T(h,u,s[u]);else R(R.P+R.F*(qr||p),t,s);return s},zr=xr(!0);Br(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=zr(t,r),this._i+=e.length,{value:e,done:!1})});var Hr=xr(!1);R(R.P,"String",{codePointAt:function(e){return Hr(this,e)}});var Wr=P("match"),Yr=function(e){var t;return c(e)&&(void 0!==(t=e[Wr])?!!t:"RegExp"==U(e))},Xr=function(e,t,r){if(Yr(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(G(e))},Jr=P("match"),Kr=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[Jr]=!1,!"/./"[e](t)}catch(e){}}return!0},$r="".endsWith;R(R.P+R.F*Kr("endsWith"),"String",{endsWith:function(e){var t=Xr(this,e,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=W(t.length),i=void 0===r?n:Math.min(W(r),n),o=String(e);return $r?$r.call(t,o,i):t.slice(i-o.length,i)===o}});R(R.P+R.F*Kr("includes"),"String",{includes:function(e){return!!~Xr(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}}),R(R.P,"String",{repeat:tr});var Qr="".startsWith;R(R.P+R.F*Kr("startsWith"),"String",{startsWith:function(e){var t=Xr(this,e,"startsWith"),r=W(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return Qr?Qr.call(t,n,r):t.slice(r,r+n.length)===n}});var Zr=/"/g,en=function(e,t,r,n){var i=String(G(e)),o="<"+t;return""!==r&&(o+=" "+r+'="'+String(n).replace(Zr,"&quot;")+'"'),o+">"+i+"</"+t+">"},tn=function(e,t){var r={};r[e]=t(en),R(R.P+R.F*a(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",r)};tn("anchor",function(e){return function(t){return e(this,"a","name",t)}}),tn("big",function(e){return function(){return e(this,"big","","")}}),tn("blink",function(e){return function(){return e(this,"blink","","")}}),tn("bold",function(e){return function(){return e(this,"b","","")}}),tn("fixed",function(e){return function(){return e(this,"tt","","")}}),tn("fontcolor",function(e){return function(t){return e(this,"font","color",t)}}),tn("fontsize",function(e){return function(t){return e(this,"font","size",t)}}),tn("italics",function(e){return function(){return e(this,"i","","")}}),tn("link",function(e){return function(t){return e(this,"a","href",t)}}),tn("small",function(e){return function(){return e(this,"small","","")}}),tn("strike",function(e){return function(){return e(this,"strike","","")}}),tn("sub",function(e){return function(){return e(this,"sub","","")}}),tn("sup",function(e){return function(){return e(this,"sup","","")}}),R(R.S,"Date",{now:function(){return(new Date).getTime()}}),R(R.P+R.F*a(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=et(this),r=v(t);return"number"!=typeof r||isFinite(r)?t.toISOString():null}});var rn=Date.prototype.getTime,nn=Date.prototype.toISOString,on=function(e){return e>9?e:"0"+e},an=a(function(){return"0385-07-25T07:06:39.999Z"!=nn.call(new Date(-5e13-1))})||!a(function(){nn.call(new Date(NaN))})?function(){if(!isFinite(rn.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),n=t<0?"-":t>9999?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+on(e.getUTCMonth()+1)+"-"+on(e.getUTCDate())+"T"+on(e.getUTCHours())+":"+on(e.getUTCMinutes())+":"+on(e.getUTCSeconds())+"."+(r>99?r:"0"+on(r))+"Z"}:nn;R(R.P+R.F*(Date.prototype.toISOString!==an),"Date",{toISOString:an});var sn=Date.prototype,un=sn.toString,cn=sn.getTime;new Date(NaN)+""!="Invalid Date"&&T(sn,"toString",function(){var e=cn.call(this);return e==e?un.call(this):"Invalid Date"});var ln=P("toPrimitive"),fn=Date.prototype;ln in fn||_(fn,ln,function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return v(l(this),"number"!=e)}),R(R.S,"Array",{isArray:ae});var dn=function(e,t,r,n){try{return n?t(l(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&l(i.call(e)),t}},pn=P("iterator"),hn=Array.prototype,vn=function(e){return void 0!==e&&(Lr.Array===e||hn[pn]===e)},gn=function(e,t,r){t in e?m.f(e,t,y(0,r)):e[t]=r},mn=P("iterator"),yn=u.getIteratorMethod=function(e){if(null!=e)return e[mn]||e["@@iterator"]||Lr[ht(e)]},_n=P("iterator"),En=!1;try{[7][_n]().return=function(){En=!0}}catch(e){}var bn=function(e,t){if(!t&&!En)return!1;var r=!1;try{var n=[7],i=n[_n]();i.next=function(){return{done:r=!0}},n[_n]=function(){return i},e(n)}catch(e){}return r};R(R.S+R.F*!bn(function(e){}),"Array",{from:function(e){var t,r,n,i,o=et(e),a="function"==typeof this?this:Array,s=arguments.length,u=s>1?arguments[1]:void 0,c=void 0!==u,l=0,f=yn(o);if(c&&(u=O(u,s>2?arguments[2]:void 0,2)),null==f||a==Array&&vn(f))for(r=new a(t=W(o.length));t>l;l++)gn(r,l,c?u(o[l],l):o[l]);else for(i=f.call(o),r=new a;!(n=i.next()).done;l++)gn(r,l,c?dn(i,u,[n.value,l],!0):n.value);return r.length=l,r}}),R(R.S+R.F*a(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)gn(r,e,arguments[e++]);return r.length=t,r}});var Sn=function(e,t){return!!e&&a(function(){t?e.call(null,function(){},1):e.call(null)})},Tn=[].join;R(R.P+R.F*(F!=Object||!Sn(Tn)),"Array",{join:function(e){return Tn.call(q(this),void 0===e?",":e)}});var wn=[].slice;R(R.P+R.F*a(function(){ce&&wn.call(ce)}),"Array",{slice:function(e,t){var r=W(this.length),n=U(this);if(t=void 0===t?r:t,"Array"==n)return wn.call(this,e,t);for(var i=J(e,r),o=J(t,r),a=W(o-i),s=new Array(a),u=0;u<a;u++)s[u]="String"==n?this.charAt(i+u):this[i+u];return s}});var On=[].sort,kn=[1,2,3];R(R.P+R.F*(a(function(){kn.sort(void 0)})||!a(function(){kn.sort(null)})||!Sn(On)),"Array",{sort:function(e){return void 0===e?On.call(et(this)):On.call(et(this),w(e))}});var Rn=P("species"),An=function(e,t){return new(function(e){var t;return ae(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!ae(t.prototype)||(t=void 0),c(t)&&null===(t=t[Rn])&&(t=void 0)),void 0===t?Array:t}(e))(t)},In=function(e,t){var r=1==e,n=2==e,i=3==e,o=4==e,a=6==e,s=5==e||a,u=t||An;return function(t,c,l){for(var f,d,p=et(t),h=F(p),v=O(c,l,3),g=W(h.length),m=0,y=r?u(t,g):n?u(t,0):void 0;g>m;m++)if((s||m in h)&&(d=v(f=h[m],m,p),e))if(r)y[m]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:y.push(f)}else if(o)return!1;return a?-1:i||o?o:y}},Pn=In(0),Cn=Sn([].forEach,!0);R(R.P+R.F*!Cn,"Array",{forEach:function(e){return Pn(this,e,arguments[1])}});var Mn=In(1);R(R.P+R.F*!Sn([].map,!0),"Array",{map:function(e){return Mn(this,e,arguments[1])}});var Nn=In(2);R(R.P+R.F*!Sn([].filter,!0),"Array",{filter:function(e){return Nn(this,e,arguments[1])}});var Dn=In(3);R(R.P+R.F*!Sn([].some,!0),"Array",{some:function(e){return Dn(this,e,arguments[1])}});var jn=In(4);R(R.P+R.F*!Sn([].every,!0),"Array",{every:function(e){return jn(this,e,arguments[1])}});var xn=function(e,t,r,n,i){w(t);var o=et(e),a=F(o),s=W(o.length),u=i?s-1:0,c=i?-1:1;if(r<2)for(;;){if(u in a){n=a[u],u+=c;break}if(u+=c,i?u<0:s<=u)throw TypeError("Reduce of empty array with no initial value")}for(;i?u>=0:s>u;u+=c)u in a&&(n=t(n,a[u],u,o));return n};R(R.P+R.F*!Sn([].reduce,!0),"Array",{reduce:function(e){return xn(this,e,arguments.length,arguments[1],!1)}}),R(R.P+R.F*!Sn([].reduceRight,!0),"Array",{reduceRight:function(e){return xn(this,e,arguments.length,arguments[1],!0)}});var Ln=K(!1),Un=[].indexOf,Fn=!!Un&&1/[1].indexOf(1,-0)<0;R(R.P+R.F*(Fn||!Sn(Un)),"Array",{indexOf:function(e){return Fn?Un.apply(this,arguments)||0:Ln(this,e,arguments[1])}});var Gn=[].lastIndexOf,qn=!!Gn&&1/[1].lastIndexOf(1,-0)<0;R(R.P+R.F*(qn||!Sn(Gn)),"Array",{lastIndexOf:function(e){if(qn)return Gn.apply(this,arguments)||0;var t=q(this),r=W(t.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,z(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}});var Vn=[].copyWithin||function(e,t){var r=et(this),n=W(r.length),i=J(e,n),o=J(t,n),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?n:J(a,n))-o,n-i),u=1;for(o<i&&i<o+s&&(u=-1,o+=s-1,i+=s-1);s-- >0;)o in r?r[i]=r[o]:delete r[i],i+=u,o+=u;return r},Bn=P("unscopables"),zn=Array.prototype;null==zn[Bn]&&_(zn,Bn,{});var Hn=function(e){zn[Bn][e]=!0};R(R.P,"Array",{copyWithin:Vn}),Hn("copyWithin");var Wn=function(e){for(var t=et(this),r=W(t.length),n=arguments.length,i=J(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,a=void 0===o?r:J(o,r);a>i;)t[i++]=e;return t};R(R.P,"Array",{fill:Wn}),Hn("fill");var Yn=In(5),Xn=!0;"find"in[]&&Array(1).find(function(){Xn=!1}),R(R.P+R.F*Xn,"Array",{find:function(e){return Yn(this,e,arguments.length>1?arguments[1]:void 0)}}),Hn("find");var Jn=In(6),Kn=!0;"findIndex"in[]&&Array(1).findIndex(function(){Kn=!1}),R(R.P+R.F*Kn,"Array",{findIndex:function(e){return Jn(this,e,arguments.length>1?arguments[1]:void 0)}}),Hn("findIndex");var $n=P("species"),Qn=function(e){var t=n[e];s&&t&&!t[$n]&&m.f(t,$n,{configurable:!0,get:function(){return this}})};Qn("Array");var Zn=function(e,t){return{value:t,done:!!e}},ei=Br(Array,"Array",function(e,t){this._t=q(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,Zn(1)):Zn(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values");Lr.Arguments=Lr.Array,Hn("keys"),Hn("values"),Hn("entries");var ti=function(){var e=l(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},ri=m.f,ni=ve.f,ii=n.RegExp,oi=ii,ai=ii.prototype,si=/a/g,ui=/a/g,ci=new ii(si)!==si;if(s&&(!ci||a(function(){return ui[P("match")]=!1,ii(si)!=si||ii(ui)==ui||"/a/i"!=ii(si,"i")}))){ii=function(e,t){var r=this instanceof ii,n=Yr(e),i=void 0===t;return!r&&n&&e.constructor===ii&&i?e:Gt(ci?new oi(n&&!i?e.source:e,t):oi((n=e instanceof ii)?e.source:e,n&&i?ti.call(e):t),r?this:ai,ii)};for(var li=function(e){e in ii||ri(ii,e,{configurable:!0,get:function(){return oi[e]},set:function(t){oi[e]=t}})},fi=ni(oi),di=0;fi.length>di;)li(fi[di++]);ai.constructor=ii,ii.prototype=ai,T(n,"RegExp",ii)}Qn("RegExp"),s&&"g"!=/./g.flags&&m.f(RegExp.prototype,"flags",{configurable:!0,get:ti});var pi=/./.toString,hi=function(e){T(RegExp.prototype,"toString",e,!0)};a(function(){return"/a/b"!=pi.call({source:"a",flags:"b"})})?hi(function(){var e=l(this);return"/".concat(e.source,"/","flags"in e?e.flags:!s&&e instanceof RegExp?ti.call(e):void 0)}):"toString"!=pi.name&&hi(function(){return pi.call(this)});var vi=function(e,t,r){var n=P(e),i=r(G,n,""[e]),o=i[0],s=i[1];a(function(){var t={};return t[n]=function(){return 7},7!=""[e](t)})&&(T(String.prototype,e,o),_(RegExp.prototype,n,2==t?function(e,t){return s.call(e,this,t)}:function(e){return s.call(e,this)}))};vi("match",1,function(e,t,r){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},r]}),vi("replace",2,function(e,t,r){return[function(n,i){var o=e(this),a=null==n?void 0:n[t];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},r]}),vi("search",1,function(e,t,r){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},r]}),vi("split",2,function(e,t,r){var n=Yr,i=r,o=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var a=void 0===/()??/.exec("")[1];r=function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!n(e))return i.call(r,e,t);var s,u,c,l,f,d=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,v=void 0===t?4294967295:t>>>0,g=new RegExp(e.source,p+"g");for(a||(s=new RegExp("^"+g.source+"$(?!\\s)",p));(u=g.exec(r))&&!((c=u.index+u[0].length)>h&&(d.push(r.slice(h,u.index)),!a&&u.length>1&&u[0].replace(s,function(){for(f=1;f<arguments.length-2;f++)void 0===arguments[f]&&(u[f]=void 0)}),u.length>1&&u.index<r.length&&o.apply(d,u.slice(1)),l=u[0].length,h=c,d.length>=v));)g.lastIndex===u.index&&g.lastIndex++;return h===r.length?!l&&g.test("")||d.push(""):d.push(r.slice(h)),d.length>v?d.slice(0,v):d}}else"0".split(void 0,0).length&&(r=function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)});return[function(n,i){var o=e(this),a=null==n?void 0:n[t];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},r]});var gi,mi,yi,_i=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e},Ei=r(function(e){var t={},r={},n=e.exports=function(e,n,i,o,a){var s,u,c,f,d=a?function(){return e}:yn(e),p=O(i,o,n?2:1),h=0;if("function"!=typeof d)throw TypeError(e+" is not iterable!");if(vn(d)){for(s=W(e.length);s>h;h++)if((f=n?p(l(u=e[h])[0],u[1]):p(e[h]))===t||f===r)return f}else for(c=d.call(e);!(u=c.next()).done;)if((f=dn(c,p,u.value,n))===t||f===r)return f};n.BREAK=t,n.RETURN=r}),bi=P("species"),Si=function(e,t){var r,n=l(e).constructor;return void 0===n||null==(r=l(n)[bi])?t:w(r)},Ti=n.process,wi=n.setImmediate,Oi=n.clearImmediate,ki=n.MessageChannel,Ri=n.Dispatch,Ai=0,Ii={},Pi=function(){var e=+this;if(Ii.hasOwnProperty(e)){var t=Ii[e];delete Ii[e],t()}},Ci=function(e){Pi.call(e.data)};wi&&Oi||(wi=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return Ii[++Ai]=function(){gt("function"==typeof e?e:Function(e),t)},gi(Ai),Ai},Oi=function(e){delete Ii[e]},"process"==U(Ti)?gi=function(e){Ti.nextTick(O(Pi,e,1))}:Ri&&Ri.now?gi=function(e){Ri.now(O(Pi,e,1))}:ki?(yi=(mi=new ki).port2,mi.port1.onmessage=Ci,gi=O(yi.postMessage,yi,1)):n.addEventListener&&"function"==typeof postMessage&&!n.importScripts?(gi=function(e){n.postMessage(e+"","*")},n.addEventListener("message",Ci,!1)):gi="onreadystatechange"in p("script")?function(e){ce.appendChild(p("script")).onreadystatechange=function(){ce.removeChild(this),Pi.call(e)}}:function(e){setTimeout(O(Pi,e,1),0)});var Mi={set:wi,clear:Oi},Ni=Mi.set,Di=n.MutationObserver||n.WebKitMutationObserver,ji=n.process,xi=n.Promise,Li="process"==U(ji),Ui=function(){var e,t,r,i=function(){var n,i;for(Li&&(n=ji.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(Li)r=function(){ji.nextTick(i)};else if(!Di||n.navigator&&n.navigator.standalone)if(xi&&xi.resolve){var o=xi.resolve(void 0);r=function(){o.then(i)}}else r=function(){Ni.call(n,i)};else{var a=!0,s=document.createTextNode("");new Di(i).observe(s,{characterData:!0}),r=function(){s.data=a=!a}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}};function Fi(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=w(t),this.reject=w(r)}var Gi,qi,Vi,Bi,zi={f:function(e){return new Fi(e)}},Hi=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},Wi=n.navigator,Yi=Wi&&Wi.userAgent||"",Xi=function(e,t){if(l(e),c(t)&&t.constructor===e)return t;var r=zi.f(e);return(0,r.resolve)(t),r.promise},Ji=function(e,t,r){for(var n in t)T(e,n,t[n],r);return e},Ki=Mi.set,$i=Ui(),Qi=n.TypeError,Zi=n.process,eo=Zi&&Zi.versions,to=eo&&eo.v8||"",ro=n.Promise,no="process"==ht(Zi),io=function(){},oo=qi=zi.f,ao=!!function(){try{var e=ro.resolve(1),t=(e.constructor={})[P("species")]=function(e){e(io,io)};return(no||"function"==typeof PromiseRejectionEvent)&&e.then(io)instanceof t&&0!==to.indexOf("6.6")&&-1===Yi.indexOf("Chrome/66")}catch(e){}}(),so=function(e){var t;return!(!c(e)||"function"!=typeof(t=e.then))&&t},uo=function(e,t){if(!e._n){e._n=!0;var r=e._c;$i(function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(i||(2==e._h&&fo(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?c(Qi("Promise-chain cycle")):(o=so(r))?o.call(r,u,c):u(r)):c(n)}catch(e){l&&!a&&l.exit(),c(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&co(e)})}},co=function(e){Ki.call(n,function(){var t,r,i,o=e._v,a=lo(e);if(a&&(t=Hi(function(){no?Zi.emit("unhandledRejection",o,e):(r=n.onunhandledrejection)?r({promise:e,reason:o}):(i=n.console)&&i.error&&i.error("Unhandled promise rejection",o)}),e._h=no||lo(e)?2:1),e._a=void 0,a&&t.e)throw t.v})},lo=function(e){return 1!==e._h&&0===(e._a||e._c).length},fo=function(e){Ki.call(n,function(){var t;no?Zi.emit("rejectionHandled",e):(t=n.onrejectionhandled)&&t({promise:e,reason:e._v})})},po=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),uo(t,!0))},ho=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw Qi("Promise can't be resolved itself");(t=so(e))?$i(function(){var n={_w:r,_d:!1};try{t.call(e,O(ho,n,1),O(po,n,1))}catch(e){po.call(n,e)}}):(r._v=e,r._s=1,uo(r,!1))}catch(e){po.call({_w:r,_d:!1},e)}}};ao||(ro=function(e){_i(this,ro,"Promise","_h"),w(e),Gi.call(this);try{e(O(ho,this,1),O(po,this,1))}catch(e){po.call(this,e)}},(Gi=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=Ji(ro.prototype,{then:function(e,t){var r=oo(Si(this,ro));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=no?Zi.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&uo(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Vi=function(){var e=new Gi;this.promise=e,this.resolve=O(ho,e,1),this.reject=O(po,e,1)},zi.f=oo=function(e){return e===ro||e===Bi?new Vi(e):qi(e)}),R(R.G+R.W+R.F*!ao,{Promise:ro}),N(ro,"Promise"),Qn("Promise"),Bi=u.Promise,R(R.S+R.F*!ao,"Promise",{reject:function(e){var t=oo(this);return(0,t.reject)(e),t.promise}}),R(R.S+R.F*!ao,"Promise",{resolve:function(e){return Xi(this,e)}}),R(R.S+R.F*!(ao&&bn(function(e){ro.all(e).catch(io)})),"Promise",{all:function(e){var t=this,r=oo(t),n=r.resolve,i=r.reject,o=Hi(function(){var r=[],o=0,a=1;Ei(e,!1,function(e){var s=o++,u=!1;r.push(void 0),a++,t.resolve(e).then(function(e){u||(u=!0,r[s]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=oo(t),n=r.reject,i=Hi(function(){Ei(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}});var vo=function(e,t){if(!c(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e},go=m.f,mo=A.fastKey,yo=s?"_s":"size",_o=function(e,t){var r,n=mo(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r},Eo={getConstructor:function(e,t,r,n){var i=e(function(e,o){_i(e,i,t,"_i"),e._t=t,e._i=pe(null),e._f=void 0,e._l=void 0,e[yo]=0,null!=o&&Ei(o,r,e[n],e)});return Ji(i.prototype,{clear:function(){for(var e=vo(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[yo]=0},delete:function(e){var r=vo(this,t),n=_o(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[yo]--}return!!n},forEach:function(e){vo(this,t);for(var r,n=O(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!_o(vo(this,t),e)}}),s&&go(i.prototype,"size",{get:function(){return vo(this,t)[yo]}}),i},def:function(e,t,r){var n,i,o=_o(e,t);return o?o.v=r:(e._l=o={i:i=mo(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[yo]++,"F"!==i&&(e._i[i]=o)),e},getEntry:_o,setStrong:function(e,t,r){Br(e,t,function(e,r){this._t=vo(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?Zn(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,Zn(1))},r?"entries":"values",!r,!0),Qn(t)}},bo=function(e,t,r,i,o,s){var u=n[e],l=u,f=o?"set":"add",d=l&&l.prototype,p={},h=function(e){var t=d[e];T(d,e,"delete"==e?function(e){return!(s&&!c(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(s&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return s&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof l&&(s||d.forEach&&!a(function(){(new l).entries().next()}))){var v=new l,g=v[f](s?{}:-0,1)!=v,m=a(function(){v.has(1)}),y=bn(function(e){new l(e)}),_=!s&&a(function(){for(var e=new l,t=5;t--;)e[f](t,t);return!e.has(-0)});y||((l=t(function(t,r){_i(t,l,e);var n=Gt(new u,t,l);return null!=r&&Ei(r,o,n[f],n),n})).prototype=d,d.constructor=l),(m||_)&&(h("delete"),h("has"),o&&h("get")),(_||g)&&h(f),s&&d.clear&&delete d.clear}else l=i.getConstructor(t,e,o,f),Ji(l.prototype,r),A.NEED=!0;return N(l,e),p[e]=l,R(R.G+R.W+R.F*(l!=u),p),s||i.setStrong(l,e,o),l},So=bo("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=Eo.getEntry(vo(this,"Map"),e);return t&&t.v},set:function(e,t){return Eo.def(vo(this,"Map"),0===e?0:e,t)}},Eo,!0),To=bo("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return Eo.def(vo(this,"Set"),e=0===e?0:e,e)}},Eo),wo=A.getWeak,Oo=In(5),ko=In(6),Ro=0,Ao=function(e){return e._l||(e._l=new Io)},Io=function(){this.a=[]},Po=function(e,t){return Oo(e.a,function(e){return e[0]===t})};Io.prototype={get:function(e){var t=Po(this,e);if(t)return t[1]},has:function(e){return!!Po(this,e)},set:function(e,t){var r=Po(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=ko(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}};var Co={getConstructor:function(e,t,r,n){var i=e(function(e,o){_i(e,i,t,"_i"),e._t=t,e._i=Ro++,e._l=void 0,null!=o&&Ei(o,r,e[n],e)});return Ji(i.prototype,{delete:function(e){if(!c(e))return!1;var r=wo(e);return!0===r?Ao(vo(this,t)).delete(e):r&&o(r,this._i)&&delete r[this._i]},has:function(e){if(!c(e))return!1;var r=wo(e);return!0===r?Ao(vo(this,t)).has(e):r&&o(r,this._i)}}),i},def:function(e,t,r){var n=wo(l(t),!0);return!0===n?Ao(e).set(t,r):n[e._i]=r,e},ufstore:Ao},Mo=r(function(e){var t,r=In(0),n=A.getWeak,i=Object.isExtensible,o=Co.ufstore,s={},u=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},l={get:function(e){if(c(e)){var t=n(e);return!0===t?o(vo(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return Co.def(vo(this,"WeakMap"),e,t)}},f=e.exports=bo("WeakMap",u,l,Co,!0,!0);a(function(){return 7!=(new f).set((Object.freeze||Object)(s),7).get(s)})&&(t=Co.getConstructor(u,"WeakMap"),ut(t.prototype,l),A.NEED=!0,r(["delete","has","get","set"],function(e){var r=f.prototype,n=r[e];T(r,e,function(r,o){if(c(r)&&!i(r)){this._f||(this._f=new t);var a=this._f[e](r,o);return"set"==e?this:a}return n.call(this,r,o)})}))});bo("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return Co.def(vo(this,"WeakSet"),e,!0)}},Co,!1,!0);for(var No,Do=S("typed_array"),jo=S("view"),xo=!(!n.ArrayBuffer||!n.DataView),Lo=xo,Uo=0,Fo="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");Uo<9;)(No=n[Fo[Uo++]])?(_(No.prototype,Do,!0),_(No.prototype,jo,!0)):Lo=!1;var Go={ABV:xo,CONSTR:Lo,TYPED:Do,VIEW:jo},qo=function(e){if(void 0===e)return 0;var t=z(e),r=W(t);if(t!==r)throw RangeError("Wrong length!");return r},Vo=r(function(e,t){var r=ve.f,i=m.f,o="prototype",u="Wrong index!",c=n.ArrayBuffer,l=n.DataView,f=n.Math,d=n.RangeError,p=n.Infinity,h=c,v=f.abs,g=f.pow,y=f.floor,E=f.log,b=f.LN2,S=s?"_b":"buffer",T=s?"_l":"byteLength",w=s?"_o":"byteOffset";function O(e,t,r){var n,i,o,a=new Array(r),s=8*r-t-1,u=(1<<s)-1,c=u>>1,l=23===t?g(2,-24)-g(2,-77):0,f=0,d=e<0||0===e&&1/e<0?1:0;for((e=v(e))!=e||e===p?(i=e!=e?1:0,n=u):(n=y(E(e)/b),e*(o=g(2,-n))<1&&(n--,o*=2),(e+=n+c>=1?l/o:l*g(2,1-c))*o>=2&&(n++,o/=2),n+c>=u?(i=0,n=u):n+c>=1?(i=(e*o-1)*g(2,t),n+=c):(i=e*g(2,c-1)*g(2,t),n=0));t>=8;a[f++]=255&i,i/=256,t-=8);for(n=n<<t|i,s+=t;s>0;a[f++]=255&n,n/=256,s-=8);return a[--f]|=128*d,a}function k(e,t,r){var n,i=8*r-t-1,o=(1<<i)-1,a=o>>1,s=i-7,u=r-1,c=e[u--],l=127&c;for(c>>=7;s>0;l=256*l+e[u],u--,s-=8);for(n=l&(1<<-s)-1,l>>=-s,s+=t;s>0;n=256*n+e[u],u--,s-=8);if(0===l)l=1-a;else{if(l===o)return n?NaN:c?-p:p;n+=g(2,t),l-=a}return(c?-1:1)*n*g(2,l-t)}function R(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function A(e){return[255&e]}function I(e){return[255&e,e>>8&255]}function P(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function C(e){return O(e,52,8)}function M(e){return O(e,23,4)}function D(e,t,r){i(e[o],t,{get:function(){return this[r]}})}function j(e,t,r,n){var i=qo(+r);if(i+t>e[T])throw d(u);var o=e[S]._b,a=i+e[w],s=o.slice(a,a+t);return n?s:s.reverse()}function x(e,t,r,n,i,o){var a=qo(+r);if(a+t>e[T])throw d(u);for(var s=e[S]._b,c=a+e[w],l=n(+i),f=0;f<t;f++)s[c+f]=l[o?f:t-f-1]}if(Go.ABV){if(!a(function(){c(1)})||!a(function(){new c(-1)})||a(function(){return new c,new c(1.5),new c(NaN),"ArrayBuffer"!=c.name})){for(var L,U=(c=function(e){return _i(this,c),new h(qo(e))})[o]=h[o],F=r(h),G=0;F.length>G;)(L=F[G++])in c||_(c,L,h[L]);U.constructor=c}var q=new l(new c(2)),V=l[o].setInt8;q.setInt8(0,2147483648),q.setInt8(1,2147483649),!q.getInt8(0)&&q.getInt8(1)||Ji(l[o],{setInt8:function(e,t){V.call(this,e,t<<24>>24)},setUint8:function(e,t){V.call(this,e,t<<24>>24)}},!0)}else c=function(e){_i(this,c,"ArrayBuffer");var t=qo(e);this._b=Wn.call(new Array(t),0),this[T]=t},l=function(e,t,r){_i(this,l,"DataView"),_i(e,c,"DataView");var n=e[T],i=z(t);if(i<0||i>n)throw d("Wrong offset!");if(i+(r=void 0===r?n-i:W(r))>n)throw d("Wrong length!");this[S]=e,this[w]=i,this[T]=r},s&&(D(c,"byteLength","_l"),D(l,"buffer","_b"),D(l,"byteLength","_l"),D(l,"byteOffset","_o")),Ji(l[o],{getInt8:function(e){return j(this,1,e)[0]<<24>>24},getUint8:function(e){return j(this,1,e)[0]},getInt16:function(e){var t=j(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=j(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return R(j(this,4,e,arguments[1]))},getUint32:function(e){return R(j(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return k(j(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return k(j(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){x(this,1,e,A,t)},setUint8:function(e,t){x(this,1,e,A,t)},setInt16:function(e,t){x(this,2,e,I,t,arguments[2])},setUint16:function(e,t){x(this,2,e,I,t,arguments[2])},setInt32:function(e,t){x(this,4,e,P,t,arguments[2])},setUint32:function(e,t){x(this,4,e,P,t,arguments[2])},setFloat32:function(e,t){x(this,4,e,M,t,arguments[2])},setFloat64:function(e,t){x(this,8,e,C,t,arguments[2])}});N(c,"ArrayBuffer"),N(l,"DataView"),_(l[o],Go.VIEW,!0),t.ArrayBuffer=c,t.DataView=l}),Bo=n.ArrayBuffer,zo=Vo.ArrayBuffer,Ho=Vo.DataView,Wo=Go.ABV&&Bo.isView,Yo=zo.prototype.slice,Xo=Go.VIEW;R(R.G+R.W+R.F*(Bo!==zo),{ArrayBuffer:zo}),R(R.S+R.F*!Go.CONSTR,"ArrayBuffer",{isView:function(e){return Wo&&Wo(e)||c(e)&&Xo in e}}),R(R.P+R.U+R.F*a(function(){return!new zo(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==Yo&&void 0===t)return Yo.call(l(this),e);for(var r=l(this).byteLength,n=J(e,r),i=J(void 0===t?r:t,r),o=new(Si(this,zo))(W(i-n)),a=new Ho(this),s=new Ho(o),u=0;n<i;)s.setUint8(u++,a.getUint8(n++));return o}}),Qn("ArrayBuffer"),R(R.G+R.W+R.F*!Go.ABV,{DataView:Vo.DataView});var Jo=r(function(e){if(s){var t=n,r=a,i=R,u=Go,l=Vo,f=O,d=_i,p=y,h=_,g=Ji,E=z,b=W,T=qo,w=J,k=v,A=o,I=ht,C=c,M=et,N=vn,D=pe,j=nt,x=ve.f,L=yn,U=S,F=P,G=In,q=K,V=Si,B=ei,H=Lr,Y=bn,X=Qn,$=Wn,Q=Vn,Z=m,ee=be,te=Z.f,re=ee.f,ne=t.RangeError,ie=t.TypeError,oe=t.Uint8Array,ae=Array.prototype,se=l.ArrayBuffer,ue=l.DataView,ce=G(0),le=G(2),fe=G(3),de=G(4),he=G(5),ge=G(6),me=q(!0),ye=q(!1),_e=B.values,Ee=B.keys,Se=B.entries,Te=ae.lastIndexOf,we=ae.reduce,Oe=ae.reduceRight,ke=ae.join,Re=ae.sort,Ae=ae.slice,Ie=ae.toString,Pe=ae.toLocaleString,Ce=F("iterator"),Me=F("toStringTag"),Ne=U("typed_constructor"),De=U("def_constructor"),je=u.CONSTR,xe=u.TYPED,Le=u.VIEW,Ue=G(1,function(e,t){return Be(V(e,e[De]),t)}),Fe=r(function(){return 1===new oe(new Uint16Array([1]).buffer)[0]}),Ge=!!oe&&!!oe.prototype.set&&r(function(){new oe(1).set({})}),qe=function(e,t){var r=E(e);if(r<0||r%t)throw ne("Wrong offset!");return r},Ve=function(e){if(C(e)&&xe in e)return e;throw ie(e+" is not a typed array!")},Be=function(e,t){if(!(C(e)&&Ne in e))throw ie("It is not a typed array constructor!");return new e(t)},ze=function(e,t){return He(V(e,e[De]),t)},He=function(e,t){for(var r=0,n=t.length,i=Be(e,n);n>r;)i[r]=t[r++];return i},We=function(e,t,r){te(e,t,{get:function(){return this._d[r]}})},Ye=function(e){var t,r,n,i,o,a,s=M(e),u=arguments.length,c=u>1?arguments[1]:void 0,l=void 0!==c,d=L(s);if(null!=d&&!N(d)){for(a=d.call(s),n=[],t=0;!(o=a.next()).done;t++)n.push(o.value);s=n}for(l&&u>2&&(c=f(c,arguments[2],2)),t=0,r=b(s.length),i=Be(this,r);r>t;t++)i[t]=l?c(s[t],t):s[t];return i},Xe=function(){for(var e=0,t=arguments.length,r=Be(this,t);t>e;)r[e]=arguments[e++];return r},Je=!!oe&&r(function(){Pe.call(new oe(1))}),Ke=function(){return Pe.apply(Je?Ae.call(Ve(this)):Ve(this),arguments)},$e={copyWithin:function(e,t){return Q.call(Ve(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return de(Ve(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return $.apply(Ve(this),arguments)},filter:function(e){return ze(this,le(Ve(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return he(Ve(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ge(Ve(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){ce(Ve(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ye(Ve(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return me(Ve(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return ke.apply(Ve(this),arguments)},lastIndexOf:function(e){return Te.apply(Ve(this),arguments)},map:function(e){return Ue(Ve(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return we.apply(Ve(this),arguments)},reduceRight:function(e){return Oe.apply(Ve(this),arguments)},reverse:function(){for(var e,t=Ve(this).length,r=Math.floor(t/2),n=0;n<r;)e=this[n],this[n++]=this[--t],this[t]=e;return this},some:function(e){return fe(Ve(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return Re.call(Ve(this),e)},subarray:function(e,t){var r=Ve(this),n=r.length,i=w(e,n);return new(V(r,r[De]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,b((void 0===t?n:w(t,n))-i))}},Qe=function(e,t){return ze(this,Ae.call(Ve(this),e,t))},Ze=function(e){Ve(this);var t=qe(arguments[1],1),r=this.length,n=M(e),i=b(n.length),o=0;if(i+t>r)throw ne("Wrong length!");for(;o<i;)this[t+o]=n[o++]},tt={entries:function(){return Se.call(Ve(this))},keys:function(){return Ee.call(Ve(this))},values:function(){return _e.call(Ve(this))}},rt=function(e,t){return C(e)&&e[xe]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},it=function(e,t){return rt(e,t=k(t,!0))?p(2,e[t]):re(e,t)},ot=function(e,t,r){return!(rt(e,t=k(t,!0))&&C(r)&&A(r,"value"))||A(r,"get")||A(r,"set")||r.configurable||A(r,"writable")&&!r.writable||A(r,"enumerable")&&!r.enumerable?te(e,t,r):(e[t]=r.value,e)};je||(ee.f=it,Z.f=ot),i(i.S+i.F*!je,"Object",{getOwnPropertyDescriptor:it,defineProperty:ot}),r(function(){Ie.call({})})&&(Ie=Pe=function(){return ke.call(this)});var at=g({},$e);g(at,tt),h(at,Ce,tt.values),g(at,{slice:Qe,set:Ze,constructor:function(){},toString:Ie,toLocaleString:Ke}),We(at,"buffer","b"),We(at,"byteOffset","o"),We(at,"byteLength","l"),We(at,"length","e"),te(at,Me,{get:function(){return this[xe]}}),e.exports=function(e,n,o,a){var s=e+((a=!!a)?"Clamped":"")+"Array",c="get"+e,l="set"+e,f=t[s],p=f||{},v=f&&j(f),g=!f||!u.ABV,m={},y=f&&f.prototype,_=function(e,t){te(e,t,{get:function(){return function(e,t){var r=e._d;return r.v[c](t*n+r.o,Fe)}(this,t)},set:function(e){return function(e,t,r){var i=e._d;a&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[l](t*n+i.o,r,Fe)}(this,t,e)},enumerable:!0})};g?(f=o(function(e,t,r,i){d(e,f,s,"_d");var o,a,u,c,l=0,p=0;if(C(t)){if(!(t instanceof se||"ArrayBuffer"==(c=I(t))||"SharedArrayBuffer"==c))return xe in t?He(f,t):Ye.call(f,t);o=t,p=qe(r,n);var v=t.byteLength;if(void 0===i){if(v%n)throw ne("Wrong length!");if((a=v-p)<0)throw ne("Wrong length!")}else if((a=b(i)*n)+p>v)throw ne("Wrong length!");u=a/n}else u=T(t),o=new se(a=u*n);for(h(e,"_d",{b:o,o:p,l:a,e:u,v:new ue(o)});l<u;)_(e,l++)}),y=f.prototype=D(at),h(y,"constructor",f)):r(function(){f(1)})&&r(function(){new f(-1)})&&Y(function(e){new f,new f(null),new f(1.5),new f(e)},!0)||(f=o(function(e,t,r,i){var o;return d(e,f,s),C(t)?t instanceof se||"ArrayBuffer"==(o=I(t))||"SharedArrayBuffer"==o?void 0!==i?new p(t,qe(r,n),i):void 0!==r?new p(t,qe(r,n)):new p(t):xe in t?He(f,t):Ye.call(f,t):new p(T(t))}),ce(v!==Function.prototype?x(p).concat(x(v)):x(p),function(e){e in f||h(f,e,p[e])}),f.prototype=y,y.constructor=f);var E=y[Ce],S=!!E&&("values"==E.name||null==E.name),w=tt.values;h(f,Ne,!0),h(y,xe,s),h(y,Le,!0),h(y,De,f),(a?new f(1)[Me]==s:Me in y)||te(y,Me,{get:function(){return s}}),m[s]=f,i(i.G+i.W+i.F*(f!=p),m),i(i.S,s,{BYTES_PER_ELEMENT:n}),i(i.S+i.F*r(function(){p.of.call(f,1)}),s,{from:Ye,of:Xe}),"BYTES_PER_ELEMENT"in y||h(y,"BYTES_PER_ELEMENT",n),i(i.P,s,$e),X(s),i(i.P+i.F*Ge,s,{set:Ze}),i(i.P+i.F*!S,s,tt),y.toString!=Ie&&(y.toString=Ie),i(i.P+i.F*r(function(){new f(1).slice()}),s,{slice:Qe}),i(i.P+i.F*(r(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!r(function(){y.toLocaleString.call([1,2])})),s,{toLocaleString:Ke}),H[s]=S?E:w,S||h(y,Ce,w)}}else e.exports=function(){}});Jo("Int8",1,function(e){return function(t,r,n){return e(this,t,r,n)}}),Jo("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}}),Jo("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}},!0),Jo("Int16",2,function(e){return function(t,r,n){return e(this,t,r,n)}}),Jo("Uint16",2,function(e){return function(t,r,n){return e(this,t,r,n)}}),Jo("Int32",4,function(e){return function(t,r,n){return e(this,t,r,n)}}),Jo("Uint32",4,function(e){return function(t,r,n){return e(this,t,r,n)}}),Jo("Float32",4,function(e){return function(t,r,n){return e(this,t,r,n)}}),Jo("Float64",8,function(e){return function(t,r,n){return e(this,t,r,n)}});var Ko=(n.Reflect||{}).apply,$o=Function.apply;R(R.S+R.F*!a(function(){Ko(function(){})}),"Reflect",{apply:function(e,t,r){var n=w(e),i=l(r);return Ko?Ko(n,t,i):$o.call(n,t,i)}});var Qo=(n.Reflect||{}).construct,Zo=a(function(){function e(){}return!(Qo(function(){},[],e)instanceof e)}),ea=!a(function(){Qo(function(){})});R(R.S+R.F*(Zo||ea),"Reflect",{construct:function(e,t){w(e),l(t);var r=arguments.length<3?e:w(arguments[2]);if(ea&&!Zo)return Qo(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(_t.apply(e,n))}var i=r.prototype,o=pe(c(i)?i:Object.prototype),a=Function.apply.call(e,o,t);return c(a)?a:o}}),R(R.S+R.F*a(function(){Reflect.defineProperty(m.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,r){l(e),t=v(t,!0),l(r);try{return m.f(e,t,r),!0}catch(e){return!1}}});var ta=be.f;R(R.S,"Reflect",{deleteProperty:function(e,t){var r=ta(l(e),t);return!(r&&!r.configurable)&&delete e[t]}});var ra=function(e){this._t=l(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};Fr(ra,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),R(R.S,"Reflect",{enumerate:function(e){return new ra(e)}}),R(R.S,"Reflect",{get:function e(t,r){var n,i,a=arguments.length<3?t:arguments[2];return l(t)===a?t[r]:(n=be.f(t,r))?o(n,"value")?n.value:void 0!==n.get?n.get.call(a):void 0:c(i=nt(t))?e(i,r,a):void 0}}),R(R.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return be.f(l(e),t)}}),R(R.S,"Reflect",{getPrototypeOf:function(e){return nt(l(e))}}),R(R.S,"Reflect",{has:function(e,t){return t in e}});var na=Object.isExtensible;R(R.S,"Reflect",{isExtensible:function(e){return l(e),!na||na(e)}});var ia=n.Reflect,oa=ia&&ia.ownKeys||function(e){var t=ve.f(l(e)),r=ie.f;return r?t.concat(r(e)):t};R(R.S,"Reflect",{ownKeys:oa});var aa=Object.preventExtensions;R(R.S,"Reflect",{preventExtensions:function(e){l(e);try{return aa&&aa(e),!0}catch(e){return!1}}}),R(R.S,"Reflect",{set:function e(t,r,n){var i,a,s=arguments.length<4?t:arguments[3],u=be.f(l(t),r);if(!u){if(c(a=nt(t)))return e(a,r,n,s);u=y(0)}if(o(u,"value")){if(!1===u.writable||!c(s))return!1;if(i=be.f(s,r)){if(i.get||i.set||!1===i.writable)return!1;i.value=n,m.f(s,r,i)}else m.f(s,r,y(0,n));return!0}return void 0!==u.set&&(u.set.call(s,n),!0)}}),ft&&R(R.S,"Reflect",{setPrototypeOf:function(e,t){ft.check(e,t);try{return ft.set(e,t),!0}catch(e){return!1}}});var sa=K(!0);R(R.P,"Array",{includes:function(e){return sa(this,e,arguments.length>1?arguments[1]:void 0)}}),Hn("includes");var ua=P("isConcatSpreadable");var ca=function e(t,r,n,i,o,a,s,u){for(var l,f,d=o,p=0,h=!!s&&O(s,u,3);p<i;){if(p in n){if(l=h?h(n[p],p,r):n[p],f=!1,c(l)&&(f=void 0!==(f=l[ua])?!!f:ae(l)),f&&a>0)d=e(t,r,l,W(l.length),d,a-1)-1;else{if(d>=9007199254740991)throw TypeError();t[d]=l}d++}p++}return d};R(R.P,"Array",{flatMap:function(e){var t,r,n=et(this);return w(e),t=W(n.length),r=An(n,0),ca(r,n,n,t,0,1,e,arguments[1]),r}}),Hn("flatMap"),R(R.P,"Array",{flatten:function(){var e=arguments[0],t=et(this),r=W(t.length),n=An(t,0);return ca(n,t,t,r,0,void 0===e?1:z(e)),n}}),Hn("flatten");var la=xr(!0);R(R.P,"String",{at:function(e){return la(this,e)}});var fa=function(e,t,r,n){var i=String(G(e)),o=i.length,a=void 0===r?" ":String(r),s=W(t);if(s<=o||""==a)return i;var u=s-o,c=tr.call(a,Math.ceil(u/a.length));return c.length>u&&(c=c.slice(0,u)),n?c+i:i+c};R(R.P+R.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(Yi),"String",{padStart:function(e){return fa(this,e,arguments.length>1?arguments[1]:void 0,!0)}}),R(R.P+R.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(Yi),"String",{padEnd:function(e){return fa(this,e,arguments.length>1?arguments[1]:void 0,!1)}}),Ct("trimLeft",function(e){return function(){return e(this,1)}},"trimStart"),Ct("trimRight",function(e){return function(){return e(this,2)}},"trimEnd");var da=RegExp.prototype,pa=function(e,t){this._r=e,this._s=t};Fr(pa,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),R(R.P,"String",{matchAll:function(e){if(G(this),!Yr(e))throw TypeError(e+" is not a regexp!");var t=String(this),r="flags"in da?String(e.flags):ti.call(e),n=new RegExp(e.source,~r.indexOf("g")?r:"g"+r);return n.lastIndex=W(e.lastIndex),new pa(n,t)}}),x("asyncIterator"),x("observable"),R(R.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=q(e),i=be.f,o=oa(n),a={},s=0;o.length>s;)void 0!==(r=i(n,t=o[s++]))&&gn(a,t,r);return a}});var ha=oe.f,va=function(e){return function(t){for(var r,n=q(t),i=ne(n),o=i.length,a=0,s=[];o>a;)ha.call(n,r=i[a++])&&s.push(e?[r,n[r]]:n[r]);return s}},ga=va(!1);R(R.S,"Object",{values:function(e){return ga(e)}});var ma=va(!0);R(R.S,"Object",{entries:function(e){return ma(e)}});var ya=!a(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete n[e]});s&&R(R.P+ya,"Object",{__defineGetter__:function(e,t){m.f(et(this),e,{get:w(t),enumerable:!0,configurable:!0})}}),s&&R(R.P+ya,"Object",{__defineSetter__:function(e,t){m.f(et(this),e,{set:w(t),enumerable:!0,configurable:!0})}});var _a=be.f;s&&R(R.P+ya,"Object",{__lookupGetter__:function(e){var t,r=et(this),n=v(e,!0);do{if(t=_a(r,n))return t.get}while(r=nt(r))}});var Ea=be.f;s&&R(R.P+ya,"Object",{__lookupSetter__:function(e){var t,r=et(this),n=v(e,!0);do{if(t=Ea(r,n))return t.set}while(r=nt(r))}});var ba=function(e,t){var r=[];return Ei(e,!1,r.push,r,t),r},Sa=function(e){return function(){if(ht(this)!=e)throw TypeError(e+"#toJSON isn't generic");return ba(this)}};R(R.P+R.R,"Map",{toJSON:Sa("Map")}),R(R.P+R.R,"Set",{toJSON:Sa("Set")});var Ta=function(e){R(R.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})};Ta("Map"),Ta("Set"),Ta("WeakMap"),Ta("WeakSet");var wa=function(e){R(R.S,e,{from:function(e){var t,r,n,i,o=arguments[1];return w(this),(t=void 0!==o)&&w(o),null==e?new this:(r=[],t?(n=0,i=O(o,arguments[2],2),Ei(e,!1,function(e){r.push(i(e,n++))})):Ei(e,!1,r.push,r),new this(r))}})};wa("Map"),wa("Set"),wa("WeakMap"),wa("WeakSet"),R(R.G,{global:n}),R(R.S,"System",{global:n}),R(R.S,"Error",{isError:function(e){return"Error"===U(e)}}),R(R.S,"Math",{clamp:function(e,t,r){return Math.min(r,Math.max(t,e))}}),R(R.S,"Math",{DEG_PER_RAD:Math.PI/180});var Oa=180/Math.PI;R(R.S,"Math",{degrees:function(e){return e*Oa}});var ka=Math.scale||function(e,t,r,n,i){return 0===arguments.length||e!=e||t!=t||r!=r||n!=n||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-n)/(r-t)+n};R(R.S,"Math",{fscale:function(e,t,r,n,i){return Ir(ka(e,t,r,n,i))}}),R(R.S,"Math",{iaddh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)+(n>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}}),R(R.S,"Math",{isubh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)-(n>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}}),R(R.S,"Math",{imulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>16,s=n>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>16)+((i*s>>>0)+(65535&u)>>16)}}),R(R.S,"Math",{RAD_PER_DEG:180/Math.PI});var Ra=Math.PI/180;R(R.S,"Math",{radians:function(e){return e*Ra}}),R(R.S,"Math",{scale:ka}),R(R.S,"Math",{umulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>>16,s=n>>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>>16)+((i*s>>>0)+(65535&u)>>>16)}}),R(R.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}}),R(R.P+R.R,"Promise",{finally:function(e){var t=Si(this,u.Promise||n.Promise),r="function"==typeof e;return this.then(r?function(r){return Xi(t,e()).then(function(){return r})}:e,r?function(r){return Xi(t,e()).then(function(){throw r})}:e)}}),R(R.S,"Promise",{try:function(e){var t=zi.f(this),r=Hi(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}});var Aa=I("metadata"),Ia=Aa.store||(Aa.store=new Mo),Pa=function(e,t,r){var n=Ia.get(e);if(!n){if(!r)return;Ia.set(e,n=new So)}var i=n.get(t);if(!i){if(!r)return;n.set(t,i=new So)}return i},Ca={store:Ia,map:Pa,has:function(e,t,r){var n=Pa(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=Pa(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){Pa(r,n,!0).set(e,t)},keys:function(e,t){var r=Pa(e,t,!1),n=[];return r&&r.forEach(function(e,t){n.push(t)}),n},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){R(R.S,"Reflect",e)}},Ma=Ca.key,Na=Ca.set;Ca.exp({defineMetadata:function(e,t,r,n){Na(e,t,l(r),Ma(n))}});var Da=Ca.key,ja=Ca.map,xa=Ca.store;Ca.exp({deleteMetadata:function(e,t){var r=arguments.length<3?void 0:Da(arguments[2]),n=ja(l(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var i=xa.get(t);return i.delete(r),!!i.size||xa.delete(t)}});var La=Ca.has,Ua=Ca.get,Fa=Ca.key,Ga=function(e,t,r){if(La(e,t,r))return Ua(e,t,r);var n=nt(t);return null!==n?Ga(e,n,r):void 0};Ca.exp({getMetadata:function(e,t){return Ga(e,l(t),arguments.length<3?void 0:Fa(arguments[2]))}});var qa=Ca.keys,Va=Ca.key,Ba=function(e,t){var r=qa(e,t),n=nt(e);if(null===n)return r;var i=Ba(n,t);return i.length?r.length?ba(new To(r.concat(i))):i:r};Ca.exp({getMetadataKeys:function(e){return Ba(l(e),arguments.length<2?void 0:Va(arguments[1]))}});var za=Ca.get,Ha=Ca.key;Ca.exp({getOwnMetadata:function(e,t){return za(e,l(t),arguments.length<3?void 0:Ha(arguments[2]))}});var Wa=Ca.keys,Ya=Ca.key;Ca.exp({getOwnMetadataKeys:function(e){return Wa(l(e),arguments.length<2?void 0:Ya(arguments[1]))}});var Xa=Ca.has,Ja=Ca.key,Ka=function(e,t,r){if(Xa(e,t,r))return!0;var n=nt(t);return null!==n&&Ka(e,n,r)};Ca.exp({hasMetadata:function(e,t){return Ka(e,l(t),arguments.length<3?void 0:Ja(arguments[2]))}});var $a=Ca.has,Qa=Ca.key;Ca.exp({hasOwnMetadata:function(e,t){return $a(e,l(t),arguments.length<3?void 0:Qa(arguments[2]))}});var Za=Ca.key,es=Ca.set;Ca.exp({metadata:function(e,t){return function(r,n){es(e,t,(void 0!==n?l:w)(r),Za(n))}}});var ts=Ui(),rs=n.process,ns="process"==U(rs);R(R.G,{asap:function(e){var t=ns&&rs.domain;ts(t?t.bind(e):e)}});var is=Ui(),os=P("observable"),as=Ei.RETURN,ss=function(e){return null==e?void 0:w(e)},us=function(e){var t=e._c;t&&(e._c=void 0,t())},cs=function(e){return void 0===e._o},ls=function(e){cs(e)||(e._o=void 0,us(e))},fs=function(e,t){l(e),this._c=void 0,this._o=e,e=new ds(this);try{var r=t(e),n=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){n.unsubscribe()}:w(r),this._c=r)}catch(t){return void e.error(t)}cs(this)&&us(this)};fs.prototype=Ji({},{unsubscribe:function(){ls(this)}});var ds=function(e){this._s=e};ds.prototype=Ji({},{next:function(e){var t=this._s;if(!cs(t)){var r=t._o;try{var n=ss(r.next);if(n)return n.call(r,e)}catch(e){try{ls(t)}finally{throw e}}}},error:function(e){var t=this._s;if(cs(t))throw e;var r=t._o;t._o=void 0;try{var n=ss(r.error);if(!n)throw e;e=n.call(r,e)}catch(e){try{us(t)}finally{throw e}}return us(t),e},complete:function(e){var t=this._s;if(!cs(t)){var r=t._o;t._o=void 0;try{var n=ss(r.complete);e=n?n.call(r,e):void 0}catch(e){try{us(t)}finally{throw e}}return us(t),e}}});var ps=function(e){_i(this,ps,"Observable","_f")._f=w(e)};Ji(ps.prototype,{subscribe:function(e){return new fs(e,this._f)},forEach:function(e){var t=this;return new(u.Promise||n.Promise)(function(r,n){w(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:r})})}}),Ji(ps,{from:function(e){var t="function"==typeof this?this:ps,r=ss(l(e)[os]);if(r){var n=l(r.call(e));return n.constructor===t?n:new t(function(e){return n.subscribe(e)})}return new t(function(t){var r=!1;return is(function(){if(!r){try{if(Ei(e,!1,function(e){if(t.next(e),r)return as})===as)return}catch(e){if(r)throw e;return void t.error(e)}t.complete()}}),function(){r=!0}})},of:function(){for(var e=0,t=arguments.length,r=new Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:ps)(function(e){var t=!1;return is(function(){if(!t){for(var n=0;n<r.length;++n)if(e.next(r[n]),t)return;e.complete()}}),function(){t=!0}})}}),_(ps.prototype,os,function(){return this}),R(R.G,{Observable:ps}),Qn("Observable");var hs=[].slice,vs=/MSIE .\./.test(Yi),gs=function(e){return function(t,r){var n=arguments.length>2,i=!!n&&hs.call(arguments,2);return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,r)}};R(R.G+R.B+R.F*vs,{setTimeout:gs(n.setTimeout),setInterval:gs(n.setInterval)}),R(R.G+R.B,{setImmediate:Mi.set,clearImmediate:Mi.clear});for(var ms=P("iterator"),ys=P("toStringTag"),_s=Lr.Array,Es={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},bs=ne(Es),Ss=0;Ss<bs.length;Ss++){var Ts,ws=bs[Ss],Os=Es[ws],ks=n[ws],Rs=ks&&ks.prototype;if(Rs&&(Rs[ms]||_(Rs,ms,_s),Rs[ys]||_(Rs,ys,ws),Lr[ws]=_s,Os))for(Ts in ei)Rs[Ts]||T(Rs,Ts,ei[Ts],!0)}r(function(t){!function(e){var r,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",c=e.regeneratorRuntime;if(c)t.exports=c;else{(c=e.regeneratorRuntime=t.exports).wrap=_;var l="suspendedStart",f="suspendedYield",d="executing",p="completed",h={},v={};v[a]=function(){return this};var g=Object.getPrototypeOf,m=g&&g(g(P([])));m&&m!==n&&i.call(m,a)&&(v=m);var y=T.prototype=b.prototype=Object.create(v);S.prototype=y.constructor=T,T.constructor=S,T[u]=S.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,T):(e.__proto__=T,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(y),e},c.awrap=function(e){return{__await:e}},w(O.prototype),O.prototype[s]=function(){return this},c.AsyncIterator=O,c.async=function(e,t,r,n){var i=new O(_(e,t,r,n));return c.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},w(y),y[u]="Generator",y[a]=function(){return this},y.toString=function(){return"[object Generator]"},c.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},c.values=P,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return s.type="throw",s.arg=e,t.next=n,i&&(t.method="next",t.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;A(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),h}}}function _(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,o=Object.create(i.prototype),a=new I(n||[]);return o._invoke=function(e,t,r){var n=l;return function(i,o){if(n===d)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw o;return C()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=k(a,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var u=E(e,t,r);if("normal"===u.type){if(n=r.done?p:f,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=p,r.method="throw",r.arg=u.arg)}}}(e,r,a),o}function E(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function b(){}function S(){}function T(){}function w(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function O(t){function r(e,n,o,a){var s=E(t[e],t,n);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(e){r("next",e,o,a)},function(e){r("throw",e,o,a)}):Promise.resolve(c).then(function(e){u.value=e,o(u)},a)}a(s.arg)}var n;"object"==typeof e.process&&e.process.domain&&(r=e.process.domain.bind(r)),this._invoke=function(e,t){function i(){return new Promise(function(n,i){r(e,t,n,i)})}return n=n?n.then(i,i):i()}}function k(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,k(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=E(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function P(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return o.next=o}}return{next:C}}function C(){return{value:r,done:!0}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:e)});var As=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,r)}}(/[\\^$*+?.()|[\]{}]/g,"\\$&");R(R.S,"RegExp",{escape:function(e){return As(e)}});u.RegExp.escape;if(e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var Is="defineProperty";function Ps(e,t,r){e[t]||Object[Is](e,t,{writable:!0,configurable:!0,value:r})}Ps(String.prototype,"padLeft","".padStart),Ps(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&Ps(Array,e,Function.call.bind([][e]))});var Cs="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function Ms(){throw new Error("setTimeout has not been defined")}function Ns(){throw new Error("clearTimeout has not been defined")}var Ds=Ms,js=Ns;function xs(e){if(Ds===setTimeout)return setTimeout(e,0);if((Ds===Ms||!Ds)&&setTimeout)return Ds=setTimeout,setTimeout(e,0);try{return Ds(e,0)}catch(t){try{return Ds.call(null,e,0)}catch(t){return Ds.call(this,e,0)}}}"function"==typeof Cs.setTimeout&&(Ds=setTimeout),"function"==typeof Cs.clearTimeout&&(js=clearTimeout);var Ls,Us=[],Fs=!1,Gs=-1;function qs(){Fs&&Ls&&(Fs=!1,Ls.length?Us=Ls.concat(Us):Gs=-1,Us.length&&Vs())}function Vs(){if(!Fs){var e=xs(qs);Fs=!0;for(var t=Us.length;t;){for(Ls=Us,Us=[];++Gs<t;)Ls&&Ls[Gs].run();Gs=-1,t=Us.length}Ls=null,Fs=!1,function(e){if(js===clearTimeout)return clearTimeout(e);if((js===Ns||!js)&&clearTimeout)return js=clearTimeout,clearTimeout(e);try{js(e)}catch(t){try{return js.call(null,e)}catch(t){return js.call(this,e)}}}(e)}}function Bs(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];Us.push(new zs(e,t)),1!==Us.length||Fs||xs(Vs)}function zs(e,t){this.fun=e,this.array=t}zs.prototype.run=function(){this.fun.apply(null,this.array)};function Hs(){}var Ws=Hs,Ys=Hs,Xs=Hs,Js=Hs,Ks=Hs,$s=Hs,Qs=Hs;var Zs=Cs.performance||{},eu=Zs.now||Zs.mozNow||Zs.msNow||Zs.oNow||Zs.webkitNow||function(){return(new Date).getTime()};var tu=new Date;var ru={nextTick:Bs,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:Ws,addListener:Ys,once:Xs,off:Js,removeListener:Ks,removeAllListeners:$s,emit:Qs,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*eu.call(Zs),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-tu)/1e3}},nu={}.toString,iu=function(e){return nu.call(e).slice(8,-1)},ou=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==iu(e)?e.split(""):Object(e)},au=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},su=function(e){return ou(au(e))},uu={f:{}.propertyIsEnumerable},cu=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},lu=function(e){return"object"==typeof e?null!==e:"function"==typeof e},fu=function(e,t){if(!lu(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!lu(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!lu(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!lu(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},du={}.hasOwnProperty,pu=function(e,t){return du.call(e,t)},hu=function(e){try{return!!e()}catch(e){return!0}},vu=!hu(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),gu=r(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),mu=gu.document,yu=lu(mu)&&lu(mu.createElement),_u=function(e){return yu?mu.createElement(e):{}},Eu=!vu&&!hu(function(){return 7!=Object.defineProperty(_u("div"),"a",{get:function(){return 7}}).a}),bu=Object.getOwnPropertyDescriptor,Su={f:vu?bu:function(e,t){if(e=su(e),t=fu(t,!0),Eu)try{return bu(e,t)}catch(e){}if(pu(e,t))return cu(!uu.f.call(e,t),e[t])}},Tu=r(function(e){var t=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=t)}),wu=(Tu.version,function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}),Ou=function(e,t,r){if(wu(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}},ku=function(e){if(!lu(e))throw TypeError(e+" is not an object!");return e},Ru=Object.defineProperty,Au={f:vu?Object.defineProperty:function(e,t,r){if(ku(e),t=fu(t,!0),ku(r),Eu)try{return Ru(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},Iu=vu?function(e,t,r){return Au.f(e,t,cu(1,r))}:function(e,t,r){return e[t]=r,e},Pu=function(e,t,r){var n,i,o,a=e&Pu.F,s=e&Pu.G,u=e&Pu.S,c=e&Pu.P,l=e&Pu.B,f=e&Pu.W,d=s?Tu:Tu[t]||(Tu[t]={}),p=d.prototype,h=s?gu:u?gu[t]:(gu[t]||{}).prototype;for(n in s&&(r=t),r)(i=!a&&h&&void 0!==h[n])&&pu(d,n)||(o=i?h[n]:r[n],d[n]=s&&"function"!=typeof h[n]?r[n]:l&&i?Ou(o,gu):f&&h[n]==o?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(o):c&&"function"==typeof o?Ou(Function.call,o):o,c&&((d.virtual||(d.virtual={}))[n]=o,e&Pu.R&&p&&!p[n]&&Iu(p,n,o)))};Pu.F=1,Pu.G=2,Pu.S=4,Pu.P=8,Pu.B=16,Pu.W=32,Pu.U=64,Pu.R=128;var Cu=Pu,Mu=function(e,t){var r=(Tu.Object||{})[e]||Object[e],n={};n[e]=t(r),Cu(Cu.S+Cu.F*hu(function(){r(1)}),"Object",n)},Nu=Su.f;Mu("getOwnPropertyDescriptor",function(){return function(e,t){return Nu(su(e),t)}});var Du=Tu.Object,ju=function(e,t){return Du.getOwnPropertyDescriptor(e,t)},xu=r(function(e){e.exports={default:ju,__esModule:!0}});t(xu);var Lu=Su.f;Cu(Cu.S,"Reflect",{deleteProperty:function(e,t){var r=Lu(ku(e),t);return!(r&&!r.configurable)&&delete e[t]}});var Uu=Tu.Reflect.deleteProperty,Fu=r(function(e){e.exports={default:Uu,__esModule:!0}});t(Fu);var Gu,qu=Math.ceil,Vu=Math.floor,Bu=function(e){return isNaN(e=+e)?0:(e>0?Vu:qu)(e)},zu=Iu,Hu={},Wu=Math.min,Yu=function(e){return e>0?Wu(Bu(e),9007199254740991):0},Xu=Math.max,Ju=Math.min,Ku=r(function(e){var t=gu["__core-js_shared__"]||(gu["__core-js_shared__"]={});(e.exports=function(e,r){return t[e]||(t[e]=void 0!==r?r:{})})("versions",[]).push({version:Tu.version,mode:"pure",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})}),$u=0,Qu=Math.random(),Zu=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++$u+Qu).toString(36))},ec=Ku("keys"),tc=function(e){return ec[e]||(ec[e]=Zu(e))},rc=(Gu=!1,function(e,t,r){var n,i=su(e),o=Yu(i.length),a=function(e,t){return(e=Bu(e))<0?Xu(e+t,0):Ju(e,t)}(r,o);if(Gu&&t!=t){for(;o>a;)if((n=i[a++])!=n)return!0}else for(;o>a;a++)if((Gu||a in i)&&i[a]===t)return Gu||a||0;return!Gu&&-1}),nc=tc("IE_PROTO"),ic=function(e,t){var r,n=su(e),i=0,o=[];for(r in n)r!=nc&&pu(n,r)&&o.push(r);for(;t.length>i;)pu(n,r=t[i++])&&(~rc(o,r)||o.push(r));return o},oc="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ac=Object.keys||function(e){return ic(e,oc)},sc=vu?Object.defineProperties:function(e,t){ku(e);for(var r,n=ac(t),i=n.length,o=0;i>o;)Au.f(e,r=n[o++],t[r]);return e},uc=gu.document,cc=uc&&uc.documentElement,lc=tc("IE_PROTO"),fc=function(){},dc=function(){var e,t=_u("iframe"),r=oc.length;for(t.style.display="none",cc.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),dc=e.F;r--;)delete dc.prototype[oc[r]];return dc()},pc=Object.create||function(e,t){var r;return null!==e?(fc.prototype=ku(e),r=new fc,fc.prototype=null,r[lc]=e):r=dc(),void 0===t?r:sc(r,t)},hc=r(function(e){var t=Ku("wks"),r=gu.Symbol,n="function"==typeof r;(e.exports=function(e){return t[e]||(t[e]=n&&r[e]||(n?r:Zu)("Symbol."+e))}).store=t}),vc=Au.f,gc=hc("toStringTag"),mc=function(e,t,r){e&&!pu(e=r?e:e.prototype,gc)&&vc(e,gc,{configurable:!0,value:t})},yc={};Iu(yc,hc("iterator"),function(){return this});var _c=function(e){return Object(au(e))},Ec=tc("IE_PROTO"),bc=Object.prototype,Sc=Object.getPrototypeOf||function(e){return e=_c(e),pu(e,Ec)?e[Ec]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?bc:null},Tc=hc("iterator"),wc=!([].keys&&"next"in[].keys()),Oc=function(){return this},kc=function(e,t,r,n,i,o,a){!function(e,t,r){e.prototype=pc(yc,{next:cu(1,r)}),mc(e,t+" Iterator")}(r,t,n);var s,u,c,l=function(e){if(!wc&&e in h)return h[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},f=t+" Iterator",d="values"==i,p=!1,h=e.prototype,v=h[Tc]||h["@@iterator"]||i&&h[i],g=v||l(i),m=i?d?l("entries"):g:void 0,y="Array"==t&&h.entries||v;if(y&&(c=Sc(y.call(new e)))!==Object.prototype&&c.next&&mc(c,f,!0),d&&v&&"values"!==v.name&&(p=!0,g=function(){return v.call(this)}),a&&(wc||p||!h[Tc])&&Iu(h,Tc,g),Hu[t]=g,Hu[f]=Oc,i)if(s={values:d?g:l("values"),keys:o?g:l("keys"),entries:m},a)for(u in s)u in h||zu(h,u,s[u]);else Cu(Cu.P+Cu.F*(wc||p),t,s);return s},Rc=function(e){return function(t,r){var n,i,o=String(au(t)),a=Bu(r),s=o.length;return a<0||a>=s?e?"":void 0:(n=o.charCodeAt(a))<55296||n>56319||a+1===s||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):n:e?o.slice(a,a+2):i-56320+(n-55296<<10)+65536}}(!0);kc(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=Rc(t,r),this._i+=e.length,{value:e,done:!1})});var Ac=function(e,t){return{value:t,done:!!e}};kc(Array,"Array",function(e,t){this._t=su(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,Ac(1)):Ac(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values");Hu.Arguments=Hu.Array;for(var Ic=hc("toStringTag"),Pc="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Cc=0;Cc<Pc.length;Cc++){var Mc=Pc[Cc],Nc=gu[Mc],Dc=Nc&&Nc.prototype;Dc&&!Dc[Ic]&&Iu(Dc,Ic,Mc),Hu[Mc]=Hu.Array}var jc,xc,Lc,Uc=hc("toStringTag"),Fc="Arguments"==iu(function(){return arguments}()),Gc=function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Uc))?r:Fc?iu(t):"Object"==(n=iu(t))&&"function"==typeof t.callee?"Arguments":n},qc=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e},Vc=function(e,t,r,n){try{return n?t(ku(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&ku(i.call(e)),t}},Bc=hc("iterator"),zc=Array.prototype,Hc=function(e){return void 0!==e&&(Hu.Array===e||zc[Bc]===e)},Wc=hc("iterator"),Yc=Tu.getIteratorMethod=function(e){if(null!=e)return e[Wc]||e["@@iterator"]||Hu[Gc(e)]},Xc=r(function(e){var t={},r={},n=e.exports=function(e,n,i,o,a){var s,u,c,l,f=a?function(){return e}:Yc(e),d=Ou(i,o,n?2:1),p=0;if("function"!=typeof f)throw TypeError(e+" is not iterable!");if(Hc(f)){for(s=Yu(e.length);s>p;p++)if((l=n?d(ku(u=e[p])[0],u[1]):d(e[p]))===t||l===r)return l}else for(c=f.call(e);!(u=c.next()).done;)if((l=Vc(c,d,u.value,n))===t||l===r)return l};n.BREAK=t,n.RETURN=r}),Jc=hc("species"),Kc=function(e,t){var r,n=ku(e).constructor;return void 0===n||null==(r=ku(n)[Jc])?t:wu(r)},$c=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)},Qc=gu.process,Zc=gu.setImmediate,el=gu.clearImmediate,tl=gu.MessageChannel,rl=gu.Dispatch,nl=0,il={},ol=function(){var e=+this;if(il.hasOwnProperty(e)){var t=il[e];delete il[e],t()}},al=function(e){ol.call(e.data)};Zc&&el||(Zc=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return il[++nl]=function(){$c("function"==typeof e?e:Function(e),t)},jc(nl),nl},el=function(e){delete il[e]},"process"==iu(Qc)?jc=function(e){Qc.nextTick(Ou(ol,e,1))}:rl&&rl.now?jc=function(e){rl.now(Ou(ol,e,1))}:tl?(Lc=(xc=new tl).port2,xc.port1.onmessage=al,jc=Ou(Lc.postMessage,Lc,1)):gu.addEventListener&&"function"==typeof postMessage&&!gu.importScripts?(jc=function(e){gu.postMessage(e+"","*")},gu.addEventListener("message",al,!1)):jc="onreadystatechange"in _u("script")?function(e){cc.appendChild(_u("script")).onreadystatechange=function(){cc.removeChild(this),ol.call(e)}}:function(e){setTimeout(Ou(ol,e,1),0)});var sl={set:Zc,clear:el},ul=sl.set,cl=gu.MutationObserver||gu.WebKitMutationObserver,ll=gu.process,fl=gu.Promise,dl="process"==iu(ll);function pl(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=wu(t),this.reject=wu(r)}var hl={f:function(e){return new pl(e)}},vl=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},gl=gu.navigator,ml=gl&&gl.userAgent||"",yl=function(e,t){if(ku(e),lu(t)&&t.constructor===e)return t;var r=hl.f(e);return(0,r.resolve)(t),r.promise},_l=function(e,t,r){for(var n in t)r&&e[n]?e[n]=t[n]:Iu(e,n,t[n]);return e},El=hc("species"),bl=function(e){var t="function"==typeof Tu[e]?Tu[e]:gu[e];vu&&t&&!t[El]&&Au.f(t,El,{configurable:!0,get:function(){return this}})},Sl=hc("iterator"),Tl=!1;try{[7][Sl]().return=function(){Tl=!0}}catch(e){}var wl,Ol,kl,Rl,Al=function(e,t){if(!t&&!Tl)return!1;var r=!1;try{var n=[7],i=n[Sl]();i.next=function(){return{done:r=!0}},n[Sl]=function(){return i},e(n)}catch(e){}return r},Il=sl.set,Pl=function(){var e,t,r,n=function(){var n,i;for(dl&&(n=ll.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(dl)r=function(){ll.nextTick(n)};else if(!cl||gu.navigator&&gu.navigator.standalone)if(fl&&fl.resolve){var i=fl.resolve(void 0);r=function(){i.then(n)}}else r=function(){ul.call(gu,n)};else{var o=!0,a=document.createTextNode("");new cl(n).observe(a,{characterData:!0}),r=function(){a.data=o=!o}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}(),Cl=gu.TypeError,Ml=gu.process,Nl=Ml&&Ml.versions,Dl=Nl&&Nl.v8||"",jl=gu.Promise,xl="process"==Gc(Ml),Ll=function(){},Ul=Ol=hl.f,Fl=!!function(){try{var e=jl.resolve(1),t=(e.constructor={})[hc("species")]=function(e){e(Ll,Ll)};return(xl||"function"==typeof PromiseRejectionEvent)&&e.then(Ll)instanceof t&&0!==Dl.indexOf("6.6")&&-1===ml.indexOf("Chrome/66")}catch(e){}}(),Gl=function(e){var t;return!(!lu(e)||"function"!=typeof(t=e.then))&&t},ql=function(e,t){if(!e._n){e._n=!0;var r=e._c;Pl(function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(i||(2==e._h&&zl(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?c(Cl("Promise-chain cycle")):(o=Gl(r))?o.call(r,u,c):u(r)):c(n)}catch(e){l&&!a&&l.exit(),c(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&Vl(e)})}},Vl=function(e){Il.call(gu,function(){var t,r,n,i=e._v,o=Bl(e);if(o&&(t=vl(function(){xl?Ml.emit("unhandledRejection",i,e):(r=gu.onunhandledrejection)?r({promise:e,reason:i}):(n=gu.console)&&n.error&&n.error("Unhandled promise rejection",i)}),e._h=xl||Bl(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},Bl=function(e){return 1!==e._h&&0===(e._a||e._c).length},zl=function(e){Il.call(gu,function(){var t;xl?Ml.emit("rejectionHandled",e):(t=gu.onrejectionhandled)&&t({promise:e,reason:e._v})})},Hl=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),ql(t,!0))},Wl=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw Cl("Promise can't be resolved itself");(t=Gl(e))?Pl(function(){var n={_w:r,_d:!1};try{t.call(e,Ou(Wl,n,1),Ou(Hl,n,1))}catch(e){Hl.call(n,e)}}):(r._v=e,r._s=1,ql(r,!1))}catch(e){Hl.call({_w:r,_d:!1},e)}}};Fl||(jl=function(e){qc(this,jl,"Promise","_h"),wu(e),wl.call(this);try{e(Ou(Wl,this,1),Ou(Hl,this,1))}catch(e){Hl.call(this,e)}},(wl=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=_l(jl.prototype,{then:function(e,t){var r=Ul(Kc(this,jl));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=xl?Ml.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&ql(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),kl=function(){var e=new wl;this.promise=e,this.resolve=Ou(Wl,e,1),this.reject=Ou(Hl,e,1)},hl.f=Ul=function(e){return e===jl||e===Rl?new kl(e):Ol(e)}),Cu(Cu.G+Cu.W+Cu.F*!Fl,{Promise:jl}),mc(jl,"Promise"),bl("Promise"),Rl=Tu.Promise,Cu(Cu.S+Cu.F*!Fl,"Promise",{reject:function(e){var t=Ul(this);return(0,t.reject)(e),t.promise}}),Cu(Cu.S+!0*Cu.F,"Promise",{resolve:function(e){return yl(this===Rl?jl:this,e)}}),Cu(Cu.S+Cu.F*!(Fl&&Al(function(e){jl.all(e).catch(Ll)})),"Promise",{all:function(e){var t=this,r=Ul(t),n=r.resolve,i=r.reject,o=vl(function(){var r=[],o=0,a=1;Xc(e,!1,function(e){var s=o++,u=!1;r.push(void 0),a++,t.resolve(e).then(function(e){u||(u=!0,r[s]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=Ul(t),n=r.reject,i=vl(function(){Xc(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}}),Cu(Cu.P+Cu.R,"Promise",{finally:function(e){var t=Kc(this,Tu.Promise||gu.Promise),r="function"==typeof e;return this.then(r?function(r){return yl(t,e()).then(function(){return r})}:e,r?function(r){return yl(t,e()).then(function(){throw r})}:e)}}),Cu(Cu.S,"Promise",{try:function(e){var t=hl.f(this),r=vl(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}});var Yl=Tu.Promise,Xl=r(function(e){e.exports={default:Yl,__esModule:!0}});t(Xl);var Jl={f:Object.getOwnPropertySymbols},Kl=Object.assign,$l=!Kl||hu(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=Kl({},e)[r]||Object.keys(Kl({},t)).join("")!=n})?function(e,t){for(var r=_c(e),n=arguments.length,i=1,o=Jl.f,a=uu.f;n>i;)for(var s,u=ou(arguments[i++]),c=o?ac(u).concat(o(u)):ac(u),l=c.length,f=0;l>f;)a.call(u,s=c[f++])&&(r[s]=u[s]);return r}:Kl;Cu(Cu.S+Cu.F,"Object",{assign:$l});var Ql=Tu.Object.assign,Zl=r(function(e){e.exports={default:Ql,__esModule:!0}});t(Zl);var ef=(gu.Reflect||{}).apply,tf=Function.apply;Cu(Cu.S+Cu.F*!hu(function(){ef(function(){})}),"Reflect",{apply:function(e,t,r){var n=wu(e),i=ku(r);return ef?ef(n,t,i):tf.call(n,t,i)}});var rf=Tu.Reflect.apply,nf=r(function(e){e.exports={default:rf,__esModule:!0}});t(nf);var of=Tu.JSON||(Tu.JSON={stringify:JSON.stringify}),af=function(e){return of.stringify.apply(of,arguments)},sf=r(function(e){e.exports={default:af,__esModule:!0}});t(sf);var uf=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i};var cf=function(){this.__data__=[],this.size=0};var lf=function(e,t){return e===t||e!=e&&t!=t};var ff=function(e,t){for(var r=e.length;r--;)if(lf(e[r][0],t))return r;return-1},df=Array.prototype.splice;var pf=function(e){var t=this.__data__,r=ff(t,e);return!(r<0||(r==t.length-1?t.pop():df.call(t,r,1),--this.size,0))};var hf=function(e){var t=this.__data__,r=ff(t,e);return r<0?void 0:t[r][1]};var vf=function(e){return ff(this.__data__,e)>-1};var gf=function(e,t){var r=this.__data__,n=ff(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function mf(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}mf.prototype.clear=cf,mf.prototype.delete=pf,mf.prototype.get=hf,mf.prototype.has=vf,mf.prototype.set=gf;var yf=mf;var _f=function(){this.__data__=new yf,this.size=0};var Ef=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var bf=function(e){return this.__data__.get(e)};var Sf=function(e){return this.__data__.has(e)},Tf="object"==typeof e&&e&&e.Object===Object&&e,wf="object"==typeof self&&self&&self.Object===Object&&self,Of=Tf||wf||Function("return this")(),kf=Of.Symbol,Rf=Object.prototype,Af=Rf.hasOwnProperty,If=Rf.toString,Pf=kf?kf.toStringTag:void 0;var Cf=function(e){var t=Af.call(e,Pf),r=e[Pf];try{e[Pf]=void 0}catch(e){}var n=If.call(e);return t?e[Pf]=r:delete e[Pf],n},Mf=Object.prototype.toString;var Nf=function(e){return Mf.call(e)},Df="[object Null]",jf="[object Undefined]",xf=kf?kf.toStringTag:void 0;var Lf=function(e){return null==e?void 0===e?jf:Df:xf&&xf in Object(e)?Cf(e):Nf(e)};var Uf=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Ff="[object AsyncFunction]",Gf="[object Function]",qf="[object GeneratorFunction]",Vf="[object Proxy]";var Bf,zf=function(e){if(!Uf(e))return!1;var t=Lf(e);return t==Gf||t==qf||t==Ff||t==Vf},Hf=Of["__core-js_shared__"],Wf=(Bf=/[^.]+$/.exec(Hf&&Hf.keys&&Hf.keys.IE_PROTO||""))?"Symbol(src)_1."+Bf:"";var Yf=function(e){return!!Wf&&Wf in e},Xf=Function.prototype.toString;var Jf=function(e){if(null!=e){try{return Xf.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Kf=/^\[object .+?Constructor\]$/,$f=Function.prototype,Qf=Object.prototype,Zf=$f.toString,ed=Qf.hasOwnProperty,td=RegExp("^"+Zf.call(ed).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var rd=function(e){return!(!Uf(e)||Yf(e))&&(zf(e)?td:Kf).test(Jf(e))};var nd=function(e,t){return null==e?void 0:e[t]};var id=function(e,t){var r=nd(e,t);return rd(r)?r:void 0},od=id(Of,"Map"),ad=id(Object,"create");var sd=function(){this.__data__=ad?ad(null):{},this.size=0};var ud=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},cd="__lodash_hash_undefined__",ld=Object.prototype.hasOwnProperty;var fd=function(e){var t=this.__data__;if(ad){var r=t[e];return r===cd?void 0:r}return ld.call(t,e)?t[e]:void 0},dd=Object.prototype.hasOwnProperty;var pd=function(e){var t=this.__data__;return ad?void 0!==t[e]:dd.call(t,e)},hd="__lodash_hash_undefined__";var vd=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ad&&void 0===t?hd:t,this};function gd(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}gd.prototype.clear=sd,gd.prototype.delete=ud,gd.prototype.get=fd,gd.prototype.has=pd,gd.prototype.set=vd;var md=gd;var yd=function(){this.size=0,this.__data__={hash:new md,map:new(od||yf),string:new md}};var _d=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Ed=function(e,t){var r=e.__data__;return _d(t)?r["string"==typeof t?"string":"hash"]:r.map};var bd=function(e){var t=Ed(this,e).delete(e);return this.size-=t?1:0,t};var Sd=function(e){return Ed(this,e).get(e)};var Td=function(e){return Ed(this,e).has(e)};var wd=function(e,t){var r=Ed(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Od(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Od.prototype.clear=yd,Od.prototype.delete=bd,Od.prototype.get=Sd,Od.prototype.has=Td,Od.prototype.set=wd;var kd=Od,Rd=200;var Ad=function(e,t){var r=this.__data__;if(r instanceof yf){var n=r.__data__;if(!od||n.length<Rd-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new kd(n)}return r.set(e,t),this.size=r.size,this};function Id(e){var t=this.__data__=new yf(e);this.size=t.size}Id.prototype.clear=_f,Id.prototype.delete=Ef,Id.prototype.get=bf,Id.prototype.has=Sf,Id.prototype.set=Ad;var Pd=Id;var Cd=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},Md=function(){try{var e=id(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Nd=function(e,t,r){"__proto__"==t&&Md?Md(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},Dd=Object.prototype.hasOwnProperty;var jd=function(e,t,r){var n=e[t];Dd.call(e,t)&&lf(n,r)&&(void 0!==r||t in e)||Nd(e,t,r)};var xd=function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,a=t.length;++o<a;){var s=t[o],u=n?n(r[s],e[s],s,r,e):void 0;void 0===u&&(u=e[s]),i?Nd(r,s,u):jd(r,s,u)}return r};var Ld=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var Ud=function(e){return null!=e&&"object"==typeof e},Fd="[object Arguments]";var Gd=function(e){return Ud(e)&&Lf(e)==Fd},qd=Object.prototype,Vd=qd.hasOwnProperty,Bd=qd.propertyIsEnumerable,zd=Gd(function(){return arguments}())?Gd:function(e){return Ud(e)&&Vd.call(e,"callee")&&!Bd.call(e,"callee")},Hd=Array.isArray;var Wd=function(){return!1},Yd=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r?Of.Buffer:void 0,o=(i?i.isBuffer:void 0)||Wd;e.exports=o}),Xd=9007199254740991,Jd=/^(?:0|[1-9]\d*)$/;var Kd=function(e,t){var r=typeof e;return!!(t=null==t?Xd:t)&&("number"==r||"symbol"!=r&&Jd.test(e))&&e>-1&&e%1==0&&e<t},$d=9007199254740991;var Qd=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=$d},Zd={};Zd["[object Float32Array]"]=Zd["[object Float64Array]"]=Zd["[object Int8Array]"]=Zd["[object Int16Array]"]=Zd["[object Int32Array]"]=Zd["[object Uint8Array]"]=Zd["[object Uint8ClampedArray]"]=Zd["[object Uint16Array]"]=Zd["[object Uint32Array]"]=!0,Zd["[object Arguments]"]=Zd["[object Array]"]=Zd["[object ArrayBuffer]"]=Zd["[object Boolean]"]=Zd["[object DataView]"]=Zd["[object Date]"]=Zd["[object Error]"]=Zd["[object Function]"]=Zd["[object Map]"]=Zd["[object Number]"]=Zd["[object Object]"]=Zd["[object RegExp]"]=Zd["[object Set]"]=Zd["[object String]"]=Zd["[object WeakMap]"]=!1;var ep=function(e){return Ud(e)&&Qd(e.length)&&!!Zd[Lf(e)]};var tp=function(e){return function(t){return e(t)}},rp=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r&&Tf.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o}),np=rp&&rp.isTypedArray,ip=np?tp(np):ep,op=Object.prototype.hasOwnProperty;var ap=function(e,t){var r=Hd(e),n=!r&&zd(e),i=!r&&!n&&Yd(e),o=!r&&!n&&!i&&ip(e),a=r||n||i||o,s=a?Ld(e.length,String):[],u=s.length;for(var c in e)!t&&!op.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Kd(c,u))||s.push(c);return s},sp=Object.prototype;var up=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||sp)};var cp=function(e,t){return function(r){return e(t(r))}},lp=cp(Object.keys,Object),fp=Object.prototype.hasOwnProperty;var dp=function(e){if(!up(e))return lp(e);var t=[];for(var r in Object(e))fp.call(e,r)&&"constructor"!=r&&t.push(r);return t};var pp=function(e){return null!=e&&Qd(e.length)&&!zf(e)};var hp=function(e){return pp(e)?ap(e):dp(e)};var vp=function(e,t){return e&&xd(t,hp(t),e)};var gp=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},mp=Object.prototype.hasOwnProperty;var yp=function(e){if(!Uf(e))return gp(e);var t=up(e),r=[];for(var n in e)("constructor"!=n||!t&&mp.call(e,n))&&r.push(n);return r};var _p=function(e){return pp(e)?ap(e,!0):yp(e)};var Ep=function(e,t){return e&&xd(t,_p(t),e)},bp=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r?Of.Buffer:void 0,o=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=o?o(r):new e.constructor(r);return e.copy(n),n}});var Sp=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var Tp=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o};var wp=function(){return[]},Op=Object.prototype.propertyIsEnumerable,kp=Object.getOwnPropertySymbols,Rp=kp?function(e){return null==e?[]:(e=Object(e),Tp(kp(e),function(t){return Op.call(e,t)}))}:wp;var Ap=function(e,t){return xd(e,Rp(e),t)};var Ip=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},Pp=cp(Object.getPrototypeOf,Object),Cp=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Ip(t,Rp(e)),e=Pp(e);return t}:wp;var Mp=function(e,t){return xd(e,Cp(e),t)};var Np=function(e,t,r){var n=t(e);return Hd(e)?n:Ip(n,r(e))};var Dp=function(e){return Np(e,hp,Rp)};var jp=function(e){return Np(e,_p,Cp)},xp=id(Of,"DataView"),Lp=id(Of,"Promise"),Up=id(Of,"Set"),Fp=id(Of,"WeakMap"),Gp=Jf(xp),qp=Jf(od),Vp=Jf(Lp),Bp=Jf(Up),zp=Jf(Fp),Hp=Lf;(xp&&"[object DataView]"!=Hp(new xp(new ArrayBuffer(1)))||od&&"[object Map]"!=Hp(new od)||Lp&&"[object Promise]"!=Hp(Lp.resolve())||Up&&"[object Set]"!=Hp(new Up)||Fp&&"[object WeakMap]"!=Hp(new Fp))&&(Hp=function(e){var t=Lf(e),r="[object Object]"==t?e.constructor:void 0,n=r?Jf(r):"";if(n)switch(n){case Gp:return"[object DataView]";case qp:return"[object Map]";case Vp:return"[object Promise]";case Bp:return"[object Set]";case zp:return"[object WeakMap]"}return t});var Wp=Hp,Yp=Object.prototype.hasOwnProperty;var Xp=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Yp.call(e,"index")&&(r.index=e.index,r.input=e.input),r},Jp=Of.Uint8Array;var Kp=function(e){var t=new e.constructor(e.byteLength);return new Jp(t).set(new Jp(e)),t};var $p=function(e,t){var r=t?Kp(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},Qp=/\w*$/;var Zp=function(e){var t=new e.constructor(e.source,Qp.exec(e));return t.lastIndex=e.lastIndex,t},eh=kf?kf.prototype:void 0,th=eh?eh.valueOf:void 0;var rh=function(e){return th?Object(th.call(e)):{}};var nh=function(e,t){var r=t?Kp(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},ih="[object Boolean]",oh="[object Date]",ah="[object Map]",sh="[object Number]",uh="[object RegExp]",ch="[object Set]",lh="[object String]",fh="[object Symbol]",dh="[object ArrayBuffer]",ph="[object DataView]",hh="[object Float32Array]",vh="[object Float64Array]",gh="[object Int8Array]",mh="[object Int16Array]",yh="[object Int32Array]",_h="[object Uint8Array]",Eh="[object Uint8ClampedArray]",bh="[object Uint16Array]",Sh="[object Uint32Array]";var Th=function(e,t,r){var n=e.constructor;switch(t){case dh:return Kp(e);case ih:case oh:return new n(+e);case ph:return $p(e,r);case hh:case vh:case gh:case mh:case yh:case _h:case Eh:case bh:case Sh:return nh(e,r);case ah:return new n;case sh:case lh:return new n(e);case uh:return Zp(e);case ch:return new n;case fh:return rh(e)}},wh=Object.create,Oh=function(){function e(){}return function(t){if(!Uf(t))return{};if(wh)return wh(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var kh=function(e){return"function"!=typeof e.constructor||up(e)?{}:Oh(Pp(e))},Rh="[object Map]";var Ah=function(e){return Ud(e)&&Wp(e)==Rh},Ih=rp&&rp.isMap,Ph=Ih?tp(Ih):Ah,Ch="[object Set]";var Mh=function(e){return Ud(e)&&Wp(e)==Ch},Nh=rp&&rp.isSet,Dh=Nh?tp(Nh):Mh,jh=1,xh=2,Lh=4,Uh="[object Arguments]",Fh="[object Function]",Gh="[object GeneratorFunction]",qh="[object Object]",Vh={};Vh[Uh]=Vh["[object Array]"]=Vh["[object ArrayBuffer]"]=Vh["[object DataView]"]=Vh["[object Boolean]"]=Vh["[object Date]"]=Vh["[object Float32Array]"]=Vh["[object Float64Array]"]=Vh["[object Int8Array]"]=Vh["[object Int16Array]"]=Vh["[object Int32Array]"]=Vh["[object Map]"]=Vh["[object Number]"]=Vh[qh]=Vh["[object RegExp]"]=Vh["[object Set]"]=Vh["[object String]"]=Vh["[object Symbol]"]=Vh["[object Uint8Array]"]=Vh["[object Uint8ClampedArray]"]=Vh["[object Uint16Array]"]=Vh["[object Uint32Array]"]=!0,Vh["[object Error]"]=Vh[Fh]=Vh["[object WeakMap]"]=!1;var Bh=function e(t,r,n,i,o,a){var s,u=r&jh,c=r&xh,l=r&Lh;if(n&&(s=o?n(t,i,o,a):n(t)),void 0!==s)return s;if(!Uf(t))return t;var f=Hd(t);if(f){if(s=Xp(t),!u)return Sp(t,s)}else{var d=Wp(t),p=d==Fh||d==Gh;if(Yd(t))return bp(t,u);if(d==qh||d==Uh||p&&!o){if(s=c||p?{}:kh(t),!u)return c?Mp(t,Ep(s,t)):Ap(t,vp(s,t))}else{if(!Vh[d])return o?t:{};s=Th(t,d,u)}}a||(a=new Pd);var h=a.get(t);if(h)return h;if(a.set(t,s),Dh(t))return t.forEach(function(i){s.add(e(i,r,n,i,t,a))}),s;if(Ph(t))return t.forEach(function(i,o){s.set(o,e(i,r,n,o,t,a))}),s;var v=l?c?jp:Dp:c?keysIn:hp,g=f?void 0:v(t);return Cd(g||t,function(i,o){g&&(i=t[o=i]),jd(s,o,e(i,r,n,o,t,a))}),s},zh="[object Symbol]";var Hh=function(e){return"symbol"==typeof e||Ud(e)&&Lf(e)==zh},Wh=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yh=/^\w*$/;var Xh=function(e,t){if(Hd(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Hh(e))||Yh.test(e)||!Wh.test(e)||null!=t&&e in Object(t)},Jh="Expected a function";function Kh(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Jh);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(Kh.Cache||kd),r}Kh.Cache=kd;var $h=Kh,Qh=500;var Zh=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ev=/\\(\\)?/g,tv=function(e){var t=$h(e,function(e){return r.size===Qh&&r.clear(),e}),r=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Zh,function(e,r,n,i){t.push(n?i.replace(ev,"$1"):r||e)}),t}),rv=1/0,nv=kf?kf.prototype:void 0,iv=nv?nv.toString:void 0;var ov=function e(t){if("string"==typeof t)return t;if(Hd(t))return uf(t,e)+"";if(Hh(t))return iv?iv.call(t):"";var r=t+"";return"0"==r&&1/t==-rv?"-0":r};var av=function(e){return null==e?"":ov(e)};var sv=function(e,t){return Hd(e)?e:Xh(e,t)?[e]:tv(av(e))};var uv=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},cv=1/0;var lv=function(e){if("string"==typeof e||Hh(e))return e;var t=e+"";return"0"==t&&1/e==-cv?"-0":t};var fv=function(e,t){for(var r=0,n=(t=sv(t,e)).length;null!=e&&r<n;)e=e[lv(t[r++])];return r&&r==n?e:void 0};var dv=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o};var pv=function(e,t){return t.length<2?e:fv(e,dv(t,0,-1))};var hv=function(e,t){return t=sv(t,e),null==(e=pv(e,t))||delete e[lv(uv(t))]},vv="[object Object]",gv=Function.prototype,mv=Object.prototype,yv=gv.toString,_v=mv.hasOwnProperty,Ev=yv.call(Object);var bv=function(e){if(!Ud(e)||Lf(e)!=vv)return!1;var t=Pp(e);if(null===t)return!0;var r=_v.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&yv.call(r)==Ev};var Sv=function(e){return bv(e)?void 0:e},Tv=kf?kf.isConcatSpreadable:void 0;var wv=function(e){return Hd(e)||zd(e)||!!(Tv&&e&&e[Tv])};var Ov=function e(t,r,n,i,o){var a=-1,s=t.length;for(n||(n=wv),o||(o=[]);++a<s;){var u=t[a];r>0&&n(u)?r>1?e(u,r-1,n,i,o):Ip(o,u):i||(o[o.length]=u)}return o};var kv=function(e){return null!=e&&e.length?Ov(e,1):[]};var Rv=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Av=Math.max;var Iv=function(e,t,r){return t=Av(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=Av(n.length-t,0),a=Array(o);++i<o;)a[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(a),Rv(e,this,s)}};var Pv=function(e){return function(){return e}};var Cv=function(e){return e},Mv=Md?function(e,t){return Md(e,"toString",{configurable:!0,enumerable:!1,value:Pv(t),writable:!0})}:Cv,Nv=800,Dv=16,jv=Date.now;var xv=function(e){var t=0,r=0;return function(){var n=jv(),i=Dv-(n-r);if(r=n,i>0){if(++t>=Nv)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},Lv=xv(Mv);var Uv=function(e){return Lv(Iv(e,void 0,kv),e+"")},Fv=Uv(function(e,t){var r={};if(null==e)return r;var n=!1;t=uf(t,function(t){return t=sv(t,e),n||(n=t.length>1),t}),xd(e,jp(e),r),n&&(r=Bh(r,7,Sv));for(var i=t.length;i--;)hv(r,t[i]);return r}),Gv="[object Map]",qv="[object Set]",Vv=Object.prototype.hasOwnProperty;var Bv=function(e){if(null==e)return!0;if(pp(e)&&(Hd(e)||"string"==typeof e||"function"==typeof e.splice||Yd(e)||ip(e)||zd(e)))return!e.length;var t=Wp(e);if(t==Gv||t==qv)return!e.size;if(up(e))return!dp(e).length;for(var r in e)if(Vv.call(e,r))return!1;return!0},zv=1,Hv=4;var Wv=function(e){return Bh(e,zv|Hv)};function Yv(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Xv=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function Jv(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function Kv(e,t,r,n){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?$v(Qv(e),function(n){var i=encodeURIComponent(Jv(n))+r;return Xv(e[n])?$v(e[n],function(e){return i+encodeURIComponent(Jv(e))}).join(t):i+encodeURIComponent(Jv(e[n]))}).join(t):n?encodeURIComponent(Jv(n))+r+encodeURIComponent(Jv(e)):""}function $v(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var Qv=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t};function Zv(e,t,r,n){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var s=e.length;a>0&&s>a&&(s=a);for(var u=0;u<s;++u){var c,l,f,d,p=e[u].replace(o,"%20"),h=p.indexOf(r);h>=0?(c=p.substr(0,h),l=p.substr(h+1)):(c=p,l=""),f=decodeURIComponent(c),d=decodeURIComponent(l),Yv(i,f)?Xv(i[f])?i[f].push(d):i[f]=[i[f],d]:i[f]=d}return i}var eg={encode:Kv,stringify:Kv,decode:Zv,parse:Zv},tg=2147483647,rg=36,ng=1,ig=26,og=38,ag=700,sg=72,ug=128,cg="-",lg=/[^\x20-\x7E]/,fg=/[\x2E\u3002\uFF0E\uFF61]/g,dg={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},pg=rg-ng,hg=Math.floor,vg=String.fromCharCode;function gg(e){throw new RangeError(dg[e])}function mg(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function yg(e,t,r){var n=0;for(e=r?hg(e/ag):e>>1,e+=hg(e/t);e>pg*ig>>1;n+=rg)e=hg(e/pg);return hg(n+(pg+1)*e/(e+og))}function _g(e){return function(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]);var i=function(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}((e=e.replace(fg,".")).split("."),t).join(".");return n+i}(e,function(e){return lg.test(e)?"xn--"+function(e){var t,r,n,i,o,a,s,u,c,l,f,d,p,h,v,g=[];for(d=(e=function(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}(e)).length,t=ug,r=0,o=sg,a=0;a<d;++a)(f=e[a])<128&&g.push(vg(f));for(n=i=g.length,i&&g.push(cg);n<d;){for(s=tg,a=0;a<d;++a)(f=e[a])>=t&&f<s&&(s=f);for(s-t>hg((tg-r)/(p=n+1))&&gg("overflow"),r+=(s-t)*p,t=s,a=0;a<d;++a)if((f=e[a])<t&&++r>tg&&gg("overflow"),f==t){for(u=r,c=rg;!(u<(l=c<=o?ng:c>=o+ig?ig:c-o));c+=rg)v=u-l,h=rg-l,g.push(vg(mg(l+v%h,0))),u=hg(v/h);g.push(vg(mg(u,0))),o=yg(r,p,n==i),r=0,++n}++r,++t}return g.join("")}(e):e})}var Eg=[],bg=[],Sg="undefined"!=typeof Uint8Array?Uint8Array:Array,Tg=!1;function wg(){Tg=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)Eg[t]=e[t],bg[e.charCodeAt(t)]=t;bg["-".charCodeAt(0)]=62,bg["_".charCodeAt(0)]=63}function Og(e,t,r){for(var n,i,o=[],a=t;a<r;a+=3)n=(e[a]<<16)+(e[a+1]<<8)+e[a+2],o.push(Eg[(i=n)>>18&63]+Eg[i>>12&63]+Eg[i>>6&63]+Eg[63&i]);return o.join("")}function kg(e){var t;Tg||wg();for(var r=e.length,n=r%3,i="",o=[],a=0,s=r-n;a<s;a+=16383)o.push(Og(e,a,a+16383>s?s:a+16383));return 1===n?(t=e[r-1],i+=Eg[t>>2],i+=Eg[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=Eg[t>>10],i+=Eg[t>>4&63],i+=Eg[t<<2&63],i+="="),o.push(i),o.join("")}function Rg(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,f=r?i-1:0,d=r?-1:1,p=e[t+f];for(f+=d,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=d,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+f],f+=d,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)}function Ag(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,h=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?d/u:d*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=h,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+p]=255&a,p+=h,a/=256,c-=8);e[r+p-h]|=128*v}var Ig={}.toString,Pg=Array.isArray||function(e){return"[object Array]"==Ig.call(e)};function Cg(){return Ng.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Mg(e,t){if(Cg()<t)throw new RangeError("Invalid typed array length");return Ng.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Ng.prototype:(null===e&&(e=new Ng(t)),e.length=t),e}function Ng(e,t,r){if(!(Ng.TYPED_ARRAY_SUPPORT||this instanceof Ng))return new Ng(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return xg(this,e)}return Dg(this,e,t,r)}function Dg(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);Ng.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Ng.prototype:e=Lg(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!Ng.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|Gg(t,r),i=(e=Mg(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(Fg(t)){var r=0|Ug(t.length);return 0===(e=Mg(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?Mg(e,0):Lg(e,t);if("Buffer"===t.type&&Pg(t.data))return Lg(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function jg(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function xg(e,t){if(jg(t),e=Mg(e,t<0?0:0|Ug(t)),!Ng.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function Lg(e,t){var r=t.length<0?0:0|Ug(t.length);e=Mg(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function Ug(e){if(e>=Cg())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Cg().toString(16)+" bytes");return 0|e}function Fg(e){return!(null==e||!e._isBuffer)}function Gg(e,t){if(Fg(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return dm(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return pm(e).length;default:if(n)return dm(e).length;t=(""+t).toLowerCase(),n=!0}}function qg(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Vg(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=Ng.from(t,n)),Fg(t))return 0===t.length?-1:Bg(e,t,r,n,i);if("number"==typeof t)return t&=255,Ng.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):Bg(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function Bg(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var f=!0,d=0;d<u;d++)if(c(e,o+d)!==c(t,d)){f=!1;break}if(f)return o}return-1}function zg(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function Hg(e,t,r,n){return hm(dm(t,e.length-r),e,r,n)}function Wg(e,t,r,n){return hm(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function Yg(e,t,r,n){return Wg(e,t,r,n)}function Xg(e,t,r,n){return hm(pm(t),e,r,n)}function Jg(e,t,r,n){return hm(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function Kg(e,t,r){return 0===t&&r===e.length?kg(e):kg(e.slice(t,r))}function $g(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,u,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=r)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return function(e){var t=e.length;if(t<=Qg)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Qg));return r}(n)}Ng.TYPED_ARRAY_SUPPORT=void 0===Cs.TYPED_ARRAY_SUPPORT||Cs.TYPED_ARRAY_SUPPORT,Ng.poolSize=8192,Ng._augment=function(e){return e.__proto__=Ng.prototype,e},Ng.from=function(e,t,r){return Dg(null,e,t,r)},Ng.TYPED_ARRAY_SUPPORT&&(Ng.prototype.__proto__=Uint8Array.prototype,Ng.__proto__=Uint8Array),Ng.alloc=function(e,t,r){return function(e,t,r,n){return jg(t),t<=0?Mg(e,t):void 0!==r?"string"==typeof n?Mg(e,t).fill(r,n):Mg(e,t).fill(r):Mg(e,t)}(null,e,t,r)},Ng.allocUnsafe=function(e){return xg(null,e)},Ng.allocUnsafeSlow=function(e){return xg(null,e)},Ng.isBuffer=vm,Ng.compare=function(e,t){if(!Fg(e)||!Fg(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},Ng.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Ng.concat=function(e,t){if(!Pg(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Ng.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=Ng.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!Fg(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},Ng.byteLength=Gg,Ng.prototype._isBuffer=!0,Ng.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)qg(this,t,t+1);return this},Ng.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)qg(this,t,t+3),qg(this,t+1,t+2);return this},Ng.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)qg(this,t,t+7),qg(this,t+1,t+6),qg(this,t+2,t+5),qg(this,t+3,t+4);return this},Ng.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?$g(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return tm(this,t,r);case"utf8":case"utf-8":return $g(this,t,r);case"ascii":return Zg(this,t,r);case"latin1":case"binary":return em(this,t,r);case"base64":return Kg(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return rm(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},Ng.prototype.equals=function(e){if(!Fg(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Ng.compare(this,e)},Ng.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},Ng.prototype.compare=function(e,t,r,n,i){if(!Fg(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(n,i),c=e.slice(t,r),l=0;l<s;++l)if(u[l]!==c[l]){o=u[l],a=c[l];break}return o<a?-1:a<o?1:0},Ng.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},Ng.prototype.indexOf=function(e,t,r){return Vg(this,e,t,r,!0)},Ng.prototype.lastIndexOf=function(e,t,r){return Vg(this,e,t,r,!1)},Ng.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return zg(this,e,t,r);case"utf8":case"utf-8":return Hg(this,e,t,r);case"ascii":return Wg(this,e,t,r);case"latin1":case"binary":return Yg(this,e,t,r);case"base64":return Xg(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Jg(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},Ng.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Qg=4096;function Zg(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function em(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function tm(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=fm(e[o]);return i}function rm(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function nm(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function im(e,t,r,n,i,o){if(!Fg(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function om(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function am(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function sm(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function um(e,t,r,n,i){return i||sm(e,0,r,4),Ag(e,t,r,n,23,4),r+4}function cm(e,t,r,n,i){return i||sm(e,0,r,8),Ag(e,t,r,n,52,8),r+8}Ng.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),Ng.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=Ng.prototype;else{var i=t-e;r=new Ng(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},Ng.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||nm(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},Ng.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||nm(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},Ng.prototype.readUInt8=function(e,t){return t||nm(e,1,this.length),this[e]},Ng.prototype.readUInt16LE=function(e,t){return t||nm(e,2,this.length),this[e]|this[e+1]<<8},Ng.prototype.readUInt16BE=function(e,t){return t||nm(e,2,this.length),this[e]<<8|this[e+1]},Ng.prototype.readUInt32LE=function(e,t){return t||nm(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Ng.prototype.readUInt32BE=function(e,t){return t||nm(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Ng.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||nm(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},Ng.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||nm(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},Ng.prototype.readInt8=function(e,t){return t||nm(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Ng.prototype.readInt16LE=function(e,t){t||nm(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Ng.prototype.readInt16BE=function(e,t){t||nm(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Ng.prototype.readInt32LE=function(e,t){return t||nm(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Ng.prototype.readInt32BE=function(e,t){return t||nm(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Ng.prototype.readFloatLE=function(e,t){return t||nm(e,4,this.length),Rg(this,e,!0,23,4)},Ng.prototype.readFloatBE=function(e,t){return t||nm(e,4,this.length),Rg(this,e,!1,23,4)},Ng.prototype.readDoubleLE=function(e,t){return t||nm(e,8,this.length),Rg(this,e,!0,52,8)},Ng.prototype.readDoubleBE=function(e,t){return t||nm(e,8,this.length),Rg(this,e,!1,52,8)},Ng.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||im(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},Ng.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||im(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},Ng.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||im(this,e,t,1,255,0),Ng.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Ng.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||im(this,e,t,2,65535,0),Ng.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):om(this,e,t,!0),t+2},Ng.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||im(this,e,t,2,65535,0),Ng.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):om(this,e,t,!1),t+2},Ng.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||im(this,e,t,4,4294967295,0),Ng.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):am(this,e,t,!0),t+4},Ng.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||im(this,e,t,4,4294967295,0),Ng.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):am(this,e,t,!1),t+4},Ng.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);im(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},Ng.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);im(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},Ng.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||im(this,e,t,1,127,-128),Ng.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Ng.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||im(this,e,t,2,32767,-32768),Ng.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):om(this,e,t,!0),t+2},Ng.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||im(this,e,t,2,32767,-32768),Ng.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):om(this,e,t,!1),t+2},Ng.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||im(this,e,t,4,2147483647,-2147483648),Ng.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):am(this,e,t,!0),t+4},Ng.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||im(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Ng.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):am(this,e,t,!1),t+4},Ng.prototype.writeFloatLE=function(e,t,r){return um(this,e,t,!0,r)},Ng.prototype.writeFloatBE=function(e,t,r){return um(this,e,t,!1,r)},Ng.prototype.writeDoubleLE=function(e,t,r){return cm(this,e,t,!0,r)},Ng.prototype.writeDoubleBE=function(e,t,r){return cm(this,e,t,!1,r)},Ng.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!Ng.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},Ng.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Ng.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=Fg(e)?e:dm(new Ng(e,n).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var lm=/[^+\/0-9A-Za-z-_]/g;function fm(e){return e<16?"0"+e.toString(16):e.toString(16)}function dm(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function pm(e){return function(e){var t,r,n,i,o,a;Tg||wg();var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[s-2]?2:"="===e[s-1]?1:0,a=new Sg(3*s/4-o),n=o>0?s-4:s;var u=0;for(t=0,r=0;t<n;t+=4,r+=3)i=bg[e.charCodeAt(t)]<<18|bg[e.charCodeAt(t+1)]<<12|bg[e.charCodeAt(t+2)]<<6|bg[e.charCodeAt(t+3)],a[u++]=i>>16&255,a[u++]=i>>8&255,a[u++]=255&i;return 2===o?(i=bg[e.charCodeAt(t)]<<2|bg[e.charCodeAt(t+1)]>>4,a[u++]=255&i):1===o&&(i=bg[e.charCodeAt(t)]<<10|bg[e.charCodeAt(t+1)]<<4|bg[e.charCodeAt(t+2)]>>2,a[u++]=i>>8&255,a[u++]=255&i),a}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(lm,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function hm(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function vm(e){return null!=e&&(!!e._isBuffer||gm(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&gm(e.slice(0,0))}(e))}function gm(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var mm="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e},ym=/%[sdj%]/g;function _m(e){if(!jm(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(wm(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,o=String(e).replace(ym,function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),a=n[r];r<i;a=n[++r])Mm(a)||!Um(a)?o+=" "+a:o+=" "+wm(a);return o}function Em(e,t){if(xm(Cs.process))return function(){return Em(e,t).apply(this,arguments)};var r=!1;return function(){return r||(console.error(t),r=!0),e.apply(this,arguments)}}var bm,Sm={};function Tm(e){if(xm(bm)&&(bm=""),e=e.toUpperCase(),!Sm[e])if(new RegExp("\\b"+e+"\\b","i").test(bm)){Sm[e]=function(){var t=_m.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else Sm[e]=function(){};return Sm[e]}function wm(e,t){var r={seen:[],stylize:km};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),Cm(t)?r.showHidden=t:t&&Hm(r,t),xm(r.showHidden)&&(r.showHidden=!1),xm(r.depth)&&(r.depth=2),xm(r.colors)&&(r.colors=!1),xm(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=Om),Rm(r,e,r.depth)}function Om(e,t){var r=wm.styles[t];return r?"["+wm.colors[r][0]+"m"+e+"["+wm.colors[r][1]+"m":e}function km(e,t){return e}function Rm(e,t,r){if(e.customInspect&&t&&qm(t.inspect)&&t.inspect!==wm&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return jm(n)||(n=Rm(e,n,r)),n}var i=function(e,t){if(xm(t))return e.stylize("undefined","undefined");if(jm(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(Dm(t))return e.stylize(""+t,"number");if(Cm(t))return e.stylize(""+t,"boolean");if(Mm(t))return e.stylize("null","null")}(e,t);if(i)return i;var o=Object.keys(t),a=function(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),Gm(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return Am(t);if(0===o.length){if(qm(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if(Lm(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(Fm(t))return e.stylize(Date.prototype.toString.call(t),"date");if(Gm(t))return Am(t)}var u,c="",l=!1,f=["{","}"];(Pm(t)&&(l=!0,f=["[","]"]),qm(t))&&(c=" [Function"+(t.name?": "+t.name:"")+"]");return Lm(t)&&(c=" "+RegExp.prototype.toString.call(t)),Fm(t)&&(c=" "+Date.prototype.toUTCString.call(t)),Gm(t)&&(c=" "+Am(t)),0!==o.length||l&&0!=t.length?r<0?Lm(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=l?function(e,t,r,n,i){for(var o=[],a=0,s=t.length;a<s;++a)Wm(t,String(a))?o.push(Im(e,t,r,n,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(Im(e,t,r,n,i,!0))}),o}(e,t,r,a,o):o.map(function(n){return Im(e,t,r,a,n,l)}),e.seen.pop(),function(e,t,r){if(e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,c,f)):f[0]+c+f[1]}function Am(e){return"["+Error.prototype.toString.call(e)+"]"}function Im(e,t,r,n,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),Wm(n,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=Mm(r)?Rm(e,u.value,null):Rm(e,u.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),xm(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function Pm(e){return Array.isArray(e)}function Cm(e){return"boolean"==typeof e}function Mm(e){return null===e}function Nm(e){return null==e}function Dm(e){return"number"==typeof e}function jm(e){return"string"==typeof e}function xm(e){return void 0===e}function Lm(e){return Um(e)&&"[object RegExp]"===Vm(e)}function Um(e){return"object"==typeof e&&null!==e}function Fm(e){return Um(e)&&"[object Date]"===Vm(e)}function Gm(e){return Um(e)&&("[object Error]"===Vm(e)||e instanceof Error)}function qm(e){return"function"==typeof e}function Vm(e){return Object.prototype.toString.call(e)}function Bm(e){return e<10?"0"+e.toString(10):e.toString(10)}wm.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},wm.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var zm=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Hm(e,t){if(!t||!Um(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function Wm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Ym={inherits:mm,_extend:Hm,log:function(){var e,t;console.log("%s - %s",(e=new Date,t=[Bm(e.getHours()),Bm(e.getMinutes()),Bm(e.getSeconds())].join(":"),[e.getDate(),zm[e.getMonth()],t].join(" ")),_m.apply(null,arguments))},isBuffer:function(e){return vm(e)},isPrimitive:function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},isFunction:qm,isError:Gm,isDate:Fm,isObject:Um,isRegExp:Lm,isUndefined:xm,isSymbol:function(e){return"symbol"==typeof e},isString:jm,isNumber:Dm,isNullOrUndefined:Nm,isNull:Mm,isBoolean:Cm,isArray:Pm,inspect:wm,deprecate:Em,format:_m,debuglog:Tm},Xm={parse:cy,resolve:function(e,t){return cy(e,!1,!0).resolve(t)},resolveObject:function(e,t){return e?cy(e,!1,!0).resolveObject(t):t},format:function(e){jm(e)&&(e=ly({},e));return fy(e)},Url:Jm};function Jm(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Km=/^([a-z0-9.+-]+:)/i,$m=/:[0-9]*$/,Qm=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Zm=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),ey=["'"].concat(Zm),ty=["%","/","?",";","#"].concat(ey),ry=["/","?","#"],ny=255,iy=/^[+a-z0-9A-Z_-]{0,63}$/,oy=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ay={javascript:!0,"javascript:":!0},sy={javascript:!0,"javascript:":!0},uy={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function cy(e,t,r){if(e&&Um(e)&&e instanceof Jm)return e;var n=new Jm;return n.parse(e,t,r),n}function ly(e,t,r,n){if(!jm(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),o=-1!==i&&i<t.indexOf("#")?"?":"#",a=t.split(o);a[0]=a[0].replace(/\\/g,"/");var s=t=a.join(o);if(s=s.trim(),!n&&1===t.split("#").length){var u=Qm.exec(s);if(u)return e.path=s,e.href=s,e.pathname=u[1],u[2]?(e.search=u[2],e.query=r?Zv(e.search.substr(1)):e.search.substr(1)):r&&(e.search="",e.query={}),e}var c,l,f,d,p=Km.exec(s);if(p){var h=(p=p[0]).toLowerCase();e.protocol=h,s=s.substr(p.length)}if(n||p||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var v="//"===s.substr(0,2);!v||p&&sy[p]||(s=s.substr(2),e.slashes=!0)}if(!sy[p]&&(v||p&&!uy[p])){var g,m,y=-1;for(c=0;c<ry.length;c++)-1!==(l=s.indexOf(ry[c]))&&(-1===y||l<y)&&(y=l);for(-1!==(m=-1===y?s.lastIndexOf("@"):s.lastIndexOf("@",y))&&(g=s.slice(0,m),s=s.slice(m+1),e.auth=decodeURIComponent(g)),y=-1,c=0;c<ty.length;c++)-1!==(l=s.indexOf(ty[c]))&&(-1===y||l<y)&&(y=l);-1===y&&(y=s.length),e.host=s.slice(0,y),s=s.slice(y),dy(e),e.hostname=e.hostname||"";var _="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!_){var E=e.hostname.split(/\./);for(c=0,f=E.length;c<f;c++){var b=E[c];if(b&&!b.match(iy)){for(var S="",T=0,w=b.length;T<w;T++)b.charCodeAt(T)>127?S+="x":S+=b[T];if(!S.match(iy)){var O=E.slice(0,c),k=E.slice(c+1),R=b.match(oy);R&&(O.push(R[1]),k.unshift(R[2])),k.length&&(s="/"+k.join(".")+s),e.hostname=O.join(".");break}}}}e.hostname.length>ny?e.hostname="":e.hostname=e.hostname.toLowerCase(),_||(e.hostname=_g(e.hostname)),d=e.port?":"+e.port:"";var A=e.hostname||"";e.host=A+d,e.href+=e.host,_&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!ay[h])for(c=0,f=ey.length;c<f;c++){var I=ey[c];if(-1!==s.indexOf(I)){var P=encodeURIComponent(I);P===I&&(P=escape(I)),s=s.split(I).join(P)}}var C=s.indexOf("#");-1!==C&&(e.hash=s.substr(C),s=s.slice(0,C));var M=s.indexOf("?");if(-1!==M?(e.search=s.substr(M),e.query=s.substr(M+1),r&&(e.query=Zv(e.query)),s=s.slice(0,M)):r&&(e.search="",e.query={}),s&&(e.pathname=s),uy[h]&&e.hostname&&!e.pathname&&(e.pathname="/"),e.pathname||e.search){d=e.pathname||"";var N=e.search||"";e.path=d+N}return e.href=fy(e),e}function fy(e){var t=e.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var r=e.protocol||"",n=e.pathname||"",i=e.hash||"",o=!1,a="";e.host?o=t+e.host:e.hostname&&(o=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(o+=":"+e.port)),e.query&&Um(e.query)&&Object.keys(e.query).length&&(a=Kv(e.query));var s=e.search||a&&"?"+a||"";return r&&":"!==r.substr(-1)&&(r+=":"),e.slashes||(!r||uy[r])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),i&&"#"!==i.charAt(0)&&(i="#"+i),s&&"?"!==s.charAt(0)&&(s="?"+s),r+o+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(s=s.replace("#","%23"))+i}function dy(e){var t=e.host,r=$m.exec(t);r&&(":"!==(r=r[0])&&(e.port=r.substr(1)),t=t.substr(0,t.length-r.length)),t&&(e.hostname=t)}Jm.prototype.parse=function(e,t,r){return ly(this,e,t,r)},Jm.prototype.format=function(){return fy(this)},Jm.prototype.resolve=function(e){return this.resolveObject(cy(e,!1,!0)).format()},Jm.prototype.resolveObject=function(e){if(jm(e)){var t=new Jm;t.parse(e,!1,!0),e=t}for(var r,n=new Jm,i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var c=s[u];"protocol"!==c&&(n[c]=e[c])}return uy[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!uy[e.protocol]){for(var l=Object.keys(e),f=0;f<l.length;f++){var d=l[f];n[d]=e[d]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||sy[e.protocol])n.pathname=e.pathname;else{for(r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),n.pathname=r.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",h=n.search||"";n.path=p+h}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var v,g=n.pathname&&"/"===n.pathname.charAt(0),m=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=m||g||n.host&&e.pathname,_=y,E=n.pathname&&n.pathname.split("/")||[],b=n.protocol&&!uy[n.protocol];if(r=e.pathname&&e.pathname.split("/")||[],b&&(n.hostname="",n.port=null,n.host&&(""===E[0]?E[0]=n.host:E.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),y=y&&(""===r[0]||""===E[0])),m)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,E=r;else if(r.length)E||(E=[]),E.pop(),E=E.concat(r),n.search=e.search,n.query=e.query;else if(!Nm(e.search))return b&&(n.hostname=n.host=E.shift(),(v=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=v.shift(),n.host=n.hostname=v.shift())),n.search=e.search,n.query=e.query,Mm(n.pathname)&&Mm(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!E.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var S=E.slice(-1)[0],T=(n.host||e.host||E.length>1)&&("."===S||".."===S)||""===S,w=0,O=E.length;O>=0;O--)"."===(S=E[O])?E.splice(O,1):".."===S?(E.splice(O,1),w++):w&&(E.splice(O,1),w--);if(!y&&!_)for(;w--;w)E.unshift("..");!y||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),T&&"/"!==E.join("/").substr(-1)&&E.push("");var k=""===E[0]||E[0]&&"/"===E[0].charAt(0);return b&&(n.hostname=n.host=k?"":E.length?E.shift():"",(v=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=v.shift(),n.host=n.hostname=v.shift())),(y=y||n.host&&E.length)&&!k&&E.unshift(""),E.length?n.pathname=E.join("/"):(n.pathname=null,n.path=null),Mm(n.pathname)&&Mm(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},Jm.prototype.parseHost=function(){return dy(this)};var py={version:"1.0.0",encode:function(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},decode:function(e){return new Ng(e=(e+=Array(5-e.length%4).join("=")).replace(/\-/g,"+").replace(/\_/g,"/"),"base64")},validate:function(e){return/^[A-Za-z0-9\-_]+$/.test(e)}},hy=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fromBase64url=i,t.toBase64Url=o,t.encode=a,t.decode=s,t.validate=u;var r,n=(r=py)&&r.__esModule?r:{default:r};function i(e){return n.default.decode(e).toString()}function o(e){var t=e;return vm(t)||(t=Ng.from(t)),n.default.encode(t)}function a(e){return o(e)}function s(e){return i(e)}function u(e){return n.default.validate(e)}t.default={fromBase64url:i,toBase64Url:o,encode:a,decode:s,validate:u}});t(hy);hy.fromBase64url,hy.toBase64Url,hy.encode,hy.decode,hy.validate;var vy=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=nf)&&r.__esModule?r:{default:r};t.default=function(e,t,r){if(!e)throw new Error("`fn` must be a function");if(!t)throw new Error("`wait` is required");if(!(r=r||{}).maxWait)throw new Error("`options.maxWait` is required");if(!r.maxCalls)throw new Error("`options.maxCalls` is required");var i=r,o=i.maxCalls,a=i.maxWait,s=0,u=void 0,c=void 0;return function(){s+=1,clearTimeout(c),c=setTimeout(function(){return l()},t),u||(u=setTimeout(function(){return l()},a)),s>=o&&(0,n.default)(l,this,[])};function l(){clearTimeout(c),c=null,clearTimeout(u),u=null,s=0,(0,n.default)(e,this,[])}}});t(vy);var gy=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.forEach(function(e){if(!t[e])throw new Error("missing required property "+e+" from "+t)})}});t(gy);var my=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=Xl)&&r.__esModule?r:{default:r};t.default=function(){var e=this;this.promise=new n.default(function(t,r){e.resolve=t,e.reject=r})}});t(my);var yy=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!e||!t)throw new Error("missing parameter for makeStateDataType");return{dataType:{set:function(r){return r instanceof e?(r.parent=this,{val:r,type:t}):{val:r?new e(r,{parent:this}):void 0,type:t}},compare:function(e,t){return e===t},onChange:function(e,t,r){t&&this.stopListening(t,"all",this._getCachedEventBubblingHandler(r)),e&&this.listenTo(e,"all",this._getCachedEventBubblingHandler(r))}},prop:{test:function(e){return!!e&&(e.parent=this,!1)},type:t}}}});t(yy);var _y=r(function(e,t){t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}});t(_y),Cu(Cu.S+Cu.F*!vu,"Object",{defineProperty:Au.f});var Ey=Tu.Object,by=function(e,t,r){return Ey.defineProperty(e,t,r)},Sy=r(function(e){e.exports={default:by,__esModule:!0}});t(Sy);var Ty=r(function(e,t){t.__esModule=!0;var r,n=(r=Sy)&&r.__esModule?r:{default:r};t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,n.default)(e,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()});t(Ty);var wy=Array.isArray||function(e){return"Array"==iu(e)},Oy=hc("species"),ky=function(e,t){return new(function(e){var t;return wy(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!wy(t.prototype)||(t=void 0),lu(t)&&null===(t=t[Oy])&&(t=void 0)),void 0===t?Array:t}(e))(t)},Ry=function(e,t){var r=1==e,n=2==e,i=3==e,o=4==e,a=6==e,s=5==e||a,u=t||ky;return function(t,c,l){for(var f,d,p=_c(t),h=ou(p),v=Ou(c,l,3),g=Yu(h.length),m=0,y=r?u(t,g):n?u(t,0):void 0;g>m;m++)if((s||m in h)&&(d=v(f=h[m],m,p),e))if(r)y[m]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:y.push(f)}else if(o)return!1;return a?-1:i||o?o:y}},Ay=r(function(e){var t=Zu("meta"),r=Au.f,n=0,i=Object.isExtensible||function(){return!0},o=!hu(function(){return i(Object.preventExtensions({}))}),a=function(e){r(e,t,{value:{i:"O"+ ++n,w:{}}})},s=e.exports={KEY:t,NEED:!1,fastKey:function(e,r){if(!lu(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!pu(e,t)){if(!i(e))return"F";if(!r)return"E";a(e)}return e[t].i},getWeak:function(e,r){if(!pu(e,t)){if(!i(e))return!0;if(!r)return!1;a(e)}return e[t].w},onFreeze:function(e){return o&&s.NEED&&i(e)&&!pu(e,t)&&a(e),e}}}),Iy=(Ay.KEY,Ay.NEED,Ay.fastKey,Ay.getWeak,Ay.onFreeze,function(e,t){if(!lu(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}),Py=Ay.getWeak,Cy=Ry(5),My=Ry(6),Ny=0,Dy=function(e){return e._l||(e._l=new jy)},jy=function(){this.a=[]},xy=function(e,t){return Cy(e.a,function(e){return e[0]===t})};jy.prototype={get:function(e){var t=xy(this,e);if(t)return t[1]},has:function(e){return!!xy(this,e)},set:function(e,t){var r=xy(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=My(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}};var Ly={getConstructor:function(e,t,r,n){var i=e(function(e,o){qc(e,i,t,"_i"),e._t=t,e._i=Ny++,e._l=void 0,null!=o&&Xc(o,r,e[n],e)});return _l(i.prototype,{delete:function(e){if(!lu(e))return!1;var r=Py(e);return!0===r?Dy(Iy(this,t)).delete(e):r&&pu(r,this._i)&&delete r[this._i]},has:function(e){if(!lu(e))return!1;var r=Py(e);return!0===r?Dy(Iy(this,t)).has(e):r&&pu(r,this._i)}}),i},def:function(e,t,r){var n=Py(ku(t),!0);return!0===n?Dy(e).set(t,r):n[e._i]=r,e},ufstore:Dy},Uy=Au.f,Fy=Ry(0),Gy=function(e,t,r,n,i,o){var a=gu[e],s=a,u=i?"set":"add",c=s&&s.prototype,l={};return vu&&"function"==typeof s&&(o||c.forEach&&!hu(function(){(new s).entries().next()}))?(s=t(function(t,r){qc(t,s,e,"_c"),t._c=new a,null!=r&&Xc(r,i,t[u],t)}),Fy("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in c&&(!o||"clear"!=e)&&Iu(s.prototype,e,function(r,n){if(qc(this,s,e),!t&&o&&!lu(r))return"get"==e&&void 0;var i=this._c[e](0===r?0:r,n);return t?this:i})}),o||Uy(s.prototype,"size",{get:function(){return this._c.size}})):(s=n.getConstructor(t,e,i,u),_l(s.prototype,r),Ay.NEED=!0),mc(s,e),l[e]=s,Cu(Cu.G+Cu.W+Cu.F,l),o||n.setStrong(s,e,i),s},qy=(r(function(e){var t,r=Ry(0),n=Ay.getWeak,i=Object.isExtensible,o=Ly.ufstore,a={},s=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},u={get:function(e){if(lu(e)){var t=n(e);return!0===t?o(Iy(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return Ly.def(Iy(this,"WeakMap"),e,t)}},c=e.exports=Gy("WeakMap",s,u,Ly,!0,!0);hu(function(){return 7!=(new c).set((Object.freeze||Object)(a),7).get(a)})&&(t=Ly.getConstructor(s,"WeakMap"),$l(t.prototype,u),Ay.NEED=!0,r(["delete","has","get","set"],function(e){var r=c.prototype,n=r[e];zu(r,e,function(r,o){if(lu(r)&&!i(r)){this._f||(this._f=new t);var a=this._f[e](r,o);return"set"==e?this:a}return n.call(this,r,o)})}))}),function(e){Cu(Cu.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})});qy("WeakMap");var Vy=function(e){Cu(Cu.S,e,{from:function(e){var t,r,n,i,o=arguments[1];return wu(this),(t=void 0!==o)&&wu(o),null==e?new this:(r=[],t?(n=0,i=Ou(o,arguments[2],2),Xc(e,!1,function(e){r.push(i(e,n++))})):Xc(e,!1,r.push,r),new this(r))}})};Vy("WeakMap");var By=Tu.WeakMap,zy=r(function(e){e.exports={default:By,__esModule:!0}});t(zy);var Hy=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(_y),n=a(Ty),i=a(zy),o=a(Ym);function a(e){return e&&e.__esModule?e:{default:e}}function s(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(e.add)e.add.apply(e,r);else if(e.set)e.set.apply(e,r);else{if(!e.push)throw new TypeError("Could not determine how to insert into the specified container");e.push.apply(e,r)}}t.default=function e(){for(var t=arguments.length,a=Array(t),u=0;u<t;u++)a[u]=arguments[u];var c=a.shift(),l=new i.default,f=new i.default,d=a.length>1?e.apply(void 0,a):a[0],p="("+[c.name].concat(a.map(function(e){return e.name})).join(", ")+")";return function(){function e(){(0,r.default)(this,e);for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];l.set(this,new(Function.prototype.bind.apply(c,[null].concat(n)))),f.set(this,0)}return(0,n.default)(e,[{key:"add",value:function(){return this.set.apply(this,arguments)}},{key:"clear",value:function(){var e=l.get(this).clear();return f.set(this,0),e}},{key:"delete",value:function(e){for(var t=l.get(this),r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if(!n.length)return t.delete(e);var o=t.get(e);if(!o)return!1;var a=o.delete.apply(o,n);return a&&f.set(this,f.get(this)-1),0===o.size&&t.delete(e),a}},{key:"get",value:function(e){var t=l.get(this);if(!t.get)return t;for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if(!n.length)return t.get(e);var o=t.get(e);return o?o.get?o.get.apply(o,n):o:void 0}},{key:"has",value:function(){return void 0!==this.get.apply(this,arguments)}},{key:"set",value:function(){for(var e=!1,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];this.has.apply(this,r)&&(e=!0);var i=l.get(this),o=r.shift();if(!i.get)return s.apply(void 0,[i,o].concat(r)),this;var a=i.get(o);if(!a){if(!d)return s.apply(void 0,[i,o].concat(r)),this;s(i,o,a=new d)}return s.apply(void 0,[a].concat(r)),e||f.set(this,f.get(this)+1),this}},{key:"inspect",value:function(){return"Container"+p+" {\n  "+o.default.inspect(l.get(this),{depth:null})+"\n}"}},{key:"size",get:function(){return f.get(this)}}]),e}()}});t(Hy);var Wy={f:hc},Yy=Wy.f("iterator"),Xy=r(function(e){e.exports={default:Yy,__esModule:!0}});t(Xy);var Jy=Au.f,Ky=function(e){var t=Tu.Symbol||(Tu.Symbol={});"_"==e.charAt(0)||e in t||Jy(t,e,{value:Wy.f(e)})},$y=oc.concat("length","prototype"),Qy={f:Object.getOwnPropertyNames||function(e){return ic(e,$y)}},Zy=Qy.f,e_={}.toString,t_="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],r_={f:function(e){return t_&&"[object Window]"==e_.call(e)?function(e){try{return Zy(e)}catch(e){return t_.slice()}}(e):Zy(su(e))}},n_=Ay.KEY,i_=Su.f,o_=Au.f,a_=r_.f,s_=gu.Symbol,u_=gu.JSON,c_=u_&&u_.stringify,l_=hc("_hidden"),f_=hc("toPrimitive"),d_={}.propertyIsEnumerable,p_=Ku("symbol-registry"),h_=Ku("symbols"),v_=Ku("op-symbols"),g_=Object.prototype,m_="function"==typeof s_,y_=gu.QObject,__=!y_||!y_.prototype||!y_.prototype.findChild,E_=vu&&hu(function(){return 7!=pc(o_({},"a",{get:function(){return o_(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=i_(g_,t);n&&delete g_[t],o_(e,t,r),n&&e!==g_&&o_(g_,t,n)}:o_,b_=function(e){var t=h_[e]=pc(s_.prototype);return t._k=e,t},S_=m_&&"symbol"==typeof s_.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof s_},T_=function(e,t,r){return e===g_&&T_(v_,t,r),ku(e),t=fu(t,!0),ku(r),pu(h_,t)?(r.enumerable?(pu(e,l_)&&e[l_][t]&&(e[l_][t]=!1),r=pc(r,{enumerable:cu(0,!1)})):(pu(e,l_)||o_(e,l_,cu(1,{})),e[l_][t]=!0),E_(e,t,r)):o_(e,t,r)},w_=function(e,t){ku(e);for(var r,n=function(e){var t=ac(e),r=Jl.f;if(r)for(var n,i=r(e),o=uu.f,a=0;i.length>a;)o.call(e,n=i[a++])&&t.push(n);return t}(t=su(t)),i=0,o=n.length;o>i;)T_(e,r=n[i++],t[r]);return e},O_=function(e){var t=d_.call(this,e=fu(e,!0));return!(this===g_&&pu(h_,e)&&!pu(v_,e))&&(!(t||!pu(this,e)||!pu(h_,e)||pu(this,l_)&&this[l_][e])||t)},k_=function(e,t){if(e=su(e),t=fu(t,!0),e!==g_||!pu(h_,t)||pu(v_,t)){var r=i_(e,t);return!r||!pu(h_,t)||pu(e,l_)&&e[l_][t]||(r.enumerable=!0),r}},R_=function(e){for(var t,r=a_(su(e)),n=[],i=0;r.length>i;)pu(h_,t=r[i++])||t==l_||t==n_||n.push(t);return n},A_=function(e){for(var t,r=e===g_,n=a_(r?v_:su(e)),i=[],o=0;n.length>o;)!pu(h_,t=n[o++])||r&&!pu(g_,t)||i.push(h_[t]);return i};m_||(zu((s_=function(){if(this instanceof s_)throw TypeError("Symbol is not a constructor!");var e=Zu(arguments.length>0?arguments[0]:void 0),t=function(r){this===g_&&t.call(v_,r),pu(this,l_)&&pu(this[l_],e)&&(this[l_][e]=!1),E_(this,e,cu(1,r))};return vu&&__&&E_(g_,e,{configurable:!0,set:t}),b_(e)}).prototype,"toString",function(){return this._k}),Su.f=k_,Au.f=T_,Qy.f=r_.f=R_,uu.f=O_,Jl.f=A_,Wy.f=function(e){return b_(hc(e))}),Cu(Cu.G+Cu.W+Cu.F*!m_,{Symbol:s_});for(var I_="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),P_=0;I_.length>P_;)hc(I_[P_++]);for(var C_=ac(hc.store),M_=0;C_.length>M_;)Ky(C_[M_++]);Cu(Cu.S+Cu.F*!m_,"Symbol",{for:function(e){return pu(p_,e+="")?p_[e]:p_[e]=s_(e)},keyFor:function(e){if(!S_(e))throw TypeError(e+" is not a symbol!");for(var t in p_)if(p_[t]===e)return t},useSetter:function(){__=!0},useSimple:function(){__=!1}}),Cu(Cu.S+Cu.F*!m_,"Object",{create:function(e,t){return void 0===t?pc(e):w_(pc(e),t)},defineProperty:T_,defineProperties:w_,getOwnPropertyDescriptor:k_,getOwnPropertyNames:R_,getOwnPropertySymbols:A_}),u_&&Cu(Cu.S+Cu.F*(!m_||hu(function(){var e=s_();return"[null]"!=c_([e])||"{}"!=c_({a:e})||"{}"!=c_(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(lu(t)||void 0!==e)&&!S_(e))return wy(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!S_(t))return t}),n[1]=t,c_.apply(u_,n)}}),s_.prototype[f_]||Iu(s_.prototype,f_,s_.prototype.valueOf),mc(s_,"Symbol"),mc(Math,"Math",!0),mc(gu.JSON,"JSON",!0),Ky("asyncIterator"),Ky("observable");var N_=Tu.Symbol,D_=r(function(e){e.exports={default:N_,__esModule:!0}});t(D_);var j_=r(function(e,t){t.__esModule=!0;var r=o(Xy),n=o(D_),i="function"==typeof n.default&&"symbol"==typeof r.default?function(e){return typeof e}:function(e){return e&&"function"==typeof n.default&&e.constructor===n.default&&e!==n.default.prototype?"symbol":typeof e};function o(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof n.default&&"symbol"===i(r.default)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof n.default&&e.constructor===n.default&&e!==n.default.prototype?"symbol":void 0===e?"undefined":i(e)}});t(j_);var x_=Au.f,L_=Ay.fastKey,U_=vu?"_s":"size",F_=function(e,t){var r,n=L_(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r},G_={getConstructor:function(e,t,r,n){var i=e(function(e,o){qc(e,i,t,"_i"),e._t=t,e._i=pc(null),e._f=void 0,e._l=void 0,e[U_]=0,null!=o&&Xc(o,r,e[n],e)});return _l(i.prototype,{clear:function(){for(var e=Iy(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[U_]=0},delete:function(e){var r=Iy(this,t),n=F_(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[U_]--}return!!n},forEach:function(e){Iy(this,t);for(var r,n=Ou(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!F_(Iy(this,t),e)}}),vu&&x_(i.prototype,"size",{get:function(){return Iy(this,t)[U_]}}),i},def:function(e,t,r){var n,i,o=F_(e,t);return o?o.v=r:(e._l=o={i:i=L_(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[U_]++,"F"!==i&&(e._i[i]=o)),e},getEntry:F_,setStrong:function(e,t,r){kc(e,t,function(e,r){this._t=Iy(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?Ac(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,Ac(1))},r?"entries":"values",!r,!0),bl(t)}},q_=(Gy("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=G_.getEntry(Iy(this,"Map"),e);return t&&t.v},set:function(e,t){return G_.def(Iy(this,"Map"),0===e?0:e,t)}},G_,!0),function(e){return function(){if(Gc(this)!=e)throw TypeError(e+"#toJSON isn't generic");return Xc(this,!1,(r=[]).push,r,t),r;var t,r}});Cu(Cu.P+Cu.R,"Map",{toJSON:q_("Map")}),qy("Map"),Vy("Map");var V_=Tu.Map,B_=r(function(e){e.exports={default:V_,__esModule:!0}});t(B_);var z_=function(e){return"function"==typeof e?e:Cv};var H_=function(e,t){return Lv(Iv(e,t,Cv),e+"")},W_=Fp&&new Fp,Y_=W_?function(e,t){return W_.set(e,t),e}:Cv;var X_=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Oh(e.prototype),n=e.apply(r,t);return Uf(n)?n:r}},J_=1;var K_=function(e,t,r){var n=t&J_,i=X_(e);return function t(){return(this&&this!==Of&&this instanceof t?i:e).apply(n?r:this,arguments)}},$_=Math.max;var Q_=function(e,t,r,n){for(var i=-1,o=e.length,a=r.length,s=-1,u=t.length,c=$_(o-a,0),l=Array(u+c),f=!n;++s<u;)l[s]=t[s];for(;++i<a;)(f||i<o)&&(l[r[i]]=e[i]);for(;c--;)l[s++]=e[i++];return l},Z_=Math.max;var eE=function(e,t,r,n){for(var i=-1,o=e.length,a=-1,s=r.length,u=-1,c=t.length,l=Z_(o-s,0),f=Array(l+c),d=!n;++i<l;)f[i]=e[i];for(var p=i;++u<c;)f[p+u]=t[u];for(;++a<s;)(d||i<o)&&(f[p+r[a]]=e[i++]);return f};var tE=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n};var rE=function(){},nE=4294967295;function iE(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=nE,this.__views__=[]}iE.prototype=Oh(rE.prototype),iE.prototype.constructor=iE;var oE=iE;var aE=function(){},sE=W_?function(e){return W_.get(e)}:aE,uE={},cE=Object.prototype.hasOwnProperty;var lE=function(e){for(var t=e.name+"",r=uE[t],n=cE.call(uE,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t};function fE(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}fE.prototype=Oh(rE.prototype),fE.prototype.constructor=fE;var dE=fE;var pE=function(e){if(e instanceof oE)return e.clone();var t=new dE(e.__wrapped__,e.__chain__);return t.__actions__=Sp(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t},hE=Object.prototype.hasOwnProperty;function vE(e){if(Ud(e)&&!Hd(e)&&!(e instanceof oE)){if(e instanceof dE)return e;if(hE.call(e,"__wrapped__"))return pE(e)}return new dE(e)}vE.prototype=rE.prototype,vE.prototype.constructor=vE;var gE=vE;var mE=function(e){var t=lE(e),r=gE[t];if("function"!=typeof r||!(t in oE.prototype))return!1;if(e===r)return!0;var n=sE(r);return!!n&&e===n[0]},yE=xv(Y_),_E=/\{\n\/\* \[wrapped with (.+)\] \*/,EE=/,? & /;var bE=function(e){var t=e.match(_E);return t?t[1].split(EE):[]},SE=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;var TE=function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(SE,"{\n/* [wrapped with "+t+"] */\n")};var wE=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1};var OE=function(e){return e!=e};var kE=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1};var RE=function(e,t,r){return t==t?kE(e,t,r):wE(e,OE,r)};var AE=function(e,t){return!(null==e||!e.length)&&RE(e,t,0)>-1},IE=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];var PE=function(e,t){return Cd(IE,function(r){var n="_."+r[0];t&r[1]&&!AE(e,n)&&e.push(n)}),e.sort()};var CE=function(e,t,r){var n=t+"";return Lv(e,TE(n,PE(bE(n),r)))},ME=1,NE=2,DE=4,jE=8,xE=32,LE=64;var UE=function(e,t,r,n,i,o,a,s,u,c){var l=t&jE;t|=l?xE:LE,(t&=~(l?LE:xE))&DE||(t&=~(ME|NE));var f=[e,t,i,l?o:void 0,l?a:void 0,l?void 0:o,l?void 0:a,s,u,c],d=r.apply(void 0,f);return mE(e)&&yE(d,f),d.placeholder=n,CE(d,e,t)};var FE=function(e){return e.placeholder},GE=Math.min;var qE=function(e,t){for(var r=e.length,n=GE(t.length,r),i=Sp(e);n--;){var o=t[n];e[n]=Kd(o,r)?i[o]:void 0}return e},VE="__lodash_placeholder__";var BE=function(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var a=e[r];a!==t&&a!==VE||(e[r]=VE,o[i++]=r)}return o},zE=1,HE=2,WE=8,YE=16,XE=128,JE=512;var KE=function e(t,r,n,i,o,a,s,u,c,l){var f=r&XE,d=r&zE,p=r&HE,h=r&(WE|YE),v=r&JE,g=p?void 0:X_(t);return function m(){for(var y=arguments.length,_=Array(y),E=y;E--;)_[E]=arguments[E];if(h)var b=FE(m),S=tE(_,b);if(i&&(_=Q_(_,i,o,h)),a&&(_=eE(_,a,s,h)),y-=S,h&&y<l){var T=BE(_,b);return UE(t,r,e,m.placeholder,n,_,T,u,c,l-y)}var w=d?n:this,O=p?w[t]:t;return y=_.length,u?_=qE(_,u):v&&y>1&&_.reverse(),f&&c<y&&(_.length=c),this&&this!==Of&&this instanceof m&&(O=g||X_(O)),O.apply(w,_)}};var $E=function(e,t,r){var n=X_(e);return function i(){for(var o=arguments.length,a=Array(o),s=o,u=FE(i);s--;)a[s]=arguments[s];var c=o<3&&a[0]!==u&&a[o-1]!==u?[]:BE(a,u);return(o-=c.length)<r?UE(e,t,KE,i.placeholder,void 0,a,c,void 0,void 0,r-o):Rv(this&&this!==Of&&this instanceof i?n:e,this,a)}},QE=1;var ZE=function(e,t,r,n){var i=t&QE,o=X_(e);return function t(){for(var a=-1,s=arguments.length,u=-1,c=n.length,l=Array(c+s),f=this&&this!==Of&&this instanceof t?o:e;++u<c;)l[u]=n[u];for(;s--;)l[u++]=arguments[++a];return Rv(f,i?r:this,l)}},eb="__lodash_placeholder__",tb=1,rb=2,nb=4,ib=8,ob=128,ab=256,sb=Math.min;var ub=function(e,t){var r=e[1],n=t[1],i=r|n,o=i<(tb|rb|ob),a=n==ob&&r==ib||n==ob&&r==ab&&e[7].length<=t[8]||n==(ob|ab)&&t[7].length<=t[8]&&r==ib;if(!o&&!a)return e;n&tb&&(e[2]=t[2],i|=r&tb?0:nb);var s=t[3];if(s){var u=e[3];e[3]=u?Q_(u,s,t[4]):s,e[4]=u?BE(e[3],eb):t[4]}return(s=t[5])&&(u=e[5],e[5]=u?eE(u,s,t[6]):s,e[6]=u?BE(e[5],eb):t[6]),(s=t[7])&&(e[7]=s),n&ob&&(e[8]=null==e[8]?t[8]:sb(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e},cb=NaN,lb=/^\s+|\s+$/g,fb=/^[-+]0x[0-9a-f]+$/i,db=/^0b[01]+$/i,pb=/^0o[0-7]+$/i,hb=parseInt;var vb=function(e){if("number"==typeof e)return e;if(Hh(e))return cb;if(Uf(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Uf(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(lb,"");var r=db.test(e);return r||pb.test(e)?hb(e.slice(2),r?2:8):fb.test(e)?cb:+e},gb=1/0,mb=1.7976931348623157e308;var yb=function(e){return e?(e=vb(e))===gb||e===-gb?(e<0?-1:1)*mb:e==e?e:0:0===e?e:0};var _b=function(e){var t=yb(e),r=t%1;return t==t?r?t-r:t:0},Eb="Expected a function",bb=1,Sb=2,Tb=8,wb=16,Ob=32,kb=64,Rb=Math.max;var Ab=function(e,t,r,n,i,o,a,s){var u=t&Sb;if(!u&&"function"!=typeof e)throw new TypeError(Eb);var c=n?n.length:0;if(c||(t&=~(Ob|kb),n=i=void 0),a=void 0===a?a:Rb(_b(a),0),s=void 0===s?s:_b(s),c-=i?i.length:0,t&kb){var l=n,f=i;n=i=void 0}var d=u?void 0:sE(e),p=[e,t,r,n,i,l,f,o,a,s];if(d&&ub(p,d),e=p[0],t=p[1],r=p[2],n=p[3],i=p[4],!(s=p[9]=void 0===p[9]?u?0:e.length:Rb(p[9]-c,0))&&t&(Tb|wb)&&(t&=~(Tb|wb)),t&&t!=bb)h=t==Tb||t==wb?$E(e,t,s):t!=Ob&&t!=(bb|Ob)||i.length?KE.apply(void 0,p):ZE(e,t,r,n);else var h=K_(e,t,r);return CE((d?Y_:yE)(h,p),e,t)},Ib=H_(function(e,t){var r=BE(t,FE(Ib));return Ab(e,32,void 0,t,r)});Ib.placeholder={};var Pb=Ib;var Cb=function(e,t){return Pb(z_(t),e)},Mb=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=c(j_),n=c(Xl),i=c(nf),o=c(B_),a=c(zy),s=c(Cb);t.default=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];if(3===t.length)return(0,i.default)(f,null,t);var a=t[0]||{},u=a.cacheFailures,c=a.cacheSuccesses,l=a.keyFactory;return f;function f(e,t,o){var a=t;return o.value=(0,s.default)(o.value,function(t){for(var r=this,o=a,s=arguments.length,f=Array(s>1?s-1:0),p=1;p<s;p++)f[p-1]=arguments[p];l&&(o=o+"_"+l.apply(void 0,f));var h=d.get(this,e,o);return h||(h=(0,i.default)(t,this,f),!u&&h&&h.catch&&(h=h.catch(function(t){return d.delete(r,e,o),n.default.reject(t)})),!c&&h&&h.then&&(h=h.then(function(t){return d.delete(r,e,o),t})),d.set(this,e,o,h),h)}),"object"!==(void 0===e?"undefined":(0,r.default)(e))||e.prototype||(e[t]=o.value),o}};var u=c(Hy);function c(e){return e&&e.__esModule?e:{default:e}}var l=a.default,f=o.default,d=new((0,u.default)(l,f,f))});t(Mb);var Nb=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={email:/^[^\s]+?@[^\s]+?$/,uuid:/^[a-f\d]{8}(?:-[a-f\d]{4}){3}-[a-f\d]{12}$/,execEmail:/[^\s]+?@[^\s]+?/,execUuid:/[a-f\d]{8}(?:-[a-f\d]{4}){3}-[a-f\d]{12}/}});t(Nb);var Db=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(nf),n=i(Hd);function i(e){return e&&e.__esModule?e:{default:e}}t.proxyEvents=function(e,t){return["on","once"].forEach(function(r){t[r]=function(){return e[r].apply(e,arguments),t}}),e},t.transferEvents=function(e,t,i){(e=(0,n.default)(e)?e:[e]).forEach(function(e){t.on&&t.on(e,function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return function(e){var t=e.trigger||e.emit;if(!t)throw new Error("count not determine emit method");for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return(0,r.default)(t,e,i)}.apply(void 0,[i,e].concat(n))})})}});t(Db);Db.proxyEvents,Db.transferEvents;var jb=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=Xl)&&r.__esModule?r:{default:r};t.default=function(e){return function(){return n.default.resolve(e)}}});t(jb);var xb=function(e,t,r){if(!Uf(r))return!1;var n=typeof t;return!!("number"==n?pp(r)&&Kd(t,r.length):"string"==n&&t in r)&&lf(r[t],e)},Lb=Object.prototype,Ub=Lb.hasOwnProperty,Fb=H_(function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&xb(t[0],t[1],i)&&(n=1);++r<n;)for(var o=t[r],a=_p(o),s=-1,u=a.length;++s<u;){var c=a[s],l=e[c];(void 0===l||lf(l,Lb[c])&&!Ub.call(e,c))&&(e[c]=o[c])}return e});function Gb(){}function qb(){qb.init.call(this)}function Vb(e){return void 0===e._maxListeners?qb.defaultMaxListeners:e._maxListeners}function Bb(e,t,r,n){var i,o,a,s;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]):(o=e._events=new Gb,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),!a.warned&&(i=Vb(e))&&i>0&&a.length>i){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,"function"==typeof console.warn?console.warn(s):console.log(s)}}else a=o[t]=r,++e._eventsCount;return e}function zb(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}function Hb(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function Wb(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function Yb(e){Error.call(this,e),this.message=e}function Xb(e){Error.call(this,e),this.message=e}Gb.prototype=Object.create(null),qb.EventEmitter=qb,qb.usingDomains=!1,qb.prototype.domain=void 0,qb.prototype._events=void 0,qb.prototype._maxListeners=void 0,qb.defaultMaxListeners=10,qb.init=function(){this.domain=null,qb.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Gb,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},qb.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},qb.prototype.getMaxListeners=function(){return Vb(this)},qb.prototype.emit=function(e){var t,r,n,i,o,a,s,u="error"===e;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(r=a[e]))return!1;var l="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,i=Wb(e,n),o=0;o<n;++o)i[o].call(r)}(r,l,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,o=Wb(e,i),a=0;a<i;++a)o[a].call(r,n)}(r,l,this,arguments[1]);break;case 3:!function(e,t,r,n,i){if(t)e.call(r,n,i);else for(var o=e.length,a=Wb(e,o),s=0;s<o;++s)a[s].call(r,n,i)}(r,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,i,o){if(t)e.call(r,n,i,o);else for(var a=e.length,s=Wb(e,a),u=0;u<a;++u)s[u].call(r,n,i,o)}(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),o=1;o<n;o++)i[o-1]=arguments[o];!function(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,o=Wb(e,i),a=0;a<i;++a)o[a].apply(r,n)}(r,l,this,i)}return!0},qb.prototype.addListener=function(e,t){return Bb(this,e,t,!1)},qb.prototype.on=qb.prototype.addListener,qb.prototype.prependListener=function(e,t){return Bb(this,e,t,!0)},qb.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,zb(this,e,t)),this},qb.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,zb(this,e,t)),this},qb.prototype.removeListener=function(e,t){var r,n,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new Gb:(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length;o-- >0;)if(r[o]===t||r[o].listener&&r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new Gb,this;delete n[e]}else!function(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}(r,i);n.removeListener&&this.emit("removeListener",e,a||t)}return this},qb.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new Gb,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new Gb:delete r[e]),this;if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new Gb,this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},qb.prototype.listeners=function(e){var t,r=this._events;return r&&(t=r[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(t):[]},qb.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Hb.call(e,t)},qb.prototype.listenerCount=Hb,qb.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]},Ym.inherits(Yb,Error),Yb.prototype.name="IllegalArgumentError",Ym.inherits(Xb,Error),Xb.prototype.name="IllegalStateError";var Jb={IllegalStateError:Xb,IllegalArgumentError:Yb},Kb=r(function(e){var t=e.exports=Jb;function r(e,t,r,n){r=r||"";var i=new e(Ym.format.apply(this,[r].concat(n)));throw Error.captureStackTrace(i,t),i}function n(e,n,i){r(t.IllegalArgumentError,e,n,i)}function i(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array"}return t}function o(e){return function(t,r){var o=i(t);if(o==e)return t;n(arguments.callee,r||'Expected "'+e+'" but got "'+o+'".',Array.prototype.slice.call(arguments,2))}}e.exports.checkArgument=function(e,t){e||n(arguments.callee,t,Array.prototype.slice.call(arguments,2))},e.exports.checkState=function(e,n){e||function(e,n,i){r(t.IllegalStateError,e,n,i)}(arguments.callee,n,Array.prototype.slice.call(arguments,2))},e.exports.checkIsDef=function(e,t){if(void 0!==e)return e;n(arguments.callee,t||"Expected value to be defined but was undefined.",Array.prototype.slice.call(arguments,2))},e.exports.checkIsDefAndNotNull=function(e,t){if(null!=e)return e;n(arguments.callee,t||'Expected value to be defined and not null but got "'+i(e)+'".',Array.prototype.slice.call(arguments,2))},e.exports.checkIsString=o("string"),e.exports.checkIsArray=o("array"),e.exports.checkIsNumber=o("number"),e.exports.checkIsBoolean=o("boolean"),e.exports.checkIsFunction=o("function"),e.exports.checkIsObject=o("object")}),$b=(Kb.checkArgument,Kb.checkState,Kb.checkIsDef,Kb.checkIsDefAndNotNull,Kb.checkIsString,Kb.checkIsArray,Kb.checkIsNumber,Kb.checkIsBoolean,Kb.checkIsFunction,Kb.checkIsObject,Kb);function Qb(e){qb.EventEmitter.call(this),this.backoffStrategy_=e,this.maxNumberOfRetry_=-1,this.backoffNumber_=0,this.backoffDelay_=0,this.timeoutID_=-1,this.handlers={backoff:this.onBackoff_.bind(this)}}Ym.inherits(Qb,qb.EventEmitter),Qb.prototype.failAfter=function(e){$b.checkArgument(e>0,"Expected a maximum number of retry greater than 0 but got %s.",e),this.maxNumberOfRetry_=e},Qb.prototype.backoff=function(e){$b.checkState(-1===this.timeoutID_,"Backoff in progress."),this.backoffNumber_===this.maxNumberOfRetry_?(this.emit("fail",e),this.reset()):(this.backoffDelay_=this.backoffStrategy_.next(),this.timeoutID_=setTimeout(this.handlers.backoff,this.backoffDelay_),this.emit("backoff",this.backoffNumber_,this.backoffDelay_,e))},Qb.prototype.onBackoff_=function(){this.timeoutID_=-1,this.emit("ready",this.backoffNumber_,this.backoffDelay_),this.backoffNumber_++},Qb.prototype.reset=function(){this.backoffNumber_=0,this.backoffStrategy_.reset(),clearTimeout(this.timeoutID_),this.timeoutID_=-1};var Zb=Qb;function eS(e){return null!=e}function tS(e){if(eS((e=e||{}).initialDelay)&&e.initialDelay<1)throw new Error("The initial timeout must be greater than 0.");if(eS(e.maxDelay)&&e.maxDelay<1)throw new Error("The maximal timeout must be greater than 0.");if(this.initialDelay_=e.initialDelay||100,this.maxDelay_=e.maxDelay||1e4,this.maxDelay_<=this.initialDelay_)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");if(eS(e.randomisationFactor)&&(e.randomisationFactor<0||e.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");this.randomisationFactor_=e.randomisationFactor||0}tS.prototype.getMaxDelay=function(){return this.maxDelay_},tS.prototype.getInitialDelay=function(){return this.initialDelay_},tS.prototype.next=function(){var e=this.next_(),t=1+Math.random()*this.randomisationFactor_;return Math.round(e*t)},tS.prototype.next_=function(){throw new Error("BackoffStrategy.next_() unimplemented.")},tS.prototype.reset=function(){this.reset_()},tS.prototype.reset_=function(){throw new Error("BackoffStrategy.reset_() unimplemented.")};var rS=tS;function nS(e){rS.call(this,e),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay(),this.factor_=nS.DEFAULT_FACTOR,e&&void 0!==e.factor&&($b.checkArgument(e.factor>1,"Exponential factor should be greater than 1 but got %s.",e.factor),this.factor_=e.factor)}Ym.inherits(nS,rS),nS.DEFAULT_FACTOR=2,nS.prototype.next_=function(){return this.backoffDelay_=Math.min(this.nextBackoffDelay_,this.getMaxDelay()),this.nextBackoffDelay_=this.backoffDelay_*this.factor_,this.backoffDelay_},nS.prototype.reset_=function(){this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()};var iS=nS;function oS(e){rS.call(this,e),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}Ym.inherits(oS,rS),oS.prototype.next_=function(){var e=Math.min(this.nextBackoffDelay_,this.getMaxDelay());return this.nextBackoffDelay_+=this.backoffDelay_,this.backoffDelay_=e,e},oS.prototype.reset_=function(){this.nextBackoffDelay_=this.getInitialDelay(),this.backoffDelay_=0};var aS=oS;function sS(e,t,r){qb.EventEmitter.call(this),$b.checkIsFunction(e,"Expected fn to be a function."),$b.checkIsArray(t,"Expected args to be an array."),$b.checkIsFunction(r,"Expected callback to be a function."),this.function_=e,this.arguments_=t,this.callback_=r,this.lastResult_=[],this.numRetries_=0,this.backoff_=null,this.strategy_=null,this.failAfter_=-1,this.retryPredicate_=sS.DEFAULT_RETRY_PREDICATE_,this.state_=sS.State_.PENDING}Ym.inherits(sS,qb.EventEmitter),sS.State_={PENDING:0,RUNNING:1,COMPLETED:2,ABORTED:3},sS.DEFAULT_RETRY_PREDICATE_=function(e){return!0},sS.prototype.isPending=function(){return this.state_==sS.State_.PENDING},sS.prototype.isRunning=function(){return this.state_==sS.State_.RUNNING},sS.prototype.isCompleted=function(){return this.state_==sS.State_.COMPLETED},sS.prototype.isAborted=function(){return this.state_==sS.State_.ABORTED},sS.prototype.setStrategy=function(e){return $b.checkState(this.isPending(),"FunctionCall in progress."),this.strategy_=e,this},sS.prototype.retryIf=function(e){return $b.checkState(this.isPending(),"FunctionCall in progress."),this.retryPredicate_=e,this},sS.prototype.getLastResult=function(){return this.lastResult_.concat()},sS.prototype.getNumRetries=function(){return this.numRetries_},sS.prototype.failAfter=function(e){return $b.checkState(this.isPending(),"FunctionCall in progress."),this.failAfter_=e,this},sS.prototype.abort=function(){this.isCompleted()||this.isAborted()||(this.isRunning()&&this.backoff_.reset(),this.state_=sS.State_.ABORTED,this.lastResult_=[new Error("Backoff aborted.")],this.emit("abort"),this.doCallback_())},sS.prototype.start=function(e){$b.checkState(!this.isAborted(),"FunctionCall is aborted."),$b.checkState(this.isPending(),"FunctionCall already started.");var t=this.strategy_||new aS;this.backoff_=e?e(t):new Zb(t),this.backoff_.on("ready",this.doCall_.bind(this,!0)),this.backoff_.on("fail",this.doCallback_.bind(this)),this.backoff_.on("backoff",this.handleBackoff_.bind(this)),this.failAfter_>0&&this.backoff_.failAfter(this.failAfter_),this.state_=sS.State_.RUNNING,this.doCall_(!1)},sS.prototype.doCall_=function(e){e&&this.numRetries_++;var t=["call"].concat(this.arguments_);qb.EventEmitter.prototype.emit.apply(this,t);var r=this.handleFunctionCallback_.bind(this);this.function_.apply(null,this.arguments_.concat(r))},sS.prototype.doCallback_=function(){this.callback_.apply(null,this.lastResult_)},sS.prototype.handleFunctionCallback_=function(){if(!this.isAborted()){var e=Array.prototype.slice.call(arguments);this.lastResult_=e,qb.EventEmitter.prototype.emit.apply(this,["callback"].concat(e));var t=e[0];t&&this.retryPredicate_(t)?this.backoff_.backoff(t):(this.state_=sS.State_.COMPLETED,this.doCallback_())}},sS.prototype.handleBackoff_=function(e,t,r){this.emit("backoff",e,t,r)};var uS=sS,cS={Backoff:Zb,FunctionCall:uS,FibonacciStrategy:aS,ExponentialStrategy:iS,fibonacci:function(e){return new Zb(new aS(e))},exponential:function(e){return new Zb(new iS(e))},call:function(e,t,r){var n=Array.prototype.slice.call(arguments);return e=n[0],t=n.slice(1,n.length-1),r=n[n.length-1],new uS(e,t,r)}},lS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(j_),n=l(Xl),i=l(nf),o=l(Zl),a=l(Cb),s=l(zf),u=l(Fb);t.default=function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];var f=t[0]||{};f=(0,o.default)({},f),(0,u.default)(f,{backoff:!0,delay:1,maxAttempts:3});var d=void 0;d=f.backoff?{initialDelay:f.delay,maxDelay:f.maxDelay}:{initialDelay:1,maxDelay:1};if(3===t.length)return(0,i.default)(p,null,t);return p;function p(e,t,o){return o.value=(0,a.default)(o.value,function(e){for(var t=this,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];var u=new qb.EventEmitter,l=new n.default(function(r,n){var a=c.default.call(function(r){var n=(0,i.default)(e,t,o);return(0,s.default)(n.on)&&(n.on("progress",u.emit.bind(u,"progress")),n.on("upload-progress",u.emit.bind(u,"upload-progress")),n.on("download-progress",u.emit.bind(u,"download-progress"))),n.then(function(e){r(null,e)}).catch(function(e){e||(e=new Error("retryable method failed without providing an error object")),r(e)})},function(e,t){return e?n(e):r(t)});a.setStrategy(new c.default.ExponentialStrategy(d)),f.maxAttempts&&a.failAfter(f.maxAttempts-1),a.start()});return l.on=function(e,t){return u.on(e,t),l},l}),"object"!==(void 0===e?"undefined":(0,r.default)(e))||e.prototype||(e[t]=o.value),o}};var c=l(cS);function l(e){return e&&e.__esModule?e:{default:e}}});t(lS);var fS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=Xl)&&r.__esModule?r:{default:r};t.default=function(e){return function(t){return new n.default(function(r){r(e(t))}).then(function(){return t}).catch(function(){return t})}}});t(fS);var dS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(nf),n=a(Xl),i=a(Cb);t.default=function(e){return function(t,a,s){s.value=(0,i.default)(s.value,function(t){for(var i=this,a=arguments.length,s=Array(a>1?a-1:0),u=1;u<a;u++)s[u-1]=arguments[u];return new n.default(function(a){i[e]=!0,a((0,r.default)(t,i,s).then((0,o.default)(function(){i[e]=!1})).catch(function(t){return i[e]=!1,n.default.reject(t)}))})})}};var o=a(fS);function a(e){return e&&e.__esModule?e:{default:e}}});t(dS),Cu(Cu.S,"Object",{create:pc});var pS=Tu.Object,hS=function(e,t){return pS.create(e,t)},vS=r(function(e){e.exports={default:hS,__esModule:!0}});t(vS);var gS=function(e,t){if(ku(e),!lu(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},mS={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=Ou(Function.call,Su.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return gS(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:gS};Cu(Cu.S,"Object",{setPrototypeOf:mS.set});var yS=Tu.Object.setPrototypeOf,_S=r(function(e){e.exports={default:yS,__esModule:!0}});t(_S);var ES=function(e,t,r){t in e?Au.f(e,t,cu(0,r)):e[t]=r};Cu(Cu.S+Cu.F*!Al(function(e){}),"Array",{from:function(e){var t,r,n,i,o=_c(e),a="function"==typeof this?this:Array,s=arguments.length,u=s>1?arguments[1]:void 0,c=void 0!==u,l=0,f=Yc(o);if(c&&(u=Ou(u,s>2?arguments[2]:void 0,2)),null==f||a==Array&&Hc(f))for(r=new a(t=Yu(o.length));t>l;l++)ES(r,l,c?u(o[l],l):o[l]);else for(i=f.call(o),r=new a;!(n=i.next()).done;l++)ES(r,l,c?Vc(i,u,[n.value,l],!0):n.value);return r.length=l,r}});var bS=Tu.Array.from,SS=r(function(e){e.exports={default:bS,__esModule:!0}});t(SS);var TS=[].slice,wS={},OS=Function.bind||function(e){var t=wu(this),r=TS.call(arguments,1),n=function(){var i=r.concat(TS.call(arguments));return this instanceof n?function(e,t,r){if(!(t in wS)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";wS[t]=Function("F,a","return new F("+n.join(",")+")")}return wS[t](e,r)}(t,i.length,i):$c(t,i,e)};return lu(t.prototype)&&(n.prototype=t.prototype),n},kS=(gu.Reflect||{}).construct,RS=hu(function(){function e(){}return!(kS(function(){},[],e)instanceof e)}),AS=!hu(function(){kS(function(){})});Cu(Cu.S+Cu.F*(RS||AS),"Reflect",{construct:function(e,t){wu(e),ku(t);var r=arguments.length<3?e:wu(arguments[2]);if(AS&&!RS)return kS(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(OS.apply(e,n))}var i=r.prototype,o=pc(lu(i)?i:Object.prototype),a=Function.apply.call(e,o,t);return lu(a)?a:o}});var IS=Tu.Reflect.construct,PS=r(function(e){e.exports={default:IS,__esModule:!0}});t(PS),Mu("getPrototypeOf",function(){return function(e){return Sc(_c(e))}});var CS=Tu.Object.getPrototypeOf,MS=r(function(e){e.exports={default:CS,__esModule:!0}});t(MS);var NS=r(function(e,t){t.__esModule=!0;var r,n=(r=j_)&&r.__esModule?r:{default:r};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,n.default)(t))&&"function"!=typeof t?e:t}});t(NS);var DS=r(function(e,t){t.__esModule=!0;var r=o(_S),n=o(vS),i=o(j_);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,i.default)(t)));e.prototype=(0,n.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}});t(DS);var jS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i=p(vS),o=p(_S),a=p(SS),s=p(PS),u=p(MS),c=p(_y),l=p(Ty),f=p(NS),d=p(DS);function p(e){return e&&e.__esModule?e:{default:e}}var h=(n=r=function(e){function t(){var e;(0,c.default)(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=(0,f.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(n))),a=void 0;if(o.parse)a=o.parse.apply(o,n);else if(o.constructor.parse){var s;a=(s=o.constructor).parse.apply(s,n)}return a||(a=o.constructor.defaultMessage),o.name=o.constructor.name,o.message=a,o}return(0,d.default)(t,e),(0,l.default)(t,null,[{key:"parse",value:function(){return arguments.length<=0?void 0:arguments[0]}}]),t}(function(e){function t(){var t=(0,s.default)(e,(0,a.default)(arguments));return(0,o.default)(t,(0,u.default)(this)),t}return t.prototype=(0,i.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o.default?(0,o.default)(t,e):t.__proto__=e,t}(Error)),r.defaultMessage="An error occurred",n);t.default=h});t(jS);var xS=Object.defineProperty;function LS(e,t,r){var n=r.configurable,i=r.enumerable,o=r.initializer,a=r.value;return{configurable:n,enumerable:i,get:function(){if(this!==e){var r=o?o.call(this):a;return xS(this,t,{configurable:n,enumerable:i,writable:!0,value:r}),r}},set:oT(t)}}function US(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(LS,t)}var FS,GS,qS,VS,BS,zS,HS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function WS(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function YS(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function XS(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var JS=Object.defineProperty,KS=Object.getOwnPropertyDescriptor,$S=Object.getOwnPropertyNames,QS=Object.getOwnPropertySymbols;function ZS(e,t){return function(e){if(!e||!e.hasOwnProperty)return!1;for(var t=["value","initializer","get","set"],r=0,n=t.length;r<n;r++)if(e.hasOwnProperty(t[r]))return!0;return!1}(t[t.length-1])?e.apply(void 0,XS(t).concat([[]])):function(){return e.apply(void 0,XS(Array.prototype.slice.call(arguments)).concat([t]))}}var eT=(GS=YS((FS=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),WS(this,"debounceTimeoutIds",GS,this),WS(this,"throttleTimeoutIds",qS,this),WS(this,"throttlePreviousTimestamps",VS,this),WS(this,"throttleTrailingArgs",BS,this),WS(this,"profileLastRan",zS,this)}).prototype,"debounceTimeoutIds",[US],{enumerable:!0,initializer:function(){return{}}}),qS=YS(FS.prototype,"throttleTimeoutIds",[US],{enumerable:!0,initializer:function(){return{}}}),VS=YS(FS.prototype,"throttlePreviousTimestamps",[US],{enumerable:!0,initializer:function(){return{}}}),BS=YS(FS.prototype,"throttleTrailingArgs",[US],{enumerable:!0,initializer:function(){return null}}),zS=YS(FS.prototype,"profileLastRan",[US],{enumerable:!0,initializer:function(){return null}}),FS),tT="function"==typeof Symbol?Symbol("__core_decorators__"):"__core_decorators__";function rT(e){return!1===e.hasOwnProperty(tT)&&JS(e,tT,{value:new eT}),e[tT]}var nT=QS?function(e){return $S(e).concat(QS(e))}:$S;function iT(e){var t={};return nT(e).forEach(function(r){return t[r]=KS(e,r)}),t}function oT(e){return function(t){return Object.defineProperty(this,e,{configurable:!0,writable:!0,enumerable:!0,value:t}),t}}function aT(e,t){return e.bind?e.bind(t):function(){return e.apply(t,arguments)}}var sT="object"===("undefined"==typeof console?"undefined":HS(console))&&console&&"function"==typeof console.warn?aT(console.warn,console):function(){},uT={};function cT(e){!0!==uT[e]&&(uT[e]=!0,sT("DEPRECATION: "+e))}var lT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fT=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var dT=/^function ([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?(\([^\)]*\))[\s\S]+$/,pT=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentKlass=t,this.childKlass=r,this.parentDescriptor=n,this.childDescriptor=i}return fT(e,[{key:"_getTopic",value:function(e){return void 0===e?null:"value"in e?e.value:"get"in e?e.get:"set"in e?e.set:void 0}},{key:"_extractTopicSignature",value:function(e){switch(void 0===e?"undefined":lT(e)){case"function":return this._extractFunctionSignature(e);default:return this.key}}},{key:"_extractFunctionSignature",value:function(e){var t=this;return e.toString().replace(dT,function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.key)+arguments[2]})}},{key:"key",get:function(){return this.childDescriptor.key}},{key:"parentNotation",get:function(){return this.parentKlass.constructor.name+"#"+this.parentPropertySignature}},{key:"childNotation",get:function(){return this.childKlass.constructor.name+"#"+this.childPropertySignature}},{key:"parentTopic",get:function(){return this._getTopic(this.parentDescriptor)}},{key:"childTopic",get:function(){return this._getTopic(this.childDescriptor)}},{key:"parentPropertySignature",get:function(){return this._extractTopicSignature(this.parentTopic)}},{key:"childPropertySignature",get:function(){return this._extractTopicSignature(this.childTopic)}}]),fT(e,[{key:"assert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!0!==e&&this.error("{child} does not properly override {parent}"+t)}},{key:"error",value:function(e){var t=this;throw e=e.replace("{parent}",function(e){return t.parentNotation}).replace("{child}",function(e){return t.childNotation}),new SyntaxError(e)}}]),e}();function hT(e){return e.hasOwnProperty("value")?"data":e.hasOwnProperty("get")||e.hasOwnProperty("set")?"accessor":"data"}function vT(e,t,r){r.assert(e.length===t.length)}function gT(e,t,r){var n=hT(e),i=hT(t);switch(n!==i&&r.error('descriptor types do not match. {parent} is "'+n+'", {child} is "'+i+'"'),i){case"data":!function(e,t,r){var n=lT(e.value),i=lT(t.value);switch("undefined"===n&&"undefined"===i&&r.error("descriptor values are both undefined. (class properties are are not currently supported)'"),n!==i&&("function"===i&&void 0===n||void 0!==n)&&r.error('value types do not match. {parent} is "'+n+'", {child} is "'+i+'"'),i){case"function":vT(e.value,t.value,r);break;default:r.error('Unexpected error. Please file a bug with: {parent} is "'+n+'", {child} is "'+i+'"')}}(e,t,r);break;case"accessor":!function(e,t,r){var n="function"==typeof e.get,i="function"==typeof t.get,o="function"==typeof e.set,a="function"==typeof t.set;(n||i)&&(!n&&o&&r.error("{parent} is setter but {child} is getter"),!i&&a&&r.error("{parent} is getter but {child} is setter"),vT(e.get,t.get,r)),(o||a)&&(!o&&n&&r.error("{parent} is getter but {child} is setter"),!a&&i&&r.error("{parent} is setter but {child} is getter"),vT(e.set,t.set,r))}(e,t,r)}}var mT=[function(e){return e.toLowerCase()},function(e){return e.toUpperCase()},function(e){return e+"s"},function(e){return e.slice(0,-1)},function(e){return e.slice(1,e.length)}];function yT(e,t,r){r.key=t;var n=Object.getPrototypeOf(e),i=Object.getOwnPropertyDescriptor(n,t),o=new pT(n,e,i,r);if(void 0===i){var a=function(e,t){for(var r=0,n=mT.length;r<n;r++){var i=(0,mT[r])(t);if(i in e)return i}return null}(n,t),s=a?'\n\n  Did you mean "'+a+'"?':"";o.error("No descriptor matching {child} was found on the prototype chain."+s)}return gT(i,r,o),r}var _T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ET=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),bT="This function will be removed in future versions.";function ST(e,t,r,n){var i=ET(n,2),o=i[0],a=void 0===o?bT:o,s=i[1],u=void 0===s?{}:s;if("function"!=typeof r.value)throw new SyntaxError("Only functions can be marked as deprecated");var c=e.constructor.name+"#"+t;return u.url&&(a+="\n\n    See "+u.url+" for more details.\n\n"),_T({},r,{value:function(){return sT("DEPRECATION "+c+": "+a),r.value.apply(this,arguments)}})}function TT(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(ST,t)}var wT=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function kT(){}function RT(e,t,r){return wT({},r,{value:function(){return function(e,t,r){if("object"===("undefined"==typeof console?"undefined":OT(console))){var n=console.warn;console.warn=kT;var i=t.apply(e,r);return console.warn=n,i}return t.apply(e,r)}(this,r.value,arguments)}})}var AT=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function IT(e,t,r){var n=function(e){var t=void 0,r=void 0;return e.value?(t=e.value,r="value"):e.get?(t=e.get,r="get"):e.set&&(t=e.set,r="set"),{fn:t,wrapKey:r}}(r),i=n.fn,o=n.wrapKey,a=new WeakMap,s=Object.create(null),u=Object.create(null),c=0;return AT({},r,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},o,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n,o,l="0",f=0,d=t.length;f<d;f++){var p=t[f],h=(n=u,(o=p)===Object(o)?o:n[o]||(n[o]={})),v=a.get(h);void 0===v&&(v=++c,a.set(h,v)),l+=v}return s[l]||function(e,t,r,n,i){var o=t.apply(e,r);return n[i]=o,o}(this,i,arguments,s,l)}))}function PT(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var CT=Object.defineProperty,MT=Object.getPrototypeOf,NT=void 0;function DT(e,t,r){var n=r.value,i=r.configurable,o=r.enumerable;if("function"!=typeof n)throw new SyntaxError("@autobind can only be used on functions, not: "+n);var a=e.constructor;return{configurable:i,enumerable:o,get:function(){if(this===e)return n;if(this.constructor!==a&&MT(this).constructor===a)return n;if(this.constructor!==a&&t in this.constructor.prototype)return function(e,t){if("undefined"==typeof WeakMap)throw new Error("Using @autobind on "+t.name+"() requires WeakMap support due to its use of super."+t.name+"()\n      See https://github.com/jayphelps/core-decorators.js/issues/20");NT||(NT=new WeakMap),!1===NT.has(e)&&NT.set(e,new WeakMap);var r=NT.get(e);return!1===r.has(t)&&r.set(t,aT(t,e)),r.get(t)}(this,n);var r=aT(n,this);return CT(this,t,{configurable:!0,writable:!0,enumerable:!1,value:r}),r},set:oT(t)}}function jT(e){return 1===e.length?function(e){for(var t=iT(e.prototype),r=nT(t),n=0,i=r.length;n<i;n++){var o=r[n],a=t[o];"function"==typeof a.value&&"constructor"!==o&&CT(e.prototype,o,DT(e.prototype,o,a))}}.apply(void 0,PT(e)):DT.apply(void 0,PT(e))}function xT(e,t,r){return r.writable=!1,r}function LT(e,t,r){return r.enumerable=!0,r}function UT(e,t,r){return r.enumerable=!1,r}function FT(e,t,r){return r.configurable=!1,r}var GT=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qT=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),VT=300;function BT(e,t,r,n){var i=qT(n,2),o=i[0],a=void 0===o?VT:o,s=i[1],u=void 0!==s&&s,c=r.value;if("function"!=typeof c)throw new SyntaxError("Only functions can be debounced");return GT({},r,{value:function(){var e=this,r=rT(this).debounceTimeoutIds,n=r[t],i=u&&!n,o=arguments;clearTimeout(n),r[t]=setTimeout(function(){delete r[t],u||c.apply(e,o)},a),i&&c.apply(this,o)}})}var zT=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HT=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),WT=300;function YT(e,t,r,n){var i=HT(n,2),o=i[0],a=void 0===o?WT:o,s=i[1],u=void 0===s?{}:s,c=r.value;if("function"!=typeof c)throw new SyntaxError("Only functions can be throttled");return!1!==u.leading&&(u.leading=!0),!1!==u.trailing&&(u.trailing=!0),zT({},r,{value:function(){var e=this,r=rT(this),n=r.throttleTimeoutIds,i=r.throttlePreviousTimestamps,o=n[t],s=i[t]||0,l=Date.now();u.trailing&&(r.throttleTrailingArgs=arguments),s||!1!==u.leading||(s=l);var f=a-(l-s);f<=0?(clearTimeout(o),delete n[t],i[t]=l,c.apply(this,arguments)):!o&&u.trailing&&(n[t]=setTimeout(function(){i[t]=!1===u.leading?0:Date.now(),delete n[t],c.apply(e,r.throttleTrailingArgs),r.throttleTrailingArgs=null},f))}})}var XT=Object.defineProperty;function JT(e,t,r,n){var i,o=(i=n,Array.isArray(i)?i:Array.from(i)),a=o[0],s=o.slice(1),u=r.configurable,c=r.enumerable,l=r.writable,f=r.get,d=r.set,p=r.value,h=!!f;return{configurable:u,enumerable:c,get:function(){var e=h?f.call(this):p,r=a.call.apply(a,[this,e].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(s)));if(h)return r;var n={configurable:u,enumerable:c};return n.value=r,n.writable=l,XT(this,t,n),r},set:h?d:oT()}}var KT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$T=Object.defineProperty,QT=Object.getPrototypeOf;function ZT(e,t){if(r=e,"[object Symbol]"===Object.prototype.toString.call(r)&&"object"===(void 0===r?"undefined":KT(r))){do{if(t===Object.prototype)return void 0!==t[e];if(t.hasOwnProperty(e))return!0}while(t=QT(t));return!1}return e in t;var r}function ew(e,t){if(!t.length)throw new SyntaxError("@mixin() class "+e.name+" requires at least one mixin as an argument");for(var r=0,n=t.length;r<n;r++)for(var i=iT(t[r]),o=nT(i),a=0,s=o.length;a<s;a++){var u=o[a];ZT(u,e.prototype)||$T(e.prototype,u,i[u])}}function tw(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return cT("@mixin is deprecated and will be removed shortly. Use @mixin from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators"),"function"==typeof t[0]?ew(t[0],[]):function(e){return ew(e,t)}}var rw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nw=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),iw={},ow={time:console.time?console.time.bind(console):function(e){iw[e]=new Date},timeEnd:console.timeEnd?console.timeEnd.bind(console):function(e){var t=new Date-iw[e];delete iw[e],console.log(e+": "+t+"ms")}},aw=0;function sw(e,t,r,n){var i=nw(n,2),o=i[0],a=void 0===o?null:o,s=i[1],u=void 0===s?ow:s,c=r.value;if(null===a&&(a=e.constructor.name+"."+t),"function"!=typeof c)throw new SyntaxError("@time can only be used on functions, not: "+c);return rw({},r,{value:function(){var e=a+"-"+aw;aw++,u.time(e);try{return c.apply(this,arguments)}finally{u.timeEnd(e)}}})}var uw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cw=Object.getPrototypeOf,lw=Object.getOwnPropertyDescriptor;function fw(e,t,r){var n=cw(e),i=lw(n,t);return uw({},i,{value:r.value,initializer:r.initializer,get:r.get||i.get,set:r.set||i.set})}var dw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pw=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),hw={profile:console.profile?aT(console.profile,console):function(){},profileEnd:console.profileEnd?aT(console.profileEnd,console):function(){},warn:sT};function vw(e,t,r,n){var i=pw(n,3),o=i[0],a=void 0===o?null:o,s=i[1],u=void 0!==s&&s,c=i[2],l=void 0===c?hw:c;if(!gw.__enabled)return gw.__warned||(l.warn("console.profile is not supported. All @profile decorators are disabled."),gw.__warned=!0),r;var f=r.value;if(null===a&&(a=e.constructor.name+"."+t),"function"!=typeof f)throw new SyntaxError("@profile can only be used on functions, not: "+f);return dw({},r,{value:function(){var e=Date.now(),t=rT(this);(!0===u&&!t.profileLastRan||!1===u||"number"==typeof u&&e-t.profileLastRan>u||"function"==typeof u&&u.apply(this,arguments))&&(l.profile(a),t.profileLastRan=e);try{return f.apply(this,arguments)}finally{l.profileEnd(a)}}})}function gw(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(vw,t)}gw.__enabled=!!console.profile,gw.__warned=!1;var mw=Object.defineProperty,yw=Object.getOwnPropertyDescriptor;var _w=Object.freeze({override:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(yT,t)},deprecate:TT,deprecated:TT,suppressWarnings:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(RT,t)},memoize:function(){cT("@memoize is deprecated and will be removed shortly. Use @memoize from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators");for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(IT,t)},autobind:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(){return jT(arguments)}:jT(t)},readonly:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(xT,t)},enumerable:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(LT,t)},nonenumerable:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(UT,t)},nonconfigurable:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(FT,t)},debounce:function(){cT("@debounce is deprecated and will be removed shortly. Use @debounce from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators");for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(BT,t)},throttle:function(){cT("@throttle is deprecated and will be removed shortly. Use @throttle from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators");for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(YT,t)},decorate:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(JT,t)},mixin:tw,mixins:tw,lazyInitialize:US,time:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(sw,t)},extendDescriptor:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ZS(fw,t)},profile:gw,applyDecorators:function(e,t){var r=e.prototype;for(var n in t)for(var i=t[n],o=0,a=i.length;o<a;o++){var s=i[o];mw(r,n,s(r,n,yw(r,n)))}return e}}),Ew=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=_w.deprecated;t.default=r});t(Ew);var bw=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=!0});t(bw);var Sw=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=bw,e&&e.__esModule?e:{default:e}).default;var e}})});t(Sw);var Tw=r(function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"base64",{enumerable:!0,get:function(){return r(hy).default}}),Object.defineProperty(t,"cappedDebounce",{enumerable:!0,get:function(){return r(vy).default}}),Object.defineProperty(t,"checkRequired",{enumerable:!0,get:function(){return r(gy).default}}),Object.defineProperty(t,"Defer",{enumerable:!0,get:function(){return r(my).default}}),Object.defineProperty(t,"makeStateDataType",{enumerable:!0,get:function(){return r(yy).default}}),Object.defineProperty(t,"make",{enumerable:!0,get:function(){return r(Hy).default}}),Object.defineProperty(t,"oneFlight",{enumerable:!0,get:function(){return r(Mb).default}}),Object.defineProperty(t,"patterns",{enumerable:!0,get:function(){return r(Nb).default}}),Object.defineProperty(t,"proxyEvents",{enumerable:!0,get:function(){return Db.proxyEvents}}),Object.defineProperty(t,"transferEvents",{enumerable:!0,get:function(){return Db.transferEvents}}),Object.defineProperty(t,"resolveWith",{enumerable:!0,get:function(){return r(jb).default}}),Object.defineProperty(t,"retry",{enumerable:!0,get:function(){return r(lS).default}}),Object.defineProperty(t,"tap",{enumerable:!0,get:function(){return r(fS).default}}),Object.defineProperty(t,"whileInFlight",{enumerable:!0,get:function(){return r(dS).default}}),Object.defineProperty(t,"Exception",{enumerable:!0,get:function(){return r(jS).default}}),Object.defineProperty(t,"deprecated",{enumerable:!0,get:function(){return r(Ew).default}}),Object.defineProperty(t,"inBrowser",{enumerable:!0,get:function(){return r(Sw).default}})});t(Tw),Mu("keys",function(){return function(e){return ac(_c(e))}});var ww=Tu.Object.keys,Ow=r(function(e){e.exports={default:ww,__esModule:!0}});t(Ow);var kw=4;var Rw=function(e){return Bh(e,kw)},Aw=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.safeSetTimeout=function(){var e=setTimeout.apply(void 0,arguments);e.unref&&e.unref();return e},t.safeSetInterval=function(){var e=setInterval.apply(void 0,arguments);e.unref&&e.unref();return e}});t(Aw);Aw.safeSetTimeout,Aw.safeSetInterval;var Iw=0;var Pw=function(e){var t=++Iw;return av(e)+t};var Cw=function(e){return H_(function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&xb(r[0],r[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var s=r[n];s&&e(t,s,n,o)}return t})},Mw=Object.prototype.hasOwnProperty,Nw=Cw(function(e,t){if(up(t)||pp(t))xd(t,hp(t),e);else for(var r in t)Mw.call(t,r)&&jd(e,r,t[r])});var Dw=function(e){return function(t){return null==e?void 0:e[t]}},jw=Dw({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),xw=/[&<>"']/g,Lw=RegExp(xw.source);var Uw=function(e){return(e=av(e))&&Lw.test(e)?e.replace(xw,jw):e};var Fw=function(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var u=a[e?s:++i];if(!1===r(o[u],u,o))break}return t}},Gw=Fw();var qw=function(e,t){return e&&Gw(e,t,hp)};var Vw=function(e,t){return e&&qw(e,z_(t))},Bw="[object String]";var zw=function(e){return"string"==typeof e||!Hd(e)&&Ud(e)&&Lf(e)==Bw};var Hw=function(e,t){return uf(t,function(t){return e[t]})};var Ww=function(e){return null==e?[]:Hw(e,hp(e))},Yw=Math.max;var Xw=function(e,t,r,n){e=pp(e)?e:Ww(e),r=r&&!n?_b(r):0;var i=e.length;return r<0&&(r=Yw(i+r,0)),zw(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&RE(e,t,r)>-1},Jw="[object Date]";var Kw=function(e){return Ud(e)&&Lf(e)==Jw},$w=rp&&rp.isDate,Qw=$w?tp($w):Kw,Zw="__lodash_hash_undefined__";var eO=function(e){return this.__data__.set(e,Zw),this};var tO=function(e){return this.__data__.has(e)};function rO(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new kd;++t<r;)this.add(e[t])}rO.prototype.add=rO.prototype.push=eO,rO.prototype.has=tO;var nO=rO;var iO=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var oO=function(e,t){return e.has(t)},aO=1,sO=2;var uO=function(e,t,r,n,i,o){var a=r&aO,s=e.length,u=t.length;if(s!=u&&!(a&&u>s))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var l=-1,f=!0,d=r&sO?new nO:void 0;for(o.set(e,t),o.set(t,e);++l<s;){var p=e[l],h=t[l];if(n)var v=a?n(h,p,l,t,e,o):n(p,h,l,e,t,o);if(void 0!==v){if(v)continue;f=!1;break}if(d){if(!iO(t,function(e,t){if(!oO(d,t)&&(p===e||i(p,e,r,n,o)))return d.push(t)})){f=!1;break}}else if(p!==h&&!i(p,h,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f};var cO=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r};var lO=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r},fO=1,dO=2,pO="[object Boolean]",hO="[object Date]",vO="[object Error]",gO="[object Map]",mO="[object Number]",yO="[object RegExp]",_O="[object Set]",EO="[object String]",bO="[object Symbol]",SO="[object ArrayBuffer]",TO="[object DataView]",wO=kf?kf.prototype:void 0,OO=wO?wO.valueOf:void 0;var kO=function(e,t,r,n,i,o,a){switch(r){case TO:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case SO:return!(e.byteLength!=t.byteLength||!o(new Jp(e),new Jp(t)));case pO:case hO:case mO:return lf(+e,+t);case vO:return e.name==t.name&&e.message==t.message;case yO:case EO:return e==t+"";case gO:var s=cO;case _O:var u=n&fO;if(s||(s=lO),e.size!=t.size&&!u)return!1;var c=a.get(e);if(c)return c==t;n|=dO,a.set(e,t);var l=uO(s(e),s(t),n,i,o,a);return a.delete(e),l;case bO:if(OO)return OO.call(e)==OO.call(t)}return!1},RO=1,AO=Object.prototype.hasOwnProperty;var IO=function(e,t,r,n,i,o){var a=r&RO,s=Dp(e),u=s.length;if(u!=Dp(t).length&&!a)return!1;for(var c=u;c--;){var l=s[c];if(!(a?l in t:AO.call(t,l)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var d=!0;o.set(e,t),o.set(t,e);for(var p=a;++c<u;){var h=e[l=s[c]],v=t[l];if(n)var g=a?n(v,h,l,t,e,o):n(h,v,l,e,t,o);if(!(void 0===g?h===v||i(h,v,r,n,o):g)){d=!1;break}p||(p="constructor"==l)}if(d&&!p){var m=e.constructor,y=t.constructor;m!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof m&&m instanceof m&&"function"==typeof y&&y instanceof y)&&(d=!1)}return o.delete(e),o.delete(t),d},PO=1,CO="[object Arguments]",MO="[object Array]",NO="[object Object]",DO=Object.prototype.hasOwnProperty;var jO=function(e,t,r,n,i,o){var a=Hd(e),s=Hd(t),u=a?MO:Wp(e),c=s?MO:Wp(t),l=(u=u==CO?NO:u)==NO,f=(c=c==CO?NO:c)==NO,d=u==c;if(d&&Yd(e)){if(!Yd(t))return!1;a=!0,l=!1}if(d&&!l)return o||(o=new Pd),a||ip(e)?uO(e,t,r,n,i,o):kO(e,t,u,r,n,i,o);if(!(r&PO)){var p=l&&DO.call(e,"__wrapped__"),h=f&&DO.call(t,"__wrapped__");if(p||h){var v=p?e.value():e,g=h?t.value():t;return o||(o=new Pd),i(v,g,r,n,o)}}return!!d&&(o||(o=new Pd),IO(e,t,r,n,i,o))};var xO=function e(t,r,n,i,o){return t===r||(null==t||null==r||!Ud(t)&&!Ud(r)?t!=t&&r!=r:jO(t,r,n,i,e,o))};var LO=function(e,t){return xO(e,t)},UO=Object.prototype.hasOwnProperty;var FO=function(e,t){return null!=e&&UO.call(e,t)};var GO=function(e,t,r){for(var n=-1,i=(t=sv(t,e)).length,o=!1;++n<i;){var a=lv(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&Qd(i)&&Kd(a,i)&&(Hd(e)||zd(e))};var qO=function(e,t){return null!=e&&GO(e,t,FO)};var VO=function(e,t,r){var n=-1,i=(t=sv(t,e)).length;for(i||(i=1,e=void 0);++n<i;){var o=null==e?void 0:e[lv(t[n])];void 0===o&&(n=i,o=r),e=zf(o)?o.call(e):o}return e};var BO=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1},zO=Up&&1/lO(new Up([,-0]))[1]==1/0?function(e){return new Up(e)}:aE,HO=200;var WO=function(e,t,r){var n=-1,i=AE,o=e.length,a=!0,s=[],u=s;if(r)a=!1,i=BO;else if(o>=HO){var c=t?null:zO(e);if(c)return lO(c);a=!1,i=oO,u=new nO}else u=t?[]:s;e:for(;++n<o;){var l=e[n],f=t?t(l):l;if(l=r||0!==l?l:0,a&&f==f){for(var d=u.length;d--;)if(u[d]===f)continue e;t&&u.push(f),s.push(l)}else i(u,f,r)||(u!==s&&u.push(f),s.push(l))}return s};var YO=function(e){return Ud(e)&&pp(e)},XO=H_(function(e){return WO(Ov(e,1,YO,!0))}),JO="Expected a function";var KO=function(e,t){var r;if("function"!=typeof t)throw new TypeError(JO);return e=_b(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}};var $O=function(e){return KO(2,e)};var QO=function(e,t){return function(r,n){if(null==r)return r;if(!pp(r))return e(r,n);for(var i=r.length,o=t?i:-1,a=Object(r);(t?o--:++o<i)&&!1!==n(a[o],o,a););return r}},ZO=QO(qw);var ek=function(e,t){return(Hd(e)?Cd:ZO)(e,z_(t))},tk=/\s+/,rk=function(e,t){var r,n=-1,i=e.length,o=t[0],a=t[1],s=t[2];switch(t.length){case 0:for(;++n<i;)(r=e[n]).callback.call(r.ctx);return;case 1:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o);return;case 2:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o,a);return;case 3:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o,a,s);return;default:for(;++n<i;)(r=e[n]).callback.apply(r.ctx,t);return}},nk=function(e,t,r,n){if(!r)return!0;if("object"==typeof r){for(var i in r)e[t].apply(e,[i,r[i]].concat(n));return!1}if(tk.test(r)){for(var o=r.split(tk),a=0,s=o.length;a<s;a++)e[t].apply(e,[o[a]].concat(n));return!1}return!0},ik=function(e){return function(t,r,n){if(!t)throw new Error("Trying to listenTo event: '"+r+"' but the target object is undefined");if((this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=Pw("l"))]=t,n||"object"!=typeof r||(n=this),"function"!=typeof t[e])throw new Error("Trying to listenTo event: '"+r+"' on object: "+t.toString()+" but it does not have an 'on' method so is unbindable");return t[e](r,n,this),this}},ok=Array.prototype.slice,ak={on:function(e,t,r){return nk(this,"on",e,[t,r])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:r,ctx:r||this}),this):this},once:function(e,t,r){if(!nk(this,"once",e,[t,r])||!t)return this;var n=this,i=$O(function(){n.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,r)},off:function(e,t,r){var n,i,o,a,s,u,c,l;if(!this._events||!nk(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;for(s=0,u=(a=e?[e]:hp(this._events)).length;s<u;s++)if(e=a[s],o=this._events[e]){if(this._events[e]=n=[],t||r)for(c=0,l=o.length;c<l;c++)i=o[c],(t&&t!==i.callback&&t!==i.callback._callback||r&&r!==i.context)&&n.push(i);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=ok.call(arguments,1);if(!nk(this,"trigger",e,t))return this;var r=this._events[e],n=this._events.all;return r&&rk(r,t),n&&rk(n,arguments),this},stopListening:function(e,t,r){var n=this._listeningTo;if(!n)return this;var i=!t&&!r;r||"object"!=typeof t||(r=this),e&&((n={})[e._listenId]=e);var o=this;return ek(n,function(e,n){e.off(t,r,o),(i||Bv(e._events))&&delete o._listeningTo[n]}),this},createEmitter:function(e){return Nw(e||{},ak)},listenTo:ik("on"),listenToOnce:ik("once"),listenToAndRun:function(e,t,r){return this.listenTo.apply(this,arguments),r||"object"!=typeof t||(r=this),r.apply(this),this}};ak.bind=ak.on,ak.unbind=ak.off,ak.removeListener=ak.off,ak.removeAllListeners=ak.off,ak.emit=ak.trigger;var sk=ak,uk=Array.prototype.slice;function ck(e){if("object"!=typeof(e=e||{}))throw new TypeError("Options must be an object");this.storage={},this.separator=e.separator||"."}ck.prototype.add=function(e,t){(this.storage[e]||(this.storage[e]=[])).push(t)},ck.prototype.remove=function(e){var t,r;for(t in this.storage)(r=this.storage[t]).some(function(t,n){if(t===e)return r.splice(n,1),!0})},ck.prototype.get=function(e){var t,r=[];for(t in this.storage)e&&e!==t&&0!==t.indexOf(e+this.separator)||(r=r.concat(this.storage[t]));return r},ck.prototype.getGrouped=function(e){var t,r={};for(t in this.storage)e&&e!==t&&0!==t.indexOf(e+this.separator)||(r[t]=uk.call(this.storage[t]));return r},ck.prototype.getAll=function(e){var t,r={};for(t in this.storage)e!==t&&0!==t.indexOf(e+this.separator)||(r[t]=uk.call(this.storage[t]));return r},ck.prototype.run=function(e,t){var r=uk.call(arguments,2);this.get(e).forEach(function(e){e.apply(t||this,r)})};var lk=ck,fk=function(e){return Nw({},e)},dk=/^change:/,pk=function(){};function hk(e,t){t||(t={}),this.cid||(this.cid=Pw("state")),this._events={},this._values={},this._eventBubblingHandlerCache={},this._definition=Object.create(this._definition),t.parse&&(e=this.parse(e,t)),this.parent=t.parent,this.collection=t.collection,this._keyTree=new lk,this._initCollections(),this._initChildren(),this._cache={},this._previousAttributes={},e&&this.set(e,Nw({silent:!0,initial:!0},t)),this._changed={},this._derived&&this._initDerived(),!1!==t.init&&this.initialize.apply(this,arguments)}function vk(e,t,r,n){var i,o,a=e._definition[t]={};if(zw(r))(i=e._ensureValidType(r))&&(a.type=i);else{if(Array.isArray(r)&&(r={type:(o=r)[0],required:o[1],default:o[2]}),(i=e._ensureValidType(r.type))&&(a.type=i),r.required&&(a.required=!0),r.default&&"object"==typeof r.default)throw new TypeError("The default value for "+t+" cannot be an object/array, must be a value or a function which returns a value/object/array");a.default=r.default,a.allowNull=!!r.allowNull&&r.allowNull,r.setOnce&&(a.setOnce=!0),a.required&&void 0===a.default&&!a.setOnce&&(a.default=e._getDefaultForType(i)),a.test=r.test,a.values=r.values}return n&&(a.session=!0),i||(i=zw(r)?r:r.type,console.warn("Invalid data type of `"+i+"` for `"+t+"` property. Use one of the default types or define your own")),Object.defineProperty(e,t,{set:function(e){this.set(t,e)},get:function(){if(!this._values)throw Error('You may be trying to `extend` a state object with "'+t+'" which has been defined in `props` on the object being extended');var e=this._values[t],r=this._dataTypes[a.type];if(void 0!==e)return r&&r.get&&(e=r.get(e)),e;var n=VO(a,"default");(this._values[t]=n,void 0!==n)&&this._getOnChangeForType(a.type)(n,e,t);return n}}),a}function gk(e,t,r){(e._derived[t]={fn:zf(r)?r:r.fn,cache:!1!==r.cache,depList:r.deps||[]}).depList.forEach(function(r){e._deps[r]=XO(e._deps[r]||[],[t])}),Object.defineProperty(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`"+t+"` is a derived property, it can't be set directly.")}})}Nw(hk.prototype,sk,{extraProperties:"ignore",idAttribute:"id",namespaceAttribute:"namespace",typeAttribute:"modelType",initialize:function(){return this},getId:function(){return this[this.idAttribute]},getNamespace:function(){return this[this.namespaceAttribute]},getType:function(){return this[this.typeAttribute]},isNew:function(){return null==this.getId()},escape:function(e){return Uw(this.get(e))},isValid:function(e){return this._validate({},Nw(e||{},{validate:!0}))},parse:function(e,t){return e},serialize:function(e){var t=Nw({props:!0},e),r=this.getAttributes(t,!0),n=function(e,t){r[t]=this[t].serialize()}.bind(this);return Vw(this._children,n),Vw(this._collections,n),r},set:function(e,t,r){var n,i,o,a,s,u,c,l,f,d,p,h,v,g,m,y,_,E=this,b=this.extraProperties;if(Uf(e)||null===e?(f=e,r=t):(f={})[e]=t,r=r||{},!this._validate(f,r))return!1;h=r.unset,p=r.silent,g=r.initial,n=this._changing,this._changing=!0,i=[],g?this._previousAttributes={}:n||(this._previousAttributes=this.attributes,this._changed={});for(var S=0,T=Object.keys(f),w=T.length;S<w;S++){if(o=typeof(a=f[l=T[S]]),v=this._values[l],!(s=this._definition[l])){if(this._children[l]||this._collections[l]){Uf(a)||(a={}),this[l].set(a,r);continue}if("ignore"===b)continue;if("reject"===b)throw new TypeError('No "'+l+'" property defined on '+(this.type||"this")+' model and extraProperties not set to "ignore" or "allow"');if("allow"===b)s=this._createPropertyDefinition(l,"any");else if(b)throw new TypeError('Invalid value for extraProperties: "'+b+'"')}if(y=this._getCompareForType(s.type),_=this._getOnChangeForType(s.type),(d=this._dataTypes[s.type])&&d.set&&(a=(u=d.set(a)).val,o=u.type),s.test&&(c=s.test.call(this,a,o)))throw new TypeError("Property '"+l+"' failed validation with error: "+c);if(void 0===a&&s.required)throw new TypeError("Required property '"+l+"' must be of type "+s.type+". Tried to set "+a);if(null===a&&s.required&&!s.allowNull)throw new TypeError("Property '"+l+"' must be of type "+s.type+" (cannot be null). Tried to set "+a);if(s.type&&"any"!==s.type&&s.type!==o&&null!=a)throw new TypeError("Property '"+l+"' must be of type "+s.type+". Tried to set "+a);if(s.values&&!Xw(s.values,a)){var O=VO(s,"default");if(h&&void 0!==O)a=O;else if(!h||h&&void 0!==a)throw new TypeError("Property '"+l+"' must be one of values: "+s.values.join(", ")+". Tried to set "+a)}if(m=g||!y(v,a,l),s.setOnce&&void 0!==v&&m)throw new TypeError("Property '"+l+"' can only be set once.");m?(_(a,v,l),g||(this._changed[l]=a,this._previousAttributes[l]=v,h&&delete this._values[l],p||i.push({prev:v,val:a,key:l})),h||(this._values[l]=a)):delete this._changed[l]}if(i.length&&(this._pending=!0),i.forEach(function(e){E.trigger("change:"+e.key,E,e.val,r)}),n)return this;for(;this._pending;)this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},get:function(e){return this[e]},toggle:function(e){var t,r,n,i,o=this._definition[e];if("boolean"===o.type)this[e]=!this[e];else{if(!o||!o.values)throw new TypeError("Can only toggle properties that are type `boolean` or have `values` array.");this[e]=(t=o.values,r=this[e],n=t.length,(i=t.indexOf(r)+1)>n-1&&(i=0),t[i])}return this},previousAttributes:function(){return fk(this._previousAttributes)},hasChanged:function(e){return null==e?!!Object.keys(this._changed).length:qO(this._derived,e)?this._derived[e].depList.some(function(e){return this.hasChanged(e)},this):qO(this._changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&fk(this._changed);var t,r,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var o in e)(r=this._definition[o])&&(this._getCompareForType(r.type)(i[o],t=e[o])||((n||(n={}))[o]=t));return n},toJSON:function(){return this.serialize()},unset:function(e,t){var r=this;(e=Array.isArray(e)?e:[e]).forEach(function(e){var n,i=r._definition[e];if(i)return i.required?(n=VO(i,"default"),r.set(e,n,t)):r.set(e,n,Nw({},t,{unset:!0}))})},clear:function(e){var t=this;return Object.keys(this.attributes).forEach(function(r){t.unset(r,e)}),this},previous:function(e){return null!=e&&Object.keys(this._previousAttributes).length?this._previousAttributes[e]:null},_getDefaultForType:function(e){var t=this._dataTypes[e];return t&&t.default},_getCompareForType:function(e){var t=this._dataTypes[e];return t&&t.compare?t.compare.bind(this):LO},_getOnChangeForType:function(e){var t=this._dataTypes[e];return t&&t.onChange?t.onChange.bind(this):pk},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=Nw({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return!r||(this.trigger("invalid",this,r,Nw(t||{},{validationError:r})),!1)},_createPropertyDefinition:function(e,t,r){return vk(this,e,t,r)},_ensureValidType:function(e){return Xw(["string","number","boolean","array","object","date","state","any"].concat(Object.keys(this._dataTypes)),e)?e:void 0},getAttributes:function(e,t){e=Nw({session:!1,props:!1,derived:!1},e||{});var r,n,i={};for(var o in this._definition)n=this._definition[o],(e.session&&n.session||e.props&&!n.session)&&(r=t?this._values[o]:this[o],t&&r&&zf(r.serialize)&&(r=r.serialize()),void 0===r&&(r=VO(n,"default")),void 0!==r&&(i[o]=r));if(e.derived)for(var a in this._derived)i[a]=this[a];return i},_initDerived:function(){var e=this;Vw(this._derived,function(t,r){var n=e._derived[r];n.deps=n.depList;var i=function(){var t=n.fn.call(e);e._cache[r]===t&&n.cache||(n.cache&&(e._previousAttributes[r]=e._cache[r]),e._cache[r]=t,e.trigger("change:"+r,e,e._cache[r]))};n.deps.forEach(function(t){e._keyTree.add(t,i)})}),this.on("all",function(t){dk.test(t)&&e._keyTree.get(t.split(":")[1]).forEach(function(e){e()})},this)},_getDerivedProperty:function(e,t){return this._derived[e].cache?(!t&&this._cache.hasOwnProperty(e)||(this._cache[e]=this._derived[e].fn.apply(this)),this._cache[e]):this._derived[e].fn.apply(this)},_initCollections:function(){var e;if(this._collections)for(e in this._collections)this._safeSet(e,new this._collections[e](null,{parent:this}))},_initChildren:function(){var e;if(this._children)for(e in this._children)this._safeSet(e,new this._children[e]({},{parent:this})),this.listenTo(this[e],"all",this._getCachedEventBubblingHandler(e))},_getCachedEventBubblingHandler:function(e){return this._eventBubblingHandlerCache[e]||(this._eventBubblingHandlerCache[e]=function(t,r,n){dk.test(t)?this.trigger("change:"+e+"."+t.split(":")[1],r,n):"change"===t&&this.trigger("change",this)}.bind(this)),this._eventBubblingHandlerCache[e]},_verifyRequired:function(){var e=this.attributes;for(var t in this._definition)if(this._definition[t].required&&void 0===e[t])return!1;return!0},_safeSet:function(e,t){if(e in this)throw new Error("Encountered namespace collision while setting instance property `"+e+"`");return this[e]=t,this}}),Object.defineProperties(hk.prototype,{attributes:{get:function(){return this.getAttributes({props:!0,session:!0})}},all:{get:function(){return this.getAttributes({session:!0,props:!0,derived:!0})}},isState:{get:function(){return!0},set:function(){}}});var mk={string:{default:function(){return""}},date:{set:function(e){var t;if(null==e)t="object";else if(Qw(e))t="date",e=e.valueOf();else{var r=null,n=new Date(e).valueOf();isNaN(n)&&(n=new Date(parseInt(e,10)).valueOf(),isNaN(n)&&(r=!0)),e=n,t="date",r&&(t=typeof e)}return{val:e,type:t}},get:function(e){return null==e?e:new Date(e)},default:function(){return new Date}},array:{set:function(e){return{val:e,type:Array.isArray(e)?"array":typeof e}},default:function(){return[]}},object:{set:function(e){var t=typeof e;return"object"!==t&&void 0===e&&(e=null,t="object"),{val:e,type:t}},default:function(){return{}}},state:{set:function(e){return e instanceof hk||e&&e.isState?{val:e,type:"state"}:{val:e,type:typeof e}},compare:function(e,t){return e===t},onChange:function(e,t,r){t&&this.stopListening(t,"all",this._getCachedEventBubblingHandler(r)),null!=e&&this.listenTo(e,"all",this._getCachedEventBubblingHandler(r))}}};hk.extend=function(e){var t,r=this;t=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return r.apply(this,arguments)},Nw(t,r);var n=function(){this.constructor=t};if(n.prototype=r.prototype,t.prototype=new n,t.prototype._derived=Nw({},r.prototype._derived),t.prototype._deps=Nw({},r.prototype._deps),t.prototype._definition=Nw({},r.prototype._definition),t.prototype._collections=Nw({},r.prototype._collections),t.prototype._children=Nw({},r.prototype._children),t.prototype._dataTypes=Nw({},r.prototype._dataTypes||mk),e)for(var i=["dataTypes","props","session","derived","collections","children"],o=0;o<arguments.length;o++){var a=arguments[o];a.dataTypes&&Vw(a.dataTypes,function(e,r){t.prototype._dataTypes[r]=e}),a.props&&Vw(a.props,function(e,r){vk(t.prototype,r,e)}),a.session&&Vw(a.session,function(e,r){vk(t.prototype,r,e,!0)}),a.derived&&Vw(a.derived,function(e,r){gk(t.prototype,r,e)}),a.collections&&Vw(a.collections,function(e,r){t.prototype._collections[r]=e}),a.children&&Vw(a.children,function(e,r){t.prototype._children[r]=e}),Nw(t.prototype,Fv(a,i))}return t.__super__=r.prototype,t};var yk=hk,_k=r(function(e,t){t.__esModule=!0;var r,n=(r=Sy)&&r.__esModule?r:{default:r};t.default=function(e,t,r){return t in e?(0,n.default)(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}});t(_k);var Ek=r(function(e,t){t.__esModule=!0;var r,n=(r=SS)&&r.__esModule?r:{default:r};t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,n.default)(e)}});t(Ek);Gy("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return G_.def(Iy(this,"Set"),e=0===e?0:e,e)}},G_);Cu(Cu.P+Cu.R,"Set",{toJSON:q_("Set")}),qy("Set"),Vy("Set");var bk=Tu.Set,Sk=r(function(e){e.exports={default:bk,__esModule:!0}});t(Sk);var Tk=function(){return Of.Date.now()},wk="Expected a function",Ok=Math.max,kk=Math.min;var Rk=function(e,t,r){var n,i,o,a,s,u,c=0,l=!1,f=!1,d=!0;if("function"!=typeof e)throw new TypeError(wk);function p(t){var r=n,o=i;return n=i=void 0,c=t,a=e.apply(o,r)}function h(e){var r=e-u;return void 0===u||r>=t||r<0||f&&e-c>=o}function v(){var e=Tk();if(h(e))return g(e);s=setTimeout(v,function(e){var r=t-(e-u);return f?kk(r,o-(e-c)):r}(e))}function g(e){return s=void 0,d&&n?p(e):(n=i=void 0,a)}function m(){var e=Tk(),r=h(e);if(n=arguments,i=this,u=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(v,t),l?p(e):a}(u);if(f)return s=setTimeout(v,t),p(u)}return void 0===s&&(s=setTimeout(v,t)),a}return t=vb(t)||0,Uf(r)&&(l=!!r.leading,o=(f="maxWait"in r)?Ok(vb(r.maxWait)||0,t):o,d="trailing"in r?!!r.trailing:d),m.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=u=i=s=void 0},m.flush=function(){return void 0===s?a:g(Tk())},m},Ak=8;function Ik(e,t,r){var n=Ab(e,Ak,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=Ik.placeholder,n}Ik.placeholder={};var Pk=Ik,Ck=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NotFoundError=t.StorageError=void 0;var r=a(MS),n=a(_y),i=a(NS),o=a(DS);function a(e){return e&&e.__esModule?e:{default:e}}var s=t.StorageError=function(e){function t(){return(0,n.default)(this,t),(0,i.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,o.default)(t,e),t}(Tw.Exception);t.NotFoundError=function(e){function t(){return(0,n.default)(this,t),(0,i.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,o.default)(t,e),t}(s)});t(Ck);Ck.NotFoundError,Ck.StorageError;var Mk=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=h(_k),n=h(j_),i=h(Ek),o=h(Sk),a=h(B_),s=h(Xl),u=h(nf),c=h(Cb),l=h(VO),f=h(Cv),d=h(Rk),p=h(Pk);function h(e){return e&&e.__esModule?e:{default:e}}t.persist=function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(3===r.length)return e("@").apply(void 0,r);var i=r[0],o=r[1];return function(e,t,r){if("initialize"!==t)throw new TypeError("@persist can only currently be applied to AmpersandState objects or their derivatives and must be applied to the initialize method");r.value=(0,c.default)(r.value,function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];var c=(0,u.default)(e,this,n),l="@"===i?"change":"change:"+i;return this.on(l,(0,d.default)(function(){var e=!o||u.default.apply(Reflect,[o,t].concat(n));return e?"@"===i?t.boundedStorage.put(i,t):t.boundedStorage.put(i,t[i]):s.default.resolve()},0)),c}),E(e,t)}},t.waitForValue=function(e){if(!e)throw new Error("`key` is required");return function(t,r,o){return m.add(t,r,e),o.value=(0,c.default)(o.value,function(e){for(var n=this,o=arguments.length,a=Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];var l=m.get(t,r);return s.default.all([].concat((0,i.default)(l)).map(function(e){return n.boundedStorage.waitFor(e)})).then(function(){return(0,u.default)(e,n,a)})}),"object"!==(void 0===t?"undefined":(0,n.default)(t))||t.prototype||(t[r]=o.value),E(t,r),o}};var v=a.default,g=o.default,m=new((0,Tw.make)(v,v,g));var y=new o.default;var _=new o.default;function E(e,t){var n=function(e){return e.namespace?e.namespace:e}(e);if(!y.has(n)){if(y.add(n),e.initialize)return void(e.initialize=(0,c.default)(e.initialize,function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=(0,u.default)(e,this,r);return(0,u.default)(i,this,r),o}));e.initialize=i}function i(){var n=this,i=this.getNamespace();this.spark.initialize=(0,c.default)(this.spark.initialize||f.default,function(o){var a=this;_.add(i);for(var c=arguments.length,f=Array(c>1?c-1:0),d=1;d<c;d++)f[d-1]=arguments[d];(0,u.default)(o,this,f);var h=(0,p.default)(function(e,t){a.logger.debug("storage:("+i+"): got `"+e+"` for first time"),"@"===e?n.parent.set((0,r.default)({},i.toLowerCase(),t)):(0,l.default)(n[e],"isState")?n[e].set(t):n.set(e,t),a.logger.debug("storage:("+i+"): set `"+e+"` for first time")}),v=(0,p.default)(function(e,t){return t instanceof Ck.NotFoundError||t.toString().includes("MockNotFoundError")?(a.logger.debug("storage("+i+"): no data for `"+e+"`, continuing"),s.default.resolve()):(a.logger.error("storage("+i+"): failed to init `"+e+"`",t),s.default.reject(t))}),g=m.get(e,t),y=[];g.forEach(function(e){y.push(a.boundedStorage.get(i,e).then(h(e)).catch(v(e)))}),s.default.all(y).then(function(){_.delete(i),0===_.size&&(a.loaded=!0)})})}}});t(Mk);Mk.persist,Mk.waitForValue;var Nk=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(Zl),n=l(xu),i=l(Xl),o=l(B_),a=l(_y),s=l(Ty),u=l(zy);t.default=function(e,t){var u,l,d=(u=(0,Tw.oneFlight)({keyFactory:function(e){return e}}),function(e,t,r,n,i){var o={};Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0);o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0);void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((l=function(){function r(){(0,a.default)(this,r),t.logger.debug("spark-store: constructing "+e+"Storage"),f.set(this,new o.default)}return(0,s.default)(r,[{key:"clear",value:function(){var e=[];return this.bindings.forEach(function(t){e.push(t.clear())}),i.default.all(e)}},{key:"del",value:function(e,r){return t.logger.debug("spark-store: removing "+e+":"+r),this._getBinding(e).then(function(e){return e.del(r)})}},{key:"get",value:function(e,r){return t.logger.debug("spark-store: retrieving "+e+":"+r),this._getBinding(e).then(function(e){return e.get(r)})}},{key:"put",value:function(e,r,n){return void 0===n?this.del(e,r):(t.logger.debug("spark-store: setting "+e+":"+r),this._getBinding(e).then(function(e){return e.put(r,n.serialize?n.serialize():n)}).then(function(){return n}))}},{key:"_getBinding",value:function(e){var r=this;return new i.default(function(n){t.logger.debug("storage: getting binding for `"+e+"`");var i=r.bindings.get(e);return i?(t.logger.debug("storage: found binding for `"+e+"`"),n(i)):n(r.adapter.bind(e,{logger:t.logger}).then(function(n){return t.logger.debug("storage: made binding for `"+e+"`"),r.bindings.set(e,n),n}))})}},{key:"adapter",get:function(){return t.config.storage[e+"Adapter"]}},{key:"bindings",get:function(){return f.get(this)}}]),r}()).prototype,"_getBinding",[u],(0,n.default)(l.prototype,"_getBinding"),l.prototype),l);return(0,r.default)(d.prototype,c.default),new d};var c=l(sk);function l(e){return e&&e.__esModule?e:{default:e}}var f=new u.default});t(Nk);var Dk=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=f(xu),n=f(B_),i=f(_y),o=f(Ty),a=f(Ow),s=f(zy),u=f(VO),c=f(Uf),l=f(Hd);function f(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var a,s;return new(a=(0,Tw.oneFlight)({keyFactory:function(e){return"initValue-"+e}}),function(e,t,r,n,i){var o={};Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0);o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0);void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((s=function(){function r(){(0,i.default)(this,r),d.set(this,new n.default)}return(0,o.default)(r,[{key:"clear",value:function(){return t.spark[e+"Storage"].del(t.getNamespace())}},{key:"del",value:function(){for(var r,n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=t.spark[e+"Storage"]).del.apply(r,[t.getNamespace()].concat(i))}},{key:"get",value:function(r){var n=d.get(this).get(r);return n||(n=new Tw.Defer,d.get(this).set(r,n)),t.spark[e+"Storage"].get(t.getNamespace(),r).then(function(e){return n.resolve(),e})}},{key:"put",value:function(r,n){return t.spark[e+"Storage"].put(t.getNamespace(),r,p(n))}},{key:"waitFor",value:function(e){t.logger.debug("plugin-storage("+t.getNamespace()+"): waiting to init key `"+e+"`");var r=d.get(this).get(e);return r?(t.logger.debug("plugin-storage("+t.getNamespace()+"): already inited `"+e+"`"),r.promise):(t.logger.debug("plugin-storage("+t.getNamespace()+"): initing `"+e+"`"),this.initValue(e))}},{key:"initValue",value:function(r){var n=new Tw.Defer;return d.get(this).set(r,n),t.spark[e+"Storage"].get(t.getNamespace(),r).then(function(e){t.logger.debug("plugin-storage("+t.getNamespace()+"): got `"+r+"` for first time"),"@"===r?t.parent.set(e):(0,u.default)(t[r],"isState")?t[r].set(e):t.set(r,e),t.logger.debug("plugin-storage("+t.getNamespace()+"): set `"+r+"` for first time"),n.resolve(),t.logger.debug("plugin-storage("+t.getNamespace()+"): inited `"+r+"`")}).catch(function(e){return e instanceof Ck.NotFoundError||e.toString().includes("MockNotFoundError")?(t.logger.debug("plugin-storage("+t.getNamespace()+"): no data for `"+r+"`, continuing"),n.resolve()):(t.logger.warn("plugin-storage("+t.getNamespace()+"): failed to init `"+r+"`",e),n.reject(e))}),n.promise}}]),r}()).prototype,"initValue",[a],(0,r.default)(s.prototype,"initValue"),s.prototype),s)};var d=new s.default;function p(e){if(!(0,c.default)(e))return e;var t=e.serialize?e.serialize():e;return(0,a.default)(t).forEach(function(e){var r=t[e];(0,l.default)(r)?0===r.length?t[e]=void 0:t[e]=r.map(p):(0,c.default)(r)&&(0,a.default)(r).forEach(function(e){r[e]=p(r[e])})}),(0,a.default)(t).reduce(function(e,r){return e&&!t[r]},!0)?void 0:t}});t(Dk);var jk=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Ow),n=o(B_),i=o(Xl);function o(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t=t||{},!e)return i.default.reject(new Error("`namespace` is required"));if(!t.logger)return i.default.reject(new Error("`options.logger` is required"));var o=t.logger,a=new n.default;return t.data&&(0,r.default)(t.data).forEach(function(e){a.set(e,t.data[e])}),o.debug("memory-store-adapter: returning binding"),i.default.resolve({clear:function(){return o.debug("memory-store-adapter: clearing the binding"),i.default.resolve(a.clear())},del:function(e){return o.debug("memory-store-adapter: deleting `"+e+"`"),i.default.resolve(a.delete(e))},get:function(e){o.debug("memory-store-adapter: reading `"+e+"`");var t=a.get(e);return void 0===t?i.default.reject(new Ck.NotFoundError):i.default.resolve(t)},put:function(e,t){return o.debug("memory-store-adapter: writing `"+e+"`"),i.default.resolve(a.set(e,t))}})}t.default={bind:a,preload:function(e){return{bind:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e[t]&&(r.data=e[t]),a(t,r)}}}}});t(jk);var xk=r(function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"persist",{enumerable:!0,get:function(){return Mk.persist}}),Object.defineProperty(t,"waitForValue",{enumerable:!0,get:function(){return Mk.waitForValue}}),Object.defineProperty(t,"makeSparkStore",{enumerable:!0,get:function(){return r(Nk).default}}),Object.defineProperty(t,"makeSparkPluginStore",{enumerable:!0,get:function(){return r(Dk).default}}),Object.defineProperty(t,"MemoryStoreAdapter",{enumerable:!0,get:function(){return r(jk).default}}),Object.defineProperty(t,"StorageError",{enumerable:!0,get:function(){return Ck.StorageError}}),Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return Ck.NotFoundError}})});t(xk);var Lk=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(Xl),n=l(nf),i=l(Ow),o=l(Fv),a=l(Uf),s=l(Wv),u=l(Ym),c=l(yk);function l(e){return e&&e.__esModule?e:{default:e}}var f=c.default.extend({derived:{boundedStorage:{deps:[],fn:function(){return(0,xk.makeSparkPluginStore)("bounded",this)}},unboundedStorage:{deps:[],fn:function(){return(0,xk.makeSparkPluginStore)("unbounded",this)}},config:{cache:!1,deps:["spark","spark.config"],fn:function(){if(this.spark&&this.spark.config){var e=this.getNamespace();return e?this.spark.config[e.toLowerCase()]:this.spark.config}return{}}},logger:{deps:["spark","spark.logger"],fn:function(){return this.spark.logger||console}},spark:{deps:["parent"],fn:function(){if(!this.parent&&!this.collection)throw new Error("Cannot determine `this.spark` without `this.parent` or `this.collection`. Please initialize `this` via `children` or `collection` or set `this.parent` manually");for(var e=this;e.parent||e.collection;)e=e.parent||e.collection;return e}}},session:{parent:{type:"any"},ready:{default:!0,type:"boolean"}},clear:function(e){var t=this;return(0,i.default)(this.attributes).forEach(function(r){"parent"!==r&&t.unset(r,e)}),(0,i.default)(this._children).forEach(function(e){t[e].clear()}),(0,i.default)(this._collections).forEach(function(e){t[e].reset()}),this},initialize:function(){for(var e=this,t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(0,n.default)(c.default.prototype.initialize,this,r),this._dataTypes=(0,s.default)(this._dataTypes),(0,i.default)(this._dataTypes).forEach(function(t){e._dataTypes[t].set&&(e._dataTypes[t].set=e._dataTypes[t].set.bind(e))}),this.on("change",function(t,r){e.parent&&e.parent.trigger("change:"+e.getNamespace().toLowerCase(),e.parent,e,r)})},inspect:function(e){return u.default.inspect((0,o.default)(this.serialize({props:!0,session:!0,derived:!0}),"boundedStorage","unboundedStorage","config","logger","spark","parent"),{depth:e})},request:function(){var e;return(e=this.spark).request.apply(e,arguments)},upload:function(){var e;return(e=this.spark).upload.apply(e,arguments)},when:function(e){for(var t=this,n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];if(i&&i.length>0)throw new Error("#when() does not accept a callback, you must attach to its promise");return new r.default(function(r){t.once(e,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(t)})})},_filterSetParameters:function(e,t,r){var n=void 0;return(0,a.default)(e)||null===e?(n=e,r=t):(n={})[e]=t,[n,r=r||{}]}});t.default=f});t(Lk),Cu(Cu.S+Cu.F*!vu,"Object",{defineProperties:sc});var Uk=Tu.Object,Fk=function(e,t){return Uk.defineProperties(e,t)},Gk=r(function(e){e.exports={default:Fk,__esModule:!0}});t(Gk);var qk=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.OAuthError=void 0;var r=u(Gk),n=u(MS),i=u(_y),o=u(Ty),a=u(NS),s=u(DS);function u(e){return e&&e.__esModule?e:{default:e}}var c=t.OAuthError=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"parse",value:function(e){var t=e.body||e;return(0,r.default)(this,{error:{enumerable:!0,value:t.error},errorDescription:{enumerable:!0,value:t.error_description},errorUri:{enumerable:!0,value:t.error_uri},res:{enumerable:!1,value:e}}),this.errorDescription}}]),t}(Tw.Exception),l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),f=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),d=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),p=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),h=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),v=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),g={OAuthError:c,InvalidRequestError:l,InvalidClientError:f,InvalidGrantError:d,UnauthorizedClientError:p,UnsupportGrantTypeError:h,InvalidScopeError:v,invalid_request:l,invalid_client:f,invalid_grant:d,unauthorized_client:p,unsupported_grant_type:h,invalid_scope:v,select:function(e){return g[e]||c}};t.default=g});t(qk);qk.OAuthError;var Vk=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.sortScope=function(e){if(!e)return"";return e.split(" ").sort().join(" ")},t.filterScope=function(e,t){if(!t)return"";return t.split(" ").filter(function(t){return t!==e}).sort().join(" ")}});t(Vk);Vk.sortScope,Vk.filterScope;var Bk=hc("iterator"),zk=Tu.isIterable=function(e){var t=Object(e);return void 0!==t[Bk]||"@@iterator"in t||Hu.hasOwnProperty(Gc(t))},Hk=r(function(e){e.exports={default:zk,__esModule:!0}});t(Hk);var Wk=Tu.getIterator=function(e){var t=Yc(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return ku(t.call(e))},Yk=r(function(e){e.exports={default:Wk,__esModule:!0}});t(Yk);var Xk=r(function(e,t){t.__esModule=!0;var r=i(Hk),n=i(Yk);function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,r.default)(Object(e)))return function(e,t){var r=[],i=!0,o=!1,a=void 0;try{for(var s,u=(0,n.default)(e);!(i=(s=u.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()});t(Xk);var Jk=function(e,t,r,n){if(!Uf(e))return e;for(var i=-1,o=(t=sv(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var u=lv(t[i]),c=r;if(i!=a){var l=s[u];void 0===(c=n?n(l,u,s):void 0)&&(c=Uf(l)?l:Kd(t[i+1])?[]:{})}jd(s,u,c),s=s[u]}return e};var Kk=function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var a=t[n],s=fv(e,a);r(s,a)&&Jk(o,sv(a,e),s)}return o};var $k=function(e,t){return null!=e&&t in Object(e)};var Qk=function(e,t){return null!=e&&GO(e,t,$k)};var Zk=function(e,t){return Kk(e,t,function(t,r){return Qk(e,r)})},eR=Uv(function(e,t){return null==e?{}:Zk(e,t)});Cu(Cu.S+Cu.F*hu(function(){Reflect.defineProperty(Au.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,r){ku(e),t=fu(t,!0),ku(r);try{return Au.f(e,t,r),!0}catch(e){return!1}}});var tR=Tu.Reflect.defineProperty,rR=r(function(e){e.exports={default:tR,__esModule:!0}});t(rR),Cu(Cu.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return Su.f(ku(e),t)}});var nR=Tu.Reflect.getOwnPropertyDescriptor,iR=r(function(e){e.exports={default:nR,__esModule:!0}});t(iR),Cu(Cu.S,"Number",{isNaN:function(e){return e!=e}});var oR=Tu.Number.isNaN,aR=r(function(e){e.exports={default:oR,__esModule:!0}});t(aR);var sR="[object Number]";var uR=function(e){return"number"==typeof e||Ud(e)&&Lf(e)==sR},cR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(aR),n=o(Gk),i=o(uR);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){(0,n.default)(this,{loaded:{enumerable:!0,value:e,writable:!1},total:{enumerable:!0,value:t,writable:!1},lengthComputable:{enumerable:!0,value:(0,i.default)(e)&&!(0,r.default)(e)&&(0,i.default)(t)&&!(0,r.default)(t)&&t>0,writable:!1}})}});t(cR);var lR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(Xl),n=s(rR),i=s(Ow),o=s(_y),a=s(Ty);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){var r=this;(0,o.default)(this,e),t&&(0,i.default)(t).forEach(function(e){var i=t[e];(0,n.default)(r,e,{enumerable:!0,value:i})})}return(0,a.default)(e,[{key:"onRequest",value:function(e){return r.default.resolve(e)}},{key:"onRequestError",value:function(e,t){return r.default.reject(t)}},{key:"onResponse",value:function(e,t){return r.default.resolve(t)}},{key:"onResponseError",value:function(e,t){return r.default.reject(t)}}],[{key:"create",value:function(){throw new Error("`Interceptor.create()` must be defined")}}]),e}();t.default=u});t(lR);var fR=uu.f,dR=function(e){return function(t){for(var r,n=su(t),i=ac(n),o=i.length,a=0,s=[];o>a;)fR.call(n,r=i[a++])&&s.push(e?[r,n[r]]:n[r]);return s}},pR=dR(!1);Cu(Cu.S,"Object",{values:function(e){return pR(e)}});var hR=Tu.Object.values,vR=r(function(e){e.exports={default:hR,__esModule:!0}});t(vR);var gR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(Zl),n=s(MS),i=s(_y),o=s(NS),a=s(DS);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(e),s=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(e),u=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),c=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),l=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),f=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),d=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),p=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),h=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),v=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),g=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),m=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),y=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),_=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),E=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),b=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),S=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),T=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),w=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),O=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),k=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(e),R=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(k),A=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(k),I=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(k),P=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(k),C=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(k);(0,r.default)(e,{0:t,NetworkOrCORSError:t,400:s,BadRequest:s,401:u,Unauthorized:u,402:c,PaymentRequired:c,403:l,Forbidden:l,404:f,NotFound:f,405:d,MethodNotAllowed:d,406:p,NotAcceptable:p,407:h,ProxyAuthenticationRequired:h,408:v,RequestTimeout:v,409:g,Conflict:g,410:m,Gone:m,411:y,LengthRequired:y,412:_,PreconditionFailed:_,413:E,RequestEntityTooLarge:E,414:b,RequestUriTooLong:b,415:S,UnsupportedMediaType:S,416:T,RequestRangeNotSatisfiable:T,417:w,ExpectationFailed:w,429:O,TooManyRequests:O,500:k,InternalServerError:k,501:R,NotImplemented:R,502:A,BadGateway:A,503:I,ServiceUnavailable:I,504:P,GatewayTimeout:P,505:C,HttpVersionNotSupported:C,select:function(t){if(null==t)return e;t=t.statusCode||t;var r=e[t];return r||(t=t.toString().split("").shift()+"00",t=parseInt(t,10),e[t]||e)}})}});t(gR);var mR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i=v(sf),o=v(vR),a=v(Gk),s=v(j_),u=v(MS),c=v(_y),l=v(Ty),f=v(NS),d=v(DS),p=v(eR),h=v(gR);function v(e){return e&&e.__esModule?e:{default:e}}var g=(n=r=function(e){function t(){return(0,c.default)(this,t),(0,f.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,d.default)(t,e),(0,l.default)(t,[{key:"parse",value:function(e){var t=e.body,r=void 0;switch(void 0===t?"undefined":(0,s.default)(t)){case"string":try{t=JSON.parse(t),r=this.parseObject(t)}catch(e){r=t}break;case"object":r=this.parseObject(t)}return r||(r=this.defaultMessage),(0,a.default)(this,{body:{enumerable:!1,value:t},httpVersion:{enumerable:!1,value:e.httpVersion},headers:{enumerable:!1,value:e.headers||{}},rawHeaders:{enumerable:!1,value:e.rawHeaders||[]},trailers:{enumerable:!1,value:e.trailers||{}},rawTrailers:{enumerable:!1,value:e.rawTrailers||[]},method:{enumerable:!1,value:e.method},url:{enumerable:!1,value:e.url},statusCode:{enumerable:!1,value:e.statusCode},statusMessage:{enumerable:!1,value:e.statusMessage},socket:{enumerable:!1,value:e.socket},_res:{enumerable:!1,value:e}}),r}},{key:"parseObject",value:function(e){var r=(0,o.default)((0,p.default)(e,t.errorKeys));if(0===r.length)return(0,i.default)(e,null,2);var n=r[0];return"object"===(void 0===n?"undefined":(0,s.default)(n))?this.parseObject(n):n}}]),t}(Tw.Exception),r.errorKeys=["error","errorString","response","errorResponse","message","msg"],r.defaultMessage="An error was received while trying to fulfill the request",n);t.default=g,(0,h.default)(g),g.makeSubTypes=h.default});t(mR);var yR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=f(Xl),n=f(Gk),i=f(MS),o=f(_y),a=f(Ty),s=f(NS),u=f(DS),c=f(mR),l=f(lR);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e,r){(0,o.default)(this,t);var a=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e)),u=r&&(r.error||r.ErrorConstructor)||c.default;return(0,n.default)(a,{ErrorConstructor:{value:u}}),a}return(0,u.default)(t,e),(0,a.default)(t,[{key:"onResponse",value:function(e,t){if(t.statusCode){if(t.statusCode<400)return r.default.resolve(t);if(404===t.statusCode&&t.body&&2000002===t.body.errorCode)return r.default.resolve(t)}return r.default.reject(new(this.ErrorConstructor.select(t.statusCode))(t))}}],[{key:"create",value:function(e){return new t(this,e)}}]),t}(l.default);t.default=d});t(yR);var _R=function(e){return e&&e.length>1?255===e[0]&&216===e[1]&&255===e[2]?{ext:"jpg",mime:"image/jpeg"}:137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]?{ext:"png",mime:"image/png"}:71===e[0]&&73===e[1]&&70===e[2]?{ext:"gif",mime:"image/gif"}:87===e[8]&&69===e[9]&&66===e[10]&&80===e[11]?{ext:"webp",mime:"image/webp"}:70===e[0]&&76===e[1]&&73===e[2]&&70===e[3]?{ext:"flif",mime:"image/flif"}:(73===e[0]&&73===e[1]&&42===e[2]&&0===e[3]||77===e[0]&&77===e[1]&&0===e[2]&&42===e[3])&&67===e[8]&&82===e[9]?{ext:"cr2",mime:"image/x-canon-cr2"}:73===e[0]&&73===e[1]&&42===e[2]&&0===e[3]||77===e[0]&&77===e[1]&&0===e[2]&&42===e[3]?{ext:"tif",mime:"image/tiff"}:66===e[0]&&77===e[1]?{ext:"bmp",mime:"image/bmp"}:73===e[0]&&73===e[1]&&188===e[2]?{ext:"jxr",mime:"image/vnd.ms-photo"}:56===e[0]&&66===e[1]&&80===e[2]&&83===e[3]?{ext:"psd",mime:"image/vnd.adobe.photoshop"}:80===e[0]&&75===e[1]&&3===e[2]&&4===e[3]&&109===e[30]&&105===e[31]&&109===e[32]&&101===e[33]&&116===e[34]&&121===e[35]&&112===e[36]&&101===e[37]&&97===e[38]&&112===e[39]&&112===e[40]&&108===e[41]&&105===e[42]&&99===e[43]&&97===e[44]&&116===e[45]&&105===e[46]&&111===e[47]&&110===e[48]&&47===e[49]&&101===e[50]&&112===e[51]&&117===e[52]&&98===e[53]&&43===e[54]&&122===e[55]&&105===e[56]&&112===e[57]?{ext:"epub",mime:"application/epub+zip"}:80===e[0]&&75===e[1]&&3===e[2]&&4===e[3]&&77===e[30]&&69===e[31]&&84===e[32]&&65===e[33]&&45===e[34]&&73===e[35]&&78===e[36]&&70===e[37]&&47===e[38]&&109===e[39]&&111===e[40]&&122===e[41]&&105===e[42]&&108===e[43]&&108===e[44]&&97===e[45]&&46===e[46]&&114===e[47]&&115===e[48]&&97===e[49]?{ext:"xpi",mime:"application/x-xpinstall"}:80!==e[0]||75!==e[1]||3!==e[2]&&5!==e[2]&&7!==e[2]||4!==e[3]&&6!==e[3]&&8!==e[3]?117===e[257]&&115===e[258]&&116===e[259]&&97===e[260]&&114===e[261]?{ext:"tar",mime:"application/x-tar"}:82!==e[0]||97!==e[1]||114!==e[2]||33!==e[3]||26!==e[4]||7!==e[5]||0!==e[6]&&1!==e[6]?31===e[0]&&139===e[1]&&8===e[2]?{ext:"gz",mime:"application/gzip"}:66===e[0]&&90===e[1]&&104===e[2]?{ext:"bz2",mime:"application/x-bzip2"}:55===e[0]&&122===e[1]&&188===e[2]&&175===e[3]&&39===e[4]&&28===e[5]?{ext:"7z",mime:"application/x-7z-compressed"}:120===e[0]&&1===e[1]?{ext:"dmg",mime:"application/x-apple-diskimage"}:0===e[0]&&0===e[1]&&0===e[2]&&(24===e[3]||32===e[3])&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]||51===e[0]&&103===e[1]&&112===e[2]&&53===e[3]||0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&109===e[8]&&112===e[9]&&52===e[10]&&50===e[11]&&109===e[16]&&112===e[17]&&52===e[18]&&49===e[19]&&109===e[20]&&112===e[21]&&52===e[22]&&50===e[23]&&105===e[24]&&115===e[25]&&111===e[26]&&109===e[27]||0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&105===e[8]&&115===e[9]&&111===e[10]&&109===e[11]||0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&109===e[8]&&112===e[9]&&52===e[10]&&50===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&0===e[15]?{ext:"mp4",mime:"video/mp4"}:0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&77===e[8]&&52===e[9]&&86===e[10]?{ext:"m4v",mime:"video/x-m4v"}:77===e[0]&&84===e[1]&&104===e[2]&&100===e[3]?{ext:"mid",mime:"audio/midi"}:109===e[31]&&97===e[32]&&116===e[33]&&114===e[34]&&111===e[35]&&115===e[36]&&107===e[37]&&97===e[38]?{ext:"mkv",mime:"video/x-matroska"}:26===e[0]&&69===e[1]&&223===e[2]&&163===e[3]?{ext:"webm",mime:"video/webm"}:0===e[0]&&0===e[1]&&0===e[2]&&20===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]?{ext:"mov",mime:"video/quicktime"}:82===e[0]&&73===e[1]&&70===e[2]&&70===e[3]&&65===e[8]&&86===e[9]&&73===e[10]?{ext:"avi",mime:"video/x-msvideo"}:48===e[0]&&38===e[1]&&178===e[2]&&117===e[3]&&142===e[4]&&102===e[5]&&207===e[6]&&17===e[7]&&166===e[8]&&217===e[9]?{ext:"wmv",mime:"video/x-ms-wmv"}:0===e[0]&&0===e[1]&&1===e[2]&&"b"===e[3].toString(16)[0]?{ext:"mpg",mime:"video/mpeg"}:73===e[0]&&68===e[1]&&51===e[2]||255===e[0]&&251===e[1]?{ext:"mp3",mime:"audio/mpeg"}:102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&77===e[8]&&52===e[9]&&65===e[10]||77===e[0]&&52===e[1]&&65===e[2]&&32===e[3]?{ext:"m4a",mime:"audio/m4a"}:79===e[28]&&112===e[29]&&117===e[30]&&115===e[31]&&72===e[32]&&101===e[33]&&97===e[34]&&100===e[35]?{ext:"opus",mime:"audio/opus"}:79===e[0]&&103===e[1]&&103===e[2]&&83===e[3]?{ext:"ogg",mime:"audio/ogg"}:102===e[0]&&76===e[1]&&97===e[2]&&67===e[3]?{ext:"flac",mime:"audio/x-flac"}:82===e[0]&&73===e[1]&&70===e[2]&&70===e[3]&&87===e[8]&&65===e[9]&&86===e[10]&&69===e[11]?{ext:"wav",mime:"audio/x-wav"}:35===e[0]&&33===e[1]&&65===e[2]&&77===e[3]&&82===e[4]&&10===e[5]?{ext:"amr",mime:"audio/amr"}:37===e[0]&&80===e[1]&&68===e[2]&&70===e[3]?{ext:"pdf",mime:"application/pdf"}:77===e[0]&&90===e[1]?{ext:"exe",mime:"application/x-msdownload"}:67!==e[0]&&70!==e[0]||87!==e[1]||83!==e[2]?123===e[0]&&92===e[1]&&114===e[2]&&116===e[3]&&102===e[4]?{ext:"rtf",mime:"application/rtf"}:119===e[0]&&79===e[1]&&70===e[2]&&70===e[3]&&(0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]||79===e[4]&&84===e[5]&&84===e[6]&&79===e[7])?{ext:"woff",mime:"application/font-woff"}:119===e[0]&&79===e[1]&&70===e[2]&&50===e[3]&&(0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]||79===e[4]&&84===e[5]&&84===e[6]&&79===e[7])?{ext:"woff2",mime:"application/font-woff"}:76===e[34]&&80===e[35]&&(0===e[8]&&0===e[9]&&1===e[10]||1===e[8]&&0===e[9]&&2===e[10]||2===e[8]&&0===e[9]&&2===e[10])?{ext:"eot",mime:"application/octet-stream"}:0===e[0]&&1===e[1]&&0===e[2]&&0===e[3]&&0===e[4]?{ext:"ttf",mime:"application/font-sfnt"}:79===e[0]&&84===e[1]&&84===e[2]&&79===e[3]&&0===e[4]?{ext:"otf",mime:"application/font-sfnt"}:0===e[0]&&0===e[1]&&1===e[2]&&0===e[3]?{ext:"ico",mime:"image/x-icon"}:70===e[0]&&76===e[1]&&86===e[2]&&1===e[3]?{ext:"flv",mime:"video/x-flv"}:37===e[0]&&33===e[1]?{ext:"ps",mime:"application/postscript"}:253===e[0]&&55===e[1]&&122===e[2]&&88===e[3]&&90===e[4]&&0===e[5]?{ext:"xz",mime:"application/x-xz"}:83===e[0]&&81===e[1]&&76===e[2]&&105===e[3]?{ext:"sqlite",mime:"application/x-sqlite3"}:78===e[0]&&69===e[1]&&83===e[2]&&26===e[3]?{ext:"nes",mime:"application/x-nintendo-nes-rom"}:67===e[0]&&114===e[1]&&50===e[2]&&52===e[3]?{ext:"crx",mime:"application/x-google-chrome-extension"}:77===e[0]&&83===e[1]&&67===e[2]&&70===e[3]||73===e[0]&&83===e[1]&&99===e[2]&&40===e[3]?{ext:"cab",mime:"application/vnd.ms-cab-compressed"}:33===e[0]&&60===e[1]&&97===e[2]&&114===e[3]&&99===e[4]&&104===e[5]&&62===e[6]&&10===e[7]&&100===e[8]&&101===e[9]&&98===e[10]&&105===e[11]&&97===e[12]&&110===e[13]&&45===e[14]&&98===e[15]&&105===e[16]&&110===e[17]&&97===e[18]&&114===e[19]&&121===e[20]?{ext:"deb",mime:"application/x-deb"}:33===e[0]&&60===e[1]&&97===e[2]&&114===e[3]&&99===e[4]&&104===e[5]&&62===e[6]?{ext:"ar",mime:"application/x-unix-archive"}:237===e[0]&&171===e[1]&&238===e[2]&&219===e[3]?{ext:"rpm",mime:"application/x-rpm"}:31===e[0]&&160===e[1]||31===e[0]&&157===e[1]?{ext:"Z",mime:"application/x-compress"}:76===e[0]&&90===e[1]&&73===e[2]&&80===e[3]?{ext:"lz",mime:"application/x-lzip"}:208===e[0]&&207===e[1]&&17===e[2]&&224===e[3]&&161===e[4]&&177===e[5]&&26===e[6]&&225===e[7]?{ext:"msi",mime:"application/x-msi"}:null:{ext:"swf",mime:"application/x-shockwave-flash"}:{ext:"rar",mime:"application/x-rar-compressed"}:{ext:"zip",mime:"application/zip"}:null},ER=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.detect=void 0;var r=i(Xl);t.default=o,t.detectSync=a;var n=i(_R);function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return new r.default(function(t){t(a(e))})}function a(e){var t=e;if(Tw.inBrowser){if(e instanceof Blob)return e.type;if(e instanceof ArrayBuffer)t=new Uint8Array(e);else if(!(e instanceof Uint8Array))throw new Error("`detect` requires a buffer of type Blob, ArrayBuffer, or Uint8Array")}var r=(0,n.default)(t);return r?r.mime:"application/octet-stream"}t.detect=o});t(ER);ER.detect,ER.detectSync;var bR=Object.prototype.hasOwnProperty,SR=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),TR=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r},wR={arrayToObject:TR,assign:function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],o=i.obj[i.prop],a=Object.keys(o),s=0;s<a.length;++s){var u=a[s],c=o[u];"object"==typeof c&&null!==c&&-1===r.indexOf(c)&&(t.push({obj:o,prop:u}),r.push(c))}return function(e){for(var t;e.length;){var r=e.pop();if(t=r.obj[r.prop],Array.isArray(t)){for(var n=[],i=0;i<t.length;++i)void 0!==t[i]&&n.push(t[i]);r.obj[r.prop]=n}}return t}(t)},decode:function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},encode:function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),r="",n=0;n<t.length;++n){var i=t.charCodeAt(n);45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122?r+=t.charAt(n):i<128?r+=SR[i]:i<2048?r+=SR[192|i>>6]+SR[128|63&i]:i<55296||i>=57344?r+=SR[224|i>>12]+SR[128|i>>6&63]+SR[128|63&i]:(n+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(n)),r+=SR[240|i>>18]+SR[128|i>>12&63]+SR[128|i>>6&63]+SR[128|63&i])}return r},isBuffer:function(e){return null!=e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(Array.isArray(t))t.push(r);else{if("object"!=typeof t)return[t,r];(n.plainObjects||n.allowPrototypes||!bR.call(Object.prototype,r))&&(t[r]=!0)}return t}if("object"!=typeof t)return[t].concat(r);var i=t;return Array.isArray(t)&&!Array.isArray(r)&&(i=TR(t,n)),Array.isArray(t)&&Array.isArray(r)?(r.forEach(function(r,i){bR.call(t,i)?t[i]&&"object"==typeof t[i]?t[i]=e(t[i],r,n):t.push(r):t[i]=r}),t):Object.keys(r).reduce(function(t,i){var o=r[i];return bR.call(t,i)?t[i]=e(t[i],o,n):t[i]=o,t},i)}},OR=String.prototype.replace,kR=/%20/g,RR={default:"RFC3986",formatters:{RFC1738:function(e){return OR.call(e,kR,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"},AR={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},IR=Date.prototype.toISOString,PR={delimiter:"&",encode:!0,encoder:wR.encode,encodeValuesOnly:!1,serializeDate:function(e){return IR.call(e)},skipNulls:!1,strictNullHandling:!1},CR=function e(t,r,n,i,o,a,s,u,c,l,f,d){var p=t;if("function"==typeof s)p=s(r,p);else if(p instanceof Date)p=l(p);else if(null===p){if(i)return a&&!d?a(r,PR.encoder):r;p=""}if("string"==typeof p||"number"==typeof p||"boolean"==typeof p||wR.isBuffer(p))return a?[f(d?r:a(r,PR.encoder))+"="+f(a(p,PR.encoder))]:[f(r)+"="+f(String(p))];var h,v=[];if(void 0===p)return v;if(Array.isArray(s))h=s;else{var g=Object.keys(p);h=u?g.sort(u):g}for(var m=0;m<h.length;++m){var y=h[m];o&&null===p[y]||(v=Array.isArray(p)?v.concat(e(p[y],n(r,y),n,i,o,a,s,u,c,l,f,d)):v.concat(e(p[y],r+(c?"."+y:"["+y+"]"),n,i,o,a,s,u,c,l,f,d)))}return v},MR=Object.prototype.hasOwnProperty,NR={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:wR.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},DR=function(e,t,r){if(e){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,i=/(\[[^[\]]*])/g,o=/(\[[^[\]]*])/.exec(n),a=o?n.slice(0,o.index):n,s=[];if(a){if(!r.plainObjects&&MR.call(Object.prototype,a)&&!r.allowPrototypes)return;s.push(a)}for(var u=0;null!==(o=i.exec(n))&&u<r.depth;){if(u+=1,!r.plainObjects&&MR.call(Object.prototype,o[1].slice(1,-1))&&!r.allowPrototypes)return;s.push(o[1])}return o&&s.push("["+n.slice(o.index)+"]"),function(e,t,r){for(var n=t,i=e.length-1;i>=0;--i){var o,a=e[i];if("[]"===a)o=(o=[]).concat(n);else{o=r.plainObjects?Object.create(null):{};var s="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,u=parseInt(s,10);!isNaN(u)&&a!==s&&String(u)===s&&u>=0&&r.parseArrays&&u<=r.arrayLimit?(o=[])[u]=n:o[s]=n}n=o}return n}(s,t,r)}},jR={formats:RR,parse:function(e,t){var r=t?wR.assign({},t):{};if(null!==r.decoder&&void 0!==r.decoder&&"function"!=typeof r.decoder)throw new TypeError("Decoder has to be a function.");if(r.ignoreQueryPrefix=!0===r.ignoreQueryPrefix,r.delimiter="string"==typeof r.delimiter||wR.isRegExp(r.delimiter)?r.delimiter:NR.delimiter,r.depth="number"==typeof r.depth?r.depth:NR.depth,r.arrayLimit="number"==typeof r.arrayLimit?r.arrayLimit:NR.arrayLimit,r.parseArrays=!1!==r.parseArrays,r.decoder="function"==typeof r.decoder?r.decoder:NR.decoder,r.allowDots="boolean"==typeof r.allowDots?r.allowDots:NR.allowDots,r.plainObjects="boolean"==typeof r.plainObjects?r.plainObjects:NR.plainObjects,r.allowPrototypes="boolean"==typeof r.allowPrototypes?r.allowPrototypes:NR.allowPrototypes,r.parameterLimit="number"==typeof r.parameterLimit?r.parameterLimit:NR.parameterLimit,r.strictNullHandling="boolean"==typeof r.strictNullHandling?r.strictNullHandling:NR.strictNullHandling,""===e||null==e)return r.plainObjects?Object.create(null):{};for(var n="string"==typeof e?function(e,t){for(var r={},n=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,o=n.split(t.delimiter,i),a=0;a<o.length;++a){var s,u,c=o[a],l=c.indexOf("]="),f=-1===l?c.indexOf("="):l+1;-1===f?(s=t.decoder(c,NR.decoder),u=t.strictNullHandling?null:""):(s=t.decoder(c.slice(0,f),NR.decoder),u=t.decoder(c.slice(f+1),NR.decoder)),MR.call(r,s)?r[s]=[].concat(r[s]).concat(u):r[s]=u}return r}(e,r):e,i=r.plainObjects?Object.create(null):{},o=Object.keys(n),a=0;a<o.length;++a){var s=o[a],u=DR(s,n[s],r);i=wR.merge(i,u,r)}return wR.compact(i)},stringify:function(e,t){var r=e,n=t?wR.assign({},t):{};if(null!==n.encoder&&void 0!==n.encoder&&"function"!=typeof n.encoder)throw new TypeError("Encoder has to be a function.");var i=void 0===n.delimiter?PR.delimiter:n.delimiter,o="boolean"==typeof n.strictNullHandling?n.strictNullHandling:PR.strictNullHandling,a="boolean"==typeof n.skipNulls?n.skipNulls:PR.skipNulls,s="boolean"==typeof n.encode?n.encode:PR.encode,u="function"==typeof n.encoder?n.encoder:PR.encoder,c="function"==typeof n.sort?n.sort:null,l=void 0!==n.allowDots&&n.allowDots,f="function"==typeof n.serializeDate?n.serializeDate:PR.serializeDate,d="boolean"==typeof n.encodeValuesOnly?n.encodeValuesOnly:PR.encodeValuesOnly;if(void 0===n.format)n.format=RR.default;else if(!Object.prototype.hasOwnProperty.call(RR.formatters,n.format))throw new TypeError("Unknown format option provided.");var p,h,v=RR.formatters[n.format];"function"==typeof n.filter?r=(h=n.filter)("",r):Array.isArray(n.filter)&&(p=h=n.filter);var g,m=[];if("object"!=typeof r||null===r)return"";g=n.arrayFormat in AR?n.arrayFormat:"indices"in n?n.indices?"indices":"repeat":"indices";var y=AR[g];p||(p=Object.keys(r)),c&&p.sort(c);for(var _=0;_<p.length;++_){var E=p[_];a&&null===r[E]||(m=m.concat(CR(r[E],E,y,o,a,s?u:null,h,c,l,f,v,d)))}var b=m.join(i),S=!0===n.addQueryPrefix?"?":"";return b.length>0?S+b:""}},xR="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},LR=function(e){var t=UR.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},UR=Object.prototype.toString;var FR=r(function(e,t){(t=e.exports=function(e){return e.replace(/^\s*|\s*$/g,"")}).left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}}),GR=(FR.left,FR.right,Function.prototype.toString),qR=/^\s*class /,VR=function(e){try{var t=GR.call(e).replace(/\/\/.*\n/g,"").replace(/\/\*[.\s\S]*\*\//g,"").replace(/\n/gm," ").replace(/ {2}/g," ");return qR.test(t)}catch(e){return!1}},BR=Object.prototype.toString,zR="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,HR=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(zR)return function(e){try{return!VR(e)&&(GR.call(e),!0)}catch(e){return!1}}(e);if(VR(e))return!1;var t=BR.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t},WR=Object.prototype.toString,YR=Object.prototype.hasOwnProperty,XR=function(e,t,r){if(!HR(t))throw new TypeError("iterator must be a function");var n;arguments.length>=3&&(n=r),"[object Array]"===WR.call(e)?function(e,t,r){for(var n=0,i=e.length;n<i;n++)YR.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))}(e,t,n):"string"==typeof e?function(e,t,r){for(var n=0,i=e.length;n<i;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)}(e,t,n):function(e,t,r){for(var n in e)YR.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))}(e,t,n)},JR=function(e){if(!e)return{};var t={};return XR(FR(e).split("\n"),function(e){var r,n=e.indexOf(":"),i=FR(e.slice(0,n)).toLowerCase(),o=FR(e.slice(n+1));void 0===t[i]?t[i]=o:(r=t[i],"[object Array]"===Object.prototype.toString.call(r)?t[i].push(o):t[i]=[t[i],o])}),t},KR=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var n in r)$R.call(r,n)&&(e[n]=r[n])}return e},$R=Object.prototype.hasOwnProperty;var QR=r(function(e){var t,r=(t=sf)&&t.__esModule?t:{default:t};function n(e,t,r){var n=e;return LR(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=KR(t,{uri:e}),n.callback=r,n}function i(e,t,r){return o(t=n(e,t,r))}function o(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(r,n,i){t||(t=!0,e.callback(r,n,i))};function o(){var e=void 0;if(e=l.response?l.response:l.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML;return null}(l),m)try{e=JSON.parse(e)}catch(e){}return e}function a(e){return clearTimeout(f),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,y)}function s(){if(!c){var t;clearTimeout(f),t=e.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var r=y,i=null;return 0!==t?(r={body:o(),statusCode:t,method:p,headers:{},url:d,rawRequest:l},l.getAllResponseHeaders&&(r.headers=JR(l.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),n(i,r,r.body)}}var u,c,l=e.xhr||null;l||(l=e.cors||e.useXDR?new i.XDomainRequest:new i.XMLHttpRequest);var f,d=e.uri||e.url,p=e.method||"GET",h=e.body||e.data,v=e.headers||{},g=!!e.sync,m=!1,y={body:void 0,headers:{},statusCode:0,method:p,url:d,rawRequest:l};if("json"in e&&!1!==e.json&&(m=!0,v.accept||v.Accept||(v.Accept="application/json"),"GET"!==p&&"HEAD"!==p&&(v["content-type"]||v["Content-Type"]||(v["Content-Type"]="application/json"),h=(0,r.default)(!0===e.json?h:e.json))),l.onreadystatechange=function(){4===l.readyState&&setTimeout(s,0)},l.onload=s,l.onerror=a,l.onprogress=function(){},l.onabort=function(){c=!0},l.ontimeout=a,l.open(p,d,!g,e.username,e.password),g||(l.withCredentials=!!e.withCredentials),!g&&e.timeout>0&&(f=setTimeout(function(){if(!c){c=!0,l.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",a(e)}},e.timeout)),l.setRequestHeader)for(u in v)v.hasOwnProperty(u)&&l.setRequestHeader(u,v[u]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(l.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(l),l.send(h||null),l}e.exports=i,i.XMLHttpRequest=xR.XMLHttpRequest||function(){},i.XDomainRequest="withCredentials"in new i.XMLHttpRequest?i.XMLHttpRequest:xR.XDomainRequest,function(e,t){for(var r=0;r<e.length;r+=1)t(e[r])}(["get","put","post","patch","head","delete"],function(e){i["delete"===e?"del":e]=function(t,r,i){return(r=n(t,r,i)).method=e.toUpperCase(),o(r)}})});t(QR);var ZR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=d(j_),n=d(Fu),i=d(Yk),o=d(Ow),a=d(Xl),s=d(eR),u=d(Hd),c=d(Fb);t.default=function(e){return new a.default(function(t){var a=(0,s.default)(e,"method","uri","withCredentials","headers","timeout","responseType");a.response=!0,function(e,t){e.method&&["PATCH","POST","PUT"].includes(e.method.toUpperCase())&&(e.xhr=new XMLHttpRequest,e.xhr.upload.onprogress=t.upload.emit.bind(t.upload,"progress"))}(a,e),function(e,t){if(t.auth)if(t.auth.bearer)e.headers.authorization="Bearer "+t.auth.bearer;else{var r=t.auth.user||t.auth.username,n=t.auth.pass||t.auth.password,i=btoa(r+":"+n);e.headers.authorization="Basic "+i}}(a,e),function(e,t){t.jar&&(e.withCredentials=!0)}(a,e),function(e,t){var r={cors:!0,withCredentials:!1,timeout:0};(0,c.default)(e,(0,s.default)(t,(0,o.default)(r)),r)}(a,e),function(e,t){"buffer"===t.responseType&&(e.responseType="arraybuffer")}(a,e),function(e,t){(t.body instanceof Blob||t.body instanceof ArrayBuffer)&&(t.json=e.json=!1,e.headers["content-type"]=e.headers["content-type"]||(0,ER.detectSync)(t.body))}(a,e),function(e,t){"json"in t&&!0!==t.json||!t.body?t.form?(e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=l.default.stringify(t.form),(0,n.default)(e,"json")):t.formData?e.body=(0,o.default)(t.formData).reduce(function(e,r){var n=t.formData[r];return function e(t,r,n){if((0,u.default)(n)){var o=!0,a=!1,s=void 0;try{for(var c,l=(0,i.default)(n);!(o=(c=l.next()).done);o=!0){var f=c.value;e(t,r,f)}}catch(e){a=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}return}n=function(e){if(e instanceof ArrayBuffer){var t=e.type?new Blob([e],{type:e.type}):new Blob([e]);return t.filename=e.filename||e.name||"untitled",t}return e}(n);n.name?(n.filename=n.name,t.append(r,n,n.name)):t.append(r,n)}(e,r,n),e},new FormData):(e.body=t.body,(0,n.default)(e,"json")):e.json=t.body}(a,e),function(e,t){t.qs&&(e.uri+="?"+l.default.stringify(t.qs))}(a,e);var d=(0,f.default)(a,function(n,i){n&&e.logger.warn(n),i?(i.options=e,function(e,t){if(!t.json&&"object"!==(0,r.default)(e.body))try{e.body=JSON.parse(e.body)}catch(e){}}(i,a),t(i)):t({statusCode:0,options:e,headers:e.headers,method:e.method,url:e.uri,body:n})});d.onprogress=e.download.emit.bind(e.download,"progress")}).catch(function(t){return{statusCode:0,options:e,headers:e.headers,method:e.method,url:e.uri,body:t}})};var l=d(jR),f=d(QR);function d(e){return e&&e.__esModule?e:{default:e}}});t(ZR);var eA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(Xl);t.default=function(e){e.url&&(e.uri=e.url,e.url=null);e.headers=e.headers||{},Tw.inBrowser||e.headers["user-agent"]||(e.headers["user-agent"]="@ciscospark/http-core");return e.download=new qb.EventEmitter,e.upload=new qb.EventEmitter,t(e.interceptors,"Request").then(function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.default.apply(void 0,[e].concat(r))}).then(function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.apply(void 0,[e.interceptors.slice().reverse(),"Response"].concat(n))});function t(t,n,i){var o="on"+n,a="on"+n+"Error";return t.reduce(function(t,n){return t.then(function(t){return n[o]?n[o](e,t):r.default.resolve(t)},function(t){return n[a]?n[a](e,t):r.default.reject(t)})},r.default.resolve(i))}};var n=i(ZR);function i(e){return e&&e.__esModule?e:{default:e}}});t(eA);var tA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.detectSync=t.detect=t.HttpStatusInterceptor=t.HttpError=t.Interceptor=t.ProgressEvent=t.request=t.defaults=void 0;var r=f(Fu),n=f(rR),i=f(iR),o=f(zw),a=f(Fb),s=f(Pk),u=f(Nw);Object.defineProperty(t,"ProgressEvent",{enumerable:!0,get:function(){return f(cR).default}}),Object.defineProperty(t,"Interceptor",{enumerable:!0,get:function(){return f(lR).default}}),Object.defineProperty(t,"HttpError",{enumerable:!0,get:function(){return f(mR).default}}),Object.defineProperty(t,"HttpStatusInterceptor",{enumerable:!0,get:function(){return f(yR).default}}),Object.defineProperty(t,"detect",{enumerable:!0,get:function(){return ER.detect}}),Object.defineProperty(t,"detectSync",{enumerable:!0,get:function(){return ER.detectSync}});var c=f(yR),l=f(eA);function f(e){return e&&e.__esModule?e:{default:e}}var d=(0,s.default)(function(e,t){if((0,o.default)(t)){var s=t;(t=arguments[2]||{}).uri=s}return["download","interceptors","logger","upload"].forEach(function(e){var r=(0,i.default)(t,e);r=(0,u.default)({},r,{enumerable:!1,writable:!0}),(0,n.default)(t,e,r)}),(0,a.default)(t,e),t.json||(0,r.default)(t,"json"),t.logger=t.logger||console,(0,l.default)(t)}),p={json:!0,interceptors:[c.default.create()]};t.defaults=d,t.request=d(p)});t(tA);tA.detectSync,tA.detect,tA.HttpStatusInterceptor,tA.HttpError,tA.Interceptor,tA.ProgressEvent,tA.request,tA.defaults;var rA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(rR),n=c(nf),i=c(MS),o=c(_y),a=c(Ty),s=c(NS),u=c(DS);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"parse",value:function(e){var t=(0,n.default)(tA.HttpError.prototype.parse,this,[e]);return(0,r.default)(this,"options",{enumerable:!1,value:e.options}),this.options.url?t+="\n"+this.options.method+" "+this.options.url:this.options.uri?t+="\n"+this.options.method+" "+this.options.uri:t+="\n"+this.options.method+" "+this.options.service.toUpperCase()+"/"+this.options.resource,t+="\nWEBEX_TRACKING_ID: "+this.options.headers.trackingid,this.options.headers&&this.options.headers["x-trans-id"]&&(t+="\nX-Trans-Id: "+this.options.headers["x-trans-id"]),this.headers["retry-after"]&&((0,r.default)(this,"retryAfter",{enumerable:!0,value:this.headers["retry-after"],writeable:!1}),t+="\nRETRY-AFTER: "+this.retryAfter),t+="\n"}}]),t}(tA.HttpError);t.default=l,tA.HttpError.makeSubTypes(l);var f=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),t}(tA.HttpError.BadRequest);tA.HttpError[429]=f,tA.HttpError.TooManyRequests=f});t(rA);var nA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=d(xu),i=d(Xk),o=d(nf),a=d(Zl),s=d(Xl),u=d(eR),c=d(rA),l=d(Lk),f=d(qk);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function h(e){if(400!==e.statusCode)return s.default.reject(e);var t=f.default.select(e.body.error);return t===qk.OAuthError&&e instanceof c.default?s.default.reject(e):t?s.default.reject(new t(e._res||e)):s.default.reject(e)}var v=l.default.extend((p(r={derived:{canAuthorize:{deps:["access_token","isExpired"],fn:function(){return!!this.access_token&&!this.isExpired}},canDownscope:{deps:["canAuthorize"],fn:function(){return this.canAuthorize&&!!this.config.client_id}},canRefresh:{deps:["refresh_token"],fn:function(){return Tw.inBrowser?!!this.refresh_token&&!!this.config.refreshCallback:!!this.refresh_token&&!!this.config.client_secret}},isExpired:{deps:["expires","_isExpired"],fn:function(){return!!this.expires&&this._isExpired}},_string:{deps:["access_token","token_type"],fn:function(){return this.access_token&&this.token_type?this.token_type+" "+this.access_token:""}}},namespace:"Credentials",props:{scope:"string",access_token:"string",expires:"number",expires_in:"number",refresh_token:"string",refresh_token_expires:"number",refresh_token_expires_in:"number",token_type:{default:"Bearer",type:"string"}},session:{_isExpired:{default:!1,type:"boolean"},previousToken:{type:"state"}},downscope:function(e){var t=this;return this.logger.info("token: downscoping token to "+e),this.isExpired?(this.logger.info("token: request received to downscope expired access_token"),s.default.reject(new Error("cannot downscope expired access token"))):this.canDownscope?(e&&(e=(0,Vk.sortScope)(e)),e===(0,Vk.sortScope)(this.config.scope)?s.default.reject(new Error("token: scope reduction requires a reduced scope")):this.spark.request({method:"POST",uri:this.config.tokenUrl,addAuthHeader:!1,form:{grant_type:"urn:cisco:oauth:grant-type:scope-reduction",token:this.access_token,scope:e,client_id:this.config.client_id}}).then(function(r){return t.logger.info("token: downscoped token to "+e),new v((0,a.default)(r.body,{scope:e}),{parent:t.parent})})):(this.config.client_id?this.logger.info("token: request received to downscope invalid access_token"):this.logger.warn("token: cannot downscope without client_id"),s.default.reject(new Error("cannot downscope access token")))},initialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,o.default)(l.default.prototype.initialize,this,[t,r]),"string"==typeof t&&(this.access_token=t),!this.access_token)throw new Error("`access_token` is required");this.expires&&(this.expires<Date.now()?this._isExpired=!0:(0,Aw.safeSetTimeout)(function(){e._isExpired=!0},this.expires-Date.now()))},refresh:function(){var e=this;if(!this.canRefresh)throw new Error("Not enough information available to refresh this access token");var t=void 0;if(Tw.inBrowser){if(!this.config.refreshCallback)throw new Error("Cannot refresh access token without refreshCallback");t=s.default.resolve(this.config.refreshCallback(this.spark,this))}return(t||this.spark.request({method:"POST",uri:this.config.tokenUrl,form:{grant_type:"refresh_token",redirect_uri:this.config.redirect_uri,refresh_token:this.refresh_token},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then(function(e){return e.body})).then(function(t){if(!t)throw new Error("token: refreshCallback() did not produce an object");return t.refresh_token||(0,a.default)(t,(0,u.default)(e,"refresh_token","refresh_token_expires","refresh_token_expires_in")),e.access_token===t.access_token?(e.logger.error("token: new token matches current token"),e.logger.error("token: current token:",e.access_token),e.logger.error("token: new token:",t.access_token),s.default.reject(new Error("new token matches current token"))):(e.previousToken&&(e.previousToken.revoke(),e.unset("previousToken")),t.previousToken=e,t.scope=e.scope,new v(t,{parent:e.parent}))}).catch(h)},revoke:function(){var e=this;return this.isExpired?(this.logger.info("token: already expired, not making making revocation request"),s.default.resolve()):this.canAuthorize?this.config.client_secret?(this.logger.info("token: revoking access token"),this.spark.request({method:"POST",uri:this.config.revokeUrl,form:{token:this.access_token,token_type_hint:"access_token"},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then(function(){e.unset(["access_token","expires","expires_in","token_type"]),e.logger.info("token: access token revoked")}).catch(h)):(this.logger.info("token: no client secret available, not making revocation request"),s.default.resolve()):(this.logger.info("token: no longer valid, not making revocation request"),s.default.resolve())},set:function(){var e=this._filterSetParameters.apply(this,arguments),t=(0,i.default)(e,2),r=t[0],n=t[1];if(!r.token_type&&r.access_token&&r.access_token.includes(" ")){var s=r.access_token.split(" "),u=(0,i.default)(s,2),c=u[0],f=u[1];r=(0,a.default)({},r,{access_token:f,token_type:c})}var d=Date.now();return!r.expires&&r.expires_in&&(r.expires=d+1e3*r.expires_in),!r.refresh_token_expires&&r.refresh_token_expires_in&&(r.refresh_token_expires=d+1e3*r.refresh_token_expires_in),r.scope&&(r.scope=(0,Vk.sortScope)(r.scope)),(0,o.default)(l.default.prototype.set,this,[r,n])},toString:function(){if(!this._string)throw new Error("cannot stringify Token");return this._string},validate:function(){var e=this;return this.spark.request({method:"POST",service:"conversation",resource:"users/validateAuthToken",body:{token:this.access_token}}).catch(function(t){if("statusCode"in t)return s.default.reject(t);e.logger.info("REMINDER: If you're investigating a network error here, it's normal");return e.spark.request({method:"POST",uri:"https://conv-a.wbx2.com/conversation/api/v1/users/validateAuthToken",body:{token:e.access_token},headers:{authorization:"Bearer "+e.access_token}})}).then(function(e){return e.body})},version:"1.50.2"},"downscope",[(0,Tw.oneFlight)({keyFactory:function(e){return e}})],(0,n.default)(r,"downscope"),r),p(r,"refresh",[Tw.oneFlight],(0,n.default)(r,"refresh"),r),p(r,"revoke",[Tw.oneFlight],(0,n.default)(r,"revoke"),r),r));t.default=v});t(nA);var iA=function(e){var t,r=this,n=[].slice.call(arguments);t=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return r.apply(this,arguments)},Nw(t,r);var i=function(){this.constructor=t};return i.prototype=r.prototype,t.prototype=new i,e&&(n.unshift(t.prototype),Nw.apply(null,n)),t.__super__=r.prototype,t},oA=H_(function(e,t,r){var n=1;if(r.length){var i=BE(r,FE(oA));n|=32}return Ab(e,n,t,r,i)});oA.placeholder={};var aA=oA,sA=[].slice;function uA(e,t){if(t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),t.parent&&(this.parent=t.parent),!this.mainIndex){var r=this.model&&this.model.prototype&&this.model.prototype.idAttribute;this.mainIndex=r||"id"}this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,Nw({silent:!0},t))}Nw(uA.prototype,sk,{initialize:function(){},isModel:function(e){return this.model&&e instanceof this.model},add:function(e,t){return this.set(e,Nw({merge:!1,add:!0,remove:!1},t))},parse:function(e,t){return e},serialize:function(){return this.map(function(e){if(e.serialize)return e.serialize();var t={};return Nw(t,e),delete t.collection,t})},toJSON:function(){return this.serialize()},set:function(e,t){(t=Nw({add:!0,remove:!0,merge:!0},t)).parse&&(e=this.parse(e,t));var r,n,i,o,a,s,u,c=!Hd(e);e=c?e?[e]:[]:e.slice();var l=t.at,f=this.comparator&&null==l&&!1!==t.sort,d="string"==typeof this.comparator?this.comparator:null,p=[],h=[],v={},g=t.add,m=t.merge,y=t.remove,_=!(f||!g||!y)&&[],E=this.model&&this.model.prototype||Object.prototype;for(s=0,u=e.length;s<u;s++){if(i=e[s]||{},this.isModel(i)?r=n=i:E.generateId?r=E.generateId(i):void 0===(r=i[this.mainIndex])&&this._isDerivedIndex(E)&&(r=E._derived[this.mainIndex].fn.call(i)),o=this.get(r))y&&(v[o.cid||o[this.mainIndex]]=!0),m&&(i=i===n?n.attributes:i,t.parse&&(i=o.parse(i,t)),o.set?(o.set(i,t),f&&!a&&o.hasChanged(d)&&(a=!0)):Nw(o,i)),e[s]=o;else if(g){if(!(n=e[s]=this._prepareModel(i,t)))continue;p.push(n),this._addReference(n,t)}(n=o||n)&&(_&&(n.isNew&&n.isNew()||!n[this.mainIndex]||!v[n.cid||n[this.mainIndex]])&&_.push(n),v[n[this.mainIndex]]=!0)}if(y){for(s=0,u=this.length;s<u;s++)v[(n=this.models[s]).cid||n[this.mainIndex]]||h.push(n);for(h.length&&this.remove(h,t),s=0,u=p.length;s<u;s++)this._index(p[s])}if(p.length||_&&_.length)if(f&&(a=!0),null!=l)for(s=0,u=p.length;s<u;s++)this.models.splice(l+s,0,p[s]);else{var b=_||p;for(s=0,u=b.length;s<u;s++)this.models.push(b[s])}if(a&&this.sort({silent:!0}),!t.silent){for(s=0,u=p.length;s<u;s++)(n=p[s]).trigger?n.trigger("add",n,this,t):this.trigger("add",n,this,t);(a||_&&_.length)&&this.trigger("sort",this,t)}return c?e[0]:e},get:function(e,t){if(null!=e){var r=this.mainIndex,n=this._indexes[t||r];return n&&(n[e]||void 0!==e[r]&&n[e[r]])||this._indexes.cid[e]||this._indexes.cid[e.cid]}},at:function(e){return this.models[e]},remove:function(e,t){var r,n,i,o,a=!Hd(e);for(t||(t={}),r=0,n=(e=a?[e]:sA.call(e)).length;r<n;r++)(i=e[r]=this.get(e[r]))&&(this._deIndex(i),o=this.models.indexOf(i),this.models.splice(o,1),t.silent||(t.index=o,i.trigger?i.trigger("remove",i,this,t):this.trigger("remove",i,this,t)),this._removeReference(i,t));return a?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,n=this.models.length;r<n;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,Nw({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},sort:function(e){var t=this;if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),"string"==typeof this.comparator?this.models.sort(function(e,r){return e.get?(e=e.get(t.comparator),r=r.get(t.comparator)):(e=e[t.comparator],r=r[t.comparator]),e>r||void 0===e?1:e<r||void 0===r?-1:0}):1===this.comparator.length?this.models.sort(function(e,r){return(e=t.comparator(e))>(r=t.comparator(r))||void 0===e?1:e<r||void 0===r?-1:0}):this.models.sort(aA(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},_reset:function(){var e=sA.call(this.indexes||[]),t=0;e.push(this.mainIndex),e.push("cid");var r=e.length;for(this.models=[],this._indexes={};t<r;t++)this._indexes[e[t]]={}},_prepareModel:function(e,t){if(!this.model)return e;if(this.isModel(e))return e.collection||(e.collection=this),e;(t=t?Nw({},t):{}).collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_deIndex:function(e,t,r){var n;if(void 0===t)for(var i in this._indexes)n=e.hasOwnProperty(i)?e[i]:e.get&&e.get(i),delete this._indexes[i][n];else{if(void 0===this._indexes[t])throw new Error("Given attribute is not an index");delete this._indexes[t][r]}},_index:function(e,t){var r;if(void 0===t)for(var n in this._indexes)null!=(r=e.hasOwnProperty(n)?e[n]:e.get&&e.get(n))&&(this._indexes[n][r]=e);else{if(void 0===this._indexes[t])throw new Error("Given attribute is not an index");(r=e[t]||e.get&&e.get(t))&&(this._indexes[t][r]=e)}},_isDerivedIndex:function(e){return!(!e||"object"!=typeof e._derived)&&Object.keys(e._derived).indexOf(this.mainIndex)>=0},_addReference:function(e,t){this._index(e),e.collection||(e.collection=this),e.on&&e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,this._deIndex(e),e.off&&e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,r,n){var i=e.split(":")[0],o=e.split(":")[1];("add"!==i&&"remove"!==i||r===this)&&("destroy"===i&&this.remove(t,n),t&&"change"===i&&o&&this._indexes[o]&&(this._deIndex(t,o,t.previousAttributes()[o]),this._index(t,o)),this.trigger.apply(this,arguments))}}),Object.defineProperties(uA.prototype,{length:{get:function(){return this.models.length}},isCollection:{get:function(){return!0}}});["indexOf","lastIndexOf","every","some","forEach","map","filter","reduce","reduceRight"].forEach(function(e){uA.prototype[e]=function(){return this.models[e].apply(this.models,arguments)}}),uA.prototype.each=uA.prototype.forEach,uA.extend=iA;var cA=uA,lA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(cA),n=i(nA);function i(e){return e&&e.__esModule?e:{default:e}}var o=r.default.extend({mainIndex:"scope",model:n.default,namespace:"Credentials"});t.default=o});t(lA);var fA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o,a,s,u,c=k(xu),l=k(Xl),f=k(nf),d=k(Ow),p=k(Zl),h=k(sf),v=k(Fu),g=k(Bv),m=k(Uf),y=k(Wv),_=k(Rw),E=k(eg),b=k(Xm),S=k(Lk),T=k(qk),w=k(nA),O=k(lA);function k(e){return e&&e.__esModule?e:{default:e}}function R(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var A=S.default.extend((r=(0,Tw.oneFlight)({keyFactory:function(e){return e}}),n=(0,Mk.waitForValue)("@"),i=(0,Mk.persist)("@"),o=(0,Mk.waitForValue)("@"),a=(0,Tw.whileInFlight)("isRefreshing"),s=(0,Mk.waitForValue)("@"),R(u={collections:{userTokens:O.default},dataTypes:{token:(0,Tw.makeStateDataType)(w.default,"token").dataType},derived:{canAuthorize:{deps:["supertoken","supertoken.canAuthorize","canRefresh"],fn:function(){return Boolean(this.supertoken&&this.supertoken.canAuthorize||this.canRefresh)}},canRefresh:{deps:["supertoken","supertoken.canRefresh"],fn:function(){return!!this.config.jwtRefreshCallback||Boolean(this.supertoken&&this.supertoken.canRefresh)}}},props:{supertoken:(0,Tw.makeStateDataType)(w.default,"token").prop},namespace:"Credentials",session:{isRefreshing:{default:!1,type:"boolean"},ready:{default:!1,type:"boolean"},refreshTimer:{default:void 0,type:"any"}},buildLoginUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clientType:"public"};if(e.state&&!(0,m.default)(e.state))throw new Error("if specified, `options.state` must be an object");return e.client_id=this.config.client_id,e.redirect_uri=this.config.redirect_uri,e.scope=this.config.scope,(e=(0,y.default)(e)).response_type||(e.response_type="public"===e.clientType?"token":"code"),(0,v.default)(e,"clientType"),e.state&&((0,g.default)(e.state)?delete e.state:e.state=Tw.base64.toBase64Url((0,h.default)(e.state))),this.config.authorizeUrl+"?"+E.default.stringify(e)},buildLogoutUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.config.logoutUrl+"?"+E.default.stringify((0,p.default)({cisService:this.config.service,goto:this.config.redirect_uri},e))},calcRefreshTimeout:function(e){return Math.floor((Math.floor(4*Math.random())+6)/10*e)},constructor:function(){var e=this;this._dataTypes=(0,y.default)(this._dataTypes),(0,d.default)(this._dataTypes).forEach(function(t){e._dataTypes[t].set&&(e._dataTypes[t].set=e._dataTypes[t].set.bind(e))});for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(0,f.default)(S.default,this,r)},downscope:function(e){var t=this;return this.supertoken.downscope(e).catch(function(r){return t.logger.error("credentials: failed to downscope supertoken to "+e,r),t.logger.error("credentials: falling back to supertoken for "+e),l.default.resolve(new w.default((0,p.default)({scope:e},t.supertoken.serialize())),{parent:t})})},getClientToken:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.logger.info("credentials: requesting client credentials grant"),(t=t||{}).scope=t.scope||"webexsquare:admin",this.spark.request({method:"POST",uri:this.config.tokenUrl,form:{grant_type:"client_credentials",scope:t.scope,self_contained_token:!0},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then(function(t){return new w.default(t.body,{parent:e})}).catch(function(e){if(400!==e.statusCode)return l.default.reject(e);var t=T.default.select(e.body.error);return l.default.reject(new t(e._res||e))})},getUserToken:function(e){var t=this;return l.default.resolve(!this.isRefreshing||new l.default(function(e){t.logger.info("credentials: token refresh inflight; delaying getUserToken until refresh completes"),t.once("change:isRefreshing",function(){t.logger.info("credentials: token refresh complete; reinvoking getUserToken"),e()})})).then(function(){if(!t.canAuthorize)return t.logger.info("credentials: cannot produce an access token from current state"),l.default.reject(new Error("Current state cannot produce an access token"));if(e||(e=(0,Vk.filterScope)("spark:kms",t.config.scope)),(e=(0,Vk.sortScope)(e))===(0,Vk.sortScope)(t.config.scope))return l.default.resolve(t.supertoken);var r=t.userTokens.get(e);return r&&r.access_token?l.default.resolve(r):t.downscope(e).then((0,Tw.tap)(function(e){return t.userTokens.add(e)}))})},initialize:function(e,t){var r=this;e&&("string"==typeof e&&(this.supertoken=e),e.access_token&&(this.supertoken=e),e.authorization&&(e.authorization.supertoken?this.supertoken=e.authorization.supertoken:this.supertoken=e.authorization),this.supertoken&&this.supertoken.expires&&this.scheduleRefresh(this.supertoken.expires)),(0,f.default)(S.default.prototype.initialize,this,[e,t]),this.listenToOnce(this.parent,"change:config",function(){if(r.config.authorizationString){var e=b.default.parse(r.config.authorizationString,!0);r.config.client_id=e.query.client_id,r.config.redirect_uri=e.query.redirect_uri,r.config.scope=e.query.scope,r.config.authorizeUrl=e.href.substr(0,e.href.indexOf("?"))}}),this.spark.once("loaded",function(){r.ready=!0})},invalidate:function(){this.logger.info("credentials: invalidating tokens"),this.refreshTimer&&(clearTimeout(this.refreshTimer),this.unset("refreshTimer"));try{this.unset("supertoken")}catch(e){this.logger.warn("credentials: failed to clear supertoken",e)}for(;this.userTokens.models.length;)try{this.userTokens.remove(this.userTokens.models[0])}catch(e){this.logger.warn("credentials: failed to remove user token",e)}return this.logger.info("credentials: finished removing tokens"),l.default.resolve()},refresh:function(){var e=this;this.logger.info("credentials: refresh requested");var t=this.supertoken,r=(0,_.default)(this.userTokens.models);return this.config.jwtRefreshCallback?this.config.jwtRefreshCallback(this.spark).then(function(t){return e.spark.authorization.requestAccessTokenFromJwt({jwt:t})}):t.refresh().then(function(t){return e.refreshTimer&&(clearTimeout(e.refreshTimer),e.unset("refreshTimer")),e.supertoken=t,l.default.all(r.map(function(t){return e.downscope(t.scope).then(function(r){return e.logger.info("credentials: revoking token for "+t.scope),t.revoke().catch(function(t){e.logger.warn("credentials: failed to revoke user token",t)}).then(function(){e.userTokens.remove(t.scope),e.userTokens.add(r)})})}))}).then(function(){e.scheduleRefresh(e.supertoken.expires)}).catch(function(t){if(t instanceof T.default.InvalidRequestError){for(e.unset("supertoken");e.userTokens.models.length;)try{e.userTokens.remove(e.userTokens.models[0])}catch(t){e.logger.warn("credentials: failed to remove user token",t)}e.spark.trigger("client:InvalidRequestError")}return l.default.reject(t)})},scheduleRefresh:function(e){var t=this,r=e-Date.now();if(r>0){var n=this.calcRefreshTimeout(r);this.refreshTimer=(0,Aw.safeSetTimeout)(function(){return t.refresh()},n)}else this.refresh()},version:"1.50.2"},"getUserToken",[r,n],(0,c.default)(u,"getUserToken"),u),R(u,"initialize",[i],(0,c.default)(u,"initialize"),u),R(u,"invalidate",[Tw.oneFlight,o],(0,c.default)(u,"invalidate"),u),R(u,"refresh",[Tw.oneFlight,a,s],(0,c.default)(u,"refresh"),u),u));t.default=A});t(fA);var dA=function(e,t){return null==e||hv(e,t)};var pA=function(e,t,r){return null==e?e:Jk(e,t,r)};var hA=function(e,t,r){(void 0===r||lf(e[t],r))&&(void 0!==r||t in e)||Nd(e,t,r)};var vA=function(e,t){if("__proto__"!=t)return e[t]};var gA=function(e){return xd(e,_p(e))};var mA=function(e,t,r,n,i,o,a){var s=vA(e,r),u=vA(t,r),c=a.get(u);if(c)hA(e,r,c);else{var l=o?o(s,u,r+"",e,t,a):void 0,f=void 0===l;if(f){var d=Hd(u),p=!d&&Yd(u),h=!d&&!p&&ip(u);l=u,d||p||h?Hd(s)?l=s:YO(s)?l=Sp(s):p?(f=!1,l=bp(u,!0)):h?(f=!1,l=nh(u,!0)):l=[]:bv(u)||zd(u)?(l=s,zd(s)?l=gA(s):Uf(s)&&!zf(s)||(l=kh(u))):f=!1}f&&(a.set(u,l),i(l,u,n,o,a),a.delete(u)),hA(e,r,l)}};var yA=function e(t,r,n,i,o){t!==r&&Gw(r,function(a,s){if(Uf(a))o||(o=new Pd),mA(t,r,s,n,e,i,o);else{var u=i?i(vA(t,s),a,s+"",t,r,o):void 0;void 0===u&&(u=a),hA(t,s,u)}},_p)},_A=Cw(function(e,t,r){yA(e,t,r)});for(var EA=function(e,t,r){var n=null==e?void 0:fv(e,t);return void 0===n?r:n},bA=r(function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}}),SA=[],TA=0;TA<256;++TA)SA[TA]=(TA+256).toString(16).substr(1);var wA,OA,kA=function(e,t){var r=t||0,n=SA;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")},RA=0,AA=0;var IA=function(e,t,r){var n=t&&r||0,i=t||[],o=(e=e||{}).node||wA,a=void 0!==e.clockseq?e.clockseq:OA;if(null==o||null==a){var s=bA();null==o&&(o=wA=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=OA=16383&(s[6]<<8|s[7]))}var u=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:AA+1,l=u-RA+(c-AA)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||u>RA)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");RA=u,AA=c,OA=a;var f=(1e4*(268435455&(u+=122192928e5))+c)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=255&f;var d=u/4294967296*1e4&268435455;i[n++]=d>>>8&255,i[n++]=255&d,i[n++]=d>>>24&15|16,i[n++]=d>>>16&255,i[n++]=a>>>8|128,i[n++]=255&a;for(var p=0;p<6;++p)i[n+p]=o[p];return t||kA(i)};var PA=function(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||bA)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[n+o]=i[o];return t||kA(i)},CA=PA;CA.v1=IA,CA.v4=PA;var MA=CA,NA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(Xl),n=c(Fu),i=c(MS),o=c(_y),a=c(Ty),s=c(NS),u=c(DS);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"onRequest",value:function(e){var t=this;return e.headers=e.headers||{},"authorization"in e.headers||"auth"in e?(e.headers.authorization||(0,n.default)(e.headers,"authorization"),r.default.resolve(e)):this.requiresCredentials(e).then(function(r){return r?t.spark.credentials.getUserToken().then(function(t){return e.headers.authorization=t.toString(),e}):e})}},{key:"requiresCredentials",value:function(e){var t=this;return e.uri&&e.uri.includes(this.spark.config.device.preDiscoveryServices.hydraServiceUrl)?r.default.resolve(!0):this.spark.internal.device?this.spark.internal.device.isSpecificService("hydra",e.uri).then(function(n){return!!n||(e.service?t.spark.internal.device.isService(e.service):!!e.uri&&t.spark.internal.device.isServiceUrl(e.uri).then(function(n){if(n)return!0;if((void 0===e.addAuthHeader&&t.spark.config.device.validateDomains&&(e.addAuthHeader=!0),e.addAuthHeader)&&t.spark.config.device.whitelistedServiceDomains.filter(function(t){return e.uri.includes(t)}).length)return r.default.resolve(!0);return!1}))}):r.default.resolve(!1)}},{key:"onResponseError",value:function(e,t){var i=this;return this.shouldAttemptReauth(t,e).then(function(o){return o&&(i.spark.logger.info("auth: received 401, attempting to reauthenticate"),t.options.headers&&(0,n.default)(t.options.headers,"authorization"),i.spark.credentials.canRefresh)?i.spark.credentials.refresh().then(function(){return i.replay(e)}):r.default.reject(t)})}},{key:"replay",value:function(e){return e.replayCount?e.replayCount+=1:e.replayCount=1,e.replayCount>this.spark.config.maxAuthenticationReplays?(this.spark.logger.error("auth: failed after "+this.spark.config.maxAuthenticationReplays+" replay attempts"),r.default.reject(new Error("Failed after "+this.spark.config.maxAuthenticationReplays+" replay attempts"))):(this.spark.logger.info("auth: replaying request "+e.replayCount+" time"),this.spark.request(e))}},{key:"shouldAttemptReauth",value:function(e,t){return t&&!1===t.shouldRefreshAccessToken?r.default.resolve(!1):401===e.statusCode?r.default.resolve(!0):r.default.resolve(!1)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=l});t(NA);var DA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(Xl),n=u(MS),i=u(_y),o=u(Ty),a=u(NS),s=u(DS);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.$timings=e.$timings||{},e.$timings.networkStart=Date.now(),e}},{key:"onResponse",value:function(e,t){return e.$timings.networkEnd=Date.now(),t}},{key:"onResponseError",value:function(e,t){return e.$timings.networkEnd=Date.now(),r.default.reject(t)}}],[{key:"create",value:function(e){return new t(this,e)}}]),t}(tA.Interceptor);t.default=c});t(DA);var jA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(Xl),n=u(MS),i=u(_y),o=u(Ty),a=u(NS),s=u(DS);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.noTransform?e:this.spark.transform("outbound",e)}},{key:"onResponse",value:function(e,t){return this.spark.transform("inbound",t)}},{key:"onResponseError",value:function(e,t){return this.spark.transform("inbound",t).then(function(e){return r.default.reject(e||t)})}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=c});t(jA);var xA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(Xl),n=l(Fu),i=l(MS),o=l(_y),a=l(Ty),s=l(NS),u=l(DS),c=l(Rw);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"onRequest",value:function(e){return e.uri.includes(this.spark.config.credentials.samlUrl)||e.uri.includes(this.spark.config.credentials.tokenUrl)||e.uri.includes(this.spark.config.credentials.authorizeUrl)?e:"cisco-no-http-redirect"in e.headers?(e.headers["cisco-no-http-redirect"]||(0,n.default)(e.headers,"cisco-no-http-redirect"),e):(e.headers["cisco-no-http-redirect"]=!0,e.$redirectCount=e.$redirectCount||0,e)}},{key:"onResponse",value:function(e,t){if(t.headers&&t.headers["cisco-location"])return(e=(0,c.default)(e)).uri=t.headers["cisco-location"],e.$redirectCount+=1,e.$redirectCount>this.spark.config.maxAppLevelRedirects?r.default.reject(new Error("Maximum redirects exceeded")):this.spark.request(e);if(t.headers&&t.body&&2000002===t.body.errorCode&&t.body.location){if(e=(0,c.default)(e),t.options&&t.options.qs){var n=t.body.location.split("?");e.uri=n[0]}else e.uri=t.body.location;return e.$redirectCount+=1,e.$redirectCount>this.spark.config.maxLocusRedirects?r.default.reject(new Error("Maximum redirects exceeded")):this.spark.request(e)}return t}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=f});t(xA);var LA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(Xl),n=c(MS),i=c(_y),o=c(Ty),a=c(NS),s=c(DS),u=c(EA);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){var t=(0,u.default)(this,"spark.logger",console);try{this.spark.trigger("request:start",e)}catch(e){t.warn("event handler for request:start failed ",e)}return r.default.resolve(e)}},{key:"onRequestError",value:function(e,t){var n=(0,u.default)(this,"spark.logger",console);try{this.spark.trigger("request:end",e,t),this.spark.trigger("request:failure",e,t)}catch(e){n.warn("event handler for request:end failed ",e)}return r.default.reject(t)}},{key:"onResponse",value:function(e,t){var n=(0,u.default)(this,"spark.logger",console);try{this.spark.trigger("request:success",t.options,t)}catch(e){n.warn("event handler for request:success failed ",e)}return r.default.resolve(t)}},{key:"onResponseError",value:function(e,t){var n=(0,u.default)(this,"spark.logger",console);try{this.spark.trigger("request:end",e,t),this.spark.trigger("request:failure",e,t)}catch(e){n.warn("event handler for request:failure failed ",e)}return r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=l});t(LA);var UA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(Xl),n=l(MS),i=l(_y),o=l(Ty),a=l(NS),s=l(DS),u=(l(Fv),l(zw),l(Hd),l(qO)),c=l(EA);l(Ym);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){var t=(0,c.default)(this,"spark.logger",console);return t.info("/**********************************************************************\\ "),t.info("Request:",e.method||"GET",e.uri),t.info("WEBEX_TRACKINGID: ",(0,c.default)(e,"headers.trackingid")),(0,u.default)(e,"headers.x-trans-id")&&t.info("X-Trans-ID: ",(0,c.default)(e,"headers.x-trans-id")),(0,u.default)(this,"spark.internal.device.userId")&&t.info("User ID:",(0,c.default)(this,"spark.internal.device.userId")),r.default.resolve(e)}},{key:"onRequestError",value:function(e,t){this.onRequest(e);var n=(0,c.default)(this,"spark.logger",console);return n.error("Request Failed: ",t.stack),n.info("\\**********************************************************************/"),r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=f});t(UA);var FA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(Xl),n=u(MS),i=u(_y),o=u(Ty),a=u(NS),s=u(DS);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.$timings=e.$timings||{},e.$timings.requestStart=Date.now(),e}},{key:"onRequestError",value:function(e){return e.$timings.requestEnd=e.$timings.requestFail=Date.now(),r.default.reject(e)}},{key:"onResponse",value:function(e,t){return e.$timings.requestEnd=Date.now(),r.default.resolve(t)}},{key:"onResponseError",value:function(e,t){return e.$timings.requestEnd=e.$timings.requestFail=Date.now(),r.default.reject(t)}}],[{key:"create",value:function(e){return new t(this,e)}}]),t}(tA.Interceptor);t.default=c});t(FA);var GA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(Xl),n=(c(j_),c(MS)),i=c(_y),o=c(Ty),a=c(NS),s=c(DS),u=(c(Fv),c(EA));c(Ym);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onResponse",value:function(e,t){return this.printResponseHeader(e,t),(0,u.default)(this,"spark.logger",console).info("\\**********************************************************************/"),t}},{key:"onResponseError",value:function(e,t){return this.printResponseHeader(e,t),(0,u.default)(this,"spark.logger",console).info("\\**********************************************************************/"),r.default.reject(t)}},{key:"printResponseHeader",value:function(e,t){var r=(0,u.default)(this,"spark.logger",console);r.info("Status Code:",t.statusCode),r.info("WEBEX_TRACKINGID:",(0,u.default)(e,"headers.trackingid")||(0,u.default)(t,"headers.trackingid")),r.info("Network duration:",e.$timings.networkEnd-e.$timings.networkStart),r.info("Processing duration:",e.$timings.requestEnd-e.$timings.requestStart)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=l});t(GA);var qA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(Fu),n=u(MS),i=u(_y),o=u(Ty),a=u(NS),s=u(DS);function u(e){return e&&e.__esModule?e:{default:e}}var c=new(u(zy).default),l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){if(e.headers=e.headers||{},"trackingid"in e.headers)return e.headers.trackingid||(0,r.default)(e.headers,"trackingid"),e;if(this.requiresTrackingId(e)&&(e.headers.trackingid=this.spark.sessionId+"_"+this.sequence),e.headers.trackingid&&e.replayCount){var t=e.headers.trackingid.split("+");t[1]=e.replayCount,e.headers.trackingid=t.join("+")}return e}},{key:"requiresTrackingId",value:function(e){return!e.headers.trackingid}},{key:"sequence",get:function(){var e=c.get(this)||0;return e+=1,c.set(this,e),e}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=l});t(qA);var VA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(Fu),n=l(MS),i=l(_y),o=l(Ty),a=l(NS),s=l(DS),u=l(zy),c=l(EA);function l(e){return e&&e.__esModule?e:{default:e}}var f=new u.default,d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.default)(this,t);var r=(0,c.default)(e,"spark.config.appName"),o=(0,c.default)(e,"spark.config.appVersion"),s=(0,c.default)(e,"spark.ciscospark",!1)?"ciscospark":"spark-js-sdk",u=(0,c.default)(e,"spark.version","development"),l=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r&&o?f.set(l,r+"/"+o+" ("+(Tw.inBrowser?"web":"node")+") "+s+"/"+u):f.set(l,s+"/"+u+" ("+(Tw.inBrowser?"web":"node")+")"),l}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.headers=e.headers||{},e.uri&&(e.uri.includes(this.spark.config.credentials.samlUrl)||e.uri.includes(this.spark.config.credentials.tokenUrl)||e.uri.includes(this.spark.config.credentials.authorizeUrl))?e:"spark-user-agent"in e.headers?(e.headers["spark-user-agent"]||(0,r.default)(e.headers,"spark-user-agent"),e):(e.headers["spark-user-agent"]=f.get(this),e)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=d});t(VA);var BA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(Xl),n=c(B_),i=c(MS),o=c(_y),a=c(NS),s=c(Ty),u=c(DS);function c(e){return e&&e.__esModule?e:{default:e}}var l=new(c(zy).default),f=/.*(idbroker|identity)(bts)?.webex.com\/([^\/]+)/,d=function(e){function t(){var e;(0,o.default)(this,t);for(var r=arguments.length,s=Array(r),u=0;u<r;u++)s[u]=arguments[u];var c=(0,a.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(s)));return l.set(c,new n.default),c}return(0,u.default)(t,e),(0,s.default)(t,null,[{key:"create",value:function(){return new t({spark:this})}}]),(0,s.default)(t,[{key:"onRequest",value:function(e){return this.isRateLimited(e.uri)?r.default.reject(new Error("API rate limited "+e.uri)):r.default.resolve(e)}},{key:"onResponseError",value:function(e,t){return 429===t.statusCode&&(e.uri.includes("idbroker")||e.uri.includes("identity"))&&this.setRateLimitExpiry(e.uri,this.extractRetryAfterTime(e)),r.default.reject(t)}},{key:"extractRetryAfterTime",value:function(e){var t=e.headers["retry-after"]||null;return null===t||t<=0?6e4:t>3600?36e5:1e3*t}},{key:"setRateLimitExpiry",value:function(e,t){var r=this.getApiName(e);if(!r)return!1;var n=(new Date).getTime()+t;return l.get(this).set(r,n)}},{key:"getRateLimitStatus",value:function(e){var t=this.getApiName(e);if(!t)return!1;var r=(new Date).getTime(),n=l.get(this);return void 0!==n.get(t)&&r<n.get(t)}},{key:"getApiName",value:function(e){if(!e)return null;var t=e.match(f);return t?t[2]:null}},{key:"isRateLimited",value:function(e){return!(!e||!e.includes("idbroker")&&!e.includes("identity"))&&this.getRateLimitStatus(e)}}]),t}(tA.Interceptor);t.default=d});t(BA);var zA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=yk)&&r.__esModule?r:{default:r};var i=n.default.extend({props:{url:["string",!1,"https://idbroker.webex.com"],defaultUrl:["string",!1,"https://idbroker.webex.com"]}}),o=n.default.extend({props:{url:["string",!1,ru.env.IDENTITY_BASE_URL],defaultUrl:["string",!1,ru.env.IDENTITY_BASE_URL]}}),a=n.default.extend({extraProperties:"allow",children:{idbroker:i,identity:o},props:{authorizationString:["string",!1,ru.env.AUTHORIZATION_STRING],client_id:["string",!1,ru.env.CLIENT_ID],client_secret:["string",!1,ru.env.CLIENT_SECRET],redirect_uri:["string",!1,ru.env.REDIRECT_URI],scope:["string",!1,ru.env.SCOPE],cisService:["string",!1,"spark"]},derived:{activationUrl:{deps:["idbroker.url"],fn:function(){return(this.idbroker.url||"https://idbroker.webex.com")+"/idb/token/v1/actions/UserActivation/invoke"}},authorizeUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/authorize"}},tokenUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/access_token"}},revokeUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/revoke"}},logoutUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/logout"}},setPasswordUrl:{deps:["identity.url"],fn:function(){return(this.identity.url||"https://identity.webex.com")+"/identity/scim/v1/Users"}}}});t.default=a});t(zA);var HA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=zA)&&r.__esModule?r:{default:r};t.default={maxAppLevelRedirects:10,maxLocusRedirects:5,maxAuthenticationReplays:1,maxReconnectAttempts:1,onBeforeLogout:[],trackingIdPrefix:"spark-js-sdk",trackingIdSuffix:"",AlternateLogger:void 0,credentials:new n.default,device:{preDiscoveryServices:{hydraServiceUrl:"https://api.ciscospark.com/v1"},validateDomains:!1,whitelistedServiceDomains:["webexkubed.com","wbx3.com","wbx2.com","ciscospark.com","webex.com"]},payloadTransformer:{predicates:[],transforms:[]},storage:{boundedAdapter:xk.MemoryStoreAdapter,unboundedAdapter:xk.MemoryStoreAdapter}}});t(HA);var WA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(rR),n=l(Ow),i=l(XO),o=l(_A),a=l(zf),s=l(Hd),u=l(qO),c=l(EA);function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n){(e._derived[t]={fn:(0,a.default)(n)?n:n.fn,cache:!1!==n.cache,depList:n.deps||[]}).depList.forEach(function(r){e._deps[r]=(0,i.default)(e._deps[r]||[],[t])}),(0,r.default)(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`"+t+"` is a derived property, it can't be set directly.")}})}t.default=function(e,t,r){return e.registerPlugin=function(i,a){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((!e.prototype._children[i]||l.replace)&&(e.prototype._children[i]=a,l.proxies&&l.proxies.forEach(function(t){f(e.prototype,t,{deps:[i+"."+t],fn:function(){return this[i][t]}})}),l.interceptors&&(0,n.default)(l.interceptors).forEach(function(e){r[e]=l.interceptors[e]}),l.config&&(0,o.default)(t,l.config),(0,u.default)(l,"payloadTransformer.predicates")&&(t.payloadTransformer.predicates=t.payloadTransformer.predicates.concat((0,c.default)(l,"payloadTransformer.predicates"))),(0,u.default)(l,"payloadTransformer.transforms")&&(t.payloadTransformer.transforms=t.payloadTransformer.transforms.concat((0,c.default)(l,"payloadTransformer.transforms"))),l.onBeforeLogout&&(t.onBeforeLogout=t.onBeforeLogout||[],((0,s.default)(l.onBeforeLogout)?l.onBeforeLogout:[l.onBeforeLogout]).forEach(function(e){return t.onBeforeLogout.push({plugin:i,fn:e})})),a.prototype._definition&&a.prototype._definition.ready)){var d=e.prototype._derived.ready,p=d.fn,h={deps:d.depList.concat(i+".ready"),fn:p};f(e.prototype,"ready",h)}},e}});t(WA);var YA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(rR),n=l(Ow),i=l(XO),o=l(_A),a=l(zf),s=l(Hd),u=l(qO),c=l(EA);function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,l){return e.registerPlugin=function(f,d){var p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.prototype._children[f]||p.replace){if(e.prototype._children[f]=d,p.proxies)throw new Error("Proxies are not currently supported for private plugins");if(p.interceptors&&(0,n.default)(p.interceptors).forEach(function(e){l[e]=p.interceptors[e]}),p.config&&(0,o.default)(t,p.config),(0,u.default)(p,"payloadTransformer.predicates")&&(t.payloadTransformer.predicates=t.payloadTransformer.predicates.concat((0,c.default)(p,"payloadTransformer.predicates"))),(0,u.default)(p,"payloadTransformer.transforms")&&(t.payloadTransformer.transforms=t.payloadTransformer.transforms.concat((0,c.default)(p,"payloadTransformer.transforms"))),p.onBeforeLogout&&(t.onBeforeLogout=t.onBeforeLogout||[],((0,s.default)(p.onBeforeLogout)?p.onBeforeLogout:[p.onBeforeLogout]).forEach(function(e){return t.onBeforeLogout.push({plugin:f,fn:e})})),d.prototype._definition&&d.prototype._definition.ready){var h=e.prototype._derived.ready,v=h.fn,g={deps:h.depList.concat(f+".ready"),fn:v};!function(e,t,n){(e._derived[t]={fn:(0,a.default)(n)?n:n.fn,cache:!1!==n.cache,depList:n.deps||[]}).depList.forEach(function(r){e._deps[r]=(0,i.default)(e._deps[r]||[],[t])}),(0,r.default)(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`"+t+"` is a derived property, it can't be set directly.")}})}(e.prototype,"ready",g)}}},e}});t(YA);var XA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Ow),n=o(yk),i=o(Ym);function o(e){return e&&e.__esModule?e:{default:e}}var a=n.default.extend({derived:{ready:{deps:[],fn:function(){var e=this;return(0,r.default)(this._children).reduce(function(t,r){return t&&e[r]&&!1!==e[r].ready},!0)}}},inspect:function(e){return i.default.inspect(this.serialize({props:!0,session:!0,derived:!0}),{depth:e})}});t.default=a});t(XA);var JA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=L(xu),i=L(Fu),o=L(Zl),a=L(Ek),s=L(Xl),u=L(Ow),c=L(nf),l=L(dA),f=L(pA),d=L(Fv),p=L(_A),h=L(uv),v=L(zw),g=L(zf),m=L(qO),y=L(EA),_=L(Fb);t.registerPlugin=function(e,t,r){Y.registerPlugin(e,t,r)},t.registerInternalPlugin=function(e,t,r){x.default.registerPlugin(e,t,r)};var E=L(Ym),b=L(yk),S=L(MA),T=L(NA),w=L(DA),O=L(jA),k=L(xA),R=L(LA),A=(L(UA),L(FA)),I=(L(GA),L(rA)),P=L(qA),C=L(VA),M=L(BA),N=L(HA),D=L(WA),j=L(YA),x=L(XA);function L(e){return e&&e.__esModule?e:{default:e}}var U,F,G,q,V,B,z={SparkTrackingIdInterceptor:P.default.create,RequestEventInterceptor:R.default.create,RateLimitInterceptor:M.default.create,RequestLoggerInterceptor:void 0,ResponseLoggerInterceptor:void 0,RequestTimingInterceptor:A.default.create,UrlInterceptor:void 0,SparkUserAgentInterceptor:C.default.create,AuthInterceptor:T.default.create,KmsDryErrorInterceptor:void 0,PayloadTransformerInterceptor:O.default.create,ConversationInterceptor:void 0,RedirectInterceptor:k.default.create,HttpStatusInterceptor:function(){return tA.HttpStatusInterceptor.create({error:I.default})},NetworkTimingInterceptor:w.default.create},H=["ResponseLoggerInterceptor","RequestTimingInterceptor","RequestEventInterceptor","SparkTrackingIdInterceptor","RateLimitInterceptor"],W=["HttpStatusInterceptor","NetworkTimingInterceptor","RequestLoggerInterceptor","RateLimitInterceptor"],Y=b.default.extend((r={version:"1.50.2",children:{internal:x.default},constructor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return"string"==typeof e?e={credentials:{supertoken:{access_token:e}}}:(["credentials.authorization","authorization","credentials.supertoken.supertoken","supertoken","access_token","credentials.authorization.supertoken"].forEach(function(t){var r=(0,y.default)(e,t);r&&((0,l.default)(e,t),(0,f.default)(e,"credentials.supertoken",r))}),["credentials","credentials.authorization"].forEach(function(t){var r=(0,y.default)(e,t);"string"==typeof r&&((0,l.default)(e,t),(0,f.default)(e,"credentials.supertoken",r))}),"string"==typeof(0,y.default)(e,"credentials.access_token")&&((0,f.default)(e,"credentials.access_token",this.bearerValidator((0,y.default)(e,"credentials.access_token").trim())),(0,f.default)(e,"credentials.supertoken",e.credentials))),(0,c.default)(b.default,this,[e,t])},derived:{boundedStorage:{deps:[],fn:function(){return(0,xk.makeSparkStore)("bounded",this)}},unboundedStorage:{deps:[],fn:function(){return(0,xk.makeSparkStore)("unbounded",this)}},ready:{deps:["loaded","internal.ready"],fn:function(){var e=this;return this.loaded&&(0,u.default)(this._children).reduce(function(t,r){return t&&e[r]&&!1!==e[r].ready},!0)}}},session:{config:{type:"object"},loaded:{default:!1,type:"boolean"},request:{setOnce:!0,type:"any"},sessionId:{setOnce:!0,type:"string"}},refresh:function(){var e;return(e=this.credentials).refresh.apply(e,arguments)},transform:function(e,t){var r=this,n=this.config.payloadTransformer.predicates.filter(function(t){return!t.direction||t.direction===e}),i={spark:this};return s.default.all(n.map(function(e){return e.test(i,t).then(function(r){if(r)return e.extract(t).then(function(t){return{name:e.name,target:t}})})})).then(function(t){return t.filter(function(e){return Boolean(e)}).reduce(function(t,n){var i=n.name,o=n.target,a=n.alias;return t.then(function(){return a?r.applyNamedTransform(e,a,o):r.applyNamedTransform(e,i,o)})},s.default.resolve())}).then(function(){return t})},applyNamedTransform:function(e,t,r){for(var n=arguments.length,i=Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];var u=this;return(0,v.default)(t)&&(i.unshift(r),r=t,t={spark:this,transform:function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return u.applyNamedTransform.apply(u,[e,t].concat(n))}}),t.spark.config.payloadTransformer.transforms.filter(function(t){return t.name===r&&(!t.direction||t.direction===e)}).reduce(function(e,r){return e.then(function(){var e;return r.alias?(e=t).transform.apply(e,[r.alias].concat((0,a.default)(i))):s.default.resolve(r.fn.apply(r,[t].concat((0,a.default)(i))))})},s.default.resolve()).then(function(){return(0,h.default)(i)})},getWindow:function(){return window},initialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};delete N.default.credentials.federation,this.config=(0,p.default)({},N.default,t.config),this.trigger("change:config");var r=function t(){e.loaded&&(e.trigger("loaded"),e.stopListening(e,"change:loaded",t))};Bs(function(){e.listenToAndRun(e,"change:loaded",r)});var n=function t(){e.ready&&(e.trigger("ready"),e.stopListening(e,"change:ready",t))};Bs(function(){e.listenToAndRun(e,"change:ready",n)}),(0,u.default)(this.constructor.prototype._children).forEach(function(t){e.listenTo(e[t],"change",function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];n.unshift("change:"+t),e.trigger.apply(e,n)})});var i=function(t,r){var n=z[r];return(0,g.default)(n)?(t.push((0,c.default)(n,e,[])),t):t},o=[];o=H.reduce(i,o),o=(0,u.default)(z).filter(function(e){return!(H.includes(e)||W.includes(e))}).reduce(i,o),o=W.reduce(i,o),this.request=(0,tA.defaults)({json:!0,interceptors:o});var a=(0,y.default)(this,"config.trackingIdPrefix","spark-js-sdk")+"_"+(0,y.default)(this,"config.trackingIdBase",S.default.v4());(0,m.default)(this,"config.trackingIdPrefix")&&(a+="_"+(0,y.default)(this,"config.trackingIdPrefix")),this.sessionId=a},setConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=(0,p.default)({},this.config,e)},bearerValidator:function(e){return e.includes("Bearer")&&e.split(" ").length-1==0?(console.warn("Your access token does not have a space between 'Bearer' and the token, please add a space to it or replace it with this already fixed version:\n\n"+e.replace("Bearer","Bearer ").replace(/\s+/g," ")),console.info("Tip: You don't need to add 'Bearer' to the access_token field. The token by itself is fine"),e.replace("Bearer","Bearer ").replace(/\s+/g," ")):e.split(" ").length-1>1?(console.warn("Your access token has "+(e.split(" ").length-2)+" too many spaces, please use this format:\n\n"+e.replace(/\s+/g," ")),console.info("Tip: You don't need to add 'Bearer' to the access_token field, the token by itself is fine"),e.replace(/\s+/g," ")):e.replace(/\s+/g," ")},inspect:function(e){return E.default.inspect((0,d.default)(this.serialize({props:!0,session:!0,derived:!0}),"boundedStorage","unboundedStorage","request","config"),{depth:e})},logout:function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var u=this.credentials.supertoken&&(this.credentials.supertoken.refresh_token||this.credentials.supertoken.access_token);return e=(0,o.default)({token:u},e),this.config.onBeforeLogout.reverse().reduce(function(r,i){var o=i.plugin,u=i.fn;return r.then(function(){return s.default.resolve((0,c.default)(u,t[o]||t.internal[o],[e].concat((0,a.default)(n)))).catch(function(e){t.logger.warn("onBeforeLogout from plugin "+o+": failed",e)})})},s.default.resolve()).then(function(){return s.default.all([t.boundedStorage.clear(),t.unboundedStorage.clear()])}).then(function(){var e;return(e=t.credentials).invalidate.apply(e,(0,a.default)(n))}).then(function(){var r;return t.authorization&&t.authorization.logout&&(r=t.authorization).logout.apply(r,[e].concat((0,a.default)(n)))}).then(function(){return t.trigger("client:logout")})},measure:function(){var e;return this.metrics?(e=this.metrics).sendUnstructured.apply(e,arguments):s.default.resolve()},upload:function(e){var t=this;if(!e.file)return s.default.reject(new Error("`options.file` is required"));e.phases=e.phases||{},e.phases.initialize=e.phases.initialize||{},e.phases.upload=e.phases.upload||{},e.phases.finalize=e.phases.finalize||{},(0,_.default)(e.phases.initialize,{method:"POST"},(0,d.default)(e,"file","phases")),(0,_.default)(e.phases.upload,{method:"PUT",json:!1,withCredentials:!1,body:e.file,headers:{"x-trans-id":S.default.v4(),authorization:void 0}}),(0,_.default)(e.phases.finalize,{method:"POST"},(0,d.default)(e,"file","phases"));var r=new qb.EventEmitter,n=this._uploadPhaseInitialize(e).then(function(){var n=t._uploadPhaseUpload(e);return(0,Tw.transferEvents)("progress",n,r),n}).then(function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t._uploadPhaseFinalize.apply(t,[e].concat(n))}).then(function(e){return e.body});return(0,Tw.proxyEvents)(r,n),n},_uploadPhaseInitialize:function(e){var t=this;return this.logger.debug("client: initiating upload session"),this.request(e.phases.initialize).then(function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t._uploadApplySession.apply(t,[e].concat(n))}).then(function(e){return t.logger.debug("client: initiated upload session"),e})},_uploadApplySession:function(e,t){var r=t.body;["upload","finalize"].reduce(function(e,t){return e[t]=(0,u.default)(e[t]).reduce(function(e,t){return t.startsWith("$")&&(e[t.substr(1)]=e[t](r),(0,i.default)(e,t)),e},e[t]),e},e.phases)},_uploadPhaseUpload:function(e){var t=this;this.logger.debug("client: uploading file");var r=this.request(e.phases.upload).then(function(e){return t.logger.debug("client: uploaded file"),e});return(0,Tw.proxyEvents)(e.phases.upload.upload,r),r},_uploadPhaseFinalize:function(e){var t=this;return this.logger.debug("client: finalizing upload session"),this.request(e.phases.finalize).then(function(e){return t.logger.debug("client: finalized upload session"),e})}},U=r,F="_uploadPhaseUpload",G=[Tw.retry],q=(0,n.default)(r,"_uploadPhaseUpload"),V=r,B={},Object.keys(q).forEach(function(e){B[e]=q[e]}),B.enumerable=!!B.enumerable,B.configurable=!!B.configurable,("value"in B||B.initializer)&&(B.writable=!0),B=G.slice().reverse().reduce(function(e,t){return t(U,F,e)||e},B),V&&void 0!==B.initializer&&(B.value=B.initializer?B.initializer.call(V):void 0,B.initializer=void 0),void 0===B.initializer&&(Object.defineProperty(U,F,B),B=null),r));Y.version="1.50.2",(0,j.default)(x.default,N.default,z),(0,D.default)(Y,N.default,z),t.default=Y});t(JA);JA.registerPlugin,JA.registerInternalPlugin;var KA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.grantErrors=t.Token=t.sortScope=t.filterScope=t.Credentials=void 0,Object.defineProperty(t,"Credentials",{enumerable:!0,get:function(){return n(fA).default}}),Object.defineProperty(t,"filterScope",{enumerable:!0,get:function(){return Vk.filterScope}}),Object.defineProperty(t,"sortScope",{enumerable:!0,get:function(){return Vk.sortScope}}),Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return n(nA).default}}),Object.defineProperty(t,"grantErrors",{enumerable:!0,get:function(){return n(qk).default}});var r=n(fA);function n(e){return e&&e.__esModule?e:{default:e}}(0,JA.registerPlugin)("credentials",r.default,{proxies:["canAuthorize","canRefresh"]})});t(KA);KA.grantErrors,KA.Token,KA.sortScope,KA.filterScope,KA.Credentials;var $A=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i=l(Zl),o=l(Sy),a=l(_y),s=l(Ty),u=l(zy),c=l(sk);function l(e){return e&&e.__esModule?e:{default:e}}var f,d,p,h,v,g,m=new u.default,y=(r=function(){function e(){var t,r,i,s,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.default)(this,e),t=this,r="ready",s=this,(i=n)&&(0,o.default)(t,r,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(s):void 0});var l=u.spark||c.parent;if(!l)throw new Error("One of `attrs.spark` or `options.parent` must be supplied when initializing a StatelessSparkPlugin");for(;l.parent||l.collection;)l=l.parent||l.collection;m.set(this,l)}return(0,s.default)(e,[{key:"config",get:function(){var e=this.getNamespace?this.getNamespace():this.namespace;return e?(e=e.toLowerCase(),this.spark.config[e]):this.spark.config}},{key:"logger",get:function(){return this.spark.logger}},{key:"spark",get:function(){return m.get(this)}}]),(0,s.default)(e,[{key:"request",value:function(){var e;return(e=this.spark).request.apply(e,arguments)}},{key:"upload",value:function(){var e;return(e=this.spark).upload.apply(e,arguments)}}]),e}(),f=r.prototype,d="ready",p=[_w.readonly],h={enumerable:!0,initializer:function(){return!0}},g={},Object.keys(h).forEach(function(e){g[e]=h[e]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce(function(e,t){return t(f,d,e)||e},g),v&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(v):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(f,d,g),g=null),n=g,r);t.default=y,(0,i.default)(y.prototype,c.default)});t($A);var QA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(Xl),n=s(B_),i=s(qO),o=s(Lk),a=s(rA);function s(e){return e&&e.__esModule?e:{default:e}}var u=o.default.extend({session:{deferreds:{type:"object",default:function(){return new n.default}},queue:{type:"array",default:function(){return[]}}},derived:{bounce:{fn:function(){var e=this;return(0,Tw.cappedDebounce)(function(){return e.executeQueue.apply(e,arguments)},this.config.batcherWait,{maxCalls:this.config.batcherMaxCalls,maxWait:this.config.batcherMaxWait})}}},request:function(e){var t=this,n=new Tw.Defer;return this.fingerprintRequest(e).then(function(i){t.deferreds.has(i)?n.resolve(t.deferreds.get(i).promise):(t.deferreds.set(i,n),t.prepareItem(e).then(function(e){n.promise=n.promise.then((0,Tw.tap)(function(){return t.deferreds.delete(i)})).catch(function(e){return t.deferreds.delete(i),r.default.reject(e)}),t.enqueue(e).then(function(){return t.bounce()}).catch(function(e){return n.reject(e)})}).catch(function(e){return n.reject(e)}))}).catch(function(e){return n.reject(e)}),n.promise},enqueue:function(e){return this.queue.push(e),r.default.resolve()},prepareItem:function(e){return r.default.resolve(e)},executeQueue:function(){var e=this,t=this.queue.splice(0,this.config.batcherMaxCalls);return new r.default(function(n){n(e.prepareRequest(t).then(function(t){return e.submitHttpRequest(t).then(function(t){return e.handleHttpSuccess(t)})}).catch(function(n){return n instanceof a.default?e.handleHttpError(n):r.default.all(t.map(function(t){return e.getDeferredForRequest(t).then(function(e){e.reject(n)})}))}))}).catch(function(t){return e.logger.error(t.stack),r.default.reject(t)})},prepareRequest:function(e){return r.default.resolve(e)},submitHttpRequest:function(e){throw new Error("request() must be implemented")},handleHttpSuccess:function(e){var t=this;return r.default.all((e.body&&e.body.items||e.body).map(function(e){return t.acceptItem(e)}))},handleHttpError:function(e){var t=this;return e instanceof a.default&&(0,i.default)(e,"options.body.map")?r.default.all(e.options.body.map(function(r){return t.getDeferredForRequest(r).then(function(t){t.reject(e)})})):(this.logger.error("http error handler called without a SparkHttpError object",e),r.default.reject(e))},acceptItem:function(e){var t=this;return this.didItemFail(e).then(function(r){return r?t.handleItemFailure(e):t.handleItemSuccess(e)})},didItemFail:function(e){return r.default.resolve(!1)},handleItemFailure:function(e){return this.getDeferredForResponse(e).then(function(t){t.reject(e)})},handleItemSuccess:function(e){return this.getDeferredForResponse(e).then(function(t){t.resolve(e)})},getDeferredForRequest:function(e){var t=this;return this.fingerprintRequest(e).then(function(e){var r=t.deferreds.get(e);if(!r)throw new Error("Could not find pending request for received response");return r})},getDeferredForResponse:function(e){var t=this;return this.fingerprintResponse(e).then(function(e){var r=t.deferreds.get(e);if(!r)throw new Error("Could not find pending request for received response");return r})},fingerprintRequest:function(e){throw new Error("fingerprintRequest() must be implemented")},fingerprintResponse:function(e){throw new Error("fingerprintResponse() must be implemented")},version:"1.50.2"});t.default=u});t(QA);var ZA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(Xy),n=a(_y),i=a(Ty),o=a(zy);function a(e){return e&&e.__esModule?e:{default:e}}var s=new o.default,u=new o.default,c=new o.default,l=function(){function e(t,r){return(0,n.default)(this,e),s.set(this,t.body.items),u.set(this,e.parseLinkHeaders(t.headers.link)),c.set(this,r),this}return(0,i.default)(e,[{key:"items",get:function(){return s.get(this)}},{key:"length",get:function(){return this.items.length}},{key:"links",get:function(){return u.get(this)}},{key:"spark",get:function(){return c.get(this)}}]),(0,i.default)(e,[{key:"next",value:function(){return this.getLink("next")}},{key:"hasNext",value:function(){return this.hasLink("next")}},{key:"previous",value:function(){return this.getLink("previous")}},{key:"hasPrevious",value:function(){return this.hasLink("previous")}},{key:"getLink",value:function(t){var r=this;return this.spark.request({uri:this.links[t]}).then(function(t){return new e(t,r.spark)})}},{key:"hasLink",value:function(e){return Boolean(this.links[e])}},{key:r.default,value:function(){var e=this,t=-1;return{next:function(){return(t+=1)<e.length?{value:e.items[t]}:{done:!0}}}}}],[{key:"parseLinkHeaders",value:function(e){return e?(e=Array.isArray(e)?e:[e]).reduce(function(e,t){var r=(t=t.split(";"))[0].replace("<","").replace(">","");return e[t[1].split("=")[1].replace(/"/g,"")]=r,e},{}):{}}}]),e}();t.default=l});t(ZA),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={error:["log"],warn:["error","log"],info:["log"],debug:["info","log"],trace:["debug","info","log"]};function n(e){var t=r[e];if(t)for(t=t.slice();!console[e];)e=t.pop();return function(){for(var t,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console)[e].apply(t,n)}}var i=eI.SparkPlugin.extend({namespace:"Logger",error:n("error"),warn:n("warn"),log:n("log"),info:n("info"),debug:n("debug"),trace:n("trace"),version:"1.50.2"});(0,eI.registerPlugin)("logger",i),t.default=i}));var eI=r(function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.Page=t.Batcher=t.RateLimitInterceptor=t.SparkUserAgentInterceptor=t.SparkTrackingIdInterceptor=t.RequestTimingInterceptor=t.RequestLoggerInterceptor=t.RequestEventInterceptor=t.ResponseLoggerInterceptor=t.RedirectInterceptor=t.PayloadTransformerInterceptor=t.NetworkTimingInterceptor=t.AuthInterceptor=t.SparkPlugin=t.StatelessSparkPlugin=t.SparkHttpError=t.registerInternalPlugin=t.registerPlugin=t.default=t.children=t.waitForValue=t.StorageError=t.persist=t.NotFoundError=t.MemoryStoreAdapter=t.makeSparkPluginStore=t.makeSparkStore=t.Token=t.sortScope=t.grantErrors=t.filterScope=t.Credentials=void 0,Object.defineProperty(t,"Credentials",{enumerable:!0,get:function(){return KA.Credentials}}),Object.defineProperty(t,"filterScope",{enumerable:!0,get:function(){return KA.filterScope}}),Object.defineProperty(t,"grantErrors",{enumerable:!0,get:function(){return KA.grantErrors}}),Object.defineProperty(t,"sortScope",{enumerable:!0,get:function(){return KA.sortScope}}),Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return KA.Token}}),Object.defineProperty(t,"makeSparkStore",{enumerable:!0,get:function(){return xk.makeSparkStore}}),Object.defineProperty(t,"makeSparkPluginStore",{enumerable:!0,get:function(){return xk.makeSparkPluginStore}}),Object.defineProperty(t,"MemoryStoreAdapter",{enumerable:!0,get:function(){return xk.MemoryStoreAdapter}}),Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return xk.NotFoundError}}),Object.defineProperty(t,"persist",{enumerable:!0,get:function(){return xk.persist}}),Object.defineProperty(t,"StorageError",{enumerable:!0,get:function(){return xk.StorageError}}),Object.defineProperty(t,"waitForValue",{enumerable:!0,get:function(){return xk.waitForValue}}),Object.defineProperty(t,"children",{enumerable:!0,get:function(){return JA.children}}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(JA).default}}),Object.defineProperty(t,"registerPlugin",{enumerable:!0,get:function(){return JA.registerPlugin}}),Object.defineProperty(t,"registerInternalPlugin",{enumerable:!0,get:function(){return JA.registerInternalPlugin}}),Object.defineProperty(t,"SparkHttpError",{enumerable:!0,get:function(){return r(rA).default}}),Object.defineProperty(t,"StatelessSparkPlugin",{enumerable:!0,get:function(){return r($A).default}}),Object.defineProperty(t,"SparkPlugin",{enumerable:!0,get:function(){return r(Lk).default}}),Object.defineProperty(t,"AuthInterceptor",{enumerable:!0,get:function(){return r(NA).default}}),Object.defineProperty(t,"NetworkTimingInterceptor",{enumerable:!0,get:function(){return r(DA).default}}),Object.defineProperty(t,"PayloadTransformerInterceptor",{enumerable:!0,get:function(){return r(jA).default}}),Object.defineProperty(t,"RedirectInterceptor",{enumerable:!0,get:function(){return r(xA).default}}),Object.defineProperty(t,"ResponseLoggerInterceptor",{enumerable:!0,get:function(){return r(GA).default}}),Object.defineProperty(t,"RequestEventInterceptor",{enumerable:!0,get:function(){return r(LA).default}}),Object.defineProperty(t,"RequestLoggerInterceptor",{enumerable:!0,get:function(){return r(UA).default}}),Object.defineProperty(t,"RequestTimingInterceptor",{enumerable:!0,get:function(){return r(FA).default}}),Object.defineProperty(t,"SparkTrackingIdInterceptor",{enumerable:!0,get:function(){return r(qA).default}}),Object.defineProperty(t,"SparkUserAgentInterceptor",{enumerable:!0,get:function(){return r(VA).default}}),Object.defineProperty(t,"RateLimitInterceptor",{enumerable:!0,get:function(){return r(BA).default}}),Object.defineProperty(t,"Batcher",{enumerable:!0,get:function(){return r(QA).default}}),Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return r(ZA).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return r(HA).default}})});t(eI);eI.config,eI.Page,eI.Batcher,eI.RateLimitInterceptor,eI.SparkUserAgentInterceptor,eI.SparkTrackingIdInterceptor,eI.RequestTimingInterceptor,eI.RequestLoggerInterceptor,eI.RequestEventInterceptor,eI.ResponseLoggerInterceptor,eI.RedirectInterceptor,eI.PayloadTransformerInterceptor,eI.NetworkTimingInterceptor,eI.AuthInterceptor,eI.SparkPlugin,eI.StatelessSparkPlugin,eI.SparkHttpError,eI.registerInternalPlugin,eI.registerPlugin,eI.children,eI.waitForValue,eI.StorageError,eI.persist,eI.NotFoundError,eI.MemoryStoreAdapter,eI.makeSparkPluginStore,eI.makeSparkStore,eI.Token,eI.sortScope,eI.grantErrors,eI.filterScope,eI.Credentials;var tI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o=m(xu),a=m(Fu),s=m(Xl),u=m(Zl),c=m(nf),l=m(sf),f=m(Fv),d=m(Bv),p=m(Wv),h=m(eg),v=m(Xm),g=m(MA);function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var _=Tw.base64.encode((0,l.default)({})),E=eI.SparkPlugin.extend((r=(0,Tw.whileInFlight)("isAuthorizing"),n=(0,Tw.whileInFlight)("isAuthorizing"),y(i={derived:{isAuthenticating:{deps:["isAuthorizing"],fn:function(){return this.isAuthorizing}}},session:{isAuthorizing:{default:!1,type:"boolean"},ready:{default:!1,type:"boolean"}},namespace:"Credentials",initialize:function(e,t){var r=this,n=(0,c.default)(eI.SparkPlugin.prototype.initialize,this,[e,t]);if(!1===e.parse)return this.ready=!0,n;var i=v.default.parse(this.spark.getWindow().location.href,!0);this._checkForErrors(i);var o=i.hash;if(!o)return this.ready=!0,n;o.includes("#")&&(o=o.substr(1)),i.hash=h.default.parse(o),i.hash.state&&(i.hash.state=JSON.parse(Tw.base64.decode(i.hash.state)));var a=this._parseHash(i);return a?(this._cleanUrl(i),Bs(function(){r.spark.credentials.set({supertoken:a}),r.ready=!0}),n):n},initiateLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.state=e.state||{},e.state.csrf_token=this._generateSecurityToken(),"confidential"===this.config.clientType?this.initiateAuthorizationCodeGrant(e):this.initiateImplicitGrant(e)},initiateImplicitGrant:function(e){return this.logger.info("authorization: initiating implicit grant flow"),this.spark.getWindow().location=this.spark.credentials.buildLoginUrl((0,u.default)({response_type:"token"},e)),s.default.resolve()},initiateAuthorizationCodeGrant:function(e){return this.logger.info("authorization: initiating authorization code grant flow"),this.spark.getWindow().location=this.spark.credentials.buildLoginUrl((0,u.default)({response_type:"code"},e)),s.default.resolve()},requestAccessTokenFromJwt:function(e){var t=this,r=e.jwt;return this.spark.request({method:"POST",service:"hydra",resource:"jwt/login",headers:{authorization:r}}).then(function(e){var t=e.body;return{access_token:t.token,token_type:"Bearer",expires_in:t.expiresIn}}).then(function(e){t.spark.credentials.set({supertoken:e})})},logout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.noRedirect||(this.spark.getWindow().location=this.spark.credentials.buildLogoutUrl(e))},_checkForErrors:function(e){var t=e.query;if(t&&t.error)throw new(eI.grantErrors.select(t.error))(t)},_cleanUrl:function(e){e=(0,p.default)(e),this.spark.getWindow().history&&this.spark.getWindow().history.replaceState&&(["access_token","token_type","expires_in","refresh_token","refresh_token_expires_in"].forEach(function(t){return(0,a.default)(e.hash,t)}),(0,d.default)(e.hash.state)?(0,a.default)(e.hash,"state"):(e.hash.state=Tw.base64.encode((0,l.default)((0,f.default)(e.hash.state,"csrf_token"))),e.hash.state===_&&(0,a.default)(e.hash,"state")),e.hash=h.default.stringify(e.hash),this.spark.getWindow().history.replaceState({},null,v.default.format(e)))},_generateSecurityToken:function(){this.logger.info("authorization: generating csrf token");var e=g.default.v4();return this.spark.getWindow().sessionStorage.setItem("oauth2-csrf-token",e),e},_parseHash:function(e){var t=(0,p.default)(e.hash);if(t&&this._verifySecurityToken(t),t.access_token)return t.expires_in&&(t.expires_in=parseInt(t.expires_in,10)),t.refresh_token_expires_in&&(t.refresh_token_expires_in=parseInt(t.refresh_token_expires_in,10)),t;this.ready=!0},_verifySecurityToken:function(e){var t=this.spark.getWindow().sessionStorage.getItem("oauth2-csrf-token");if(this.spark.getWindow().sessionStorage.removeItem("oauth2-csrf-token"),t){if(!e.state)throw new Error("Expected CSRF token "+t+", but not found in redirect hash");if(!e.state.csrf_token)throw new Error("Expected CSRF token "+t+", but not found in redirect hash");var r=e.state.csrf_token;if(r!==t)throw new Error("CSRF token "+r+" does not match stored token "+t)}},version:"1.50.2"},"initiateImplicitGrant",[r],(0,o.default)(i,"initiateImplicitGrant"),i),y(i,"initiateAuthorizationCodeGrant",[n],(0,o.default)(i,"initiateAuthorizationCodeGrant"),i),y(i,"requestAccessTokenFromJwt",[Tw.oneFlight],(0,o.default)(i,"requestAccessTokenFromJwt"),i),i));t.default=E});t(tI);var rI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={credentials:{clientType:"public"}}});t(rI);var nI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(aR),n=s(nf),i=s(Uf),o=s(Fb),a=s(yk);function s(e){return e&&e.__esModule?e:{default:e}}var u=a.default.extend({props:{key:"string",lastModified:"date",mutable:"boolean",type:"string",val:"string",value:"any"},constructor:function(e,t){return t=t||{},(0,o.default)(t,{parse:!0}),(0,n.default)(a.default.prototype.constructor,this,[e,t])},idAttribute:"key",parse:function(e){if(!e)return{};var t=Number(e.val);return e.val&&!(0,r.default)(t)?(e.value=t,e.type="number"):"true"===e.val?(e.value=!0,e.type="boolean"):"false"===e.val?(e.value=!1,e.type="boolean"):(e.value=e.val,e.type="string"),e},serialize:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=(0,n.default)(a.default.prototype.serialize,this,t);return i.lastModified&&(i.lastModified=new Date(i.lastModified).toISOString()),i},set:function(e,t,r){var o=void 0;return(0,i.default)(e)||null===e?(o=e,r=t):(o={})[e]=t,o=this.parse(o,r),(0,n.default)(a.default.prototype.set,this,[o,r])}});t.default=u});t(nI);var iI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(cA),n=i(nI);function i(e){return e&&e.__esModule?e:{default:e}}var o=r.default.extend({mainIndex:"key",model:n.default});t.default=o});t(iI);var oI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Ow),n=o(yk),i=o(iI);function o(e){return e&&e.__esModule?e:{default:e}}var a=n.default.extend({collections:{developer:i.default,entitlement:i.default,user:i.default},clear:function(e){var t=this;return(0,r.default)(this.attributes).forEach(function(r){t.unset(r,e)}),(0,r.default)(this._children).forEach(function(e){t[e].clear()}),(0,r.default)(this._collections).forEach(function(e){t[e].reset()}),this},initialize:function(){var e=this;["change:value","add","remove"].forEach(function(t){["developer","entitlement","user"].forEach(function(r){e[r].on(t,function(t,n){e.trigger("change:"+r,e,e[r],n)})})})}});t.default=a});t(oI);var aI=1,sI=2;var uI=function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var u=(s=r[i])[0],c=e[u],l=s[1];if(a&&s[2]){if(void 0===c&&!(u in e))return!1}else{var f=new Pd;if(n)var d=n(c,l,u,e,t,f);if(!(void 0===d?xO(l,c,aI|sI,n,f):d))return!1}}return!0};var cI=function(e){return e==e&&!Uf(e)};var lI=function(e){for(var t=hp(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,cI(i)]}return t};var fI=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}};var dI=function(e){var t=lI(e);return 1==t.length&&t[0][2]?fI(t[0][0],t[0][1]):function(r){return r===e||uI(r,e,t)}},pI=1,hI=2;var vI=function(e,t){return Xh(e)&&cI(t)?fI(lv(e),t):function(r){var n=EA(r,e);return void 0===n&&n===t?Qk(r,e):xO(t,n,pI|hI)}};var gI=function(e){return function(t){return null==t?void 0:t[e]}};var mI=function(e){return function(t){return fv(t,e)}};var yI=function(e){return Xh(e)?gI(lv(e)):mI(e)};var _I=function(e){return"function"==typeof e?e:null==e?Cv:"object"==typeof e?Hd(e)?vI(e[0],e[1]):dI(e):yI(e)};var EI=function(e){return function(t,r,n){var i=Object(t);if(!pp(t)){var o=_I(r,3);t=hp(t),r=function(e){return o(i[e],e,i)}}var a=e(t,r,n);return a>-1?i[o?t[a]:a]:void 0}},bI=Math.max;var SI=EI(function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:_b(r);return i<0&&(i=bI(n+i,0)),wE(e,_I(t,3),i)});var TI=function(e,t){var r;return ZO(e,function(e,n,i){return!(r=t(e,n,i))}),!!r};var wI=function(e,t,r){var n=Hd(e)?iO:TI;return r&&xb(e,t,r)&&(t=void 0),n(e,_I(t,3))},OI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(Xl),n=l(nf),i=l(SI),o=l(wI),a=l(Uf),s=l(Fb),u=l(yk),c=l(Xm);function l(e){return e&&e.__esModule?e:{default:e}}var f=u.default.extend({props:{service:"string",defaultUrl:"string",availableHosts:{type:"array",default:function(){return[]}}},session:{currentHostIndex:{type:"number",default:0}},derived:{url:{deps:["defaultUrl","availableHosts","currentHostIndex"],fn:function(){if(0===this.availableHosts.length)return this.defaultUrl;var e=void 0;return e=this.currentHostIndex>=this.availableHosts.length?this.availableHosts[this.availableHosts.length-1]:this.availableHosts[this.currentHostIndex],this._changeUrlHost(this.defaultUrl,e.host)}}},constructor:function(e,t){return t=t||{},(0,s.default)(t,{parse:!0}),(0,n.default)(u.default.prototype.constructor,this,[e,t])},idAttribute:"service",serialize:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=(0,n.default)(u.default.prototype.serialize,this,t);return i.url=this.url,i},parse:function(e){return e?(e.availableHosts&&e.availableHosts.sort(function(e,t){return e.priority-t.priority}),e):{}},set:function(e,t,r){var i=void 0;return(0,a.default)(e)||null===e?(i=e,r=t):(i={})[e]=t,i=this.parse(i,r),(0,n.default)(u.default.prototype.set,this,[i,r])},markHostFailed:function(e){var t=this.getCurrentHost();if(e){var r=c.default.parse(e);t=(0,i.default)(this.availableHosts,function(e){return e.host===r.host})}t&&(t.failed=!0)},cycleNextHost:function(){for(var e=0;e<this.availableHosts.length;e+=1){var t=this.availableHosts[e];if(!t.failed&&this.currentHostIndex!==e)return this.currentHostIndex=e,r.default.resolve(t)}return this.currentHostIndex=0,r.default.reject(new Error("All hosts have failed for "+this.service))},doesUrlBelongToService:function(e){var t=c.default.parse(e),r=this.availableHosts.map(function(e){return e.host});return r.push(c.default.parse(this.defaultUrl).host),(0,o.default)(r,function(e){return e===t.host})},getCurrentHost:function(){return this.availableHosts[this.currentHostIndex]},resetAllHosts:function(){this.availableHosts.forEach(function(e){e.failed=!1})},replaceUrlWithCurrentHost:function(e){return this._changeUrlHost(e,this.getCurrentHost().host)},_changeUrlHost:function(e,t){var r=c.default.parse(e);return r.host=t,c.default.format(r)}});t.default=f});t(OI);var kI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Xl),n=o(cA),i=o(OI);function o(e){return e&&e.__esModule?e:{default:e}}var a=n.default.extend({mainIndex:"service",model:i.default,markFailedAndCycleUrl:function(e){return e?this.inferServiceFromUrl(e).then(function(t){return t.markHostFailed(e),t.cycleNextHost().then(function(){return t.url})}):r.default.reject(new Error("`uri` is a required parameter"))},resetAllAndRetry:function(e){return e?this.inferServiceFromUrl(e).then(function(e){return e.resetAllHosts(),e.url}):r.default.reject(new Error("`uri` is a required parameter"))},inferServiceFromUrl:function(e){var t=this.filter(function(t){return t.doesUrlBelongToService(e)});return t.length>=1?r.default.resolve(t[0]):r.default.reject(new Error("Unable to infer service for this url "+e))},inferServiceNameFromUrl:function(e){return this.inferServiceFromUrl(e).then(function(e){return e.service})}});t.default=a});t(kI);var RI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o,a,s,u,c,l,f,d=T(xu),p=T(vR),h=T(nf),v=T(Ow),g=T(Yk),m=T(Xl),y=T(Fv),_=T(Ym),E=T(oI),b=T(kI),S=T(Xm);function T(e){return e&&e.__esModule?e:{default:e}}function w(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var O=eI.SparkPlugin.extend((r=(0,eI.waitForValue)("@"),n=(0,eI.waitForValue)("@"),i=(0,eI.persist)("@",function(){return!this.config.ephemeral}),o=(0,eI.waitForValue)("@"),a=(0,eI.waitForValue)("@"),s=(0,eI.waitForValue)("@"),u=(0,eI.waitForValue)("@"),c=(0,eI.waitForValue)("@"),l=(0,eI.waitForValue)("@"),w(f={children:{features:E.default},collections:{serviceCatalog:b.default},idAttribute:"url",namespace:"Device",props:{clientMessagingGiphy:"string",customerCompanyName:"string",customerLogoUrl:"string",deviceType:"string",helpUrl:"string",intranetInactivityDuration:"number",intranetInactivityCheckUrl:"string",ecmEnabledForAllUsers:{type:"boolean",default:function(){return!1}},ecmSupportedStorageProviders:{type:"array",default:function(){return[]}},modificationTime:"string",partnerCompanyName:"string",partnerLogoUrl:"string",reportingSiteDesc:"string",reportingSiteUrl:"string",searchEncryptionKeyUrl:"string",services:{default:function(){return{}},type:"object"},serviceHostMap:{default:function(){return{serviceLinks:{},hostCatalog:{}}},type:"object"},showSupportText:"boolean",supportProviderCompanyName:"string",supportProviderLogoUrl:"string",url:"string",userId:"string",webFileShareControl:"string",webSocketUrl:"string",whiteboardFileShareControl:"string"},derived:{registered:{deps:["url"],fn:function(){return Boolean(this.url)}}},session:{logoutTimer:"any",lastUserActivityDate:"number"},determineService:function(e){var t=!0,r=!1,n=void 0;try{for(var i,o=(0,g.default)((0,v.default)(this.services));!(t=(i=o.next()).done);t=!0){var a=i.value,s=this.services[a];if(e.startsWith(s))return m.default.resolve(a.substr(0,a.length-10))}}catch(e){r=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw n}}return m.default.reject(new Error(e+" does not reflect a known service"))},getServiceUrl:function(e){var t=this;return this._getServiceUrl(this.services,e).then(function(r){return r||t.getPreDiscoveryServiceUrl(e)})},getPreDiscoveryServiceUrl:function(e){return m.default.resolve(this._getServiceUrl(this.config.preDiscoveryServices,e))},getWebSocketUrl:function(){return this.useServiceCatalogUrl(this.webSocketUrl)},useServiceCatalogUrl:function(e){return this.serviceCatalog.inferServiceFromUrl(e).then(function(t){return t.replaceUrlWithCurrentHost(e)})},markUrlFailedAndGetNew:function(e){var t=this;return e?(this.logger.info("device: marking "+e+" as failed"),this.serviceCatalog.markFailedAndCycleUrl(e).then(function(r){return t.spark.internal.metrics.submitClientMetrics("web-ha",{tags:{action:"replace_url",failedUrl:e,newUrl:r}}),r}).catch(function(){return t._resetAllAndRetry(e)})):m.default.reject(new Error("`url` is a required parameter"))},_resetAllAndRetry:function(e){return e?(this.logger.info("device: reset available hosts and retry "+e),this.serviceCatalog.resetAllAndRetry(e)):m.default.reject(new Error("`url` is a required parameter"))},fetchNewUrls:function(e){var t=this;return new m.default(function(r){return t.serviceCatalog.inferServiceFromUrl(e).then(function(e){t.logger.info("device: refresh to "+e.service+" get new urls"),t.refresh(),t.on("serviceCatalogUpdated",function(){return r(e.url)})})})},initialize:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(0,h.default)(eI.SparkPlugin.prototype.initialize,this,r),["developer","entitlement","user"].forEach(function(t){e.features.on("change:"+t,function(t,r,n){e.trigger("change",e,n),e.trigger("change:features",e,e.features,n)})}),this.on("change:serviceHostMap",this._updateServiceCatalog),this.listenToAndRun(this,"change:intranetInactivityCheckUrl",function(){return e._resetLogoutTimer()}),this.listenToAndRun(this,"change:intranetInactivityDuration",function(){return e._resetLogoutTimer()}),this.listenTo(this.spark,"user-activity",function(){e.lastUserActivityDate=Date.now()})},inspect:function(e){return _.default.inspect((0,y.default)(this.serialize(),"features"),{depth:e})},isPreDiscoveryService:function(e){return m.default.resolve(this._isService(this.config.preDiscoveryServices,e))},isPreDiscoveryServiceUrl:function(e){return m.default.resolve(this._isServiceUrl(this.config.preDiscoveryServices,e))},isService:function(e){var t=this;return this._isService(this.services,e).then(function(r){return r||t.isPreDiscoveryService(e)})},isServiceUrl:function(e){return m.default.resolve(this._isServiceUrl(this.services,e))},isSpecificService:function(e,t){return t===e?m.default.resolve(!0):this.getServiceUrl(e).then(function(e){return t.includes(e)})},_getServiceUrl:function(e,t){if(!e)return m.default.reject(new Error("`target` is a required parameter"));if(!t)return m.default.reject(new Error("`service` is a required parameter"));var r=this.features.developer.get("web-ha-messaging");if(r&&r.value){var n=this.serviceCatalog.get(t+"ServiceUrl");if(n)return m.default.resolve(n.url)}return m.default.resolve(e[t+"ServiceUrl"])},_isService:function(e,t){return this._getServiceUrl(e,t).then(function(e){return Boolean(e)})},_isServiceUrl:function(e,t){if(!t)return m.default.reject(new Error("`uri` is a required parameter"));var r=!0,n=!1,i=void 0;try{for(var o,a=(0,g.default)((0,p.default)(e));!(r=(o=a.next()).done);r=!0){var s=o.value;if(s&&t.startsWith(s))return m.default.resolve(!0)}}catch(e){n=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}return m.default.resolve(!1)},refresh:function(){var e=this;if(this.logger.info("device: refreshing"),!this.registered)return this.logger.info("device: device not registered, registering"),this.register();var t=(0,y.default)(this.serialize(),"features","mediaClusters");return this.config.ephemeral&&(t.ttl=this.config.ephemeralDeviceTTL),this.request({method:"PUT",uri:this.url,body:t}).then(function(t){return e._processRegistrationSuccess(t)}).catch(function(t){return 404===t.statusCode?(e.logger.info("device: refresh failed with 404, attempting to register new device"),e.clear(),e.register()):m.default.reject(t)})},register:function(){var e=this;if(this.logger.info("device: registering"),this.registered)return this.logger.info("device: device already registered, refreshing"),this.refresh();var t=this.config.defaults;return this.config.ephemeral&&(t.ttl=this.config.ephemeralDeviceTTL),this.request({method:"POST",service:"wdm",resource:"devices",body:t}).then(function(t){return e._processRegistrationSuccess(t)})},unregister:function(){var e=this;return this.logger.info("device: unregistering"),this.url?this.request({uri:this.url,method:"DELETE"}).then(function(){return e.clear()}):(this.logger.warn("device: not registered"),m.default.resolve())},clear:function(){clearTimeout(this.refreshTimer);for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];(0,h.default)(eI.SparkPlugin.prototype.clear,this,t)},_processRegistrationSuccess:function(e){var t=this;if(this.logger.info("device: received registration payload"),this.set(e.body),this.config.ephemeral){this.logger.info("device: enqueing device refresh");var r=1e3*(this.config.ephemeralDeviceTTL/2+60);this.refreshTimer=(0,Aw.safeSetTimeout)(function(){return t.refresh()},r)}},_updateServiceCatalog:function(e){var t=this,r=this.features.developer.get("web-ha-messaging");r&&r.value&&(e.serviceHostMap&&e.serviceHostMap.hostCatalog?((0,v.default)(e.services).forEach(function(r){var n=e.services[r],i=S.default.parse(n),o=e.serviceHostMap.hostCatalog[i.host];t.serviceCatalog.set({service:r,defaultUrl:n,availableHosts:o||[]},{remove:!1})}),this.trigger("serviceCatalogUpdated")):this.refresh())},_resetLogoutTimer:function(){var e=this;if(clearTimeout(this.logoutTimer),this.off("change:lastUserActivityDate"),this.unset("logoutTimer"),this.config.enableInactivityEnforcement&&this.intranetInactivityCheckUrl&&this.intranetInactivityDuration){this.on("change:lastUserActivityDate",function(){return e._resetLogoutTimer()});var t=(0,Aw.safeSetTimeout)(function(){e.spark.request({headers:{"cisco-no-http-redirect":null,"spark-user-agent":null,trackingid:null},method:"GET",uri:e.intranetInactivityCheckUrl}).catch(function(){return e.logger.info("device: did not reach internal ping endpoint; logging out after inactivity on a public network"),e.spark.logout()}).catch(function(t){e.logger.warn("device: logout failed",t)})},1e3*this.intranetInactivityDuration);this.logoutTimer=t}},version:"1.50.2"},"determineService",[r],(0,d.default)(f,"determineService"),f),w(f,"getServiceUrl",[n],(0,d.default)(f,"getServiceUrl"),f),w(f,"initialize",[i],(0,d.default)(f,"initialize"),f),w(f,"isService",[o],(0,d.default)(f,"isService"),f),w(f,"isServiceUrl",[a],(0,d.default)(f,"isServiceUrl"),f),w(f,"isSpecificService",[s],(0,d.default)(f,"isSpecificService"),f),w(f,"refresh",[Tw.oneFlight,u],(0,d.default)(f,"refresh"),f),w(f,"register",[Tw.oneFlight,c],(0,d.default)(f,"register"),f),w(f,"unregister",[Tw.oneFlight,l],(0,d.default)(f,"unregister"),f),f));t.default=O});t(RI);var AI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=RI,e&&e.__esModule?e:{default:e}).default;var e}})});t(AI);var II=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(Xl),n=u(MS),i=u(_y),o=u(Ty),a=u(NS),s=u(DS);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onResponseError",value:function(e,t){return 451===t.statusCode&&(this.spark.internal.device.clear(),this.spark.credentials.clear(),this.spark.logger.info("Received `HTTP 451 Unavailable For Legal Reasons`, discarding credentials and device registration")),r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=c});t(II);var PI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(Fu),n=l(Zl),i=l(Xl),o=l(MS),a=l(_y),s=l(Ty),u=l(NS),c=l(DS);function l(e){return e&&e.__esModule?e:{default:e}}var f=/(?:^\/)|(?:\/$)/,d=function(e){function t(){return(0,a.default)(this,t),(0,u.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,s.default)(t,[{key:"onRequest",value:function(e){return e.uri?e:(this.checkOptions(e),this.normalizeOptions(e),this.spark.internal.device.getServiceUrl(e.service).then(function(t){return t?(e.resource&&(t=t.replace(f,"")+"/"+e.resource.replace(f,"")),e.uri=t,e):i.default.reject(new Error("`"+e.service+"` is not a known service"))}))}},{key:"checkOptions",value:function(e){if(!e.api&&!e.service)throw new Error("A `service` or `uri` parameter is required");if(!e.resource)throw new Error("A `resource` parameter is required")}},{key:"normalizeOptions",value:function(e){e.service||((0,n.default)(e,{service:e.service||e.api}),(0,r.default)(e,"api"))}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=d});t(PI);var CI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(Xl),n=c(MS),i=c(_y),o=c(Ty),a=c(NS),s=c(DS),u=c(pA);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){var t=this;return!this.spark.internal.device.url||e.headers&&"cisco-device-url"in e.headers&&!e.headers["cisco-device-url"]?r.default.resolve(e):r.default.resolve(e.service||this.spark.internal.device.determineService(e.uri)).then(function(r){return r&&"oauth"!==r&&"saml"!==r&&(0,u.default)(e,"headers['cisco-device-url']",t.spark.internal.device.url),e}).catch(function(t){if(t.message.match(/does not reflect a known service/))return e;throw t})}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=l});t(CI);var MI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(Xl),n=u(MS),i=u(_y),o=u(Ty),a=u(NS),s=u(DS);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onResponseError",value:function(e,t){if(t instanceof eI.SparkHttpError.InternalServerError&&e.uri){var n=this.spark.internal.device.features.developer.get("web-ha-messaging");if(n&&n.value)return this.spark.internal.metrics.submitClientMetrics("web-ha",{fields:{success:!1},tags:{action:"failed",error:t.message,url:e.uri}}),this.spark.internal.device.markUrlFailedAndGetNew(e.uri).then(function(){return r.default.reject(t)})}return r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(tA.Interceptor);t.default=c});t(MI);var NI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={device:{preDiscoveryServices:{wdmServiceUrl:"https://wdm-a.wbx2.com/wdm/api/v1",hydraServiceUrl:"https://api.ciscospark.com/v1"},defaults:{name:ru.title||Tw.inBrowser&&"browser",deviceType:"WEB",model:"web-js-sdk",localizedModel:"webex-js-sdk",systemName:"WEBEX_JS_SDK",systemVersion:"1.0.0"},enableInactivityEnforcement:!1,ephemeral:!1,ephemeralDeviceTTL:1800}}});t(NI);var DI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.ServerErrorInterceptor=t.DeviceUrlInterceptor=t.UrlInterceptor=t.EmbargoInterceptor=t.ServiceModel=t.ServiceCollection=t.FeatureModel=t.FeatureCollection=t.FeaturesModel=t.Device=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return u(AI).default}}),Object.defineProperty(t,"Device",{enumerable:!0,get:function(){return u(AI).default}}),Object.defineProperty(t,"FeaturesModel",{enumerable:!0,get:function(){return u(oI).default}}),Object.defineProperty(t,"FeatureCollection",{enumerable:!0,get:function(){return u(iI).default}}),Object.defineProperty(t,"FeatureModel",{enumerable:!0,get:function(){return u(nI).default}}),Object.defineProperty(t,"ServiceCollection",{enumerable:!0,get:function(){return u(kI).default}}),Object.defineProperty(t,"ServiceModel",{enumerable:!0,get:function(){return u(OI).default}}),Object.defineProperty(t,"EmbargoInterceptor",{enumerable:!0,get:function(){return u(II).default}}),Object.defineProperty(t,"UrlInterceptor",{enumerable:!0,get:function(){return u(PI).default}}),Object.defineProperty(t,"DeviceUrlInterceptor",{enumerable:!0,get:function(){return u(CI).default}}),Object.defineProperty(t,"ServerErrorInterceptor",{enumerable:!0,get:function(){return u(MI).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return u(NI).default}});var r=u(AI),n=u(NI),i=u(PI),o=u(CI),a=u(II),s=u(MI);function u(e){return e&&e.__esModule?e:{default:e}}(0,eI.registerInternalPlugin)("device",r.default,{interceptors:{UrlInterceptor:i.default.create,DeviceUrlInterceptor:o.default.create,EmbargoInterceptor:a.default.create,ServerErrorInterceptor:s.default.create},config:n.default,onBeforeLogout:function(){return this.unregister()}})});t(DI);DI.config,DI.ServerErrorInterceptor,DI.DeviceUrlInterceptor,DI.UrlInterceptor,DI.EmbargoInterceptor,DI.ServiceModel,DI.ServiceCollection,DI.FeatureModel,DI.FeatureCollection,DI.FeaturesModel,DI.Device;var jI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(tI).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return i(rI).default}});var r=i(tI),n=i(rI);function i(e){return e&&e.__esModule?e:{default:e}}(0,eI.registerPlugin)("authorization",r.default,{config:n.default,proxies:["isAuthorizing","isAuthenticating"]})});t(jI);jI.config;t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=jI,e&&e.__esModule?e:{default:e}).default;var e}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return jI.config}})}));var xI=dR(!0);Cu(Cu.S,"Object",{entries:function(e){return xI(e)}});var LI=Tu.Object.entries,UI=r(function(e){e.exports={default:LI,__esModule:!0}});t(UI);var FI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.levels=void 0;var r=d(Ek),n=d(Fu),i=d(UI),o=d(Yk),a=d(Xk),s=d(Ow),u=d(zw),c=d(Uf),l=d(Hd),f=(d(qO),d(Wv));function d(e){return e&&e.__esModule?e:{default:e}}var p={silent:0,error:1,warn:2,log:3,info:4,debug:5,trace:6},h=t.levels=(0,s.default)(p).filter(function(e){return"silent"!==e}),v={error:["log"],warn:["error","log"],info:["log"],debug:["info","log"],trace:["debug","info","log"]},g=/[Aa]uthorization/;function m(e){if((0,l.default)(e))return e.map(m);if(!(0,c.default)(e))return(0,u.default)(e)&&Tw.patterns.email.test(e)?"-- REDACTED --":e;var t=!0,r=!1,s=void 0;try{for(var f,d=(0,o.default)((0,i.default)(e));!(t=(f=d.next()).done);t=!0){var p=f.value,h=(0,a.default)(p,2),v=h[0],y=h[1];g.test(v)?(0,n.default)(e,v):e[v]=m(y)}}catch(e){r=!0,s=e}finally{try{!t&&d.return&&d.return()}finally{if(r)throw s}}return e}var y=eI.SparkPlugin.extend({namespace:"Logger",derived:{level:{cache:!1,fn:function(){return this.getCurrentLevel()}}},session:{buffer:{type:"array",default:function(){return[]}}},filter:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.map(function(e){return e instanceof Error?e:m(e=(0,f.default)(e))})},shouldPrint:function(e){return p[e]<=p[this.getCurrentLevel()]},shouldBuffer:function(e){return p[e]<=p.info},getCurrentLevel:function(){if(this.config.level)return this.config.level;if(h.includes(ru.env.CISCOSPARK_LOG_LEVEL))return ru.env.CISCOSPARK_LOG_LEVEL;var e=this.spark.internal.device&&this.spark.internal.device.features.developer.get("log-level");return e&&h.includes(e)?e:"error"},version:"1.50.2"});h.forEach(function(e){var t=v[e],n=e;if(t)for(t=t.slice();!console[n];)n=t.pop();y.prototype[e]=function(){try{var t=this.shouldPrint(e),i=this.shouldBuffer(e);if(!i&&!t)return;var o=this.filter.apply(this,arguments),a=o.map(function(e){return e instanceof eI.SparkHttpError?e.toString():e});if(t){var s,u=Tw.inBrowser?a:o;(s=console)[n].apply(s,(0,r.default)(u))}i&&(a.unshift(Date.now()),this.buffer.push(a),this.buffer.length>this.config.historyLength&&this.buffer.shift())}catch(t){console.warn("failed to execute Logger#"+e,t)}}}),t.default=y});t(FI);FI.levels;var GI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={logger:{level:ru.env.LOGGER_LEVEL,historyLength:1e3}}});t(GI);var qI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.levels=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(FI).default}}),Object.defineProperty(t,"levels",{enumerable:!0,get:function(){return FI.levels}});var r=i(FI),n=i(GI);function i(e){return e&&e.__esModule?e:{default:e}}(0,eI.registerPlugin)("logger",r.default,{config:n.default,replace:!0})});t(qI);qI.levels;var VI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r){void 0===r&&(r={}),this.execute=e,this.applicator=t,this.options=r}return Object.defineProperty(e.prototype,"bound",{get:function(){return null!=this.options.bound&&this.options.bound},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setter",{get:function(){return null!=this.options.setter&&this.options.setter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getter",{get:function(){return null!=this.options.getter&&this.options.getter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"property",{get:function(){return null!=this.options.property&&this.options.property},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return null==this.options.method||this.options.method},enumerable:!0,configurable:!0}),e}();t.DecoratorConfig=r});t(VI);VI.DecoratorConfig;var BI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(e){return void 0===e&&(e=""),"lodash-decorators -> "+e}});t(BI);BI.log;var zI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.resolveFunction=function(e,t,r,n){if(void 0===n&&(n=!0),zf(e))return e;if(zw(e)){if(t&&zf(t[e]))return t[e];if(r&&zf(r[e]))return r[e]}if(n)throw new ReferenceError(BI.log("Can not resolve method "+e+" on any target Objects"))}});t(zI);zI.resolveFunction;var HI=function(e){return void 0===e},WI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._weakMap=new WeakMap}return e.prototype.set=function(e,t){for(var r=this._weakMap,n=0,i=e.length-1;n<i;n++){var o=e[n],a=r.get(o);a||(a=new Map,r.set(o,a)),r=a}r.set(e[e.length-1],t)},e.prototype.get=function(e){for(var t=this._weakMap,r=0,n=e.length;r<n&&(t=t.get(e[r]),!HI(t));r++);return t},e.prototype.has=function(e){return!HI(this.get(e))},e}();t.CompositeKeyWeakMap=r});t(WI);WI.CompositeKeyWeakMap;var YI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.returnAtIndex=function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.call.apply(e,[this].concat(r)),r[t]}}});t(YI);YI.returnAtIndex;var XI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.copyMetadata=function(e,t){return Vw(t,function(t,r){return e[r]=t}),e}});t(XI);XI.copyMetadata;var JI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.bind=function(e,t){return XI.copyMetadata(e.bind(t),e)}});t(JI);JI.bind;var KI=200;var $I=function(e,t,r,n){var i=-1,o=AE,a=!0,s=e.length,u=[],c=t.length;if(!s)return u;r&&(t=uf(t,tp(r))),n?(o=BO,a=!1):t.length>=KI&&(o=oO,a=!1,t=new nO(t));e:for(;++i<s;){var l=e[i],f=null==r?l:r(l);if(l=n||0!==l?l:0,a&&f==f){for(var d=c;d--;)if(t[d]===f)continue e;u.push(l)}else o(t,f,n)||u.push(l)}return u},QI=H_(function(e,t){return YO(e)?$I(e,t):[]}),ZI="[object DOMException]",eP="[object Error]";var tP=function(e){if(!Ud(e))return!1;var t=Lf(e);return t==eP||t==ZI||"string"==typeof e.message&&"string"==typeof e.name&&!bv(e)},rP=H_(function(e,t){try{return Rv(e,void 0,t)}catch(e){return tP(e)?e:new Error(e)}}),nP=r(function(e,t){function r(e,t,r){var n=Object.getOwnPropertyDescriptor(e,r);if(!n||n.configurable){var i=Object.getOwnPropertyDescriptor(t,r);Uf(i)?Object.defineProperty(e,r,i):e[r]=t[r]}}Object.defineProperty(t,"__esModule",{value:!0}),t.assignAll=function(e,t,n){void 0===n&&(n=[]);for(var i=0,o=QI.apply(void 0,[Object.getOwnPropertyNames(t)].concat(n));i<o.length;i++){var a=o[i];rP(r,e,t,a)}return e},t.assignProperty=r});t(nP);nP.assignAll,nP.assignProperty;var iP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=["length","name","arguments","called","prototype"];t.wrapConstructor=function(e,t){function n(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.call.apply(t,[this,e].concat(r))}return n.prototype=e.prototype,Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:e.name,writable:!1}),nP.assignAll(n,e,r)}});t(iP);iP.wrapConstructor;var oP=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(BI),r(zI),r(WI),r(YI),r(XI),r(JI),r(iP),r(nP)});t(oP);var aP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceChainMap=new oP.CompositeKeyWeakMap});t(aP);aP.InstanceChainMap;var sP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.createDecorator=function(e){var t=this,r=e.applicator;return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return function(i,o,a){var s=t._resolveDescriptor(i,o,a),u=s.value,c=s.get,l=s.set;return aP.InstanceChainMap.has([i,o])||(zf(u)?s.value=oP.copyMetadata(r.apply({config:e,target:i,value:u,args:n}),u):zf(c)&&e.getter?s.get=oP.copyMetadata(r.apply({config:e,target:i,value:c,args:n}),c):zf(l)&&e.setter&&(s.set=oP.copyMetadata(r.apply({config:e,target:i,value:l,args:n}),c))),s}}},e.prototype.createInstanceDecorator=function(e){var t=this,r=e.applicator,n=e.bound;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return function(o,a,s){var u=t._resolveDescriptor(o,a,s),c=u.value,l=u.writable,f=u.enumerable,d=u.configurable,p=u.get,h=u.set,v=!aP.InstanceChainMap.has([o,a]),g=aP.InstanceChainMap.get([o,a])||{fns:[],properties:[]},m=v&&zf(p),y=v&&zf(h),_=v&&zf(c),E=v&&!m&&!y&&!_;if(g.properties.push(a),g.fns.push(function(a,s,u){return t._isApplicable(u,e)?(n&&(a=oP.bind(a,s)),oP.copyMetadata(r.apply({args:i,target:o,instance:s,value:a,config:e}),a)):a}),aP.InstanceChainMap.set([o,a],g),!v)return u;g.isSetter=y,g.isGetter=m,g.isMethod=_,g.isProperty=E;var b=function(e,t,r){return g.fns.reduce(function(e,n){return n(e,r,t)},e)},S=function(e){var t=p||void 0,r=h||void 0;if(m||y)m&&(t=b(p,{value:p,getter:!0},e)),y&&(r=b(h,{value:h,setter:!0},e)),Object.defineProperty(e,a,{enumerable:f,configurable:d,get:t,set:r});else if(_||E){var n=b(c,_?{value:c,method:!0}:{value:c,property:!0},e);Object.defineProperty(e,a,{writable:l,enumerable:f,configurable:d,value:n})}};return(_||E)&&(delete u.value,delete u.writable),u.get=function(){S(this);var e=Object.getOwnPropertyDescriptor(this,a);return e.get?e.get.call(this):e.value},u.set=function(e){S(this);var t=Object.getOwnPropertyDescriptor(this,a);t.set?t.set.call(this,e):(E||_)&&(this[a]=e)},u}}},e.prototype._isApplicable=function(e,t){return!Boolean(e.getter&&!t.getter||e.setter&&!t.setter||e.method&&!t.method||e.property&&!t.property)},e.prototype._resolveDescriptor=function(e,t,r){return r||(Object.getOwnPropertyDescriptor(e,t)||{})},e}();t.InternalDecoratorFactory=r,t.DecoratorFactory=new r});t(sP);sP.InternalDecoratorFactory,sP.DecoratorFactory;var uP=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(VI),r(sP),r(aP)});t(uP);var cP="Expected a function";var lP=function(e,t){if("function"!=typeof t)throw new TypeError(cP);return e=_b(e),function(){if(--e<1)return t.apply(this,arguments)}},fP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){}}();t.Applicator=r});t(fP);fP.Applicator;var dP=function(e,t){return(dP=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var pP=function(){return(pP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function hP(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function vP(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function gP(e){return this instanceof gP?(this.v=e,this):new gP(e)}var mP=Object.freeze({__extends:function(e,t){function r(){this.constructor=e}dP(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},get __assign(){return pP},__rest:function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]])}return r},__decorate:function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},__param:function(e,t){return function(r,n){t(r,n,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,s)}u((n=n.apply(e,t||[])).next())})},__generator:function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},__exportStar:function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},__values:hP,__read:vP,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(vP(arguments[t]));return e},__await:gP,__asyncGenerator:function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||s(e,t)})})}function s(e,t){try{(r=i[e](t)).value instanceof gP?Promise.resolve(r.value.v).then(u,c):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}},__asyncDelegator:function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:gP(e[n](t)),done:"return"===n}:i?i(t):t}:i}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=hP(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}}}),yP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){void 0===t&&(t={});var r=e.call(this)||this;return r._config=t,r}return mP.__extends(t,e),Object.defineProperty(t.prototype,"post",{get:function(){return!0===this._config.post},enumerable:!0,configurable:!0}),t.prototype.apply=function(e){var t=e.config.execute,r=e.value,n=void 0===r?Cv:r,i=e.args,o=e.target,a=this;return function(){for(var e=this,r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];var u=i.map(function(t){return oP.resolveFunction(t,e,o)}).slice();return a.post?u.push(n):u.unshift(n),t.apply(void 0,u).apply(this,r)}},t}(fP.Applicator);t.ComposeApplicator=r});t(yP);yP.ComposeApplicator;var _P=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mP.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=e.target,n=e.config.execute;return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return n.apply(void 0,[oP.resolveFunction(t[0],this,r)].concat(t.slice(1))).apply(this,e)}},t}(fP.Applicator);t.PartialApplicator=r});t(_P);_P.PartialApplicator;var EP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mP.__extends(t,e),t.prototype.apply=function(e){var t=e.config.execute,r=e.value,n=e.args;return Pb.apply(void 0,[t,r].concat(n))},t}(fP.Applicator);t.PartialedApplicator=r});t(EP);EP.PartialedApplicator;var bP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mP.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=e.target,n=e.value,i=e.config.execute;return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var a=n,s=0;return zf(a)||(a=oP.resolveFunction(t[0],this,r),s=1),i.apply(void 0,[a].concat(t.slice(s))).apply(this,e)}},t}(fP.Applicator);t.PartialValueApplicator=r});t(bP);bP.PartialValueApplicator;var SP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mP.__extends(t,e),t.prototype.apply=function(e){var t=e.config,r=t.execute,n=(t.bound,e.args),i=e.value;return r.apply(void 0,n.concat([i]))},t}(fP.Applicator);t.PostValueApplicator=r});t(SP);SP.PostValueApplicator;var TP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mP.__extends(t,e),t.prototype.apply=function(e){var t=e.value,r=e.config.execute,n=e.args;return r.apply(void 0,[t].concat(n))},t}(fP.Applicator);t.PreValueApplicator=r});t(TP);TP.PreValueApplicator;var wP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mP.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=e.config.execute,n=e.target,i=e.value;return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return r(oP.resolveFunction(t[0],this,n),i).apply(this,e)}},t}(fP.Applicator);t.WrapApplicator=r});t(wP);wP.WrapApplicator;var OP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mP.__extends(t,e),t.prototype.apply=function(e){var t=e.value,r=e.config.execute,n=e.args,i=e.instance;e.target;return i?r.apply(void 0,[t,i].concat(n)):t},t}(fP.Applicator);t.BindApplicator=r});t(OP);OP.BindApplicator;var kP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mP.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=(e.target,e.config.execute),n=e.value;return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return r.apply(void 0,[n.bind(this)].concat(e,t))}},t}(fP.Applicator);t.InvokeApplicator=r});t(kP);kP.InvokeApplicator;var RP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mP.__extends(t,e),t.prototype.apply=function(e){var t=e.value,r=e.instance,n=e.config.execute,i=e.args,o=e.target,a=oP.resolveFunction(zf(i[0])?i[0]:Uf(i[0])?i[0].resolver:i[0],r,o,!1);a&&r&&(a=a.bind(r));var s=a?n(t,a):n(t);if(Uf(i[0])){var u=i[0],c=u.cache,l=u.type;c?s.cache=c:zf(l)&&(s.cache=new l)}return s},t}(fP.Applicator);t.MemoizeApplicator=r});t(RP);RP.MemoizeApplicator;var AP=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(fP),r(yP),r(_P),r(EP),r(bP),r(SP),r(TP),r(wP),r(OP),r(kP),r(RP)});t(AP);var IP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(lP,new AP.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.After=n,t.after=n,t.default=r});t(IP);IP.After,IP.after;var PP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(lP,new AP.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.AfterAll=n,t.afterAll=n,t.default=r});t(PP);PP.AfterAll,PP.afterAll;var CP=128;var MP=function(e,t,r){return t=r?void 0:t,t=e&&null==t?e.length:t,Ab(e,CP,void 0,void 0,void 0,void 0,t)},NP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(MP,new AP.PreValueApplicator));function n(e){return r(e)}t.Ary=n,t.ary=n,t.default=r});t(NP);NP.Ary,NP.ary;var DP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(function(e){return Pb(rP,e)},new AP.PreValueApplicator));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Attempt=n,t.attempt=n,t.default=r});t(DP);DP.Attempt,DP.attempt;var jP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(KO,new AP.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.Before=n,t.before=n,t.default=r});t(jP);jP.Before,jP.before;var xP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(KO,new AP.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.BeforeAll=n,t.beforeAll=n,t.default=r});t(xP);xP.BeforeAll,xP.beforeAll;var LP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(aA,new AP.BindApplicator));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Bind=n,t.bind=n,t.default=r});t(LP);LP.Bind,LP.bind;var UP=r(function(e,t){function r(e){return void 0===e&&(e=[]),function(t){return oP.wrapConstructor(t,function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];!function(e,t,r){void 0===r&&(r=[]);var n=e.prototype;for(;n&&n!==Object.prototype;){for(var i=0,o=Object.getOwnPropertyNames(n);i<o.length;i++){var a=o[i],s=!r.length||-1!==r.indexOf(a),u=Object.getOwnPropertyDescriptor(n,a);if(s&&"constructor"!==a&&!t.hasOwnProperty(a)){if(u.get){var c=uP.InstanceChainMap.get([n,a]);if(!c||!c.isMethod)continue}var l=t[a];zf(l)&&Object.defineProperty(t,a,{configurable:!0,enumerable:u.enumerable,value:oP.copyMetadata(l.bind(t),l),writable:u.writable})}}n=Object.getPrototypeOf(n)}}(t,this,e),r.apply(this,n)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.BindAll=r,t.bindAll=r,t.default=r});t(UP);UP.BindAll,UP.bindAll;var FP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(Pk,new AP.PreValueApplicator,{bound:!0}));function n(e){return r(e)}t.Curry=n,t.curry=n,t.default=r});t(FP);FP.Curry,FP.curry;var GP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(Pk,new AP.PreValueApplicator));function n(e){return r(e)}t.CurryAll=n,t.curryAll=n,t.default=r});t(GP);GP.CurryAll,GP.curryAll;var qP=16;function VP(e,t,r){var n=Ab(e,qP,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=VP.placeholder,n}VP.placeholder={};var BP=VP,zP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(BP,new AP.PreValueApplicator,{bound:!0}));function n(e){return r(e)}t.CurryRight=n,t.curryRight=n,t.default=r});t(zP);zP.CurryRight,zP.curryRight;var HP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(BP,new AP.PreValueApplicator));function n(e){return r(e)}t.CurryRightAll=n,t.curryRightAll=n,t.default=r});t(HP);HP.CurryRightAll,HP.curryRightAll;var WP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(Rk,new AP.PreValueApplicator,{setter:!0}));function n(e,t){return r(e,t)}t.Debounce=n,t.debounce=n,t.default=r});t(WP);WP.Debounce,WP.debounce;var YP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(Rk,new AP.PreValueApplicator));function n(e,t){return r(e,t)}t.DebounceAll=n,t.debounceAll=n,t.default=r});t(YP);YP.DebounceAll,YP.debounceAll;var XP="Expected a function";var JP=function(e,t,r){if("function"!=typeof e)throw new TypeError(XP);return setTimeout(function(){e.apply(void 0,r)},t)},KP=H_(function(e,t){return JP(e,1,t)}),$P=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(KP,new AP.InvokeApplicator,{setter:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Defer=n,t.defer=n,t.default=r});t($P);$P.Defer,$P.defer;var QP=H_(function(e,t,r){return JP(e,vb(t)||0,r)}),ZP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return QP.apply(void 0,[e.bind(this),t].concat(n,r))}},new AP.PreValueApplicator,{setter:!0}));function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(void 0,[e].concat(t))}t.Delay=n,t.delay=n,t.default=r});t(ZP);ZP.Delay,ZP.delay;var eC=512;var tC=function(e){return Ab(e,eC)},rC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(tC,new AP.PartialValueApplicator,{property:!0}));function n(e){return r(e)}t.Flip=n,t.flip=n,t.default=r});t(rC);rC.Flip,rC.flip;var nC="Expected a function",iC=8,oC=32,aC=128,sC=256;var uC=function(e){return Uv(function(t){var r=t.length,n=r,i=dE.prototype.thru;for(e&&t.reverse();n--;){var o=t[n];if("function"!=typeof o)throw new TypeError(nC);if(i&&!a&&"wrapper"==lE(o))var a=new dE([],!0)}for(n=a?n:r;++n<r;){o=t[n];var s=lE(o),u="wrapper"==s?sE(o):void 0;a=u&&mE(u[0])&&u[1]==(aC|iC|oC|sC)&&!u[4].length&&1==u[9]?a[lE(u[0])].apply(a,u[3]):1==o.length&&mE(o)?a[s]():a.thru(o)}return function(){var e=arguments,n=e[0];if(a&&1==e.length&&Hd(n))return a.plant(n).value();for(var i=0,o=r?t[i].apply(this,e):n;++i<r;)o=t[i].call(this,o);return o}})},cC=uC(),lC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(cC,new AP.ComposeApplicator({post:!0}),{property:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Flow=n,t.flow=n,t.default=r});t(lC);lC.Flow,lC.flow;var fC=uC(!0),dC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(fC,new AP.ComposeApplicator({post:!1}),{property:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.FlowRight=n,t.flowRight=n,t.default=r});t(dC);dC.FlowRight,dC.flowRight;var pC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig($h,new AP.MemoizeApplicator));function n(e){return r(e)}t.Memoize=n,t.memoize=n,t.default=r});t(pC);pC.Memoize,pC.memoize;var hC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig($h,new AP.MemoizeApplicator));function n(e){return r(e)}t.MemoizeAll=n,t.memoizeAll=n,t.default=r});t(hC);hC.MemoizeAll,hC.memoizeAll;var vC=r(function(e,t){function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return Nw.apply(void 0,[t.prototype].concat(e)),t}}Object.defineProperty(t,"__esModule",{value:!0}),t.Mixin=r,t.mixin=r,t.default=r});t(vC);vC.Mixin,vC.mixin;var gC="Expected a function";var mC=function(e){if("function"!=typeof e)throw new TypeError(gC);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}},yC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(mC,new AP.PartialValueApplicator,{property:!0}));function n(e){return r(e)}t.Negate=n,t.negate=n,t.default=r});t(yC);yC.Negate,yC.negate;var _C=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig($O,new AP.PreValueApplicator,{setter:!0}));function n(){return r()}t.Once=n,t.once=n,t.default=r});t(_C);_C.Once,_C.once;var EC=H_,bC=Math.min,SC=EC(function(e,t){var r=(t=1==t.length&&Hd(t[0])?uf(t[0],tp(_I)):uf(Ov(t,1),tp(_I))).length;return H_(function(n){for(var i=-1,o=bC(n.length,r);++i<o;)n[i]=t[i].call(this,n[i]);return Rv(e,this,n)})}),TC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(SC,new AP.PreValueApplicator,{setter:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.OverArgs=n,t.overArgs=n,t.default=r});t(TC);TC.OverArgs,TC.overArgs;var wC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(Pb,new AP.PartialApplicator,{property:!0,method:!1}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Partial=n,t.partial=n,t.default=r});t(wC);wC.Partial,wC.partial;var OC=H_(function(e,t){var r=BE(t,FE(OC));return Ab(e,64,void 0,t,r)});OC.placeholder={};var kC=OC,RC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(kC,new AP.PartialApplicator,{property:!0,method:!1}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.PartialRight=n,t.partialRight=n,t.default=r});t(RC);RC.PartialRight,RC.partialRight;var AC=Uv(function(e,t){return Ab(e,256,void 0,void 0,void 0,t)}),IC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(AC,new AP.PartialValueApplicator,{property:!0}));function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(void 0,[e].concat(t))}t.Rearg=n,t.rearg=n,t.default=r});t(IC);IC.Rearg,IC.rearg;var PC="Expected a function";var CC=function(e,t){if("function"!=typeof e)throw new TypeError(PC);return t=void 0===t?t:_b(t),H_(e,t)},MC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(CC,new AP.PreValueApplicator));function n(e){return r(e)}t.Rest=n,t.rest=n,t.default=r});t(MC);MC.Rest,MC.rest;var NC=function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:dv(e,t,r)},DC="Expected a function",jC=Math.max;var xC=function(e,t){if("function"!=typeof e)throw new TypeError(DC);return t=null==t?0:jC(_b(t),0),H_(function(r){var n=r[t],i=NC(r,0,t);return n&&Ip(i,n),Rv(e,this,i)})},LC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(xC,new AP.PreValueApplicator));function n(e){return r(e)}t.Spread=n,t.spread=n,t.default=r});t(LC);LC.Spread,LC.spread;var UC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(function(e){return oP.returnAtIndex(e,0)},new AP.PreValueApplicator));function n(){return r()}t.Tap=n,t.tap=n,t.default=r});t(UC);UC.Tap,UC.tap;var FC="Expected a function";var GC=function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError(FC);return Uf(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),Rk(e,t,{leading:n,maxWait:t,trailing:i})},qC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(GC,new AP.PreValueApplicator,{setter:!0,getter:!0})),n=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(GC,new AP.PreValueApplicator,{getter:!0})),i=uP.DecoratorFactory.createInstanceDecorator(new uP.DecoratorConfig(GC,new AP.PreValueApplicator,{setter:!0}));function o(e,t){return r(e,t)}function a(e,t){return n(e,t)}function s(e,t){return i(e,t)}t.Throttle=o,t.throttle=o,t.ThrottleGetter=a,t.throttleGetter=a,t.ThrottleSetter=s,t.throttleSetter=s,t.default=r});t(qC);qC.Throttle,qC.throttle,qC.ThrottleGetter,qC.throttleGetter,qC.ThrottleSetter,qC.throttleSetter;var VC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(GC,new AP.PreValueApplicator,{setter:!0}));function n(e,t){return r(e,t)}t.ThrottleAll=n,t.throttleAll=n,t.default=r});t(VC);VC.ThrottleAll,VC.throttleAll;var BC=function(e){return MP(e,1)},zC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(BC,new AP.PreValueApplicator));function n(){return r()}t.Unary=n,t.unary=n,t.default=r});t(zC);zC.Unary,zC.unary;var HC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=uP.DecoratorFactory.createDecorator(new uP.DecoratorConfig(Cb,new AP.WrapApplicator));function n(e){return r(e)}t.Wrap=n,t.wrap=n,t.default=r});t(HC);HC.Wrap,HC.wrap;var WC=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(uP),r(IP),r(PP),r(NP),r(DP),r(jP),r(xP),r(LP),r(UP),r(FP),r(GP),r(zP),r(HP),r(WP),r(YP),r($P),r(ZP),r(rC),r(lC),r(dC),r(pC),r(hC),r(vC),r(yC),r(_C),r(TC),r(wC),r(RC),r(IC),r(MC),r(LC),r(UC),r(qC),r(VC),r(zC),r(HC)});t(WC);var YC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Fu),n=o(B_),i=o(zy);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){var i=n.initializer&&n.initializer();(0,r.default)(n,"value"),(0,r.default)(n,"initializer"),(0,r.default)(n,"writable"),n.get=function(){var e=a.get(this,t);return void 0!==e?e:i},n.set=function(e){var r=this[t];r!==e&&(a.set(this,t,e),this.trigger("change:"+t,e,r),this.trigger("change"))}};var a=new((0,Tw.make)(i.default,n.default))});t(YC);var XC=r(function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach(function(e){t[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})}),JC=(XC.v,XC.o,XC.s,XC.i,XC.u,XC.e,XC.p,XC.z,XC.r,XC.t,XC.c,XC.b,XC.m,XC.a,r(function(e,t){var r=function(e){return String(Number(e))===e?Number(e):e},n=function(e,t,n){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:i?t[e.name]:t;!function(e,t,n,i){if(i&&!n)t[i]=r(e[1]);else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(t[n[o]]=r(e[o+1]))}(n.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(i).forEach(function(e){var t=e[0],i=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),o=r[r.length-1]);for(var a=0;a<(XC[t]||[]).length;a+=1){var s=XC[t][a];if(s.reg.test(i))return n(s,o,i)}}),t.media=r,t};var o=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=r(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/\;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}})})}})),KC=(JC.parse,JC.parseParams,JC.parseFmtpConfig,JC.parsePayloads,JC.parseRemoteCandidates,JC.parseImageAttributes,JC.parseSimulcastStreamList,/%[sdv%]/g),$C=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?n.push(r[t.name][o]):n.push(r[t.names[i]])}else n.push(r[t.name]);return function(e){var t=1,r=arguments,n=r.length;return e.replace(KC,function(e){if(t>=n)return e;var i=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})}.apply(null,n)},QC=["v","o","s","i","u","e","p","c","b","t","r","z","a"],ZC=["i","c","b","a"],eM={write:function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var r=t.outerOrder||QC,n=t.innerOrder||ZC,i=[];return r.forEach(function(t){XC[t].forEach(function(r){r.name in e&&null!=e[r.name]?i.push($C(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){i.push($C(t,r,e))})})}),e.media.forEach(function(e){i.push($C("m",XC.m[0],e)),n.forEach(function(t){XC[t].forEach(function(r){r.name in e&&null!=e[r.name]?i.push($C(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){i.push($C(t,r,e))})})})}),i.join("\r\n")+"\r\n"},parse:JC.parse,parseFmtpConfig:JC.parseFmtpConfig,parseParams:JC.parseParams,parsePayloads:JC.parsePayloads,parseRemoteCandidates:JC.parseRemoteCandidates,parseImageAttributes:JC.parseImageAttributes,parseSimulcastStreamList:JC.parseSimulcastStreamList},tM=r(function(t){var r,n;r=e,n=function(){var e=!0;function t(t){function r(e){var r=t.match(e);return r&&r.length>1&&r[1]||""}function n(e){var r=t.match(e);return r&&r.length>1&&r[2]||""}var i,a=r(/(ipod|iphone|ipad)/i).toLowerCase(),s=!/like android/i.test(t)&&/android/i.test(t),u=/nexus\s*[0-6]\s*/i.test(t),c=!u&&/nexus\s*[0-9]+/i.test(t),l=/CrOS/.test(t),f=/silk/i.test(t),d=/sailfish/i.test(t),p=/tizen/i.test(t),h=/(web|hpw)(o|0)s/i.test(t),v=/windows phone/i.test(t),g=(/SamsungBrowser/i.test(t),!v&&/windows/i.test(t)),m=!a&&!f&&/macintosh/i.test(t),y=!s&&!d&&!p&&!h&&/linux/i.test(t),_=n(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),E=r(/version\/(\d+(\.\d+)?)/i),b=/tablet/i.test(t)&&!/tablet pc/i.test(t),S=!b&&/[^-]mobi/i.test(t),T=/xbox/i.test(t);/opera/i.test(t)?i={name:"Opera",opera:e,version:E||r(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(t)?i={name:"Opera",opera:e,version:r(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||E}:/SamsungBrowser/i.test(t)?i={name:"Samsung Internet for Android",samsungBrowser:e,version:E||r(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(t)?i={name:"NAVER Whale browser",whale:e,version:r(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(t)?i={name:"MZ Browser",mzbrowser:e,version:r(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(t)?i={name:"Opera Coast",coast:e,version:E||r(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(t)?i={name:"Focus",focus:e,version:r(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(t)?i={name:"Yandex Browser",yandexbrowser:e,version:E||r(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?i={name:"UC Browser",ucbrowser:e,version:r(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?i={name:"Maxthon",maxthon:e,version:r(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?i={name:"Epiphany",epiphany:e,version:r(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?i={name:"Puffin",puffin:e,version:r(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?i={name:"Sleipnir",sleipnir:e,version:r(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?i={name:"K-Meleon",kMeleon:e,version:r(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:v?(i={name:"Windows Phone",osname:"Windows Phone",windowsphone:e},_?(i.msedge=e,i.version=_):(i.msie=e,i.version=r(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?i={name:"Internet Explorer",msie:e,version:r(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:l?i={name:"Chrome",osname:"Chrome OS",chromeos:e,chromeBook:e,chrome:e,version:r(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(t)?i={name:"Microsoft Edge",msedge:e,version:_}:/vivaldi/i.test(t)?i={name:"Vivaldi",vivaldi:e,version:r(/vivaldi\/(\d+(\.\d+)?)/i)||E}:d?i={name:"Sailfish",osname:"Sailfish OS",sailfish:e,version:r(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?i={name:"SeaMonkey",seamonkey:e,version:r(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(i={name:"Firefox",firefox:e,version:r(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(i.firefoxos=e,i.osname="Firefox OS")):f?i={name:"Amazon Silk",silk:e,version:r(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?i={name:"PhantomJS",phantom:e,version:r(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?i={name:"SlimerJS",slimer:e,version:r(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?i={name:"BlackBerry",osname:"BlackBerry OS",blackberry:e,version:E||r(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:h?(i={name:"WebOS",osname:"WebOS",webos:e,version:E||r(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(i.touchpad=e)):/bada/i.test(t)?i={name:"Bada",osname:"Bada",bada:e,version:r(/dolfin\/(\d+(\.\d+)?)/i)}:p?i={name:"Tizen",osname:"Tizen",tizen:e,version:r(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||E}:/qupzilla/i.test(t)?i={name:"QupZilla",qupzilla:e,version:r(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||E}:/chromium/i.test(t)?i={name:"Chromium",chromium:e,version:r(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||E}:/chrome|crios|crmo/i.test(t)?i={name:"Chrome",chrome:e,version:r(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:s?i={name:"Android",version:E}:/safari|applewebkit/i.test(t)?(i={name:"Safari",safari:e},E&&(i.version=E)):a?(i={name:"iphone"==a?"iPhone":"ipad"==a?"iPad":"iPod"},E&&(i.version=E)):i=/googlebot/i.test(t)?{name:"Googlebot",googlebot:e,version:r(/googlebot\/(\d+(\.\d+))/i)||E}:{name:r(/^(.*)\/(.*) /),version:n(/^(.*)\/(.*) /)},!i.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(i.name=i.name||"Blink",i.blink=e):(i.name=i.name||"Webkit",i.webkit=e),!i.version&&E&&(i.version=E)):!i.opera&&/gecko\//i.test(t)&&(i.name=i.name||"Gecko",i.gecko=e,i.version=i.version||r(/gecko\/(\d+(\.\d+)?)/i)),i.windowsphone||!s&&!i.silk?!i.windowsphone&&a?(i[a]=e,i.ios=e,i.osname="iOS"):m?(i.mac=e,i.osname="macOS"):T?(i.xbox=e,i.osname="Xbox"):g?(i.windows=e,i.osname="Windows"):y&&(i.linux=e,i.osname="Linux"):(i.android=e,i.osname="Android");var w="";i.windows?w=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(r(/Windows ((NT|XP)( \d\d?.\d)?)/i)):i.windowsphone?w=r(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):i.mac?w=(w=r(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g,"."):a?w=(w=r(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):s?w=r(/android[ \/-](\d+(\.\d+)*)/i):i.webos?w=r(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):i.blackberry?w=r(/rim\stablet\sos\s(\d+(\.\d+)*)/i):i.bada?w=r(/bada\/(\d+(\.\d+)*)/i):i.tizen&&(w=r(/tizen[\/\s](\d+(\.\d+)*)/i)),w&&(i.osversion=w);var O=!i.windows&&w.split(".")[0];return b||c||"ipad"==a||s&&(3==O||O>=4&&!S)||i.silk?i.tablet=e:(S||"iphone"==a||"ipod"==a||s||u||i.blackberry||i.webos||i.bada)&&(i.mobile=e),i.msedge||i.msie&&i.version>=10||i.yandexbrowser&&i.version>=15||i.vivaldi&&i.version>=1||i.chrome&&i.version>=20||i.samsungBrowser&&i.version>=4||i.whale&&1===o([i.version,"1.0"])||i.mzbrowser&&1===o([i.version,"6.0"])||i.focus&&1===o([i.version,"1.0"])||i.firefox&&i.version>=20||i.safari&&i.version>=6||i.opera&&i.version>=10||i.ios&&i.osversion&&i.osversion.split(".")[0]>=6||i.blackberry&&i.version>=10.1||i.chromium&&i.version>=20?i.a=e:i.msie&&i.version<10||i.chrome&&i.version<20||i.firefox&&i.version<20||i.safari&&i.version<6||i.opera&&i.version<10||i.ios&&i.osversion&&i.osversion.split(".")[0]<6||i.chromium&&i.version<20?i.c=e:i.x=e,i}var r=t("undefined"!=typeof navigator&&navigator.userAgent||"");function n(e){return e.split(".").length}function i(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r++)n.push(t(e[r]));return n}function o(e){for(var t=Math.max(n(e[0]),n(e[1])),r=i(e,function(e){var r=t-n(e);return i((e+=new Array(r+1).join(".0")).split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});--t>=0;){if(r[0][t]>r[1][t])return 1;if(r[0][t]!==r[1][t])return-1;if(0===t)return 0}}function a(e,n,i){var a=r;"string"==typeof n&&(i=n,n=void 0),void 0===n&&(n=!1),i&&(a=t(i));var s=""+a.version;for(var u in e)if(e.hasOwnProperty(u)&&a[u]){if("string"!=typeof e[u])throw new Error("Browser version in the minVersion map should be a string: "+u+": "+String(e));return o([s,e[u]])<0}return n}return r.test=function(e){for(var t=0;t<e.length;++t){var n=e[t];if("string"==typeof n&&n in r)return!0}return!1},r.isUnsupportedBrowser=a,r.compareVersions=o,r.check=function(e,t,r){return!a(e,t,r)},r._detect=t,r.detect=t,r},t.exports?t.exports=n():r.bowser=n()});var rM=function(e,t){var r=[];return ZO(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r};var nM=function(e,t){return(Hd(e)?Tp:rM)(e,_I(t,3))},iM=!0,oM=!0;function aM(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}var sM={extractVersion:aM,wrapPeerConnectionEvent:function(e,t,r){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);var o=function(e){n(r(e))};return this._eventMap=this._eventMap||{},this._eventMap[n]=o,i.apply(this,[e,o])};var o=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return o.apply(this,arguments);var n=this._eventMap[r];return delete this._eventMap[r],o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(iM=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(oM=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(iM)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(e,t){oM&&console.warn(e+" is deprecated, please use "+t+" instead.")},detectBrowser:function(e){var t=e&&e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=aM(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia)r.browser="chrome",r.version=aM(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=aM(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=aM(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return r}},uM=sM.log,cM=sM.log;function lM(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(function(t){e.forEach(function(r){r.type===n&&r.trackId===t.id&&function e(t,r,n){r&&!n.has(r.id)&&(n.set(r.id,r),Object.keys(r).forEach(function(i){i.endsWith("Id")?e(t,t.get(r[i]),n):i.endsWith("Ids")&&r[i].forEach(function(r){e(t,t.get(r),n)})}))}(e,r,i)})}),i}var fM={shimGetUserMedia:function(e){var t=sM.detectBrowser(e),r=e&&e.navigator,n=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"==typeof e[r]?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var o={};"number"==typeof n.ideal?(o[i("min",r)]=n.ideal,t.optional.push(o),(o={})[i("max",r)]=n.ideal,t.optional.push(o)):(o[i("",r)]=n.ideal,t.optional.push(o))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",r)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,r)]=n[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};o((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"==typeof e.video){var a=e.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});var s,u=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||u)&&(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?s=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(s=["front"]),s))return r.mediaDevices.enumerateDevices().then(function(t){var r=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return s.some(function(t){return-1!==e.label.toLowerCase().indexOf(t)})});return!r&&t.length&&-1!==s.indexOf("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=a.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),uM("chrome: "+JSON.stringify(e)),i(e)});e.video=n(e.video)}return uM("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};r.getUserMedia=function(e,t,n){i(e,function(e){r.webkitGetUserMedia(e,t,function(e){n&&n(o(e))})})};var a=function(e){return new Promise(function(t,n){r.getUserMedia(e,t,n)})};if(r.mediaDevices||(r.mediaDevices={getUserMedia:a,enumerateDevices:function(){return new Promise(function(t){var r={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:r[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),r.mediaDevices.getUserMedia){var s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return i(e,function(e){return s(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(o(e))})})}}else r.mediaDevices.getUserMedia=function(e){return a(e)};void 0===r.mediaDevices.addEventListener&&(r.mediaDevices.addEventListener=function(){uM("Dummy mediaDevices.addEventListener called.")}),void 0===r.mediaDevices.removeEventListener&&(r.mediaDevices.removeEventListener=function(){uM("Dummy mediaDevices.removeEventListener called.")})},shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(e){if("object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)"RTCRtpTransceiver"in e||sM.wrapPeerConnectionEvent(e,"track",function(e){return e.transceiver||(e.transceiver={receiver:e.receiver}),e});else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return r._ontrackpoly||(r._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===n.track.id}):{track:n.track};var o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)}),t.stream.getTracks().forEach(function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===n.id}):{track:n};var o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)})},r.addEventListener("addstream",r._ontrackpoly)),t.apply(r,arguments)}}},shimGetSendersWithDtmf:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;r._senders=r._senders||[],i.apply(r,[e]),e.getTracks().forEach(function(e){r._senders.push(t(r,e))})};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[],o.apply(t,[e]),e.getTracks().forEach(function(e){var r=t._senders.find(function(t){return t.track===e});r&&t._senders.splice(t._senders.indexOf(r),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(e,[]);return t.forEach(function(t){t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSenderReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(e,[]);return r.forEach(function(t){t._pc=e}),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return lM(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(e,[]);return t.forEach(function(t){t._pc=e}),t}),sM.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return lM(t,e.track,!1)})}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,n,o=arguments[0];return this.getSenders().forEach(function(e){e.track===o&&(t?n=!0:t=e)}),this.getReceivers().forEach(function(e){return e.track===o&&(r?n=!0:r=e),e.track===o}),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}},shimSourceObject:function(e){var t=e&&e.URL;"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var r=this;this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e?(this.src=t.createObjectURL(e),e.addEventListener("addtrack",function(){r.src&&t.revokeObjectURL(r.src),r.src=t.createObjectURL(e)}),e.addEventListener("removetrack",function(){r.src&&t.revokeObjectURL(r.src),r.src=t.createObjectURL(e)})):this.src=""}}))},shimAddTrackRemoveTrackWithNative:function(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var n=t.getSenders();r.apply(this,arguments);var i=t.getSenders().filter(function(e){return-1===n.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]}),i.apply(this,arguments)}},shimAddTrackRemoveTrack:function(e){var t=sM.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return this.shimAddTrackRemoveTrackWithNative(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return e._reverseStreams=e._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(r._streams=r._streams||{},r._reverseStreams=r._reverseStreams||{},t.getTracks().forEach(function(e){if(r.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!r._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());r._streams[t.id]=i,r._reverseStreams[i.id]=t,t=i}n.apply(r,[t])};var i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)}),new RTCSessionDescription({type:t.type,sdp:r})}e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{},t._reverseStreams=t._reverseStreams||{},i.apply(t,[t._streams[e.id]||e]),delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id],delete t._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===n.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");n._streams=n._streams||{},n._reverseStreams=n._reverseStreams||{};var o=n._streams[r.id];if(o)o.addTrack(t),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))});else{var a=new e.MediaStream([t]);n._streams[r.id]=a,n._reverseStreams[a.id]=r,n.addStream(a)}return n.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(e,[function(r){var n=o(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(e,arguments).then(function(t){return o(e,t)})}});var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:r})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,r=this;if("closed"===r.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===r))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");r._streams=r._streams||{},Object.keys(r._streams).forEach(function(n){r._streams[n].getTracks().find(function(t){return e.track===t})&&(t=r._streams[n])}),t&&(1===t.getTracks().length?r.removeStream(r._reverseStreams[t.id]):t.removeTrack(e.track),r.dispatchEvent(new Event("negotiationneeded")))}},shimPeerConnection:function(e){var t=sM.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection)e.RTCPeerConnection=function(t,r){return cM("PeerConnection"),t&&t.iceTransportPolicy&&(t.iceTransports=t.iceTransportPolicy),new e.webkitRTCPeerConnection(t,r)},e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype,e.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.webkitRTCPeerConnection.generateCertificate}});else{var r=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(sM.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,n.push(o)):n.push(e.iceServers[i])}e.iceServers=n}return new r(e,t)},e.RTCPeerConnection.prototype=r.prototype,Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return r.generateCertificate}})}var n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,r){var i=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return n.apply(this,arguments);if(0===n.length&&(0===arguments.length||"function"!=typeof arguments[0]))return n.apply(this,[]);var a=function(e){var t={};return e.result().forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){r[t]=e.stat(t)}),t[r.id]=r}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){return n.apply(this,[function(e){o[1](s(a(e)))},arguments[0]])}return new Promise(function(e,t){n.apply(i,[function(t){e(s(a(t)))},t])}).then(t,r)},t.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=arguments,t=this,n=new Promise(function(n,i){r.apply(t,[e[0],n,i])});return e.length<2?n:n.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),t.version<52&&["createOffer","createAnswer"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var t=1===arguments.length?arguments[0]:void 0;return new Promise(function(n,i){r.apply(e,[n,i,t])})}return r.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}});var i=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},dM=r(function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},t.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},t.getDescription=function(e){var r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){var r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){return t.splitLines(e).filter(function(e){return 0===e.indexOf(r)})},t.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},t.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach(function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)}),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},t.getMid=function(e){var r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,r){return{role:"auto",fingerprints:t.matchPrefix(e+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),r},t.getIceParameters=function(e,r){var n=t.splitLines(e);return{usernameFragment:(n=n.concat(t.splitLines(r))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=t.parseRtpMap(a),u=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=u.length?t.parseFmtp(u[0]):{},s.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),r.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(s.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach(function(e){r.headerExtensions.push(t.parseExtmap(e))}),r},t.writeRtpDescription=function(e,r){var n="";n+="m="+e+" ",n+=r.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=r.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach(function(e){n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)});var i=0;return r.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",r.headerExtensions&&r.headerExtensions.forEach(function(e){n+=t.writeExtmap(e)}),n},t.parseRtpEncodingParameters=function(e){var r,n=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),u=s.length>0&&s[0].ssrc,c=t.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});c.length>0&&c[0].length>1&&c[0][0]===u&&(r=c[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:u,codecPayloadType:parseInt(e.parameters.apt,10)};u&&r&&(t.rtx={ssrc:r}),n.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:r,mechanism:a?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&u&&n.push({ssrc:u});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=l})),n},t.parseRtcpParameters=function(e){var r={},n=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return r.mux=o.length>0,r},t.parseMsid=function(e){var r,n=t.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(r=n[0].substr(7).split(" "))[0],track:r[1]};var i=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?{stream:(r=i[0].value.split(" "))[0],track:r[1]}:void 0},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,r){var n=void 0!==r?r:2;return"v=0\r\no=thisisadapterortc "+(e||t.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,r,n,i){var o=t.writeRtpDescription(e.kind,r);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,r){for(var n=t.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var r=t.splitLines(e)[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},t.parseOLine=function(e){var r=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.exports=t});function pM(e,t,r,n,i){var o=dM.writeRtpDescription(e.kind,t);if(o+=dM.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=dM.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":i||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var s="msid:"+(n?n.id:"-")+" "+a+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+dM.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+dM.localCName+"\r\n"),o}function hM(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},i=function(e,t,r,i){var o=n(e.parameters.apt,r),a=n(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach(function(n){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(n.name.toLowerCase()===a.name.toLowerCase()&&n.clockRate===a.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&a.parameters.apt&&!i(n,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(n.numChannels,a.numChannels),r.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var n=0;n<t.headerExtensions.length;n++){var i=t.headerExtensions[n];if(e.uri===i.uri){r.headerExtensions.push(i);break}}}),r}function vM(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function gM(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e.addRemoteCandidate(t),!r}function mM(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}var yM=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function n(t,r,n,i){var o=new Event("track");o.track=r,o.receiver=n,o.transceiver={receiver:n},o.streams=i,e.setTimeout(function(){t._dispatchEvent("track",o)})}var i=function(r){var n=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){n[e]=i[e].bind(i)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw mM("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof n;return i&&(n=[n]),n=n.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)}),delete e.url,e.urls=i?n[0]:n,!!n.length}})}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var o=r.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=dM.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},i.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport,n.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(n),n},i.prototype.addTrack=function(t,r){if(this._isClosed)throw mM("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find(function(e){return e.track===t}))throw mM("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(n=this.transceivers[i]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),n.track=t,n.stream=r,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},i.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach(function(t){r.addTrack(t,e)});else{var n=e.clone();e.getTracks().forEach(function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),n.getTracks().forEach(function(e){r.addTrack(e,n)})}},i.prototype.removeTrack=function(t){if(this._isClosed)throw mM("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find(function(e){return e.rtpSender===t});if(!r)throw mM("InvalidAccessError","Sender was not created by this connection.");var n=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});r&&t.removeTrack(r)})},i.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},i.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},i.prototype._createIceGatherer=function(t,r){var n=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;i.state=r?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},i.prototype._gather=function(t,r){var n=this,i=this.transceivers[r].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),i.onlocalcandidate=function(e){if(!(n.usingBundle&&r>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:r};var a=e.candidate,s=!a||0===Object.keys(a).length;if(s)"new"!==i.state&&"gathering"!==i.state||(i.state="completed");else{"new"===i.state&&(i.state="gathering"),a.component=1,a.ufrag=i.getLocalParameters().usernameFragment;var u=dM.writeCandidate(a);o.candidate=Object.assign(o.candidate,dM.parseCandidate(u)),o.candidate.candidate=u,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var c=dM.getMediaSections(n._localDescription.sdp);c[o.candidate.sdpMLineIndex]+=s?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",n._localDescription.sdp=dM.getDescription(n._localDescription.sdp)+c.join("");var l=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==n.iceGatheringState&&(n.iceGatheringState="gathering",n._emitGatheringStateChange()),s||n._dispatchEvent("icecandidate",o),l&&(n._dispatchEvent("icecandidate",new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange())}},e.setTimeout(function(){o.forEach(function(e){i.onlocalcandidate(e)})},0)}},i.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(r);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:n}},i.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},i.prototype._transceive=function(e,r,n){var i=hM(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:dM.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&i.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?i.encodings=e.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},i.prototype.setLocalDescription=function(e){var t,r,n=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(mM("TypeError",'Unsupported type "'+e.type+'"'));if(!vM("setLocalDescription",e.type,n.signalingState)||n._isClosed)return Promise.reject(mM("InvalidStateError","Can not set local "+e.type+" in state "+n.signalingState));if("offer"===e.type)t=dM.splitSections(e.sdp),r=t.shift(),t.forEach(function(e,t){var r=dM.parseRtpParameters(e);n.transceivers[t].localCapabilities=r}),n.transceivers.forEach(function(e,t){n._gather(e.mid,t)});else if("answer"===e.type){t=dM.splitSections(n._remoteDescription.sdp),r=t.shift();var i=dM.matchPrefix(r,"a=ice-lite").length>0;t.forEach(function(e,t){var o=n.transceivers[t],a=o.iceGatherer,s=o.iceTransport,u=o.dtlsTransport,c=o.localCapabilities,l=o.remoteCapabilities;if(!(dM.isRejected(e)&&0===dM.matchPrefix(e,"a=bundle-only").length)&&!o.rejected){var f=dM.getIceParameters(e,r),d=dM.getDtlsParameters(e,r);i&&(d.role="server"),n.usingBundle&&0!==t||(n._gather(o.mid,t),"new"===s.state&&s.start(a,f,i?"controlling":"controlled"),"new"===u.state&&u.start(d));var p=hM(c,l);n._transceive(o,p.codecs.length>0,!1)}})}return n._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?n._updateSignalingState("have-local-offer"):n._updateSignalingState("stable"),Promise.resolve()},i.prototype.setRemoteDescription=function(i){var o=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(mM("TypeError",'Unsupported type "'+i.type+'"'));if(!vM("setRemoteDescription",i.type,o.signalingState)||o._isClosed)return Promise.reject(mM("InvalidStateError","Can not set remote "+i.type+" in state "+o.signalingState));var a={};o.remoteStreams.forEach(function(e){a[e.id]=e});var s=[],u=dM.splitSections(i.sdp),c=u.shift(),l=dM.matchPrefix(c,"a=ice-lite").length>0,f=dM.matchPrefix(c,"a=group:BUNDLE ").length>0;o.usingBundle=f;var d=dM.matchPrefix(c,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!d&&d.substr(14).split(" ").indexOf("trickle")>=0,u.forEach(function(n,u){var d=dM.splitLines(n),p=dM.getKind(n),h=dM.isRejected(n)&&0===dM.matchPrefix(n,"a=bundle-only").length,v=d[0].substr(2).split(" ")[2],g=dM.getDirection(n,c),m=dM.parseMsid(n),y=dM.getMid(n)||dM.generateIdentifier();if("application"===p&&"DTLS/SCTP"===v||h)o.transceivers[u]={mid:y,kind:p,rejected:!0};else{var _,E,b,S,T,w,O,k,R;!h&&o.transceivers[u]&&o.transceivers[u].rejected&&(o.transceivers[u]=o._createTransceiver(p,!0));var A,I,P=dM.parseRtpParameters(n);h||(A=dM.getIceParameters(n,c),(I=dM.getDtlsParameters(n,c)).role="client"),O=dM.parseRtpEncodingParameters(n);var C=dM.parseRtcpParameters(n),M=dM.matchPrefix(n,"a=end-of-candidates",c).length>0,N=dM.matchPrefix(n,"a=candidate:").map(function(e){return dM.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===i.type||"answer"===i.type)&&!h&&f&&u>0&&o.transceivers[u]&&(o._disposeIceAndDtlsTransports(u),o.transceivers[u].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[u].iceTransport=o.transceivers[0].iceTransport,o.transceivers[u].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[u].rtpSender&&o.transceivers[u].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[u].rtpReceiver&&o.transceivers[u].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==i.type||h)"answer"!==i.type||h||(E=(_=o.transceivers[u]).iceGatherer,b=_.iceTransport,S=_.dtlsTransport,T=_.rtpReceiver,w=_.sendEncodingParameters,k=_.localCapabilities,o.transceivers[u].recvEncodingParameters=O,o.transceivers[u].remoteCapabilities=P,o.transceivers[u].rtcpParameters=C,N.length&&"new"===b.state&&(!l&&!M||f&&0!==u?N.forEach(function(e){gM(_.iceTransport,e)}):b.setRemoteCandidates(N)),f&&0!==u||("new"===b.state&&b.start(E,A,"controlling"),"new"===S.state&&S.start(I)),o._transceive(_,"sendrecv"===g||"recvonly"===g,"sendrecv"===g||"sendonly"===g),!T||"sendrecv"!==g&&"sendonly"!==g?delete _.rtpReceiver:(R=T.track,m?(a[m.stream]||(a[m.stream]=new e.MediaStream),r(R,a[m.stream]),s.push([R,T,a[m.stream]])):(a.default||(a.default=new e.MediaStream),r(R,a.default),s.push([R,T,a.default]))));else{(_=o.transceivers[u]||o._createTransceiver(p)).mid=y,_.iceGatherer||(_.iceGatherer=o._createIceGatherer(u,f)),N.length&&"new"===_.iceTransport.state&&(!M||f&&0!==u?N.forEach(function(e){gM(_.iceTransport,e)}):_.iceTransport.setRemoteCandidates(N)),k=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(k.codecs=k.codecs.filter(function(e){return"rtx"!==e.name})),w=_.sendEncodingParameters||[{ssrc:1001*(2*u+2)}];var D,j=!1;if("sendrecv"===g||"sendonly"===g){if(j=!_.rtpReceiver,T=_.rtpReceiver||new e.RTCRtpReceiver(_.dtlsTransport,p),j)R=T.track,m&&"-"===m.stream||(m?(a[m.stream]||(a[m.stream]=new e.MediaStream,Object.defineProperty(a[m.stream],"id",{get:function(){return m.stream}})),Object.defineProperty(R,"id",{get:function(){return m.track}}),D=a[m.stream]):(a.default||(a.default=new e.MediaStream),D=a.default)),D&&(r(R,D),_.associatedRemoteMediaStreams.push(D)),s.push([R,T,D])}else _.rtpReceiver&&_.rtpReceiver.track&&(_.associatedRemoteMediaStreams.forEach(function(t){var r,n,i=t.getTracks().find(function(e){return e.id===_.rtpReceiver.track.id});i&&(r=i,(n=t).removeTrack(r),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:r})))}),_.associatedRemoteMediaStreams=[]);_.localCapabilities=k,_.remoteCapabilities=P,_.rtpReceiver=T,_.rtcpParameters=C,_.sendEncodingParameters=w,_.recvEncodingParameters=O,o._transceive(o.transceivers[u],!1,j)}}}),void 0===o._dtlsRole&&(o._dtlsRole="offer"===i.type?"active":"passive"),o._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(a).forEach(function(t){var r=a[t];if(r.getTracks().length){if(-1===o.remoteStreams.indexOf(r)){o.remoteStreams.push(r);var i=new Event("addstream");i.stream=r,e.setTimeout(function(){o._dispatchEvent("addstream",i)})}s.forEach(function(e){var t=e[0],i=e[1];r.id===e[2].id&&n(o,t,i,[r])})}}),s.forEach(function(e){e[2]||n(o,e[0],e[1],[])}),e.setTimeout(function(){o&&o.transceivers&&o.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},i.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},i.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},i.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++,t[e.dtlsTransport.state]++}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},i.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(mM("InvalidStateError","Can not call createOffer after close"));var n=r.transceivers.filter(function(e){return"audio"===e.kind}).length,i=r.transceivers.filter(function(e){return"video"===e.kind}).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(n=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(i=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(r.transceivers.forEach(function(e){"audio"===e.kind?--n<0&&(e.wantReceive=!1):"video"===e.kind&&--i<0&&(e.wantReceive=!1)});n>0||i>0;)n>0&&(r._createTransceiver("audio"),n--),i>0&&(r._createTransceiver("video"),i--);var a=dM.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach(function(n,i){var o=n.track,a=n.kind,s=n.mid||dM.generateIdentifier();n.mid=s,n.iceGatherer||(n.iceGatherer=r._createIceGatherer(i,r.usingBundle));var u=e.RTCRtpSender.getCapabilities(a);t<15019&&(u.codecs=u.codecs.filter(function(e){return"rtx"!==e.name})),u.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),n.remoteCapabilities&&n.remoteCapabilities.codecs&&n.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),u.headerExtensions.forEach(function(e){(n.remoteCapabilities&&n.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var c=n.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];o&&t>=15019&&"video"===a&&!c[0].rtx&&(c[0].rtx={ssrc:c[0].ssrc+1}),n.wantReceive&&(n.rtpReceiver=new e.RTCRtpReceiver(n.dtlsTransport,a)),n.localCapabilities=u,n.sendEncodingParameters=c}),"max-compat"!==r._config.bundlePolicy&&(a+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n",r.transceivers.forEach(function(e,t){a+=pM(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),a+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,a+="a="+dM.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(a+="a=end-of-candidates\r\n"))});var s=new e.RTCSessionDescription({type:"offer",sdp:a});return Promise.resolve(s)},i.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(mM("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(mM("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var n=dM.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(n+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n");var i=dM.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach(function(e,o){if(!(o+1>i)){if(e.rejected)return"application"===e.kind?n+="m=application 0 DTLS/SCTP 5000\r\n":"audio"===e.kind?n+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(n+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(n+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var a;if(e.stream)"audio"===e.kind?a=e.stream.getAudioTracks()[0]:"video"===e.kind&&(a=e.stream.getVideoTracks()[0]),a&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var s=hM(e.localCapabilities,e.remoteCapabilities);!s.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,n+=pM(e,s,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(n+="a=rtcp-rsize\r\n")}});var o=new e.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(o)},i.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(n,i){if(!r._remoteDescription)return i(mM("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var a=0;a<r.transceivers.length;a++)if(r.transceivers[a].mid===e.sdpMid){o=a;break}var s=r.transceivers[o];if(!s)return i(mM("OperationError","Can not add ICE candidate"));if(s.rejected)return n();var u=Object.keys(e.candidate).length>0?dM.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port))return n();if(u.component&&1!==u.component)return n();if((0===o||o>0&&s.iceTransport!==r.transceivers[0].iceTransport)&&!gM(s.iceTransport,u))return i(mM("OperationError","Can not add ICE candidate"));var c=e.candidate.trim();0===c.indexOf("a=")&&(c=c.substr(2)),(t=dM.getMediaSections(r._remoteDescription.sdp))[o]+="a="+(u.type?c:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=dM.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var l=0;l<r.transceivers.length&&(r.transceivers[l].rejected||(r.transceivers[l].iceTransport.addRemoteCandidate({}),(t=dM.getMediaSections(r._remoteDescription.sdp))[l]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=dM.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));l++);n()})},i.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)}),!r)throw mM("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&n.push(e[t].getStats())})}),Promise.all(n).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var n=r.prototype.getStats;r.prototype.getStats=function(){return n.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(r){var n;e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(n=e[r]).type]||n.type,t.set(r,e[r])}),t})}}});var o=["createOffer","createAnswer"];return o.forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),i},_M={shimGetUserMedia:function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}},shimPeerConnection:function(e){var t=sM.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=yM(e,t.version);e.RTCPeerConnection=function(e){var t,r,i;return e&&e.iceServers&&(e.iceServers=(t=e.iceServers,i=!1,(t=JSON.parse(JSON.stringify(t))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&sM.deprecated("RTCIceServer.url","RTCIceServer.urls");var n="string"==typeof t;return n&&(t=[t]),t=t.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||i?0===e.indexOf("stun:")&&r>=14393&&-1===e.indexOf("?transport=udp"):(i=!0,!0)}),delete e.url,e.urls=n?t[0]:t,!!t.length}}))),new n(e)},e.RTCPeerConnection.prototype=n.prototype},shimReplaceTrack:function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}},EM=sM.log,bM={shimGetUserMedia:function(e){var t=sM.detectBrowser(e),r=e&&e.navigator,n=e&&e.MediaStreamTrack,i=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},o=function(e,n,o){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n=e[r]="object"==typeof e[r]?e[r]:{ideal:e[r]};if(void 0===n.min&&void 0===n.max&&void 0===n.exact||t.push(r),void 0!==n.exact&&("number"==typeof n.exact?n.min=n.max=n.exact:e[r]=n.exact,delete n.exact),void 0!==n.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof n.ideal?i[r]={min:n.ideal,max:n.ideal}:i[r]=n.ideal,e.advanced.push(i),delete n.ideal,Object.keys(n).length||delete e[r]}}}),t.length&&(e.require=t),e};return e=JSON.parse(JSON.stringify(e)),t.version<38&&(EM("spec: "+JSON.stringify(e)),e.audio&&(e.audio=a(e.audio)),e.video&&(e.video=a(e.video)),EM("ff37: "+JSON.stringify(e))),r.mozGetUserMedia(e,n,function(e){o(i(e))})};if(r.mediaDevices||(r.mediaDevices={getUserMedia:function(e){return new Promise(function(t,r){o(e,t,r)})},addEventListener:function(){},removeEventListener:function(){}}),r.mediaDevices.enumerateDevices=r.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},t.version<41){var a=r.mediaDevices.enumerateDevices.bind(r.mediaDevices);r.mediaDevices.enumerateDevices=function(){return a().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(t.version<49){var s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return s(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return t},function(e){return Promise.reject(i(e))})}}if(!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var u=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},c=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),u(e.audio,"autoGainControl","mozAutoGainControl"),u(e.audio,"noiseSuppression","mozNoiseSuppression")),c(e)},n&&n.prototype.getSettings){var l=n.prototype.getSettings;n.prototype.getSettings=function(){var e=l.apply(this,arguments);return u(e,"mozAutoGainControl","autoGainControl"),u(e,"mozNoiseSuppression","noiseSuppression"),e}}if(n&&n.prototype.applyConstraints){var f=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),u(e,"autoGainControl","mozAutoGainControl"),u(e,"noiseSuppression","mozNoiseSuppression")),f.apply(this,[e])}}}r.getUserMedia=function(e,n,i){if(t.version<44)return o(e,n,i);sM.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(n,i)}},shimOnTrack:function(e){"object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var r=new Event("track");r.track=t,r.receiver={track:t},r.transceiver={receiver:r.receiver},r.streams=[e.stream],this.dispatchEvent(r)}.bind(this))}.bind(this))}}),"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(e){"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(e){var t=sM.detectBrowser(e);if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){e.RTCPeerConnection||(e.RTCPeerConnection=function(r,n){if(t.version<38&&r&&r.iceServers){for(var i=[],o=0;o<r.iceServers.length;o++){var a=r.iceServers[o];if(a.hasOwnProperty("urls"))for(var s=0;s<a.urls.length;s++){var u={url:a.urls[s]};0===a.urls[s].indexOf("turn")&&(u.username=a.username,u.credential=a.credential),i.push(u)}else i.push(r.iceServers[o])}r.iceServers=i}return new e.mozRTCPeerConnection(r,n)},e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype,e.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.mozRTCPeerConnection.generateCertificate}}),e.RTCSessionDescription=e.mozRTCSessionDescription,e.RTCIceCandidate=e.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}});var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,r,o){return i.apply(this,[e||null]).then(function(e){if(t.version<48&&(e=function(e){var t=new Map;return Object.keys(e).forEach(function(r){t.set(r,e[r]),t[r]=e[r]}),t}(e)),t.version<53&&!r)try{e.forEach(function(e){e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach(function(t,r){e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(r,o)}}},shimSenderGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(e,[]);return r.forEach(function(t){t._pc=e}),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},shimReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(e,[]);return r.forEach(function(t){t._pc=e}),r}),sM.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},shimRemoveStream:function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;sM.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(r){r.track&&-1!==e.getTracks().indexOf(r.track)&&t.removeTrack(r)})})},shimRTCDataChannel:function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}},SM={shimLocalStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;return this._localStreams&&this._localStreams.forEach(function(r){r.id===e&&(t=r)}),this._remoteStreams&&this._remoteStreams.forEach(function(r){r.id===e&&(t=r)}),t}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(e)&&this._localStreams.push(e);var r=this;e.getTracks().forEach(function(n){t.call(r,n,e)})},e.RTCPeerConnection.prototype.addTrack=function(e,r){return r&&(this._localStreams?-1===this._localStreams.indexOf(r)&&this._localStreams.push(r):this._localStreams=[r]),t.call(this,e,r)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var r=this,n=e.getTracks();this.getSenders().forEach(function(e){-1!==n.indexOf(e.track)&&r.removeTrack(e)})}})}},shimRemoteStreamsAPI:function(e){"object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),"onaddstream"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!(t._remoteStreams.indexOf(e)>=0)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}})})}}))},shimCallbacksAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var s=function(e,t,r){var n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=s,s=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=s,s=function(e,t,r){var n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=s}},shimGetUserMedia:function(e){var t=e&&e.navigator;t.getUserMedia||(t.webkitGetUserMedia?t.getUserMedia=t.webkitGetUserMedia.bind(t):t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t)))},shimRTCIceServerUrls:function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(sM.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[i])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},shimTrackEventTransceiver:function(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var r=this;if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=r.getTransceivers().find(function(e){return e.sender.track&&"audio"===e.sender.track.kind});!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||r.addTransceiver("audio"),void 0!==e.offerToReceiveAudio&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=r.getTransceivers().find(function(e){return e.sender.track&&"video"===e.sender.track.kind});!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection("sendonly"):"recvonly"===i.direction&&i.setDirection("inactive"):!0!==e.offerToReceiveVideo||i||r.addTransceiver("video")}return t.apply(r,arguments)}}},TM={shimRTCIceCandidate:function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),n=dM.parseCandidate(e.candidate),i=Object.assign(r,n);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,sM.wrapPeerConnectionEvent(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})}},shimCreateObjectURL:function(e){var t=e&&e.URL;if("object"==typeof e&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL){var r=t.createObjectURL.bind(t),n=t.revokeObjectURL.bind(t),i=new Map,o=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++o;return i.set(t,e),sM.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),t}return r(e)},t.revokeObjectURL=function(e){n(e),i.delete(e)};var a=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function(){return a.get.apply(this)},set:function(e){return this.srcObject=i.get(e)||null,a.set.apply(this,[e])}});var s=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=i.get(arguments[1])||null),s.apply(this,arguments)}}},shimMaxMessageSize:function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=sM.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,n,i,o;if(this._sctp=null,i=arguments[0],(o=dM.splitSections(i.sdp)).shift(),o.some(function(e){var t=dM.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})){var a,s=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),u=(e=s,n=65536,"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n),c=function(e,r){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var i=dM.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?n=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n}(arguments[0],s);a=0===u&&0===c?Number.POSITIVE_INFINITY:0===u||0===c?Math.max(u,c):Math.min(u,c);var l={};Object.defineProperty(l,"maxMessageSize",{get:function(){return a}}),this._sctp=l}return r.apply(this,arguments)}}},shimSendThrowTypeError:function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},sM.wrapPeerConnectionEvent(e,"datachannel",function(e){return r(e.channel,e.target),e})}function r(e,t){var r=e.send;e.send=function(){var n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}}},wM=(function(e,t){var r=e&&e.window,n={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var i in t)hasOwnProperty.call(t,i)&&(n[i]=t[i]);var o=sM.log,a=sM.detectBrowser(r),s=fM||null,u=_M||null,c=bM||null,l=SM||null,f=TM||null,d={browserDetails:a,commonShim:f,extractVersion:sM.extractVersion,disableLog:sM.disableLog,disableWarnings:sM.disableWarnings};switch(a.browser){case"chrome":if(!s||!s.shimPeerConnection||!n.shimChrome)return o("Chrome shim is not included in this adapter release."),d;o("adapter.js shimming chrome."),d.browserShim=s,f.shimCreateObjectURL(r),s.shimGetUserMedia(r),s.shimMediaStream(r),s.shimSourceObject(r),s.shimPeerConnection(r),s.shimOnTrack(r),s.shimAddTrackRemoveTrack(r),s.shimGetSendersWithDtmf(r),s.shimSenderReceiverGetStats(r),f.shimRTCIceCandidate(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;case"firefox":if(!c||!c.shimPeerConnection||!n.shimFirefox)return o("Firefox shim is not included in this adapter release."),d;o("adapter.js shimming firefox."),d.browserShim=c,f.shimCreateObjectURL(r),c.shimGetUserMedia(r),c.shimSourceObject(r),c.shimPeerConnection(r),c.shimOnTrack(r),c.shimRemoveStream(r),c.shimSenderGetStats(r),c.shimReceiverGetStats(r),c.shimRTCDataChannel(r),f.shimRTCIceCandidate(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;case"edge":if(!u||!u.shimPeerConnection||!n.shimEdge)return o("MS edge shim is not included in this adapter release."),d;o("adapter.js shimming edge."),d.browserShim=u,f.shimCreateObjectURL(r),u.shimGetUserMedia(r),u.shimPeerConnection(r),u.shimReplaceTrack(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;case"safari":if(!l||!n.shimSafari)return o("Safari shim is not included in this adapter release."),d;o("adapter.js shimming safari."),d.browserShim=l,f.shimCreateObjectURL(r),l.shimRTCIceServerUrls(r),l.shimCallbacksAPI(r),l.shimLocalStreamsAPI(r),l.shimRemoteStreamsAPI(r),l.shimTrackEventTransceiver(r),l.shimGetUserMedia(r),l.shimCreateOfferLegacy(r),f.shimRTCIceCandidate(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;default:o("Unsupported browser!")}}({window:e.window}),r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ensureH264=void 0;var r=o(nM),n=o(SI),i=o(Pk);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r="screen"===e?{content:"slides",type:"video"}:{type:e},i=(0,n.default)((0,eM.parse)(t).media,r);return i?i.direction:"inactive"}function s(e){switch(e){case"inactive":case"sendrecv":return e;case"sendonly":return"recvonly";case"recvonly":return"sendonly";default:throw new Error('direction "'+e+'" is not valid')}}t.getMediaDirectionFromSDP=a,t.getMediaFromSDP=function(e,t,n){var i="screen"===e?{content:"slides",type:"video"}:{type:e},o=(0,r.default)((0,eM.parse)(t).media,i),a={};n&&("sendrecv"===n?(o.forEach(function(e){a[e.direction]=e}),!a.sendrecv||a.recvonly||a.sendonly?!a.sendrecv&&a.recvonly&&a.sendonly&&(o=[a.recvonly,a.sendonly]):o=a.sendrecv):o=o.filter(function(e){return e.direction===n}));return o},t.reverseMediaDirection=s,t.limitBandwith=function(e,t){var r=e.audioBandwidthLimit,n=e.videoBandwidthLimit;return t.split("\r\n").reduce(function(e,t){return e.push(t),t.startsWith("m=")&&e.push("b=TIAS:"+(t.includes("audio")?r:n)),e},[]).join("\r\n")},t.kindToPropertyFragment=function(e){return"audio"===e?"Audio":"Video"},t.getMediaDirectionFromSDPForAnswer=function(e,t){return s(a(e,t))},t.boolToDirection=u,t.getMediaDirectionFromTracks=function(e,t){if("closed"===t.signalingState)return"inactive";var r=t.getSenders().filter(function(t){return t.track&&t.track.kind===e}),n=r.length>0&&r.reduce(function(e,t){return e||t.track.enabled},!1),i=t.getReceivers().filter(function(t){return t.track&&t.track.kind===e}),o=i.length>0&&i.reduce(function(e,t){return e||t.track.enabled},!1);return u(n,o)},t.removeExtmap=function(e){return e.replace(/a=extmap.*\r\n/g,"")};t.ensureH264=(0,i.default)(function(e,t){if(e){if(!t.includes("m=video"))throw new Error("No video section found in offer");if(!/[hH]264/.test(t))throw new Error("Offer does not include h264 codec")}return t});function u(e,t){return e&&t?"sendrecv":e?"sendonly":t?"recvonly":"inactive"}}));t(wM);wM.ensureH264,wM.getMediaDirectionFromSDP,wM.getMediaFromSDP,wM.reverseMediaDirection,wM.limitBandwith,wM.kindToPropertyFragment,wM.getMediaDirectionFromSDPForAnswer,wM.boolToDirection,wM.getMediaDirectionFromTracks,wM.removeExtmap;var OM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i,o,a,s,u,c,l,f,d,p,h,v,g,m,y=N(Zl),_=N(Sy),E=N(xu),b=N(Xk),S=N(Fu),T=N(Xl),w=N(_y),O=N(Ty),k=N(B_),R=N(zy),A=N(Fb),I=N(YC),P=N(sk),C=N(XC),M=N(tM);function N(e){return e&&e.__esModule?e:{default:e}}function D(e,t,r,n){r&&(0,_.default)(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function j(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}C.default.a.find(function(e){return"content"===e.name})||C.default.a.unshift({name:"content",reg:/^content:(slides)/});var x=new((0,Tw.make)(R.default,k.default)),L={audio:"Audio",video:"Video"};function U(e,t){return x.get(e,t)||"inactive"}var F=(r=(0,Tw.whileInFlight)("gumming"),n=(0,WC.debounce)(500),i=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,w.default)(this,e),this.logger=console,D(this,"localMediaStream",o,this),D(this,"remoteMediaStream",a,this),D(this,"localScreenShare",s,this),this.pc=new RTCPeerConnection({iceServers:[],bundlePolicy:"max-compat",sdpSemantics:"plan-b"}),D(this,"offerSdp",u,this),D(this,"answerSdp",c,this),D(this,"sendingAudio",l,this),D(this,"sendingVideo",f,this),D(this,"receivingAudio",d,this),D(this,"receivingVideo",p,this),D(this,"ended",h,this),this.negotiationNeeded=!1,this.bandwidthLimit={audioBandwidthLimit:6e4,videoBandwidthLimit:1e6},D(this,"constraints",v,this),D(this,"offerOptions",g,this),D(this,"gumming",m,this),n.parent?Bs(function(){n.parent.logger&&(t.logger=n.parent.logger)}):r.logger&&(this.logger=r.logger),this.pc.onnegotiationneeded=function(){t.logger.info("peer connection emitted negotiationneeded"),t.answerSdp&&!t.negotiationNeeded&&(t.negotiationNeeded=!0,t.triggerNegotiationNeeded())},this.pc.ontrack=function(e){t.logger.info("peerConnection ontrack fired, updating remoteMediaStream"),t.trigger("track");var r=t.remoteMediaStream||new MediaStream;e.streams[0].getTracks().forEach(function(e){t.logger.info("adding "+e.kind+" track to remoteMediaStream"),r&&!r.getTracks().includes(e)&&r.addTrack(e),e.onended=function(){t.logger.info("remote "+e.kind+" has ended, removing track from remoteMediaStream"),r.removeTrack(e),e.onended=void 0;try{t["receiving"+L[e.kind]]=(0,wM.getMediaDirectionFromTracks)(e.kind,t.pc).includes("recv")}catch(r){t["receiving"+L[e.kind]]=!1}},t["receiving"+L[e.kind]]=(0,wM.getMediaDirectionFromTracks)(e.kind,t.pc).includes("recv")}),t.remoteMediaStream=r,t.trigger("internalTrackUpdate")}}return(0,O.default)(e,[{key:"audioDirection",get:function(){return(0,wM.getMediaDirectionFromTracks)("audio",this.pc)}},{key:"videoDirection",get:function(){return(0,wM.getMediaDirectionFromTracks)("video",this.pc)}},{key:"screenDirection",get:function(){return this.localScreenShare&&0!==this.localScreenShare.getTracks().length?"sendonly":"inactive"}},{key:"senderTracks",get:function(){return this.pc.getSenders().reduce(function(e,t){return t.track&&e.push(t.track),e},[])}},{key:"receiverTracks",get:function(){return this.pc.getReceivers().reduce(function(e,t){return t.track&&e.push(t.track),e},[])}}],[{key:"getUserMedia",value:function(e){var t=(0,A.default)({},e,{fake:"test"===ru.env.NODE_ENV});return navigator.mediaDevices.getUserMedia(t)}}]),(0,O.default)(e,[{key:"_prepareIceGatherer",value:function(){var e=this,t=!1;if("new"===this.pc.iceGatheringState)this.logger.info('ice gathering is in state "new", definitely need to block for ice gathering'),t=!0;else{var r=(0,eM.parse)(this.pc.localDescription.sdp);["audio","video","screen"].forEach(function(n){var i=n+"Direction";("inactive"!==e[i]||U(e,n)!==e[i]&&"inactive"!==U(e,n))&&(r.media.find(function(e){return e.type===n})?e.logger.info(n+" candidates already gathered"):(e.logger.info("transitioning "+n+" from inactive, ice needed"),t=!0))})}var n=void 0;return t&&(n=new T.default(function(t){e.logger.info("configuring ice gathering"),e.pc.onicecandidate=function(r){if(!r.candidate)return e.logger.info("ice gathering complete"),e.pc.onicecandidate=void 0,void t();e.logger.info("got ice candidate")}})),n}},{key:"createOffer",value:function(){var e=this;this.logger.info("beginning negotiation");var t=U(this,"video"),r=t.includes("send")||t.includes("recv"),n=this._prepareIceGatherer();return new T.default(function(t){if(e.gumming)return e.logger.info("gum in flight, waiting until it completes"),void t(e._getUserMedia().then((0,Tw.tap)(function(){return e.logger.info("gum completed")})));t()}).then((0,Tw.tap)(function(){return e.logger.info("starting create offer",e.offerOptions)})).then(function(){return e.offerOptions.offerToReceiveAudio=!!e.offerOptions.offerToReceiveAudio,e.offerOptions.offerToReceiveVideo=!!e.offerOptions.offerToReceiveVideo,e.logger.info("creating REAL offer",e.offerOptions),e.logger.info("createOffer audioDirection: "+e.audioDirection),e.logger.info("createOffer videoDirection: "+e.videoDirection),e.logger.info("createOffer screenDirection: "+e.screenDirection),e.updateLocalMediaToTargetDirection(),e.pc.createOffer(e.offerOptions)}).then((0,Tw.tap)(function(t){t.sdp=(0,wM.limitBandwith)(e.bandwidthLimit,t.sdp),t.sdp=(0,wM.removeExtmap)(t.sdp)})).then((0,Tw.tap)(function(){return e.logger.info("setting local description")})).then(function(t){return e.pc.setLocalDescription(t)}).then((0,Tw.tap)(function(){return n&&e.logger.info("blocking for ice gathering")})).then(function(){return n}).then((0,Tw.tap)(function(){return e.logger.info("limiting bandwith")})).then(function(){return(0,wM.limitBandwith)(e.bandwidthLimit,e.pc.localDescription.sdp)}).then((0,Tw.tap)(function(){return r&&e.logger.info("confirm h264 in offer")})).then((0,wM.ensureH264)(r)).then(function(t){if(e.localScreenShare){var r=e.localScreenShare.id,n=e.localScreenShare.getVideoTracks()[0];if(n){var i=r+" "+n.id,o=t.split(i);if(o[1])return o[1]="\r\na=content:slides"+o[1],t=o.join(i)}t+="a=content:slides\r\n"}return t}).then((0,Tw.tap)(function(t){e.offerSdp=t}))}},{key:"acceptAnswer",value:function(e){var t=this;this.logger.info("accepting answer"),this.logger.debug("new answer sdp:",e);var r=e.replace(/max-mbps=27600;max-fs=920/g,"max-mbps=27600;max-fs=8160");return r=r.replace(/m=video 0(.*?\r\n)/,"m=video 0$1a=inactive\r\n"),r=(0,wM.removeExtmap)(r),this.logger.debug("cleaned answer sdp:",r),"have-local-offer"===this.pc.signalingState?this.pc.setRemoteDescription(new RTCSessionDescription({sdp:r,type:"answer"})).then(function(){t.logger.info("answer accepted"),t.answerSdp=r,t.sendingAudio=(0,wM.getMediaDirectionFromTracks)("audio",t.pc).includes("send"),t.sendingVideo=(0,wM.getMediaDirectionFromTracks)("video",t.pc).includes("send"),t.updateLocalMediaToTargetDirection(),t.trigger("answeraccepted"),t.negotiationNeeded=!1}):T.default.resolve()}},{key:"_setNewMediaDirection",value:function(e,t){var r=this;this.logger.info("setting "+e+" direction to "+t);var n=t.includes("send");if(this.constraints[e]=n,!n)return this.logger.info("muting "+e+" local tracks"),this.localMediaStream?this.localMediaStream.getTracks().filter(function(t){return t.kind===e}).forEach(function(t){r.logger.info("muting existing "+e+" track from localMediaStream");var i=r.pc.getSenders().find(function(e){return e.track===t});M.default.firefox||r.localMediaStream.removeTrack(t),i&&(r.logger.info("muting existing "+e+" track on sender"),i.track.enabled=!1,t.enabled=!1,M.default.firefox||r.pc.removeTrack(i)),r.logger.info("setting sending"+L[e]+" to "+n),r["sending"+L[e]]=n}):T.default.resolve();var i=this.pc.getSenders().filter(function(t){return t.track&&t.track.kind===e});if(i.length>0){this.logger.info("enabling existing "+e+" sender track");var o=this.localMediaStream.getTracks().filter(function(t){return t.kind===e});return i.forEach(function(e){e.track.enabled=o.includes(e.track)}),this["sending"+L[e]]=n,T.default.resolve()}return this[e+"Direction"].includes("send")?T.default.resolve():this._setNewMediaConstraint(e,n)}},{key:"_setNewMediaTrack",value:function(e,t){return this.logger.info("setting new "+e+" track"),this.constraints[e]=!1,this.addOrReplaceTrack(t)}},{key:"_setNewMediaConstraint",value:function(e,t){return this.logger.info("setting "+e+" with new constraint"),this.constraints[e]=t,this._getUserMedia()}},{key:"_setScreenShare",value:function(e,t){var r=this;if(this.logger.info("calling _setScreenShare"),x.set(this,"screen",e),e.includes("send")){var n=(0,A.default)({},t,{mediaSource:"application",width:{min:"160",max:"1920"},height:{min:"90",max:"1080"},frameRate:{min:"1",max:"30"}});this._setNewMediaConstraint("screen",n)}else this.logger.info("removing existing screenshare tracks from peer connection and localScreenShare stream"),this.pc.getSenders().filter(function(e){return e.track&&r.localScreenShare.getTracks().includes(e.track)}).forEach(function(e){r.logger.info("removing screenshare track "+e.track.id+" from peer connection and localScreenShare stream");var t=e.track;e.track.enabled=!1,r.localScreenShare.removeTrack(t),r.pc.removeTrack(e),t.stop(),r.logger.info("removed screenshare track "+t.id+" from peer connection and localScreenShare stream")}),this.localScreenShare=!1}},{key:"setMedia",value:function(e,t,r){var n=this;return this.logger.info("setMedia"),"screen"===e?(this.logger.info("setMedia: setting new screen direction"),this._setScreenShare(t,r),T.default.resolve()):new T.default(function(i){if(r){if(!t.includes("send"))throw new Error("Cannot set new "+e+" track or constraint if direction does not include send");if(r instanceof MediaStreamTrack){if(r.kind!==e)throw new Error("track is not a valid "+e+" media stream track");i(n._setNewMediaTrack(e,r))}else i(n._setNewMediaConstraint(e,r))}else t===U(n,e)&&(n.logger.info("setMedia: "+e+" already transitioning to "+t+", not making changes"),i()),t===n[e+"Direction"]&&(n.logger.info("setMedia: "+e+" already set to "+t+", not making changes"),i()),i(n._setNewMediaDirection(e,t))}).then(function(){var r=t.includes("recv");n.logger.info("setMedia: set targetMediaDirection for "+e+" to "+t),x.set(n,e,t),n.logger.info("setMedia: set offerToReceive"+(0,wM.kindToPropertyFragment)(e)+" to "+r),n.offerOptions["offerToReceive"+(0,wM.kindToPropertyFragment)(e)]=r;var i=n.pc.getReceivers().filter(function(t){return t.track&&t.track.kind===e});r?i.length>0?(n.logger.info("setMedia: unpause existing receiving "+e+" track"),n.unpauseReceivingMedia(e)):!i.length&&n.answerSdp&&(n.logger.info("setMedia: no receiving "+e+" track exists, trigger negotiation"),n.triggerNegotiationNeeded()):i.length>0&&(n.logger.info("setMedia: pausing existing receiving "+e+" track"),n.pauseReceivingMedia(e))})}},{key:"_getUserMedia",value:function(){var t=this;return this.logger.info("enqueing request to get user media"),new T.default(function(e){return Bs(e)}).then(function(){!0===t.constraints.audio&&t.pc.getSenders().find(function(e){return e.track&&"audio"===e.track.kind})&&(t.logger.info("already have a local audio track, removing constraint for a second one"),(0,S.default)(t.constraints,"audio")),!0===t.constraints.video&&t.pc.getSenders().find(function(e){return e.track&&"video"===e.track.kind})&&(t.logger.info("already have a local video track, removing constraint for a second one"),(0,S.default)(t.constraints,"video"));var r=t.constraints,n=r.audio,i=r.video,o=r.screen;return t.logger.info("getting user media with "+(n?"1":"0")+" audio track, "+(i?"1":"0")+" video track, and "+(o?"1":"0")+" screenshare track."),T.default.all([(n||i)&&e.getUserMedia({audio:n,video:i}),o&&e.getUserMedia({video:o})])}).then(function(e){var r=(0,b.default)(e,2),n=r[0],i=r[1],o=[];if(n&&(t.logger.info("got local media stream with "+n.getAudioTracks().length+" audio tracks and "+n.getVideoTracks().length+" video tracks"),n.getTracks().forEach(function(e){return o.push(t.addOrReplaceTrack(e))})),i){if(t.localScreenShare){var a=t.pc.getSenders().find(function(e){return t.localScreenShare.getTracks().includes(e.track)});a&&(t.logger.info("removing existing screenshare track from localScreenShare stream"),t.localScreenShare.removeTrack(a.track),t.logger.info("disabling existing screenshare track on sender"),a.track.enabled=!1),i.getTracks().forEach(function(e){a?(t.logger.info("replacing existing screenshare track on sender"),o.push(a.replaceTrack(e))):(t.logger.info("adding new screen track to peerConnection"),t.pc.addTrack(e,i))})}else t.logger.info("adding localScreenShare for the first time"),t.logger.info("adding new screenshare track to peer connection"),i.getVideoTracks().forEach(function(e){return t.pc.addTrack(e,i)});t.localScreenShare=i}return t.constraints={},T.default.all(o)}).catch(function(e){return t.trigger("error",e),T.default.reject(e)})}},{key:"addOrReplaceTrack",value:function(e){var t=this,r=[];this.localMediaStream||(this.localMediaStream=new MediaStream);var n=this.pc.getSenders().find(function(t){return t.track&&t.track.kind===e.kind}),i=this.localMediaStream.getTracks().find(function(t){return t.kind===e.kind});return i!==e&&(i&&(this.logger.info("removing previous "+i.kind+" track from localMediaStream"),this.localMediaStream.removeTrack(i)),this.logger.info("adding new "+e.kind+" track to localMediaStream"),this.localMediaStream.addTrack(e)),n?n.track===e?(this.logger.info("new track is the same as existing track, renabling "+e.kind+" track on sender"),n.track.enabled=!0):(this.logger.info("replacing new "+e.kind+" on existing sender"),r.push(n.replaceTrack(e).then(function(){t.logger.info("successfully replace "+e.kind+" on existing sender")}).catch(function(r){t.logger.warn(r),t.logger.warn("was not able to replace "+e.kind+" track on sender"),t.logger.info("adding as new "+e.kind+" track to peerConnection"),t.pc.removeTrack(n),t.pc.addTrack(e,t.localMediaStream)}))):(this.logger.info("adding new "+e.kind+" track to peerConnection"),this.pc.addTrack(e,this.localMediaStream)),this.logger.info("setting sending"+L[e.kind]+" to true"),this["sending"+L[e.kind]]=!0,T.default.all(r)}},{key:"pauseSendingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getSenders().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" media senders to pause");r.forEach(function(r){t.logger.info("pausing "+e+" sender"),r.track.enabled=!1}),this.logger.info("setting sending"+L[e]+" to false"),this["sending"+L[e]]=!1}},{key:"updateLocalMediaToTargetDirection",value:function(){var e=this;["audio","video"].forEach(function(t){var r=U(e,t),n=e[t+"Direction"];if(n!==r){var i=r.includes("send");n.includes("send")!==i&&e.pc.getSenders().forEach(function(e){e.track&&e.track.kind===t&&(e.track.enabled=i)});var o=r.includes("recv");n.includes("send")!==o&&e.pc.getReceivers().forEach(function(e){e.track&&e.track.kind===t&&(e.track.enabled=o)})}})}},{key:"unpauseSendingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getSenders().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" media senders to unpause");r.forEach(function(r){t.logger.info("unpausing "+e+" sender"),r.track.enabled=!0}),this.logger.info("setting sending"+L[e]+" to true"),this["sending"+L[e]]=!0}},{key:"pauseReceivingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getReceivers().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" receiver media tracks to pause");r.forEach(function(r){t.logger.info("pausing remote "+e+" track"),r.track.enabled=!1}),this.logger.info("setting receiving"+L[e]+" to false"),this["receiving"+L[e]]=!1}},{key:"unpauseReceivingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getReceivers().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" receiver media tracks to pause");r.forEach(function(r){t.logger.info("unpausing "+e+" receiver track"),r.track.enabled=!0}),this.logger.info("setting receiving"+L[e]+" to true from "+this["receiving"+L[e]]),this["receiving"+L[e]]=!0}},{key:"stop",value:function(){"closed"!==this.pc.signalingState&&(this.pc.getSenders().forEach(function(e){return e.track&&e.track.stop()}),this.pc.close()),this.pc.onnegotiationneeded=void 0,this.pc.ontrack=void 0,this.pc.onicecandidate=void 0,this.ended=!0,this.off()}},{key:"triggerNegotiationNeeded",value:function(){this.trigger("negotiationneeded")}},{key:"serialize",value:function(){return"WebRTCMediaEngine"}}]),e}(),o=j(i.prototype,"localMediaStream",[I.default],{enumerable:!0,initializer:null}),a=j(i.prototype,"remoteMediaStream",[I.default],{enumerable:!0,initializer:null}),s=j(i.prototype,"localScreenShare",[I.default],{enumerable:!0,initializer:null}),u=j(i.prototype,"offerSdp",[I.default],{enumerable:!0,initializer:function(){return""}}),c=j(i.prototype,"answerSdp",[I.default],{enumerable:!0,initializer:function(){return""}}),l=j(i.prototype,"sendingAudio",[I.default],{enumerable:!0,initializer:function(){return!1}}),f=j(i.prototype,"sendingVideo",[I.default],{enumerable:!0,initializer:function(){return!1}}),d=j(i.prototype,"receivingAudio",[I.default],{enumerable:!0,initializer:function(){return!1}}),p=j(i.prototype,"receivingVideo",[I.default],{enumerable:!0,initializer:function(){return!1}}),h=j(i.prototype,"ended",[I.default],{enumerable:!0,initializer:function(){return!1}}),v=j(i.prototype,"constraints",[_w.nonenumerable],{enumerable:!0,initializer:function(){return{}}}),g=j(i.prototype,"offerOptions",[_w.nonenumerable],{enumerable:!0,initializer:function(){return{}}}),m=j(i.prototype,"gumming",[_w.nonenumerable,I.default],{enumerable:!0,initializer:function(){return!1}}),j(i.prototype,"_getUserMedia",[r,Tw.oneFlight],(0,E.default)(i.prototype,"_getUserMedia"),i.prototype),j(i.prototype,"triggerNegotiationNeeded",[n],(0,E.default)(i.prototype,"triggerNegotiationNeeded"),i.prototype),i);t.default=F,(0,y.default)(F.prototype,P.default)});t(OM);var kM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.webrtcHelpers=t.WebRTCMediaEngine=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n(OM).default}}),Object.defineProperty(t,"WebRTCMediaEngine",{enumerable:!0,get:function(){return n(OM).default}});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(wM);function n(e){return e&&e.__esModule?e:{default:e}}t.webrtcHelpers=r});t(kM);kM.webrtcHelpers,kM.WebRTCMediaEngine;var RM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=t.locusEventKeys=["locus.summary","locus.self_changed","locus.participant_joined","locus.participant_left","locus.participant_declined","locus.participant_alerted","locus.participant_updated","locus.participant_roles_updated","locus.participant_audio_muted","locus.participant_audio_unmuted","locus.participant_video_muted","locus.participant_video_unmuted","locus.floor_granted","locus.floor_released","locus.space_users_modified","locus.controls_updated","locus.participant_controls_updated"];t.default=r});t(RM);RM.locusEventKeys;var AM=function(e){return e&&e.length?e[0]:void 0},IM=H_(function(e,t){return YO(e)?$I(e,Ov(t,1,YO,!0)):[]}),PM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DESYNC=t.LESS_THAN=t.GREATER_THAN=t.FETCH=t.EQUAL=t.USE_CURRENT=t.USE_INCOMING=void 0;var r=v(vR),n=v(B_),i=v(Sk),o=v(Ow),a=v(Xl),s=v(sf),u=v(Yk),c=v($h),l=v(uv),f=v(AM),d=v(IM),p=v(Wv),h=v(MA);function v(e){return e&&e.__esModule?e:{default:e}}var g=t.USE_INCOMING="USE_INCOMING",m=t.USE_CURRENT="USE_CURRENT",y=t.EQUAL="EQUAL",_=t.FETCH="FETCH",E=t.GREATER_THAN="GREATER_THAN",b=t.LESS_THAN="LESS_THAN",S=t.DESYNC="DESYNC";function T(e){switch(e){case y:case E:return m;case b:return g;case S:return _;default:throw new Error(e+" is not a recognized sequence comparison result")}}var w=eI.SparkPlugin.extend({namespace:"Locus",alert:function(e){return this.request({method:"PUT",uri:e.url+"/participant/alert",body:{deviceUrl:this.spark.internal.device.url,sequence:e.sequence}}).then(function(e){return e.body})},compare:function(e,t){function r(e){var t=e.sequence;return!(t.entries&&t.entries.length||0!==t.rangeStart||0!==t.rangeEnd)}return r(e)||r(t)?g:t.baseSequence?this.compareDelta(e,t):T(this.compareSequence(e.sequence,t.sequence))},compareDelta:function(e,t){var r=this.compareSequence(e.sequence,t.sequence);if(r!==b)return T(r);switch(r=this.compareSequence(e.sequence,t.baseSequence)){case E:case y:return g;default:return _}},compareSequence:function(e,t){if(!e)throw new Error("`current` is required");if(!t)throw new Error("`incoming` is required");var r=(0,c.default)(function(e){return 0===e.entries.length?0:(0,f.default)(e.entries)}),n=(0,c.default)(function(e){return 0===e.entries.length?0:(0,l.default)(e.entries)}),i=(0,c.default)(function(e){return e.rangeStart||r(e)}),o=(0,c.default)(function(e){return n(e)||e.rangeEnd});function a(e,t){return e>=t.rangeStart&&e<=t.rangeEnd}if(i(e)>o(t))return E;if(o(e)<i(t))return b;var s=(0,d.default)(e.entries,t.entries),p=(0,d.default)(t.entries,e.entries),h=[],v=[],g=!0,m=!1,_=void 0;try{for(var T,w=(0,u.default)(s);!(g=(T=w.next()).done);g=!0){var O=T.value;a(O,t)||h.push(O)}}catch(e){m=!0,_=e}finally{try{!g&&w.return&&w.return()}finally{if(m)throw _}}var k=!0,R=!1,A=void 0;try{for(var I,P=(0,u.default)(p);!(k=(I=P.next()).done);k=!0){var C=I.value;a(C,e)||v.push(C)}}catch(e){R=!0,A=e}finally{try{!k&&P.return&&P.return()}finally{if(R)throw A}}if(!h.length&&!v.length)return e.rangeEnd-i(e)>t.rangeEnd-i(t)?E:e.rangeEnd-i(e)<t.rangeEnd-i(t)?b:y;if(h.length&&!v.length)return E;if(!h.length&&v.length)return b;if(!(e.rangeStart||e.rangeEnd||t.rangeStart||t.rangeEnd))return S;var M=!0,N=!1,D=void 0;try{for(var j,x=(0,u.default)(h);!(M=(j=x.next()).done);M=!0){var L=j.value;if(i(t)<L&&L<o(t))return S}}catch(e){N=!0,D=e}finally{try{!M&&x.return&&x.return()}finally{if(N)throw D}}var U=!0,F=!1,G=void 0;try{for(var q,V=(0,u.default)(v);!(U=(q=V.next()).done);U=!0){var B=q.value;if(i(e)<B&&B<o(e))return S}}catch(e){F=!0,G=e}finally{try{!U&&V.return&&V.return()}finally{if(F)throw G}}return h[0]>v[0]?E:b},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.correlationId;if(!r)throw new Error("options.correlationId is required");return this.request({method:"POST",service:"locus",resource:"loci/call",body:{correlationId:r,deviceUrl:this.spark.internal.device.url,invitee:{invitee:e},localMedias:[{localSdp:(0,s.default)({type:"SDP",sdp:t.localSdp})}],sequence:{entries:[],rangeStart:0,rangeEnd:0}}}).then(function(e){return e.body.locus})},createOrJoin:function(e,t){return e.url?this.join(e,t):this.create(e,t)},decline:function(e){var t=this;return this.request({method:"PUT",uri:e.url+"/participant/decline",body:{deviceUrl:this.spark.internal.device.url,sequence:e.sequence}}).then(function(e){return e.body}).catch(function(r){return r instanceof eI.SparkHttpError.Conflict?t.get(e):a.default.reject(r)})},get:function(e){return this.request({method:"GET",uri:""+e.url}).then(function(e){return e.body})},getCallHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Date(e.from||Date.now()).toISOString();return this.request({method:"GET",service:"janus",resource:"history/userSessions",qs:{from:t}}).then(function(e){return e.body})},join:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.correlationId||t.correlationId;if(!r)throw new Error("locus.correlationId or options.correlationId is required");return this.request({method:"POST",uri:e.url+"/participant",body:{correlationId:r,deviceUrl:this.spark.internal.device.url,localMedias:[{localSdp:(0,s.default)({type:"SDP",sdp:t.localSdp})}],sequence:e.sequence||{entries:[],rangeStart:0,rangeEnd:0}}}).then(function(e){return e.body.locus})},leave:function(e){var t=this;return this.request({method:"PUT",uri:e.self.url+"/leave",body:{deviceUrl:this.spark.internal.device.url,sequence:e.sequence}}).then(function(e){return e.body.locus}).catch(function(r){return r instanceof eI.SparkHttpError.Conflict?t.get(e):a.default.reject(r)})},list:function(){return this.request({method:"GET",service:"locus",resource:"loci"}).then(function(e){return e.body.loci})},merge:function(e,t){if(!t.baseSequence)return t;var a=(0,p.default)(e);if((0,o.default)(t).forEach(function(e){"baseSequence"!==e&&"participants"!==e&&(a[e]=t[e]||a[e])}),t.participants||t.participants.length){var s=new i.default,u=new n.default;t.participants.forEach(function(e){e.removed?s.add(e.url):u.set(e.url,e)});var c=a.participants.reduce(function(e,t){return s.has(t.url)||(e[t.url]=t),e},{});u.forEach(function(e,t){c[t]=e}),a.participants=(0,r.default)(c)}return a},releaseFloorGrant:function(e,t){return this.spark.request({uri:t.url,method:"PUT",body:{floor:{disposition:"RELEASED"}}}).then(function(e){return e.body})},requestFloorGrant:function(e,t){return this.spark.request({uri:t.url,method:"PUT",body:{floor:{beneficiary:{url:e.self.url,devices:[{url:this.spark.internal.device.url}]},disposition:"GRANTED"}}}).then(function(e){return e.body})},sendDtmf:function(e,t){return this.request({method:"POST",uri:e.self.url+"/sendDtmf",body:{deviceUrl:this.spark.internal.device.url,dtmf:{correlationId:h.default.v4(),tones:t}}})},sync:function(e){return this.request({method:"GET",uri:e.syncUrl}).then(function(e){return e.body||{}})},updateMedia:function(e,t){var r=t.sdp,n=t.audioMuted,i=t.videoMuted,o=t.mediaId,a={audioMuted:n,videoMuted:i};return r&&(a.type="SDP",a.sdp=r),this.request({method:"PUT",uri:e.self.url+"/media",body:{deviceUrl:this.spark.internal.device.url,localMedias:[{localSdp:(0,s.default)(a),mediaId:o}],sequence:e.sequence}}).then(function(e){return e.body.locus})},version:"1.50.2"});t.default=w});t(PM);PM.DESYNC,PM.LESS_THAN,PM.GREATER_THAN,PM.FETCH,PM.EQUAL,PM.USE_CURRENT,PM.USE_INCOMING;var CM=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var MM=function(e){return CM.test(e)};var NM=function(e){return e.split("")},DM="[\\ud800-\\udfff]",jM="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",xM="\\ud83c[\\udffb-\\udfff]",LM="[^\\ud800-\\udfff]",UM="(?:\\ud83c[\\udde6-\\uddff]){2}",FM="[\\ud800-\\udbff][\\udc00-\\udfff]",GM="(?:"+jM+"|"+xM+")"+"?",qM="[\\ufe0e\\ufe0f]?"+GM+("(?:\\u200d(?:"+[LM,UM,FM].join("|")+")[\\ufe0e\\ufe0f]?"+GM+")*"),VM="(?:"+[LM+jM+"?",jM,UM,FM,DM].join("|")+")",BM=RegExp(xM+"(?="+xM+")|"+VM+qM,"g");var zM=function(e){return e.match(BM)||[]};var HM=function(e){return MM(e)?zM(e):NM(e)};var WM=function(e){return function(t){t=av(t);var r=MM(t)?HM(t):void 0,n=r?r[0]:t.charAt(0),i=r?NC(r,1).join(""):t.slice(1);return n[e]()+i}}("toUpperCase");var YM=function(e){return WM(av(e).toLowerCase())};var XM=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r},JM=Dw({"Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã":"C","Ã§":"c","Ã":"D","Ã°":"d","Ã":"E","Ã":"E","Ã":"E","Ã":"E","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","Ã":"I","Ã":"I","Ã":"I","Ã":"I","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã":"N","Ã±":"n","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã":"U","Ã":"U","Ã":"U","Ã":"U","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã":"Y","Ã½":"y","Ã¿":"y","Ã":"Ae","Ã¦":"ae","Ã":"Th","Ã¾":"th","Ã":"ss","Ä":"A","Ä":"A","Ä":"A","Ä":"a","Ä":"a","Ä":"a","Ä":"C","Ä":"C","Ä":"C","Ä":"C","Ä":"c","Ä":"c","Ä":"c","Ä":"c","Ä":"D","Ä":"D","Ä":"d","Ä":"d","Ä":"E","Ä":"E","Ä":"E","Ä":"E","Ä":"E","Ä":"e","Ä":"e","Ä":"e","Ä":"e","Ä":"e","Ä":"G","Ä":"G","Ä ":"G","Ä¢":"G","Ä":"g","Ä":"g","Ä¡":"g","Ä£":"g","Ä¤":"H","Ä¦":"H","Ä¥":"h","Ä§":"h","Ä¨":"I","Äª":"I","Ä¬":"I","Ä®":"I","Ä°":"I","Ä©":"i","Ä«":"i","Ä­":"i","Ä¯":"i","Ä±":"i","Ä´":"J","Äµ":"j","Ä¶":"K","Ä·":"k","Ä¸":"k","Ä¹":"L","Ä»":"L","Ä½":"L","Ä¿":"L","Å":"L","Äº":"l","Ä¼":"l","Ä¾":"l","Å":"l","Å":"l","Å":"N","Å":"N","Å":"N","Å":"N","Å":"n","Å":"n","Å":"n","Å":"n","Å":"O","Å":"O","Å":"O","Å":"o","Å":"o","Å":"o","Å":"R","Å":"R","Å":"R","Å":"r","Å":"r","Å":"r","Å":"S","Å":"S","Å":"S","Å ":"S","Å":"s","Å":"s","Å":"s","Å¡":"s","Å¢":"T","Å¤":"T","Å¦":"T","Å£":"t","Å¥":"t","Å§":"t","Å¨":"U","Åª":"U","Å¬":"U","Å®":"U","Å°":"U","Å²":"U","Å©":"u","Å«":"u","Å­":"u","Å¯":"u","Å±":"u","Å³":"u","Å´":"W","Åµ":"w","Å¶":"Y","Å·":"y","Å¸":"Y","Å¹":"Z","Å»":"Z","Å½":"Z","Åº":"z","Å¼":"z","Å¾":"z","Ä²":"IJ","Ä³":"ij","Å":"Oe","Å":"oe","Å":"'n","Å¿":"s"}),KM=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$M=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var QM=function(e){return(e=av(e))&&e.replace(KM,JM).replace($M,"")},ZM=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var eN=function(e){return e.match(ZM)||[]},tN=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var rN=function(e){return tN.test(e)},nN="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",iN="["+nN+"]",oN="\\d+",aN="[\\u2700-\\u27bf]",sN="[a-z\\xdf-\\xf6\\xf8-\\xff]",uN="[^\\ud800-\\udfff"+nN+oN+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",cN="(?:\\ud83c[\\udde6-\\uddff]){2}",lN="[\\ud800-\\udbff][\\udc00-\\udfff]",fN="[A-Z\\xc0-\\xd6\\xd8-\\xde]",dN="(?:"+sN+"|"+uN+")",pN="(?:"+fN+"|"+uN+")",hN="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",vN="[\\ufe0e\\ufe0f]?"+hN+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",cN,lN].join("|")+")[\\ufe0e\\ufe0f]?"+hN+")*"),gN="(?:"+[aN,cN,lN].join("|")+")"+vN,mN=RegExp([fN+"?"+sN+"+(?:['â](?:d|ll|m|re|s|t|ve))?(?="+[iN,fN,"$"].join("|")+")",pN+"+(?:['â](?:D|LL|M|RE|S|T|VE))?(?="+[iN,fN+dN,"$"].join("|")+")",fN+"?"+dN+"+(?:['â](?:d|ll|m|re|s|t|ve))?",fN+"+(?:['â](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",oN,gN].join("|"),"g");var yN=function(e){return e.match(mN)||[]};var _N=function(e,t,r){return e=av(e),void 0===(t=r?void 0:t)?rN(e)?yN(e):eN(e):e.match(t)||[]},EN=RegExp("['â]","g");var bN=function(e){return function(t){return XM(_N(QM(t).replace(EN,"")),e,"")}}(function(e,t,r){return t=t.toLowerCase(),e+(r?YM(t):t)}),SN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Forbidden=t.NotAuthorized=t.BadRequest=t.UnknownResponse=t.ConnectionError=void 0;var r,n,i,o,a,s,u,c,l,f,d=y(Gk),p=y(MS),h=y(_y),v=y(Ty),g=y(NS),m=y(DS);function y(e){return e&&e.__esModule?e:{default:e}}var _=t.ConnectionError=(n=r=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),(0,v.default)(t,[{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.default)(this,{code:{value:e.code},reason:{value:e.reason}}),e.reason}}]),t}(Tw.Exception),r.defaultMessage="Failed to connect to socket",n);t.UnknownResponse=(o=i=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),t}(_),i.defaultMessage="UnknownResponse is produced by IE when we receive a 4XXX. You probably want to treat this like a NotFound",o),t.BadRequest=(s=a=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),t}(_),a.defaultMessage="BadRequest usually implies an attempt to use service account credentials",s),t.NotAuthorized=(c=u=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),t}(_),u.defaultMessage="Please refresh your access token",c),t.Forbidden=(f=l=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),t}(_),l.defaultMessage="Forbidden usually implies these credentials are not entitled for Spark",f)});t(SN);SN.Forbidden,SN.NotAuthorized,SN.BadRequest,SN.UnknownResponse,SN.ConnectionError;var TN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=g(sf),n=g(rR),i=g(Ow),o=g(Xl),a=g(MS),s=g(_y),u=g(Ty),c=g(NS),l=g(DS),f=g(zy),d=g(Uf),p=g(qO),h=g(Fb),v=g(MA);function g(e){return e&&e.__esModule?e:{default:e}}var m=new f.default,y=function(e){function t(){(0,s.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return e.onmessage=e.onmessage.bind(e),e.onclose=e.onclose.bind(e),e}return(0,l.default)(t,e),(0,u.default)(t,[{key:"close",value:function(e){var t=this;return new o.default(function(r,n){t.logger.info("socket: closing");var i=m.get(t);if(2===i.readyState||3===i.readyState)return t.logger.info("socket: already closed"),void r();if((e=e||{}).code&&1e3!==e.code&&(e.code<3e3||e.code>4999))n(new Error("`options.code` must be 1000 or between 3000 and 4999 (inclusive)"));else{e=(0,h.default)(e,{code:1e3,reason:"Done"});var o=(0,Aw.safeSetTimeout)(function(){try{t.logger.info("socket: no close event received, forcing closure"),r(t.onclose({code:1e3,reason:"Done (forced)"}))}catch(e){t.logger.warn("socket: force-close failed",e)}},t.forceCloseDelay);i.onclose=function(e){t.logger.info("socket: close event fired",e.code,e.reason),clearTimeout(o),t.onclose(e),r(e)},i.close(e.code,e.reason)}})}},{key:"open",value:function(e,r){var a=this;return new o.default(function(o,s){if(e)if(m.get(a))s(new Error("Socket#open() can only be called once per instance"));else{r=r||{},(0,Tw.checkRequired)(["forceCloseDelay","pingInterval","pongTimeout","token","trackingId","logger"],r),(0,i.default)(r).forEach(function(e){(0,n.default)(a,e,{enumerable:!1,value:r[e]})});var u=t.getWebSocketConstructor();a.logger.info("socket: creating WebSocket");var c=new u(e);c.binaryType="arraybuffer",c.onmessage=a.onmessage,c.onclose=function(e){switch((e=a._fixCloseCode(e)).code){case 1005:return s(new SN.UnknownResponse(e));case 4400:return s(new SN.BadRequest(e));case 4401:return s(new SN.NotAuthorized(e));case 4403:return s(new SN.Forbidden(e));default:return s(new SN.ConnectionError(e))}},c.onopen=function(){a.logger.info("socket: connected"),a._authorize().then(function(){a.logger.info("socket: authorized"),c.onclose=a.onclose,o()}).catch(s)},c.onerror=function(e){a.logger.warn("socket: error event fired",e)},m.set(a,c),a.logger.info("socket: waiting for server")}else s(new Error("`url` is required"))})}},{key:"onclose",value:function(e){this.logger.info("socket: closed",e.code,e.reason),clearTimeout(this.pongTimer),clearTimeout(this.pingTimer),e=this._fixCloseCode(e),this.emit("close",e),this.removeAllListeners()}},{key:"onmessage",value:function(e){try{var t=JSON.parse(e.data),r=parseInt(t.sequenceNumber,10);this.logger.debug("socket: sequence number: ",r),this.expectedSequenceNumber&&r!==this.expectedSequenceNumber&&(this.logger.debug("socket: sequence number mismatch indicates lost mercury message. expected: "+this.expectedSequenceNumber+", actual: "+r),this.emit("sequence-mismatch",r,this.expectedSequenceNumber)),this.expectedSequenceNumber=r+1;var n={data:t};this._acknowledge(n),"pong"===t.type?this.emit("pong",n):this.emit("message",n)}catch(e){this.logger.warn("socket: error while receiving WebSocket message",e)}}},{key:"send",value:function(e){var t=this;return new o.default(function(n,i){return 1!==t.readyState?i(new Error("INVALID_STATE_ERROR")):((0,d.default)(e)&&(e=(0,r.default)(e)),m.get(t).send(e),n())})}},{key:"_acknowledge",value:function(e){return e?(0,p.default)(e,"data.id")?this.send({messageId:e.data.id,type:"ack"}):o.default.reject(new Error("`event.data.id` is required")):o.default.reject(new Error("`event` is required"))}},{key:"_authorize",value:function(){var e=this;return new o.default(function(t){e.logger.info("socket: authorizing"),e.send({id:v.default.v4(),type:"authorization",data:{token:e.token},trackingId:e.trackingId,logLevelToken:e.logLevelToken});e.once("message",function r(n){n.data.type||"mercury.buffer_state"!==n.data.data.eventType&&"mercury.registration_status"!==n.data.data.eventType||(e.removeListener("message",r),e._ping(),t())})})}},{key:"_fixCloseCode",value:function(e){if(1005===e.code&&e.reason)switch(e.reason.toLowerCase()){case"replaced":this.logger.info("socket: fixing CloseEvent code for reason: ",e.reason),e.code=4e3;break;case"authentication failed":case"authentication did not happen within the timeout window of 30000 seconds.":this.logger.info("socket: fixing CloseEvent code for reason: ",e.reason),e.code=1008}return e}},{key:"_ping",value:function(e){var t=this;return e=e||v.default.v4(),this.pongTimer=(0,Aw.safeSetTimeout)(function(){try{t.logger.info("socket: pong not receive in expected period, closing socket"),t.close({code:1e3,reason:"Pong not received"}).catch(function(e){t.logger.warn("socket: failed to close socket after missed pong",e)})}catch(e){t.logger.error("socket: error occurred in onPongNotReceived",e)}},this.pongTimeout),this.once("pong",function(){try{clearTimeout(t.pongTimer),t.pingTimer=(0,Aw.safeSetTimeout)(function(){return t._ping()},t.pingInterval)}catch(e){t.logger.error("socket: error occurred in scheduleNextPingAndCancelPongTimer",e)}}),this.once("pong",function(r){try{t.logger.debug("socket: pong",r.data.id),r.data&&r.data.id!==e&&(t.logger.info("socket: received pong for wrong ping id, closing socket"),t.logger.debug("socket: expected",e,"received",r.data.id),t.close({code:1e3,reason:"Pong mismatch"}))}catch(e){t.logger.error("socket: error occurred in confirmPongId",e)}}),this.logger.debug("socket: ping "+e),this.send({id:e,type:"ping"})}},{key:"binaryType",get:function(){return m.get(this).binaryType}},{key:"bufferedAmount",get:function(){return m.get(this).bufferedAmount}},{key:"extensions",get:function(){return m.get(this).extensions}},{key:"protocol",get:function(){return m.get(this).protocol}},{key:"readyState",get:function(){return m.get(this).readyState}},{key:"url",get:function(){return m.get(this).url}}],[{key:"getWebSocketConstructor",value:function(){throw new Error("Socket.getWebSocketConstructor() must be implemented in an environmentally appropriate way")}}]),t}(qb.EventEmitter);t.default=y});t(TN);var wN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=TN)&&r.__esModule?r:{default:r};n.default.getWebSocketConstructor=function(){return WebSocket},t.default=n.default});t(wN);var ON=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=wN,e&&e.__esModule?e:{default:e}).default;var e}})});t(ON);var kN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o=m(xu),a=m(Xk),s=m(Fu),u=m(Zl),c=m(Ow),l=m(Xl),f=m(pA),d=m(EA),p=m(bN),h=m(cS),v=m(ON),g=m(Xm);function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var _=["idle","done (forced)","pong not received","pong mismatch"],E=eI.SparkPlugin.extend((r=(0,Tw.deprecated)("Mercury#listen(): Use Mercury#connect() instead"),n=(0,Tw.deprecated)("Mercury#stopListening(): Use Mercury#disconnect() instead"),y(i={namespace:"Mercury",session:{connected:{default:!1,type:"boolean"},connecting:{default:!1,type:"boolean"},socket:"object",localClusterServiceUrls:"object"},derived:{listening:{deps:["connected"],fn:function(){return this.connected}}},connect:function(e){var t=this;return this.connected?(this.logger.info("mercury: already connected, will not connect again"),l.default.resolve()):(this.connecting=!0,l.default.resolve(this.spark.internal.device.registered||this.spark.internal.device.register()).then(function(){return t.logger.info("mercury: connecting"),t._connectWithBackoff(e)}))},disconnect:function(){var e=this;return new l.default(function(t){if(e.backoffCall&&(e.logger.info("mercury: aborting connection"),e.backoffCall.abort()),e.socket)return e.socket.removeAllListeners("message"),e.once("offline",t),void e.socket.close();t()})},listen:function(){return this.connect()},stopListening:function(){return this.disconnect()},processRegistrationStatusEvent:function(e){this.localClusterServiceUrls=e.localClusterServiceUrls},_applyOverrides:function(e){e.headers&&(0,c.default)(e.headers).forEach(function(t){(0,f.default)(e,t,e.headers[t])})},_prepareUrl:function(e){var t=this;return e||(e=this.spark.internal.device.webSocketUrl),this.spark.internal.feature.getFeature("developer","web-ha-messaging").then(function(r){return r?t.spark.internal.device.useServiceCatalogUrl(e):e}).then(function(t){e=t}).then(function(){return t.spark.internal.feature.getFeature("developer","web-shared-mercury")}).then(function(r){return e=g.default.parse(e,!0),(0,u.default)(e.query,{outboundWireFormat:"text",bufferStates:!0,aliasHttpStatus:!0}),r&&((0,u.default)(e.query,{mercuryRegistrationStatus:!0,isRegistrationRefreshEnabled:!0}),(0,s.default)(e.query,"bufferStates")),(0,d.default)(t,"spark.config.device.ephemeral",!1)&&(e.query.multipleConnections=!0),g.default.format(e)})},_attemptConnection:function(e,t){var r=this,n=new v.default,i=void 0;n.on("close",function(){return r._onclose.apply(r,arguments)}),n.on("message",function(){return r._onmessage.apply(r,arguments)}),n.on("sequence-mismatch",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r._emit.apply(r,["sequence-mismatch"].concat(t))}),l.default.all([this._prepareUrl(e),this.spark.credentials.getUserToken()]).then(function(e){var t=(0,a.default)(e,2),o=t[0],s=t[1];return i=o,n.open(o,{forceCloseDelay:r.config.forceCloseDelay,pingInterval:r.config.pingInterval,pongTimeout:r.config.pongTimeout,token:s.toString(),trackingId:r.spark.sessionId+"_"+Date.now(),logger:r.logger})}).then(function(){return r.socket=n,r.spark.internal.metrics.submitClientMetrics("web-ha-mercury",{fields:{success:!0},tags:{action:"connected",url:i}}),t(),r.spark.internal.feature.getFeature("developer","web-ha-messaging").then(function(e){return e?r.spark.internal.device.fetchNewUrls(i):l.default.resolve()})}).catch(function(e){return 1006!==e.code&&r.backoffCall&&r.backoffCall.getNumRetries()>0&&r._emit("connection_failed",e,{retries:r.backoffCall.getNumRetries()}),r.logger.info("mercury: connection attempt failed",e),e instanceof SN.UnknownResponse?(r.logger.info("mercury: received unknown response code, refreshing device registration"),r.spark.internal.device.refresh().then(function(){return t(e)})):e instanceof SN.NotAuthorized?(r.logger.info("mercury: received authorization error, reauthorizing"),r.spark.credentials.refresh({force:!0}).then(function(){return t(e)})):e instanceof SN.BadRequest||e instanceof SN.Forbidden?(r.logger.warn("mercury: received unrecoverable response from mercury"),r.backoffCall.abort(),t(e)):e instanceof SN.ConnectionError?r.spark.internal.feature.getFeature("developer","web-ha-messaging").then(function(t){return t?(r.logger.info("mercury: received a generic connection error, will try to connect to another datacenter"),r.spark.internal.metrics.submitClientMetrics("web-ha-mercury",{fields:{success:!1},tags:{action:"failed",error:e.message,url:i}}),r.spark.internal.device.markUrlFailedAndGetNew(i)):null}).then(function(){return t(e)}):t(e)}).catch(function(e){r.logger.error("mercury: failed to handle connection failure",e),t(e)})},_connectWithBackoff:function(e){var t=this;return new l.default(function(r,n){var i=void 0;(i=h.default.call(function(r){t.logger.info("mercury: executing connection attempt "+i.getNumRetries()),t._attemptConnection(e,r)},function(e){return t.connecting=!1,t.backoffCall=void 0,e?(t.logger.info("mercury: failed to connect after "+i.getNumRetries()+" retries; log statement about next retry was inaccurate"),n(e)):(t.connected=!0,t._emit("online"),r())})).setStrategy(new h.default.ExponentialStrategy({initialDelay:t.config.backoffTimeReset,maxDelay:t.config.backoffTimeMax})),t.config.maxRetries&&i.failAfter(t.config.maxRetries),i.on("abort",function(){t.logger.info("mercury: connection aborted"),n()}),i.on("callback",function(e){if(e){var r=i.getNumRetries(),n=Math.min(i.strategy_.nextBackoffDelay_,t.config.backoffTimeMax);t.logger.info("mercury: failed to connect; attempting retry "+(r+1)+" in "+n+" ms")}else t.logger.info("mercury: connected")}),i.start(),t.backoffCall=i})},_emit:function(){try{this.trigger.apply(this,arguments)}catch(e){this.logger.error("mercury: error occurred in event handler",e)}},_getEventHandlers:function(e){var t=e.split("."),r=(0,a.default)(t,2),n=r[0],i=r[1],o=[];if(!this.spark[n]&&!this.spark.internal[n])return o;var s=(0,p.default)("process_"+i+"_event");return(this.spark[n]||this.spark.internal[n])[s]&&o.push({name:s,namespace:n}),o},_onclose:function(e){try{var t=e.reason&&e.reason.toLowerCase(),r=this.socket.url;switch(this.socket.removeAllListeners(),this.unset("socket"),this.connected=!1,this._emit("offline",e),e.code){case 1003:this.logger.info("mercury: Mercury service rejected last message; will not reconnect: "+e.reason),this._emit("offline.permanent",e);break;case 4e3:this.logger.info("mercury: socket replaced; will not reconnect"),this._emit("offline.replaced",e);break;case 1001:case 1005:case 1006:case 1011:this.logger.info("mercury: socket disconnected; reconnecting"),this._emit("offline.transient",e),this._reconnect(r);break;case 1e3:_.includes(t)?(this.logger.info("mercury: socket disconnected; reconnecting"),this._emit("offline.transient",e),this._reconnect(r)):(this.logger.info("mercury: socket disconnected; will not reconnect"),this._emit("offline.permanent",e));break;default:this.logger.info("mercury: socket disconnected unexpectedly; will not reconnect"),this._emit("offline.permanent",e)}}catch(e){this.logger.error("mercury: error occurred in close handler",e)}},_onmessage:function(e){var t=this,r=e.data,n=r.data;return this._applyOverrides(n),this._getEventHandlers(n.eventType).reduce(function(e,r){return e.then(function(){var e=r.namespace,i=r.name;return new l.default(function(r){return r((t.spark[e]||t.spark.internal[e])[i](n))}).catch(function(e){return t.logger.error("mercury: error occurred in autowired event handler for "+n.eventType,e)})})},l.default.resolve()).then(function(){t._emit("event",e.data);var i=n.eventType.split("."),o=(0,a.default)(i,1)[0];t._emit("event:"+o,r),t._emit("event:"+n.eventType,r)}).catch(function(e){t.logger.error("mercury: error occurred processing socket message",e)})},_reconnect:function(e){return this.logger.info("mercury: reconnecting"),this.connect(e)},version:"1.50.2"},"connect",[Tw.oneFlight],(0,o.default)(i,"connect"),i),y(i,"disconnect",[Tw.oneFlight],(0,o.default)(i,"disconnect"),i),y(i,"listen",[r],(0,o.default)(i,"listen"),i),y(i,"stopListening",[n],(0,o.default)(i,"stopListening"),i),i));t.default=E});t(kN);var RN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={mercury:{pingInterval:15e3,pongTimeout:14e3,backoffTimeMax:32e3,backoffTimeReset:1e3,forceCloseDelay:2e3}}});t(RN);var AN=function(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(n,a,r(a),e)}return n};var IN=function(e,t,r,n){return ZO(e,function(e,i,o){t(n,e,r(e),o)}),n};var PN=function(e,t){return function(r,n){var i=Hd(r)?AN:IN,o=t?t():{};return i(r,e,_I(n,2),o)}},CN=PN(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]}),MN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(nf),n=o(Xl),i=o(CN);function o(e){return e&&e.__esModule?e:{default:e}}var a=eI.SparkPlugin.extend({namespace:"Feature",getFeature:function(e,t,r){if("developer"!==e&&"user"!==e&&"entitlement"!==e)return n.default.reject(new Error("Invalid feature keyType provided. Only `developer`, `user`, and `entitlement` feature toggles are permitted."));r=r||{};var i=this.spark.internal.device.features[e].get(t);return i?r.full?n.default.resolve(i.serialize()):n.default.resolve(i.value):n.default.resolve(null)},setFeature:function(e,t,r){var i=this;return"developer"!==e&&"user"!==e?n.default.reject(new Error("Only `developer` and `user` feature toggles can be set.")):this.request({method:"POST",api:"feature",resource:"features/users/"+this.spark.internal.device.userId+"/"+e,body:{key:t,mutable:!0,val:r}}).then(function(t){return i.spark.internal.device.features[e].add(t.body,{merge:!0})})},setBundledFeatures:function(e){var t=this;return e.forEach(function(e){e.mutable=e.mutable||"true","USER"!==e.type&&"DEV"!==e.type&&(e.type="USER")}),this.request({method:"POST",api:"feature",resource:"features/users/"+this.spark.internal.device.userId+"/toggles",body:e}).then(function(e){var r=(0,i.default)(e.body.featureToggles,{type:"USER"});t.spark.internal.device.features.user.add(r[0],{merge:!0}),t.spark.internal.device.features.developer.add(r[1],{merge:!0})})},initialize:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];(0,r.default)(eI.SparkPlugin.prototype.initialize,this,t),this.listenToAndRun(this.spark,"change:internal.device.features.developer",this.trigger.bind(this,"change:developer")),this.listenToAndRun(this.spark,"change:internal.device.features.entitlement",this.trigger.bind(this,"change:entitlement")),this.listenToAndRun(this.spark,"change:internal.device.features.user",this.trigger.bind(this,"change:user"))},version:"1.50.2"});t.default=a});t(MN);var NN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={feature:{}}});t(NN),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(MN).default}});var r=i(MN),n=i(NN);function i(e){return e&&e.__esModule?e:{default:e}}(0,eI.registerInternalPlugin)("feature",r.default,{config:n.default})}));var DN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Xk),n=o(nf),i=o(Xl);function o(e){return e&&e.__esModule?e:{default:e}}var a=(0,o(D_).default)("metric id"),s=eI.Batcher.extend({namespace:"Metrics",prepareItem:function(e){return e.appType=e.appType||this.config.appType,e.env=e.env||"TEST",e.time=e.time||Date.now(),e.version=e.version||this.spark.version,i.default.resolve(e)},prepareRequest:function(e){return i.default.resolve(e.map(function(e){return e.postTime=e.postTime||Date.now(),e}))},submitHttpRequest:function(e){return this.spark.request({method:"POST",service:"metrics",resource:"metrics",body:{metrics:e}})},handleHttpSuccess:function(e){var t=this;return i.default.all(e.options.body.metrics.map(function(e){return t.acceptItem(e)}))},handleHttpError:function(e){var t=this;return e instanceof eI.SparkHttpError.NetworkOrCORSError?(this.logger.warn("metrics-batcher: received network error submitting metrics, reenqueuing payload"),i.default.all(e.options.body.metrics.map(function(e){return new i.default(function(r){var n=e[a].nextDelay;n<t.config.batcherRetryPlateau&&(e[a].nextDelay*=2),(0,Aw.safeSetTimeout)(function(){r(t.rerequest(e))},n)})}))):(0,n.default)(eI.Batcher.prototype.handleHttpError,this,[e])},rerequest:function(e){var t=this;return i.default.all([this.getDeferredForRequest(e),this.prepareItem(e)]).then(function(e){var n=(0,r.default)(e,2),i=n[0],o=n[1];t.enqueue(o).then(function(){return t.bounce()}).catch(function(e){return i.reject(e)})})},fingerprintRequest:function(e){return e[a]=e[a]||{nextDelay:1e3},i.default.resolve(e[a])},fingerprintResponse:function(e){return i.default.resolve(e[a])}});t.default=s});t(DN);var jN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=n(Xl);function n(e){return e&&e.__esModule?e:{default:e}}var i=n(DN).default.extend({namespace:"Metrics",prepareItem:function(e){return r.default.resolve(e)},prepareRequest:function(e){return r.default.resolve(e)},submitHttpRequest:function(e){return this.spark.request({method:"POST",service:"metrics",resource:"clientmetrics",body:{metrics:e}})}});t.default=i});t(jN);var xN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(Xl),n=i(Zl);function i(e){return e&&e.__esModule?e:{default:e}}var o=i(DN).default.extend({namespace:"Metrics",prepareItem:function(e){return e.eventPayload.origin=(0,n.default)({buildType:"test",networkType:"unknown"},e.eventPayload.origin),r.default.resolve(e)},prepareRequest:function(e){return e.forEach(function(e){e.eventPayload.originTime.sent=(new Date).toISOString()}),r.default.resolve(e)},submitHttpRequest:function(e){return this.spark.request({method:"POST",service:"metrics",resource:"clientmetrics",body:{metrics:e}})}});t.default=o});t(xN);var LN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i=c(xu),o=c(Zl),a=c(DN),s=c(jN),u=c(xN);function c(e){return e&&e.__esModule?e:{default:e}}var l,f,d,p,h,v,g=eI.SparkPlugin.extend((r=(0,Tw.deprecated)("Metrics#sendUnstructured() is deprecated; please use Metrics#submit()"),n={children:{batcher:a.default,clientMetricsBatcher:s.default,callDiagnosticEventsBatcher:u.default},namespace:"Metrics",sendUnstructured:function(e,t){return this.submit(e,t)},submit:function(e,t){return this.batcher.request((0,o.default)({key:e},t))},submitClientMetrics:function(e,t,r){var n={metricName:e};if(t.tags&&(n.tags=t.tags),t.fields&&(n.fields=t.fields),t.type&&(n.type=t.type),n.timestamp=Date.now(),r){var i={metrics:[n]};return this.postPreLoginMetric(i,r)}return this.clientMetricsBatcher.request(n)},aliasUser:function(e){return this.request({method:"POST",api:"metrics",resource:"clientmetrics",headers:{"x-prelogin-userid":e},body:{},qs:{alias:!0}})},postPreLoginMetric:function(e,t){var r=this;return this.spark.credentials.getClientToken().then(function(n){return r.request({method:"POST",api:"metrics",resource:"clientmetrics-prelogin",headers:{authorization:n.toString(),"x-prelogin-userid":t},body:e})})},submitCallDiagnosticEvents:function(e){var t={type:"diagnostic-event",eventPayload:e};return this.callDiagnosticEventsBatcher.request(t)},version:"1.50.2"},l=n,f="sendUnstructured",d=[r],p=(0,i.default)(n,"sendUnstructured"),h=n,v={},Object.keys(p).forEach(function(e){v[e]=p[e]}),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=d.slice().reverse().reduce(function(e,t){return t(l,f,e)||e},v),h&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(h):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(l,f,v),v=null),n));t.default=g});t(LN);var UN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={device:{preDiscoveryServices:{metricsServiceUrl:"https://metrics-a.wbx2.com/metrics/api/v1"}},metrics:{appType:Tw.inBrowser?"browser":"nodejs",batcherWait:500,batcherMaxCalls:50,batcherMaxWait:1500,batcherRetryPlateau:32e3}}});t(UN);var FN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(LN).default}});var r=i(LN),n=i(UN);function i(e){return e&&e.__esModule?e:{default:e}}(0,eI.registerInternalPlugin)("metrics",r.default,{config:n.default}),t.config=n.default});t(FN);FN.config;var GN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownResponse=t.NotAuthorized=t.Forbidden=t.ConnectionError=t.BadRequest=t.config=t.Socket=t.Mercury=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(kN).default}}),Object.defineProperty(t,"Mercury",{enumerable:!0,get:function(){return i(kN).default}}),Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return i(ON).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return i(RN).default}}),Object.defineProperty(t,"BadRequest",{enumerable:!0,get:function(){return SN.BadRequest}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return SN.ConnectionError}}),Object.defineProperty(t,"Forbidden",{enumerable:!0,get:function(){return SN.Forbidden}}),Object.defineProperty(t,"NotAuthorized",{enumerable:!0,get:function(){return SN.NotAuthorized}}),Object.defineProperty(t,"UnknownResponse",{enumerable:!0,get:function(){return SN.UnknownResponse}});var r=i(kN),n=i(RN);function i(e){return e&&e.__esModule?e:{default:e}}(0,eI.registerInternalPlugin)("mercury",r.default,{config:n.default,onBeforeLogout:function(){return this.disconnect()}})});t(GN);GN.UnknownResponse,GN.NotAuthorized,GN.Forbidden,GN.ConnectionError,GN.BadRequest,GN.config,GN.Socket,GN.Mercury;var qN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DESYNC=t.LESS_THAN=t.GREATER_THAN=t.FETCH=t.EQUAL=t.USE_CURRENT=t.USE_INCOMING=t.eventKeys=void 0,Object.defineProperty(t,"eventKeys",{enumerable:!0,get:function(){return RM.locusEventKeys}}),Object.defineProperty(t,"USE_INCOMING",{enumerable:!0,get:function(){return PM.USE_INCOMING}}),Object.defineProperty(t,"USE_CURRENT",{enumerable:!0,get:function(){return PM.USE_CURRENT}}),Object.defineProperty(t,"EQUAL",{enumerable:!0,get:function(){return PM.EQUAL}}),Object.defineProperty(t,"FETCH",{enumerable:!0,get:function(){return PM.FETCH}}),Object.defineProperty(t,"GREATER_THAN",{enumerable:!0,get:function(){return PM.GREATER_THAN}}),Object.defineProperty(t,"LESS_THAN",{enumerable:!0,get:function(){return PM.LESS_THAN}}),Object.defineProperty(t,"DESYNC",{enumerable:!0,get:function(){return PM.DESYNC}});var r,n=(r=PM)&&r.__esModule?r:{default:r};(0,eI.registerInternalPlugin)("locus",n.default),t.default=n.default});t(qN);qN.DESYNC,qN.LESS_THAN,qN.GREATER_THAN,qN.FETCH,qN.EQUAL,qN.USE_CURRENT,qN.USE_INCOMING,qN.eventKeys;var VN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(Yk),n=s(B_),i=s(Xl),o=s(EA),a=s(nM);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return Boolean(e.self&&d(e.self))}function c(e,t){return u(t)&&t.self.devices.some(function(t){return e.internal.device.url===t.url&&"JOINED"===t.state})}function l(e,t,r){var n=void 0,i=void 0;return r.person.isExternal||(i=r.person.id,n=e.people.inferPersonIdFromUuid(r.person.id)),{_id:r.id,isSelf:t.self.url===r.url,isInitiator:r.isCreator||!1,personUuid:i,personId:n,state:f(r),audioMuted:v(r),videoMuted:g(r)}}function f(e){var t=e.state&&e.state.toLowerCase();switch(t){case"idle":return"notified";case"joined":return"connected";case"left":return"disconnected";default:return t}}function d(e){return e&&"JOINED"===e.state}function p(e){return h(e)[0]}function h(e){return e.participants.filter(function(t){return"USER"===t.type&&t.url!==e.self.url})}function v(e){return d(e)&&!e.status.audioStatus.includes("SEND")}function g(e){return d(e)&&!e.status.videoStatus.includes("SEND")}t.activeParticipants=function(e){return(0,a.default)(e.participants,{state:"JOINED"})},t.direction=function(e){if(!e||!e.self)return"unknown";return e.self.isCreator?"out":"in"},t.waitForMediaShare=function(e){return function(){var t=new i.default(function(t,r){!function n(){try{e.logger.info("checking for media share");var i=e.locus.mediaShares.find(function(e){return"content"===e.name});if(!i)return e.logger.info("did not find media share, waiting for next locus change"),void e.once("change:locus",n);e.logger.info("found media share"),t(i)}catch(t){e.logger.error("something unexpected happened"),e.logger.error(t),r(t)}}()});return i.default.race([t,new i.default(function(e,t){return setTimeout(t(new Error("Could not find media share after 10000ms")),1e4)})])}},t.isActive=function(e){return"ACTIVE"===e.fullState.state},t.isCall=function(e){return e&&e.fullState&&"CALL"===e.fullState.type},t.joined=u,t.joinedOnThisDevice=c,t.participantsToCallMemberships=function(e,t){var i=new n.default,a=new n.default,s=!0,u=!1,c=void 0;try{for(var f,d=(0,r.default)(t.participants);!(s=(f=d.next()).done);s=!0){var p=f.value;"USER"===p.type?i.set(p.url,p):"RESOURCE_ROOM"===p.type&&a.set(p.url,p)}}catch(e){u=!0,c=e}finally{try{!s&&d.return&&d.return()}finally{if(u)throw c}}var h=[];return i.forEach(function(n){var i=l(e,t,n);if(n.devices){var s=!0,u=!1,c=void 0;try{for(var f,d=(0,r.default)(n.devices);!(s=(f=d.next()).done);s=!0){var p=f.value;if("JOINED"===p.state&&"OBSERVE"===(0,o.default)(p,"intent.type")){var m=a.get(p.url);i.audioMuted=v(m),i.videoMuted=g(m)}a.delete(p.url)}}catch(e){u=!0,c=e}finally{try{!s&&d.return&&d.return()}finally{if(u)throw c}}}h.push(i)}),a.forEach(function(r){var n=l(e,t,r);h.push(n)}),h},t.participantToCallMembership=l,t.participantStateToCallMembershipState=f,t.makeInternalCallId=function(e){return e.url+"_"+e.fullState.lastActive},t.mediaDirection=function(e,t){if(!t)return"inactive";if(!t.status)return"inactive";return(t.status[e+"Status"]||"inactive").toLowerCase()},t.participantIsJoined=d,t.remoteParticipant=p,t.remoteParticipants=h,t.remoteAudioMuted=v,t.remoteVideoMuted=g,t.shouldRing=function(e){return"NONE"!==(0,o.default)(e,"self.alertType.action")},t.getState=function(e){return e&&e.fullState&&e.fullState.state.toLowerCase()},t.getStatus=function(e,t,n){if(t){var i=p(t);if(i){if(c(e,t)&&i&&d(i))return"connected";if(t.replaces){var a=!0,s=!1,u=void 0;try{for(var l,f=(0,r.default)(t.replaces);!(a=(l=f.next()).done);a=!0){var h=l.value;if(h.locusUrl===n.url&&h.lastActive===(0,o.default)(n,"fullState.lastActive"))return"replaced"}}catch(e){s=!0,u=e}finally{try{!a&&f.return&&f.return()}finally{if(s)throw u}}}var v=t.self;if("LEFT"===i.state||"LEFT"===v.state)return"disconnected";if("DECLINED"===i.state)return"disconnected";if("NOTIFIED"===i.state)return"ringing"}}return"initiated"},t.getThisDevice=function(e,t){return t&&t.self&&t.self.devices.find(function(t){return t.url===e.internal.device.url})}});t(VN);VN.activeParticipants,VN.direction,VN.waitForMediaShare,VN.isActive,VN.isCall,VN.joined,VN.joinedOnThisDevice,VN.participantsToCallMemberships,VN.participantToCallMembership,VN.participantStateToCallMembershipState,VN.makeInternalCallId,VN.mediaDirection,VN.participantIsJoined,VN.remoteParticipant,VN.remoteParticipants,VN.remoteAudioMuted,VN.remoteVideoMuted,VN.shouldRing,VN.getState,VN.getStatus,VN.getThisDevice;var BN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e&&t)return"sendrecv";if(e&&!t)return"sendonly";if(!e&&t)return"recvonly";if(!e&&!t)return"inactive";throw new Error("If you see this error, your JavaScript engine has a major flaw")}});t(BN);var zN=Object.prototype.hasOwnProperty,HN=PN(function(e,t,r){zN.call(e,r)?++e[r]:Nd(e,r,1)});var WN=function(e,t,r){var n=null==e?0:e.length;return n?(t=r||void 0===t?1:_b(t),dv(e,t<0?0:t,n)):[]};var YN=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0};var XN=function(e,t){var r=!0;return ZO(e,function(e,n,i){return r=!!t(e,n,i)}),r};var JN=function(e,t,r){var n=Hd(e)?YN:XN;return r&&xb(e,t,r)&&(t=void 0),n(e,_I(t,3))},KN=Object.prototype.hasOwnProperty,$N=PN(function(e,t,r){KN.call(e,r)?e[r].push(t):Nd(e,r,[t])}),QN=PN(function(e,t,r){Nd(e,r,t)}),ZN=Math.max;var eD=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:_b(r);return i<0&&(i=ZN(n+i,0)),RE(e,t,i)};var tD=function(e){return null!=e&&e.length?dv(e,0,-1):[]};var rD=function(e,t,r){t=sv(t,e);var n=null==(e=pv(e,t))?e:e[lv(uv(t))];return null==n?void 0:Rv(n,e,r)},nD=H_(rD),iD=H_(function(e,t,r){var n=-1,i="function"==typeof t,o=pp(e)?Array(e.length):[];return ZO(e,function(e){o[++n]=i?Rv(t,e,r):rD(e,t,r)}),o});var oD=function(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n},aD=Math.max,sD=Math.min;var uD=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=n;return void 0!==r&&(i=(i=_b(r))<0?aD(n+i,0):sD(i,n-1)),t==t?oD(e,t,i):wE(e,OE,i,!0)};var cD=function(e,t){var r=-1,n=pp(e)?Array(e.length):[];return ZO(e,function(e,i,o){n[++r]=t(e,i,o)}),n};var lD=function(e,t){return(Hd(e)?uf:cD)(e,_I(t,3))};var fD=function(e,t,r){for(var n=-1,i=e.length;++n<i;){var o=e[n],a=t(o);if(null!=a&&(void 0===s?a==a&&!Hh(a):r(a,s)))var s=a,u=o}return u};var dD=function(e,t){return e>t};var pD=function(e){return e&&e.length?fD(e,Cv,dD):void 0};var hD=function(e,t){return e<t};var vD=function(e){return e&&e.length?fD(e,Cv,hD):void 0};var gD=function(e,t,r,n,i){return i(e,function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)}),r};var mD=function(e,t,r){var n=Hd(e)?XM:gD,i=arguments.length<3;return n(e,_I(t,4),r,i,ZO)};var yD=function(e,t,r,n){var i=null==e?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r},_D=Fw(!0);var ED=QO(function(e,t){return e&&_D(e,t,hp)},!0);var bD=function(e,t,r){var n=Hd(e)?yD:gD,i=arguments.length<3;return n(e,_I(t,4),r,i,ED)};var SD=function(e,t){return(Hd(e)?Tp:rM)(e,mC(_I(t,3)))},TD=Math.floor,wD=Math.random;var OD=function(e,t){return e+TD(wD()*(t-e+1))};var kD=function(e){var t=e.length;return t?e[OD(0,t-1)]:void 0};var RD=function(e){return kD(Ww(e))};var AD=function(e){return(Hd(e)?kD:RD)(e)};var ID=function(e,t){var r=-1,n=e.length,i=n-1;for(t=void 0===t?n:t;++r<t;){var o=OD(r,i),a=e[o];e[o]=e[r],e[r]=a}return e.length=t,e};var PD=function(e){return ID(Sp(e))};var CD=function(e){return ID(Ww(e))};var MD=function(e){return(Hd(e)?PD:CD)(e)};var ND=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e};var DD=function(e,t){if(e!==t){var r=void 0!==e,n=null===e,i=e==e,o=Hh(e),a=void 0!==t,s=null===t,u=t==t,c=Hh(t);if(!s&&!c&&!o&&e>t||o&&a&&u&&!s&&!c||n&&a&&u||!r&&u||!i)return 1;if(!n&&!o&&!c&&e<t||c&&r&&i&&!n&&!o||s&&r&&i||!a&&i||!u)return-1}return 0};var jD=function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,a=i.length,s=r.length;++n<a;){var u=DD(i[n],o[n]);if(u)return n>=s?u:u*("desc"==r[n]?-1:1)}return e.index-t.index};var xD=function(e,t,r){var n=-1;t=uf(t.length?t:[Cv],tp(_I));var i=cD(e,function(e,r,i){return{criteria:uf(t,function(t){return t(e)}),index:++n,value:e}});return ND(i,function(e,t){return jD(e,t,r)})},LD=H_(function(e,t){if(null==e)return[];var r=t.length;return r>1&&xb(e,t[0],t[1])?t=[]:r>2&&xb(t[0],t[1],t[2])&&(t=[t[0]]),xD(e,Ov(t,1),[])});var UD={countBy:HN,difference:IM,drop:WN,each:ek,every:JN,filter:nM,find:SI,forEach:ek,groupBy:$N,includes:Xw,keyBy:QN,indexOf:eD,initial:tD,invoke:nD,invokeMap:iD,isEmpty:Bv,lastIndexOf:uD,map:lD,max:pD,min:vD,partition:CN,reduce:mD,reduceRight:bD,reject:SD,sample:AD,shuffle:MD,some:wI,sortBy:LD,tail:function(e){var t=null==e?0:e.length;return t?dv(e,1,t):[]},take:function(e,t,r){return e&&e.length?(t=r||void 0===t?1:_b(t),dv(e,0,t<0?0:t)):[]},without:QI},FD=[].slice,GD={};UD.each(["forEach","each","map","reduce","reduceRight","find","filter","reject","every","some","includes","invoke","invokeMap","max","min","take","initial","tail","drop","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","sample","partition"],function(e){UD[e]&&(GD[e]=function(){var t=FD.call(arguments);return t.unshift(this.models),UD[e].apply(UD,t)})});UD.each(["groupBy","countBy","sortBy","keyBy"],function(e){UD[e]&&(GD[e]=function(t,r){var n=zf(t)?t:function(e){return e.get?e.get(t):e[t]};return UD[e](this.models,n,r)})}),GD.where=function(e,t){return UD.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){var r;for(var n in e)if(r=t.get?t.get(n):t[n],e[n]!==r)return!1;return!0})},GD.findWhere=function(e){return this.where(e,!0)},GD.pluck=function(e){return UD.invokeMap(this.models,"get",e)},GD.first=function(){return this.models[0]},GD.last=function(){return this.models[this.models.length-1]},GD.size=function(){return this.models.length};var qD=GD,VD=r(function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0});var n=((r=yk)&&r.__esModule?r:{default:r}).default.extend({idAttribute:"_id",props:{_id:{required:!0,type:"string"},isSelf:{default:!1,type:"boolean"},isInitiator:{default:!1,required:!0,type:"boolean"},personId:{type:"string"},personUuid:{require:!0,type:"string"},state:{required:!0,type:"string",values:["notified","connected","declined","disconnected","waiting"]},audioMuted:{default:!1,type:"boolean"},videoMuted:{default:!1,type:"boolean"}}});t.default=n});t(VD);var BD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(cA),n=o(qD),i=o(VD);function o(e){return e&&e.__esModule?e:{default:e}}var a=r.default.extend(n.default,{model:i.default,mainIndex:"_id"});t.default=a});function zD(){this.head=null,this.tail=null,this.length=0}t(BD),zD.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},zD.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},zD.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},zD.prototype.clear=function(){this.head=this.tail=null,this.length=0},zD.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},zD.prototype.concat=function(e){if(0===this.length)return Ng.alloc(0);if(1===this.length)return this.head.data;for(var t=Ng.allocUnsafe(e>>>0),r=this.head,n=0;r;)r.data.copy(t,n),n+=r.data.length,r=r.next;return t};var HD=Ng.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function WD(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!HD(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=XD;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=JD;break;default:return void(this.write=YD)}this.charBuffer=new Ng(6),this.charReceived=0,this.charLength=0}function YD(e){return e.toString(this.encoding)}function XD(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function JD(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}WD.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var n=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,n),n-=this.charReceived);var i;n=(t+=e.toString(this.encoding,0,n)).length-1;if((i=t.charCodeAt(n))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,n)}return t},WD.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},WD.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;t+=n.slice(0,r).toString(i)}return t},QD.ReadableState=$D;var KD=Tm("stream");function $D(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof kj&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new zD,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new WD(e.encoding),this.encoding=e.encoding)}function QD(e){if(!(this instanceof QD))return new QD(e);this._readableState=new $D(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),qb.call(this)}function ZD(e,t,r,n,i){var o=function(e,t){var r=null;vm(t)||"string"==typeof t||null==t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));return r}(t,r);if(o)e.emit("error",o);else if(null===r)t.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,rj(e)}(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var u;!t.decoder||i||n||(r=t.decoder.write(r),u=!t.objectMode&&0===r.length),i||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&rj(e))),function(e,t){t.readingMore||(t.readingMore=!0,Bs(ij,e,t))}(e,t)}else i||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}mm(QD,qb),QD.prototype.push=function(e,t){var r=this._readableState;return r.objectMode||"string"!=typeof e||(t=t||r.defaultEncoding)!==r.encoding&&(e=Ng.from(e,t),t=""),ZD(this,r,e,t,!1)},QD.prototype.unshift=function(e){return ZD(this,this._readableState,e,"",!0)},QD.prototype.isPaused=function(){return!1===this._readableState.flowing},QD.prototype.setEncoding=function(e){return this._readableState.decoder=new WD(e),this._readableState.encoding=e,this};var ej=8388608;function tj(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=ej?e=ej:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function rj(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(KD("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?Bs(nj,e):nj(e))}function nj(e){KD("emit readable"),e.emit("readable"),sj(e)}function ij(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(KD("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function oj(e){KD("readable nexttick read 0"),e.read(0)}function aj(e,t){t.reading||(KD("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),sj(e),t.flowing&&!t.reading&&e.read(0)}function sj(e){var t=e._readableState;for(KD("flow",t.flowing);t.flowing&&null!==e.read(););}function uj(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=Ng.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,a),0===(e-=a)){a===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function cj(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,Bs(lj,t,e))}function lj(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function fj(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function dj(){}function pj(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function hj(e,t){Object.defineProperty(this,"buffer",{get:Em(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof kj&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?Bs(i,n):i(n);e._writableState.errorEmitted=!0,e.emit("error",n)}(e,r,n,t,i);else{var o=_j(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||yj(e,r),n?Bs(mj,e,r,o,i):mj(e,r,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Sj(this)}function vj(e){if(!(this instanceof vj||this instanceof kj))return new vj(e);this._writableState=new hj(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),qb.call(this)}function gj(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function mj(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),bj(e,t)}function yj(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0;r;)i[a]=r,r=r.next,a+=1;gj(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new Sj(t)}else{for(;r;){var s=r.chunk,u=r.encoding,c=r.callback;if(gj(e,t,!1,t.objectMode?1:s.length,s,u,c),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function _j(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function Ej(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function bj(e,t){var r=_j(t);return r&&(0===t.pendingcb?(Ej(e,t),t.finished=!0,e.emit("finish")):Ej(e,t)),r}function Sj(e){var t=this;this.next=null,this.entry=null,this.finish=function(r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}QD.prototype.read=function(e){KD("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return KD("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?cj(this):rj(this),null;if(0===(e=tj(e,t))&&t.ended)return 0===t.length&&cj(this),null;var n,i=t.needReadable;return KD("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&KD("length less than watermark",i=!0),t.ended||t.reading?KD("reading or ended",i=!1):i&&(KD("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=tj(r,t))),null===(n=e>0?uj(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&cj(this)),null!==n&&this.emit("data",n),n},QD.prototype._read=function(e){this.emit("error",new Error("not implemented"))},QD.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,KD("pipe count=%d opts=%j",n.pipesCount,t);var i=!t||!1!==t.end?a:c;function o(e){KD("onunpipe"),e===r&&c()}function a(){KD("onend"),e.end()}n.endEmitted?Bs(i):r.once("end",i),e.on("unpipe",o);var s=function(e){return function(){var t=e._readableState;KD("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,sj(e))}}(r);e.on("drain",s);var u=!1;function c(){KD("cleanup"),e.removeListener("close",p),e.removeListener("finish",h),e.removeListener("drain",s),e.removeListener("error",d),e.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",c),r.removeListener("data",f),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||s()}var l=!1;function f(t){KD("ondata"),l=!1,!1!==e.write(t)||l||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==fj(n.pipes,e))&&!u&&(KD("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,l=!0),r.pause())}function d(t){var r;KD("onerror",t),v(),e.removeListener("error",d),0===(r="error",e.listeners(r).length)&&e.emit("error",t)}function p(){e.removeListener("finish",h),v()}function h(){KD("onfinish"),e.removeListener("close",p),v()}function v(){KD("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",h),e.emit("pipe",r),n.flowing||(KD("pipe resume"),r.resume()),e},QD.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var o=fj(t.pipes,e);return-1===o?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},QD.prototype.on=function(e,t){var r=qb.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&rj(this):Bs(oj,this))}return r},QD.prototype.addListener=QD.prototype.on,QD.prototype.resume=function(){var e=this._readableState;return e.flowing||(KD("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,Bs(aj,e,t))}(this,e)),this},QD.prototype.pause=function(){return KD("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(KD("pause"),this._readableState.flowing=!1,this.emit("pause")),this},QD.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",function(){if(KD("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){(KD("wrapped data"),t.decoder&&(i=t.decoder.write(i)),t.objectMode&&null==i)||(t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return function(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}(["error","close","destroy","pause","resume"],function(t){e.on(t,n.emit.bind(n,t))}),n._read=function(t){KD("wrapped _read",t),r&&(r=!1,e.resume())},n},QD._fromList=uj,vj.WritableState=hj,mm(vj,qb),hj.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},vj.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},vj.prototype.write=function(e,t,r){var n=this._writableState,i=!1;return"function"==typeof t&&(r=t,t=null),Ng.isBuffer(e)?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=dj),n.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),Bs(t,r)}(this,r):function(e,t,r,n){var i=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):Ng.isBuffer(r)||"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),Bs(n,o),i=!1),i}(this,n,e,r)&&(n.pendingcb++,i=function(e,t,r,n,i){r=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Ng.from(t,r)),t}(t,r,n),Ng.isBuffer(r)&&(n="buffer");var o=t.objectMode?1:r.length;t.length+=o;var a=t.length<t.highWaterMark;a||(t.needDrain=!0);if(t.writing||t.corked){var s=t.lastBufferedRequest;t.lastBufferedRequest=new pj(r,n,i),s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else gj(e,t,!1,o,r,n,i);return a}(this,n,e,t,r)),i},vj.prototype.cork=function(){this._writableState.corked++},vj.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||yj(this,e))},vj.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},vj.prototype._write=function(e,t,r){r(new Error("not implemented"))},vj.prototype._writev=null,vj.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,bj(e,t),r&&(t.finished?Bs(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r)},mm(kj,QD);for(var Tj=Object.keys(vj.prototype),wj=0;wj<Tj.length;wj++){var Oj=Tj[wj];kj.prototype[Oj]||(kj.prototype[Oj]=vj.prototype[Oj])}function kj(e){if(!(this instanceof kj))return new kj(e);QD.call(this,e),vj.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",Rj)}function Rj(){this.allowHalfOpen||this._writableState.ended||Bs(Aj,this)}function Aj(e){e.end()}function Ij(e){this.afterTransform=function(t,r){return function(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!=r&&e.push(r);i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function Pj(e){if(!(this instanceof Pj))return new Pj(e);kj.call(this,e),this._transformState=new Ij(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e){Cj(t,e)}):Cj(t)})}function Cj(e,t){if(t)return e.emit("error",t);var r=e._writableState,n=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(n.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function Mj(e){if(!(this instanceof Mj))return new Mj(e);Pj.call(this,e)}function Nj(){qb.call(this)}mm(Pj,kj),Pj.prototype.push=function(e,t){return this._transformState.needTransform=!1,kj.prototype.push.call(this,e,t)},Pj.prototype._transform=function(e,t,r){throw new Error("Not implemented")},Pj.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Pj.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},mm(Mj,Pj),Mj.prototype._transform=function(e,t,r){r(null,e)},mm(Nj,qb),Nj.Readable=QD,Nj.Writable=vj,Nj.Duplex=kj,Nj.Transform=Pj,Nj.PassThrough=Mj,Nj.Stream=Nj,Nj.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",s));var o=!1;function a(){o||(o=!0,e.end())}function s(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===qb.listenerCount(this,"error"))throw e}function c(){r.removeListener("data",n),e.removeListener("drain",i),r.removeListener("end",a),r.removeListener("close",s),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",c),r.removeListener("close",c),e.removeListener("close",c)}return r.on("error",u),e.on("error",u),r.on("end",c),r.on("close",c),e.on("close",c),e.emit("pipe",r),e};var Dj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(Yk),n=u(MS),i=u(_y),o=u(Ty),a=u(NS),s=u(DS);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,{objectMode:!0}))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_transform",value:function(e,t,n){if(e){var i={local:null,remote:null},o={local:null,remote:null},a={local:null,remote:null},s={local:null,remote:null},u=!0,c=!1,l=void 0;try{for(var f,d=(0,r.default)(e.values());!(u=(f=d.next()).done);u=!0){var p=f.value;["outbound-rtp","outboundrtp"].includes(p.type)&&!p.isRemote&&("audio"===p.mediaType&&(a.local=p,a.remote=e.get(p.remoteId)),"video"===p.mediaType&&(s.local=p,s.remote=e.get(p.remoteId))),["inbound-rtp","inboundrtp"].includes(p.type)&&!p.isRemote&&("audio"===p.mediaType&&(i.local=p,i.remote=e.get(p.remoteId)),"video"===p.mediaType&&(o.local=p,o.remote=e.get(p.remoteId)))}}catch(e){c=!0,l=e}finally{try{!u&&d.return&&d.return()}finally{if(c)throw l}}this.push({incomingAudio:i,incomingVideo:o,outgoingAudio:a,outgoingVideo:s,report:e}),n()}else n()}}]),t}(Nj.Transform);t.default=c});t(Dj);var jj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(MS),n=u(_y),i=u(Ty),o=u(NS),a=u(DS),s=u(zy);function u(e){return e&&e.__esModule?e:{default:e}}var c=new s.default,l=new s.default,f=new s.default,d=new s.default;var p=function(e){function t(e){(0,n.default)(this,t);var i=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{objectMode:!0}));c.has(e)||c.set(e,new qb.EventEmitter);var a=c.get(e);return f.has(i)||f.set(i,a),l.has(a)||l.set(a,e),a.once("error",function(e){i.emit("error",e)}),i}return(0,a.default)(t,e),(0,i.default)(t,[{key:"_read",value:function(){var e=this,t=f.get(this);t.once("data",function(t){e.isPaused()||e.push(t)}),d.has(t)||function e(t){var r=(0,Aw.safeSetTimeout)(function(){var r=l.get(t);r.getStats().then(function(n){t.emit("data",n),"closed"!==r.signalingState&&"closed"!==r.connectionState&&e(t)}).catch(function(e){t.emit("error",e)})},1e3);d.set(t,r)}(t)}}]),t}(Nj.Readable);t.default=p});t(jj);var xj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o,a,s=S(xu),u=S(Yk),c=S(nf),l=S(Zl),f=S(Xl),d=S(Cb),p=S(EA),h=S(SI),v=S(Fb),g=S(MA),m=S(kM),y=S(BN),_=S(BD),E=S(Dj),b=S(jj);function S(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var w=kM.webrtcHelpers.boolToDirection,O=["ringing","connected","disconnected","replaced"];function k(e,t){var r="string"==typeof t?(0,eM.parse)(t):t,n=void 0;return(n="screen"===e?r.media.find(function(e){return"video"===e.type&&e.content}):r.media.find(function(t){return t.type===e}))&&n.direction?n.direction:"inactive"}function R(e){switch(e){case"inactive":case"sendrecv":return e;case"sendonly":return"recvonly";case"recvonly":return"sendonly";default:throw new Error('direction "'+e+'" is not valid')}}var A={audio:"Audio",video:"Video"},I=eI.SparkPlugin.extend((r=(0,Tw.whileInFlight)("locusJoinInFlight"),n=(0,Tw.deprecated)("Please use Call#reject()"),i=(0,Tw.whileInFlight)("locusLeaveInFlight"),o=(0,WC.debounce)(),T(a={namespace:"Phone",children:{media:m.default},collections:{memberships:_.default},session:{activeParticipantsCount:{default:0,required:!0,type:"number"},remoteAudioMuted:{default:!1,required:!1,type:"boolean"},remoteVideoMuted:{default:!1,required:!1,type:"boolean"},correlationId:"string",facingMode:{type:"string",values:["user","environment"]},internalCallId:{setOnce:!0,type:"string"},locus:"object",localMediaStream:"object",locusJoinInFlight:{default:!1,type:"boolean"},locusLeaveInFlight:{default:!1,type:"boolean"},me:{type:"object"}},derived:{id:{deps:["locus"],fn:function(){return(0,p.default)(this,"locus.url")}},isActive:{deps:["locus"],fn:function(){return!(!this.locus||!(0,VN.isActive)(this.locus))}},joinedOnThisDevice:{deps:["locus"],default:!1,fn:function(){return!(!this.locus||!(0,VN.joinedOnThisDevice)(this.spark,this.locus))}},locusUrl:{deps:["locus"],fn:function(){return(0,p.default)(this,"locus.url")}},device:{deps:["locus"],fn:function(){return(0,VN.getThisDevice)(this.spark,this.locus)}},mediaConnection:{deps:["locus"],fn:function(){var e=(0,VN.getThisDevice)(this.spark,this.locus);return(0,p.default)(e,"mediaConnections[0]")}},mediaId:{deps:["locus"],fn:function(){var e=(0,VN.getThisDevice)(this.spark,this.locus);return(0,p.default)(e,"mediaConnections[0].mediaId")}},remoteMember:{deps:["memberships","locus"],fn:function(){if((0,VN.isCall)(this.locus))return this.memberships.find(function(e){return!e.isSelf})}},direction:{deps:["locus"],fn:function(){return this.locus?(0,VN.direction)(this.locus):"out"}},from:{deps:["memberships"],fn:function(){if(this.isCall)return this.memberships.find(function(e){return e.isInitiator})}},to:{deps:["memberships"],fn:function(){if(this.isCall)return this.memberships.find(function(e){return!e.isInitiator})}},state:{deps:["locus"],fn:function(){if(this.config.enableExperimentalGroupCallingSupport)return(0,VN.getState)(this.locus)}},status:{deps:["locus"],fn:function(){return(0,VN.getStatus)(this.spark,this.locus,this.previousAttributes().locus)}},host:{deps:["locus"],fn:function(){if(this.config.enableExperimentalGroupCallingSupport)return this.locus.host}},roomId:{deps:["locus"],fn:function(){if(this.config.enableExperimentalGroupCallingSupport&&this.locus.conversationUrl)return Tw.base64.encode("ciscospark://us/ROOM/"+this.locus.conversationUrl.split("/").pop())}},remoteMediaStream:{deps:["media.remoteMediaStream"],fn:function(){return this.media.remoteMediaStream}},localScreenShare:{deps:["media.localScreenShare"],fn:function(){return this.media.localScreenShare}},receivingAudio:{deps:["media.receivingAudio"],fn:function(){return this.media.receivingAudio}},receivingVideo:{deps:["media.receivingVideo"],fn:function(){return this.media.receivingVideo}},sendingAudio:{deps:["media.sendingAudio"],fn:function(){return this.media.sendingAudio}},sendingVideo:{deps:["media.sendingVideo"],fn:function(){return this.media.sendingVideo}},isCall:{deps:["locus"],fn:function(){return(0,VN.isCall)(this.locus)}},supportsDtmf:{deps:["locus"],fn:function(){return(0,p.default)(this,"locus.self.enableDTMF")}}},acknowledge:function(){var e=this;return this.logger.info("call: acknowledging"),this.spark.internal.locus.alert(this.locus).then(function(t){return e.setLocus(t)}).then((0,Tw.tap)(function(){return e.logger.info("call: acknowledged")}))},answer:function(e){var t=this;return this.logger.info("call: answering"),this.locus?this.joinedOnThisDevice&&this.media.pc.remoteDescription&&this.media.pc.remoteDescription.sdp?(this.logger.info("call: already joined on this device"),f.default.resolve()):this.createOrJoinLocus(this.locus,e).then((0,Tw.tap)(function(){return t.logger.info("call: answered")})):(this.logger.info("call: no locus provided, answer() is a noop"),f.default.resolve())},changeReceivingMedia:function(e,t){var r=this;return new f.default(function(n){var i=(0,eM.parse)(r.media.offerSdp),o=(0,h.default)(i.media,{type:e});o&&o.direction.includes("recv")?(r.logger.info('changeReceivingMedia: expecting to renegotiate, waiting for call to emit "change:receiving'+A[e]+'"'),r.once("change:receiving"+A[e],function(){return n()})):(r.logger.info('changeReceivingMedia: expecting to renegotiate, waiting for media to emit "answeraccepted"'),r.media.once("answeraccepted",function(){return n()}));var a=(0,y.default)(r.media["sending"+A[e]],t);console.warn("starting to setMedia "+e+" to "+a),r.media.setMedia(e,a)})},changeSendingMedia:function(e,t){var r=this;if(this.logger.info('changeSendingMedia: changing sending "'+e+'" to "'+t+'"'),["audio","video"].includes(e)){var n=this.media.senderTracks.filter(function(t){return t.kind===e}),i=(0,y.default)(t,this.media["receiving"+A[e]]);return n.length>0?this.media.setMedia(e,i).then(function(){return r.updateMuteToggles(e,t)}):new f.default(function(t){r.once("mediaNegotiationCompleted",function(){return t()}),r.media.setMedia(e,i)})}return f.default.reject(new Error('kind must be one of "audio" or "video"'))},cleanup:function(){var e=this;return new f.default(function(t){Bs(function(){e.media.stop(),e.stopListening(e.spark.internal.mercury),e.off(),t()})})},createOrJoinLocus:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r.localMediaStream)this.localMediaStream=r.localMediaStream;else{r.constraints||(r.constraints={audio:!0,video:{facingMode:{ideal:this.spark.phone.defaultFacingMode}}});var n=(0,p.default)(r,"constraints.video.facingMode.ideal",(0,p.default)(r,"constraints.video.facingMode.exact"));"user"!==n&&"environment"!==n||(this.facingMode=n);var i=!r.constraints.audio&&!r.constraints.video;r.offerOptions=(0,v.default)(r.offerOptions,{offerToReceiveAudio:i||!!r.constraints.audio,offerToReceiveVideo:i||!!r.constraints.video}),r.constraints.fake&&(this.media.constraints.fake=!0),this.media.setMedia("audio",(0,y.default)(r.constraints.audio,r.offerOptions.offerToReceiveAudio),r.constraints.audio),"screen"===(0,p.default)(r,"constraints.video.mediaSource")||"application"===(0,p.default)(r,"constraints.video.mediaSource")?this.media.setMedia("screen","sendonly"):this.media.setMedia("video",(0,y.default)(r.constraints.video,r.offerOptions.offerToReceiveVideo),r.constraints.video)}return e.correlationId||(r.correlationId=g.default.v4(),this.correlationId=r.correlationId),this.correlationId||(this.correlationId=e.correlationId),this.media.bandwidthLimit={audioBandwidthLimit:this.config.audioBandwidthLimit,videoBandwidthLimit:this.config.videoBandwidthLimit},this.media.createOffer().then((0,Tw.tap)(function(){return t.logger.info("created offer")})).then(function(){return t.spark.internal.locus.createOrJoin(e,(0,l.default)({localSdp:t.media.offerSdp,correlationId:t.correlationId},r))}).then((0,Tw.tap)(function(){return t.logger.info("sent offer to locus")})).then((0,Tw.tap)(function(){return t.logger.info("setting locus")})).then(function(e){return t.setLocus(e)}).then((0,Tw.tap)(function(){return t.logger.info("successfully set locus")})).then(function(){var e=JSON.parse(t.mediaConnection.remoteSdp).sdp;return t.logger.info("accepting answer"),t.logger.info("peer state",t.media.pc&&t.media.pc.signalingState),t.media.ended?(t.logger.info("call: already ended, not accepting answer"),f.default.resolve()):t.media.acceptAnswer(e).then(function(){return t.logger.info("answer accepted")}).catch(function(e){return t.logger.error("failed to accept answer",e),f.default.reject(e)})})},decline:function(){return this.reject()},dial:function(e,t){var r=this;this.locusJoinInFlight=!0,this.logger.info("call: dialing");var n=e;if(Tw.base64.validate(e)){var i=Tw.base64.decode(e).split("/"),o=i[3],a=i[4];if("PEOPLE"===o&&(n=a),"ROOM"===o){if(!(0,p.default)(this,"config.enableExperimentalGroupCallingSupport"))throw new Error("Group calling is not enabled. Please enable config.phone.enableExperimentalGroupCallingSupport");n={url:this.spark.internal.device.services.conversationServiceUrl+"/conversations/"+a+"/locus"}}}return this.spark.internal.mercury.connect().then(function(){return r.createOrJoinLocus(n,t)}).then((0,Tw.tap)(function(){return r.logger.info("call: dialed")})).catch(function(e){r.trigger("error",e)}).then(function(){r.locusJoinInFlight=!1}),this},getRawStatsStream:function(){return new b.default(this.media.pc)},getStatsStream:function(){return this.getRawStatsStream().pipe(new E.default)},hangup:function(){var e=this;return"in"!==this.direction||this.joinedOnThisDevice?(this.logger.info("call: hanging up"),this.media.stop(),this.locusJoinInFlight?(this.logger.info("call: locus join in flight, waiting for rest call to complete before hanging up"),this.when("change:locusJoinInFlight").then(function(){return e.hangup()})):this.locus?this.leave():this.cleanup().then(function(){return e.logger.info("call: hang up complete, call never created")})):this.reject()},initialize:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(0,c.default)(eI.SparkPlugin.prototype.initialize,this,r),this.on("change:activeParticipantsCount",function(){return e.onChangeActiveParticipantsCount.apply(e,arguments)}),this.on("change:isActive",function(){return e.onChangeIsActive.apply(e,arguments)}),this.on("change:localMediaStream",function(){return e.onChangeLocalMediaStream.apply(e,arguments)}),this.on("change:media.localMediaStream",function(){e.localMediaStream=e.media.localMediaStream}),this.on("change:remoteMember",function(){return e.onChangeRemoteMember.apply(e,arguments)}),["localMediaStream","remoteAudioMuted","remoteMediaStream","remoteVideoMuted","localScreenShare"].forEach(function(t){e.on("change:"+t,function(){return e.trigger(t+":change")})}),this.on("replaced",function(){return e.cleanup()}),this.listenTo(this.memberships,"add",function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.trigger.apply(e,["memberships:add"].concat(r))}),this.listenTo(this.memberships,"change",function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.trigger.apply(e,["membership:change"].concat(r))}),this.listenTo(this.memberships,"change:audioMuted",function(){return e.onMembershipsAudioMuted.apply(e,arguments)}),this.listenTo(this.memberships,"change:state",function(){return e.onMembershipsChangeState.apply(e,arguments)}),this.listenTo(this.memberships,"change:videoMuted",function(){return e.onMembershipsVideoMuted.apply(e,arguments)}),this.listenTo(this.memberships,"remove",function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.trigger.apply(e,["memberships:remove"].concat(r))}),this.listenTo(this.spark.internal.mercury,"event:locus",function(t){return e.onLocusEvent(t)}),this.listenTo(this.spark.internal.mercury,"event:locus.difference",function(t){return e.onLocusEvent(t)}),this.listenTo(this.media,"error",function(t){return e.trigger("error",t)}),this.listenTo(this.media,"internalTrackUpdate",function(){e.trigger("remoteMediaStream:change")}),this.listenTo(this.media,"negotiationneeded",function(){return e.onMediaNegotiationNeeded.apply(e,arguments)}),this.locus?this.internalCallId=(0,VN.makeInternalCallId)(this.locus):this.once("change:locus",function(){e.internalCallId=(0,VN.makeInternalCallId)(e.locus)}),this.memberships.listenToAndRun(this,"change:locus",function(){e.locus&&e.locus.participants&&(e.memberships.set((0,VN.participantsToCallMemberships)(e.spark,e.locus)),e.me=e.memberships.find(function(e){return e.isSelf}))}),this.config.enableExperimentalGroupCallingSupport?(this.on("inactive",function(){return e.hangup()}),this.on("inactive",function(){return e.cleanup()}),this.on("change:state",function(){Bs(function(){return e.trigger(e.state)})}),this.on=(0,d.default)(this.on,function(t,r){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];if(O.includes(r))throw new Error('The "'+r+'" event is no longer valid with "enableExperimentalGroupCallingSupport===true"');return(0,c.default)(t,e,[r].concat(i))})):(this.on("disconnected",function(){return e.hangup()}),this.on("disconnected",function(){return e.cleanup()}),this.on("change:status",function(){Bs(function(){return e.trigger(e.status)})}))},leave:function(){var e=this;this.logger.info("leave: attempting to leave locus");var t=(0,p.default)(this,this.config.enableExperimentalGroupCallingSupport?"me.state":"status");return"disconnected"===t?(this.logger.info("already hung up, not calling locus again"),f.default.resolve()):"declined"===t?(this.logger.info("call was declined, not leaving again"),f.default.resolve()):"connected"!==t?(this.logger.info("call is neither connected, disconnected, or declined, declining instead of leaving"),this.decline()):(this.logger.info("leave: leaving locus"),this.spark.internal.locus.leave(this.locus).catch(function(t){return e.logger.error("leave: locus leave error: ",t.stack||t.toString()),f.default.reject(t)}).then((0,Tw.tap)(function(){return e.logger.info("leave "+e.locus.id+": finished leaving via locus")})).then((0,Tw.tap)(function(){return e.logger.info("leave "+e.locus.id+": setting locus")})).then(function(t){return e.setLocus(t)}).then((0,Tw.tap)(function(){return e.logger.info("leave "+e.locus.id+": finished setting locus")})).then((0,Tw.tap)(function(){return e.logger.info("call: hung up")})))},onLocusEvent:function(e){var t=this,r=(0,p.default)(e,"data.locus.self.devices"),n=r&&(0,h.default)(r,function(e){return e.url===t.spark.internal.device.url});if(((this.locus&&(0,VN.makeInternalCallId)(e.data.locus))===this.internalCallId||n&&this.correlationId===n.correlationId)&&(this.logger.info("locus event: "+e.data.eventType),this.setLocus(e.data.locus)),e.data.locus.replaces){var i=!0,o=!1,a=void 0;try{for(var s,c=(0,u.default)(e.data.locus.replaces);!(i=(s=c.next()).done);i=!0){var l=s.value;if(l.locusUrl+"_"+l.lastActive===this.internalCallId)return this.setLocus(e.data.locus),void this.logger.info("locus replacement event: "+e.data.eventType,this.locusUrl,"->",e.data.locus.url)}}catch(e){o=!0,a=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw a}}}},onMembershipsAudioMuted:function(){this.logger.info("onMembershipsAudioMuted"),this.remoteMember&&(this.remoteAudioMuted=this.remoteMember.audioMuted)},onMembershipsVideoMuted:function(){this.logger.info("onMembershipsVideoMuted"),this.remoteMember&&(this.remoteVideoMuted=this.remoteMember.videoMuted)},onChangeRemoteMember:function(){this.remoteMember?(this.remoteAudioMuted=this.remoteMember.audioMuted,this.remoteVideoMuted=this.remoteMember.videoMuted):(this.remoteAudioMuted=void 0,this.remoteVideoMuted=void 0)},onMembershipsChangeState:function(e){this.activeParticipantsCount=this.memberships.filter(function(e){return"connected"===e.state}).length,this.trigger("membership:"+e.state,e)},onMediaNegotiationNeeded:function(){var e=this;this.logger.info("onMediaNegotiationNeeded"),this.media.createOffer().then(function(){var t=(0,eM.parse)(e.media.offerSdp),r=k("audio",t),n=!r.includes("send"),i=k("video",t),o=!i.includes("send"),a=k("screen",t);e.logger.info("onMediaNegotiationNeeded: audioOfferDir="+r+" videoOfferDir="+i+" screenOfferDir="+a),e.logger.info("onMediaNegotiationNeeded: audioMuted="+n+" videoMuted="+o);var s={sdp:e.media.offerSdp,mediaId:e.mediaId,audioMuted:n,videoMuted:o};return e.updateMedia(s)}).then(function(){return e.pollForExpectedLocusAndSdp()}).then(function(){var t=JSON.parse(e.mediaConnection.remoteSdp).sdp;return e.media.acceptAnswer(t)}).then(function(){return e.emit("mediaNegotiationCompleted")}).catch(function(t){return e.emit("error",t)})},onChangeLocalMediaStream:function(){var e=this;this.localMediaStream&&this.localMediaStream!==this.media.localMediaStream&&(["audio","video"].forEach(function(t){var r=e.localMediaStream.getTracks().find(function(e){return e.kind===t});r?e.media.setMedia(t,(0,y.default)(r.enabled,e["receiving"+A[t]]),r):e.media.setMedia(t,(0,y.default)(!1,e["receiving"+A[t]]))}),this.localMediaStream=this.media.localMediaStream)},onChangeIsActive:function(){this.isActive||this.joinedOnThisDevice&&(this.logger.info("call: hanging up due to locus going inactive"),this.hangup())},onChangeActiveParticipantsCount:function(){if(this.joinedOnThisDevice&&1===this.activeParticipantsCount&&(!this.isCall||this.config.hangupIfLastActive.call)&&(this.isCall||this.config.hangupIfLastActive.meeting)){var e=this.previousAttributes().locus;e&&(0,VN.activeParticipants)(e).length>1&&(this.logger.info("call: hanging up due to last participant in call"),this.hangup())}},pollForExpectedLocusAndSdp:function(){var e=this;return new f.default(function(t,r){var n=(0,eM.parse)(e.media.offerSdp),i=k("audio",n),o=k("video",n),a=k("screen",n),s=e,u=0;!function n(){u+=1;try{if(e.logger.info("iteration "+u+": checking if current locus sdp has the expected audio and video directions"),c=JSON.parse(e.mediaConnection.remoteSdp).sdp,l=(0,eM.parse)(c),f=k("audio",l),d=k("video",l),p=k("screen",l),h=R(i),v=R(o),g=R(a),s.logger.info("audio: "+i+", "+f+", "+h),s.logger.info("video: "+o+", "+d+", "+v),s.logger.info("screen: "+a+", "+p+", "+g),f===h&&d===v&&p===g){e.logger.info("iteration "+u+": the current locus sdp has the expected audio and video directions");try{return e.logger.info("iteration "+u+": checking if current locus has the expected audio and video directions"),e.validateLocusMediaState(e.locus),e.logger.info("iteration "+u+": the current locus has the expected audio and video directions; not syncing"),void t()}catch(t){e.logger.info("iteration "+u+": the current locus does not have the expected audio and video directions; syncing")}}else e.logger.info("iteration "+u+": the current locus sdp does not have the expected audio and video directions; syncing");if(u>4)return void r(new Error("After "+u+" attempts polling locus"));setTimeout(function(){return e.spark.internal.locus.sync(e.locus).then(function(t){return e.setLocus(t)}).then(n).catch(r)},1e3*Math.pow(2,u))}catch(e){r(e)}var c,l,f,d,p,h,v,g}()})},releaseFloor:function(){var e=this;return this.logger.info("call: releasing floor grant"),f.default.resolve().then((0,VN.waitForMediaShare)(this)).then(function(t){return e.spark.internal.locus.releaseFloorGrant(e.locus,t)})},reject:function(){var e=this;return"out"===this.direction?f.default.resolve():(this.logger.info("call: rejecting"),this.spark.internal.locus.decline(this.locus).then(function(t){return e.setLocus(t)}).then((0,Tw.tap)(function(){return e.cleanup()})).then((0,Tw.tap)(function(){return e.logger.info("call: rejected")})))},requestFloor:function(){var e=this;return this.logger.info("call: requesting floor grant"),f.default.resolve().then((0,VN.waitForMediaShare)(this)).then(function(t){return e.spark.internal.locus.requestFloorGrant(e.locus,t)})},setLocus:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.locus;if(!n)return this.locus=e,f.default.resolve();switch(this.spark.internal.locus.compare(n,e)){case qN.USE_INCOMING:this.locus=this.spark.internal.locus.merge(this.locus,e),this.device&&(this.correlationId=this.device.correlationId);break;case qN.FETCH:return r?(this.logger.info("call: fetching locus according to sequencing algorithm"),this.spark.internal.locus.get(n).then(function(e){return t.setLocus(e,!0)})):(this.logger.info("call: syncing locus according to sequencing algorithm"),this.spark.internal.locus.sync(n).then(function(e){return t.setLocus(e,!0)}))}return f.default.resolve()},sendDtmf:function(e){return this.supportsDtmf?this.spark.internal.locus.sendDtmf(this.locus,e):f.default.reject(new Error("this call does not support dtmf"))},sendFeedback:function(e){return this.spark.internal.metrics.submit("meetup_call_user_rating",e)},startApplicationShare:function(){var e=this;return this.logger.info("call: sharing application"),new f.default(function(t){e.media.once("answeraccepted",t),e.media.setMedia("screen","sendonly",{mediaSource:"application"})}).then(function(){return e.requestFloor()})},startScreenShare:function(){var e=this;return this.logger.info("call: sharing screen"),new f.default(function(t){e.media.once("answeraccepted",t),e.media.setMedia("screen","sendonly",{mediaSource:"screen"})}).then(function(){return e.requestFloor()})},startReceivingAudio:function(){return this.changeReceivingMedia("audio",!0)},startReceivingVideo:function(){return this.changeReceivingMedia("video",!0)},startSendingAudio:function(){return this.changeSendingMedia("audio",!0)},startSendingVideo:function(){return this.changeSendingMedia("video",!0)},stopScreenShare:function(){var e=this;return this.logger.info("call: stopping screen/application share"),this.releaseFloor().then(function(){return new f.default(function(t){e.media.once("answeraccepted",t),e.media.setMedia("screen","inactive")})})},stopReceivingAudio:function(){return this.changeReceivingMedia("audio",!1)},stopReceivingVideo:function(){return this.changeReceivingMedia("video",!1)},stopSendingAudio:function(){return this.changeSendingMedia("audio",!1)},stopSendingVideo:function(){return this.changeSendingMedia("video",!1)},toggleFacingMode:function(){var e=this;if(!this.sendingVideo)throw new Error("Cannot toggle facingMode if we're not sending video");if("user"!==this.facingMode&&"environment"!==this.facingMode)throw new Error("Cannot determine current facing mode; specify a new localMediaStream to change cameras");var t={facingMode:{ideal:"user"===this.facingMode?"environment":"user"}};return this.media.setMedia("video",(0,y.default)(this.sendingAudio,this.sendingVideo),t).then(function(){e.facingMode=t.facingMode.ideal})},toggleReceivingAudio:function(){return this.receivingAudio?this.stopReceivingAudio():this.startReceivingAudio()},toggleReceivingVideo:function(){return this.receivingVideo?this.stopReceivingVideo():this.startReceivingVideo()},toggleSendingAudio:function(){return this.sendingAudio?this.stopSendingAudio():this.startSendingAudio()},toggleSendingVideo:function(){return this.sendingVideo?this.stopSendingVideo():this.startSendingVideo()},updateMedia:function(e){var t=this;if(this.logger.info("updateMedia"),e.sdp&&!e.sdp.includes("b="))throw new Error("outbound sdp should always have a 'b=' line");return this.spark.internal.locus.updateMedia(this.locus,e).then(function(e){return t.setLocus(e)})},updateVideoMuteSdp:function(e,t){var r=w(!t,this.receivingVideo),n=w(t,this.receivingVideo);return e.replace(new RegExp("a=mid:video[^a]+a="+n,"gi"),"a=mid:video\na="+r)},updateMuteToggles:function(e,t){this.logger.info("updating mute toggles: "+e+"="+t);var r={mediaId:this.mediaId,audioMuted:!this.sendingAudio,videoMuted:!this.sendingVideo};return"audio"===e?r.audioMuted=!t:"video"===e&&(r.videoMuted=!t,r.sdp=this.updateVideoMuteSdp(this.media.offerSdp,!t)),this.updateMedia(r)},validateLocusMediaState:function(e){var t=e.self.status.audioStatus.toLowerCase(),r=this.media.audioDirection;if(t!==r)throw this.logger.warn("locus: expected audio "+t+" (locus) to equal "+r+" (local media)"),new Error("locus.self.status.audioStatus indicates the received DTO is out of date");var n=e.self.status.videoStatus.toLowerCase(),i=this.media.videoDirection;if(n!==i)throw this.logger.warn("locus: expected video "+n+" (locus) to equal "+i+" (local media)"),new Error("locus.self.status.videoStatus indicates the received DTO is out of date");return e},waitForExpectedLocus:function(){var e=this;return new f.default(function(t){var r=function r(){try{e.validateLocusMediaState(e.locus),e.off("change:locus",r),t()}catch(t){e.logger.warn("locus: current locus not in expected state; waiting for next locus")}};e.on("change:locus",r),r()})},version:"1.50.2"},"acknowledge",[Tw.oneFlight],(0,s.default)(a,"acknowledge"),a),T(a,"answer",[Tw.oneFlight,r],(0,s.default)(a,"answer"),a),T(a,"createOrJoinLocus",[Tw.oneFlight],(0,s.default)(a,"createOrJoinLocus"),a),T(a,"decline",[n],(0,s.default)(a,"decline"),a),T(a,"dial",[Tw.oneFlight],(0,s.default)(a,"dial"),a),T(a,"leave",[Tw.oneFlight,i],(0,s.default)(a,"leave"),a),T(a,"onMediaNegotiationNeeded",[o],(0,s.default)(a,"onMediaNegotiationNeeded"),a),T(a,"pollForExpectedLocusAndSdp",[Tw.retry],(0,s.default)(a,"pollForExpectedLocusAndSdp"),a),T(a,"reject",[Tw.oneFlight],(0,s.default)(a,"reject"),a),T(a,"updateMuteToggles",[Tw.oneFlight],(0,s.default)(a,"updateMuteToggles"),a),a));I.make=function(e,t){return new I(e,t)},t.default=I});t(xj);var Lj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(Yk),n=a(nf),i=a(cA),o=a(xj);function a(e){return e&&e.__esModule?e:{default:e}}var s=i.default.extend({model:o.default,mainIndex:"internalCallId",indexes:["correlationId"],initialize:function(){for(var e=this,t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(0,n.default)(i.default.prototype.initialize,this,r),this.on("add",function(t){e.listenTo(t,"change:state",function(){t.config.enableExperimentalGroupCallingSupport?"inactive"===t.state&&e.remove(t):"disconnected"===t.status&&e.remove(t)})})},has:function(e){if(this.get(e.url+"_"+e.fullState.lastActive))return!0;if(e.replaces){var t=!0,n=!1,i=void 0;try{for(var o,a=(0,r.default)(e.replaces);!(t=(o=a.next()).done);t=!0){var s=o.value;if(this.get(s.locusUrl+"_"+s.lastActive))return!0}}catch(e){n=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}}return!1}});t.default=s});t(Lj);var Uj=r(function(t){!function(){var r,n="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if(E="object"==typeof ru&&"object"==typeof ru.versions&&ru.versions.node&&!1){var i=ru.versions.node.toString().replace("v","");n="Nodejs/"+i+" (NodeOS) AppleWebKit/"+i+" (KHTML, like Gecko) Nodejs/"+i+" Nodejs/"+i}r=void 0!==e?e:window,"undefined"==typeof window&&("undefined"==typeof window&&void 0!==e&&(e.navigator={userAgent:n,getUserMedia:function(){}},r.window=e),"undefined"==typeof location&&(r.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(r.screen={width:0,height:0}));var o=window.navigator;void 0!==o?(void 0!==o.webkitGetUserMedia&&(o.getUserMedia=o.webkitGetUserMedia),void 0!==o.mozGetUserMedia&&(o.getUserMedia=o.mozGetUserMedia)):o={getUserMedia:function(){},userAgent:n};var a=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(o.userAgent||""),s=!(-1===o.userAgent.indexOf("Edge")||!o.msSaveOrOpenBlob&&!o.msSaveBlob),u=!!window.opera||o.userAgent.indexOf(" OPR/")>=0,c=void 0!==window.InstallTrigger,l=/^((?!chrome|android).)*safari/i.test(o.userAgent),f=!!window.chrome&&!u,d="undefined"!=typeof document&&!!document.documentMode&&!s;function p(e,t){var r=0,n=!1,i=window.setInterval(function(){e()&&(window.clearInterval(i),t(n)),r++>50&&(window.clearInterval(i),t(n=!0))},10)}var h={Android:function(){return o.userAgent.match(/Android/i)},BlackBerry:function(){return o.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return o.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return o.userAgent.match(/Opera Mini/i)},Windows:function(){return o.userAgent.match(/IEMobile/i)},any:function(){return h.Android()||h.BlackBerry()||h.iOS()||h.Opera()||h.Windows()},getOsName:function(){var e="Unknown OS";return h.Android()&&(e="Android"),h.BlackBerry()&&(e="BlackBerry"),h.iOS()&&(e="iOS"),h.Opera()&&(e="Opera Mini"),h.Windows()&&(e="Windows"),e}};var v="Unknown OS",g="Unknown OS Version";var m,y,_=function(){for(var e,t=o.appVersion,r=o.userAgent,n="-",i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],a=0;e=i[a];a++)if(e.r.test(r)){n=e.s;break}var s="-";switch(/Windows/.test(n)&&(/Windows (.*)/.test(n)&&(s=/Windows (.*)/.exec(n)[1]),n="Windows"),n){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(r)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(r)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(r)&&(s=/Android ([\.\_\d]+)/.exec(r)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(r)&&(s=(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))[1]+"."+s[2]+"."+(0|s[3]))}return{osName:n,osVersion:s}}();_&&_.osName&&"-"!=_.osName?(v=_.osName,g=_.osVersion):h.any()&&"Android"==(v=h.getOsName())&&(g=!!(y=(m=(m||o.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&y[1]);var E="object"==typeof ru&&"object"==typeof ru.versions&&ru.versions.node;"Unknown OS"===v&&E&&(v="Nodejs",g=ru.versions.node.toString().replace("v",""));var b=!1,S=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!b&&e in document.createElement("canvas")&&(b=!0),!S&&e in document.createElement("video")&&(S=!0))});var T=[],w=[],O=[],k=[];o.mediaDevices&&o.mediaDevices.enumerateDevices&&(o.enumerateDevices=function(e){var t=o.mediaDevices.enumerateDevices();t&&t.then?o.mediaDevices.enumerateDevices().then(e).catch(function(){e([])}):e([])});var R=!1;"undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack?R=!0:o.mediaDevices&&o.mediaDevices.enumerateDevices&&(R=!0);var A=!1,I=!1,P=!1,C=!1,M=!1;var N=window.DetectRTC||{};N.browser=function(){o.appVersion;var e,t,r,n=o.userAgent,i=o.appName,a=""+parseFloat(o.appVersion),p=parseInt(o.appVersion,10);if(u){i="Opera";try{p=(a=o.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){a="0.0.0.0",p=0}}else d?((t=n.indexOf("rv:"))>0?a=n.substring(t+3):(t=n.indexOf("MSIE"),a=n.substring(t+5)),i="IE"):f?(t=n.indexOf("Chrome"),i="Chrome",a=n.substring(t+7)):l?(t=n.indexOf("Safari"),i="Safari",a=n.substring(t+7),-1!==(t=n.indexOf("Version"))&&(a=n.substring(t+8)),-1!==o.userAgent.indexOf("Version/")&&(a=o.userAgent.split("Version/")[1].split(" ")[0])):c?(t=n.indexOf("Firefox"),i="Firefox",a=n.substring(t+8)):(e=n.lastIndexOf(" ")+1)<(t=n.lastIndexOf("/"))&&(i=n.substring(e,t),a=n.substring(t+1),i.toLowerCase()===i.toUpperCase()&&(i=o.appName));return s&&(i="Edge",a=o.userAgent.split("Edge/")[1]),-1!==(r=a.search(/[; \)]/))&&(a=a.substring(0,r)),p=parseInt(""+a,10),isNaN(p)&&(a=""+parseFloat(o.appVersion),p=parseInt(o.appVersion,10)),{fullVersion:a,version:p,name:i,isPrivateBrowsing:!1}}(),function(e){var t;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){t=!1},function(e){t=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var r;try{(r=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){t=!0}void 0===t&&p(function(){return"done"===r.readyState},function(e){e||(t=!r.result)})}else if(function(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var r=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);return!!(r&&parseInt(r[1],10)>=10)}(window.navigator.userAgent)){t=!1;try{window.indexedDB||(t=!0)}catch(e){t=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){t=!0}void 0===t&&(t=!1,window.localStorage.removeItem("test"))}}catch(e){t=!1}p(function(){return void 0!==t},function(r){e(t)})}(function(e){N.browser.isPrivateBrowsing=!!e}),N.browser["is"+N.browser.name]=!0,N.osName=v,N.osVersion=g;var D=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){D||e in window&&(D=!0)}),N.isWebRTCSupported=D,N.isORTCSupported="undefined"!=typeof RTCIceGatherer;var j=!1;(N.browser.isChrome&&N.browser.version>=35?j=!0:N.browser.isFirefox&&N.browser.version>=34?j=!0:N.browser.isEdge&&N.browser.version>=17?j=!0:"Android"===N.osName&&N.browser.isChrome&&(j=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||""))||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(N.browser.isChrome||N.browser.isEdge||N.browser.isOpera)?j=!1:N.browser.isFirefox&&(j=!1));N.isScreenCapturingSupported=j;var x={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){x.isSupported||e in window&&(x.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(x.isCreateMediaStreamSourceSupported=!0))}),N.isAudioContextSupported=x.isSupported,N.isCreateMediaStreamSourceSupported=x.isCreateMediaStreamSourceSupported;var L=!1;N.browser.isChrome&&N.browser.version>31&&(L=!0),N.isRtpDataChannelsSupported=L;var U=!1;N.browser.isFirefox&&N.browser.version>28?U=!0:N.browser.isChrome&&N.browser.version>25?U=!0:N.browser.isOpera&&N.browser.version>=11&&(U=!0),N.isSctpDataChannelsSupported=U,N.isMobileDevice=a;var F=!1;o.getUserMedia?F=!0:o.mediaDevices&&o.mediaDevices.getUserMedia&&(F=!0),N.browser.isChrome&&N.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(F="Requires HTTPs"),"Nodejs"===N.osName&&(F=!1),N.isGetUserMediaSupported=F;var G,q,V,B="";screen.width&&(B+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));N.displayResolution=B,N.displayAspectRatio=(G=screen.width,q=screen.height,V=function e(t,r){return 0==r?t:e(r,t%r)}(G,q),G/V/(q/V)).toFixed(2),N.isCanvasSupportsStreamCapturing=b,N.isVideoSupportsStreamCapturing=S,"Chrome"==N.browser.name&&N.browser.version>=53&&(N.isCanvasSupportsStreamCapturing||(N.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),N.isVideoSupportsStreamCapturing||(N.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),N.DetectLocalIPAddress=function(e,t){N.isWebRTCSupported&&function(e,t){if("undefined"!=typeof document&&"function"==typeof document.getElementById){var r={},n=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!n){var i=document.getElementById("iframe");if(!i)return;var o=i.contentWindow;n=o.RTCPeerConnection||o.mozRTCPeerConnection||o.webkitRTCPeerConnection}if(n){var a=null;"Chrome"===N.browser&&N.browser.version<58&&(a={optional:[{RtpDataChannels:!0}]});var s=new n({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},a);if(t&&(s.addStream?s.addStream(t):s.addTrack&&t.getTracks()[0]&&s.addTrack(t.getTracks()[0],t)),s.onicecandidate=function(e){e.candidate&&u(e.candidate.candidate)},!t)try{s.createDataChannel("sctp",{})}catch(e){}N.isPromisesSupported?s.createOffer().then(function(e){s.setLocalDescription(e).then(c)}):s.createOffer(function(e){s.setLocalDescription(e,c,function(){})},function(){})}}function u(t){var n=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(t);if(n){var i=n[1];void 0===r[i]&&e(i),r[i]=!0}}function c(){var e=s.localDescription.sdp.split("\n");e.forEach(function(e){0===e.indexOf("a=candidate:")&&u(e)})}}(function(t){t.match(/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/)?e("Local: "+t):e("Public: "+t)},t)},N.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,N.isWebSocketsBlocked=!N.isWebSocketsSupported,"Nodejs"===N.osName&&(N.isWebSocketsSupported=!0,N.isWebSocketsBlocked=!1),N.checkWebSocketsSupport=function(e){e=e||function(){};try{var t,r=new WebSocket("wss://echo.websocket.org:443/");r.onopen=function(){N.isWebSocketsBlocked=!1,t=(new Date).getTime(),r.send("ping")},r.onmessage=function(){N.WebsocketLatency=(new Date).getTime()-t+"ms",e(),r.close(),r=null},r.onerror=function(){N.isWebSocketsBlocked=!0,e()}}catch(t){N.isWebSocketsBlocked=!0,e()}},N.load=function(e){!function(e){if(R)if(!o.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(o.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!o.enumerateDevices&&o.enumerateDevices&&(o.enumerateDevices=o.enumerateDevices.bind(o)),o.enumerateDevices){T=[],w=[],O=[],k=[],A=!1,I=!1,P=!1,C=!1,M=!1;var t={};o.enumerateDevices(function(r){r.forEach(function(e){var r={};for(var n in e)try{"function"!=typeof e[n]&&(r[n]=e[n])}catch(e){}t[r.deviceId+r.label+r.kind]||("audio"===r.kind&&(r.kind="audioinput"),"video"===r.kind&&(r.kind="videoinput"),r.deviceId||(r.deviceId=r.id),r.id||(r.id=r.deviceId),r.label?("videoinput"!==r.kind||M||(M=!0),"audioinput"!==r.kind||C||(C=!0)):(r.isCustomLabel=!0,"videoinput"===r.kind?r.label="Camera "+(k.length+1):"audioinput"===r.kind?r.label="Microphone "+(w.length+1):"audiooutput"===r.kind?r.label="Speaker "+(O.length+1):r.label="Please invoke getUserMedia once.",void 0!==N&&N.browser.isChrome&&N.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(r.label="HTTPs is required to get label of this "+r.kind+" device.")),"audioinput"===r.kind&&(A=!0,-1===w.indexOf(r)&&w.push(r)),"audiooutput"===r.kind&&(I=!0,-1===O.indexOf(r)&&O.push(r)),"videoinput"===r.kind&&(P=!0,-1===k.indexOf(r)&&k.push(r)),T.push(r),t[r.deviceId+r.label+r.kind]=r)}),void 0!==N&&(N.MediaDevices=T,N.hasMicrophone=A,N.hasSpeakers=I,N.hasWebcam=P,N.isWebsiteHasWebcamPermissions=M,N.isWebsiteHasMicrophonePermissions=C,N.audioInputDevices=w,N.audioOutputDevices=O,N.videoInputDevices=k),e&&e()})}else e&&e();else e&&e()}(e=e||function(){})},N.MediaDevices=void 0!==T?T:[],N.hasMicrophone=A,N.hasSpeakers=I,N.hasWebcam=P,N.isWebsiteHasWebcamPermissions=M,N.isWebsiteHasMicrophonePermissions=C,N.audioInputDevices=w,N.audioOutputDevices=O,N.videoInputDevices=k;var z=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(z=!0),N.isSetSinkIdSupported=z;var H=!1;N.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(H=!0):N.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(H=!0),N.isRTPSenderReplaceTracksSupported=H;var W=!1;N.browser.isFirefox&&N.browser.version>38&&(W=!0),N.isRemoteStreamProcessingSupported=W;var Y=!1;"undefined"!=typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&(Y=!0),N.isApplyConstraintsSupported=Y;var X=!1;N.browser.isFirefox&&N.browser.version>=43&&(X=!0),N.isMultiMonitorScreenCapturingSupported=X,N.isPromisesSupported=!!("Promise"in window),N.version="1.3.6",void 0===N&&(window.DetectRTC={});var J=window.MediaStream;void 0===J&&"undefined"!=typeof webkitMediaStream&&(J=webkitMediaStream),N.MediaStream=void 0!==J&&"function"==typeof J&&Object.keys(J.prototype),"undefined"!=typeof MediaStreamTrack?N.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):N.MediaStreamTrack=!1;var K=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;N.RTCPeerConnection=void 0!==K&&Object.keys(K.prototype),window.DetectRTC=N,t.exports=N}()}),Fj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.events=void 0;var r=l(nf),n=l(Xk),i=l(Xl),o=l(EA),a=l(Fb),s=l(kM),u=l(xj),c=l(Lj);function l(e){return e&&e.__esModule?e:{default:e}}var f=t.events={CALL_CREATED:"call:created",CALL_INCOMING:"call:incoming"},d=eI.SparkPlugin.extend({collections:{emittedCalls:c.default},session:{connected:{default:!1,type:"boolean"},defaultFacingMode:{default:"user",type:"string",values:["user","environment"]},registered:{default:!1,type:"boolean"}},namespace:"phone",isCallingSupported:function(){return new i.default(function(e){e(Uj.isWebRTCSupported)})},register:function(){var e=this;return this.spark.internal.device.refresh().then(function(){return e.connected?i.default.resolve():i.default.all([e.emittedCalls.reset(),e.spark.internal.mercury.when("event:mercury.buffer_state").then(function(t){return"UNKNOWN"===(0,n.default)(t,1)[0].data.bufferState.locus?e.listActiveCalls():i.default.resolve()}),e.spark.internal.mercury.connect()])})},deregister:function(){var e=this;return this.spark.internal.mercury.disconnect().then(function(){return e.spark.internal.device.unregister()})},createLocalMediaStream:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.constraints||e;return(0,a.default)(t,{audio:!0,video:!0}),s.default.getUserMedia(t)},listActiveCalls:function(){var e=this;return this.spark.internal.locus.list().then(function(t){var r=e.emittedCalls.map(function(e){return e});return t?(t.forEach(function(t){if(!e.emittedCalls.has(t)){var n=u.default.make({locus:t,parent:e.spark});r.push(n),e.emittedCalls.add(n),e._triggerCallEvents(n,t)}}),r):r})},initialize:function(){for(var e=this,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];(0,r.default)(eI.SparkPlugin.prototype.initialize,this,n),this.listenTo(this.spark.internal.mercury,"event:locus",function(t){return e.onLocusEvent(t)}),this.listenTo(this.spark.internal.mercury,"change:connected",function(){e.connected=e.spark.internal.mercury.connected,e.registered=!!e.spark.internal.device.url&&e.connected}),this.listenTo(this.spark.internal.device,"change:url",function(){e.registered=!!e.spark.internal.device.url&&e.connected})},onLocusEvent:function(e){var t=e.data.locus;if(!this.emittedCalls.has(t)&&"inactive"!==t.fullState.state.toLowerCase()){var r=u.default.make({locus:t},{parent:this.spark});this.emittedCalls.add(r),this._triggerCallEvents(r,e.data.locus)}},dial:function(e,t){var r=u.default.make({},{parent:this.spark});return r.dial(e,t),this.emittedCalls.add(r),r},_triggerCallEvents:function(e,t){this.trigger(f.CALL_CREATED,e),(0,VN.shouldRing)(t)&&((0,VN.isCall)(t)||!(0,VN.isCall)(t)&&(0,o.default)(this,"config.enableExperimentalGroupCallingSupport"))&&this.trigger(f.CALL_INCOMING,e)},version:"1.50.2"});t.default=d});t(Fj);Fj.events;var Gj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=Xl)&&r.__esModule?r:{default:r};var i=eI.Batcher.extend({namespace:"People",handleHttpSuccess:function(e){var t=this;return n.default.all(e.body.items.map(function(e){return t.handleItemSuccess(e.id,e)}))},handleItemFailure:function(e,t){return this.getDeferredForResponse(e).then(function(e){e.reject(t)})},handleItemSuccess:function(e,t){return this.getDeferredForResponse(e).then(function(e){e.resolve(t)})},fingerprintRequest:function(e){var t=this.spark.people.inferPersonIdFromUuid(e);return n.default.resolve(t)},fingerprintResponse:function(e){return n.default.resolve(e)},prepareRequest:function(e){return n.default.resolve(e.join())},submitHttpRequest:function(e){return this.spark.request({service:"hydra",resource:"people/?id="+e+"&showAllTypes="+this.config.showAllTypes})}});t.default=i});t(Gj);var qj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=a(xu),i=a(Xl),o=a(Gj);function a(e){return e&&e.__esModule?e:{default:e}}var s,u,c,l,f,d,p=eI.SparkPlugin.extend((r={namespace:"People",children:{batcher:o.default},get:function(e){if(!e)return i.default.reject(new Error("A person with an id is required"));if("me"===e)return this._getMe();var t=e.personId||e.id||e;return this.batcher.request(t)},list:function(e){var t=this;if(Array.isArray(e)){var r=e;return i.default.all(r.map(function(e){return t.batcher.request(e)}))}return this.request({service:"hydra",resource:"people",qs:e}).then(function(e){return new eI.Page(e,t.spark)})},inferPersonIdFromUuid:function(e){try{if(Tw.base64.decode(e).includes("ciscospark://"))return e}catch(e){}return Tw.base64.encode("ciscospark://us/PEOPLE/"+e)},_getMe:function(){return this.spark.request({service:"hydra",resource:"people/me"}).then(function(e){return e.body})},version:"1.50.2"},s=r,u="_getMe",c=[Tw.oneFlight],l=(0,n.default)(r,"_getMe"),f=r,d={},Object.keys(l).forEach(function(e){d[e]=l[e]}),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=c.slice().reverse().reduce(function(e,t){return t(s,u,e)||e},d),f&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(f):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,u,d),d=null),r));t.default=p});t(qj);var Vj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={people:{batcherWait:100,batcherMaxCalls:10,batcherMaxWait:1500,showAllTypes:!1}}});t(Vj),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(qj).default}});var r=i(qj),n=i(Vj);function i(e){return e&&e.__esModule?e:{default:e}}(0,eI.registerPlugin)("people",r.default,{config:n.default})}));var Bj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={phone:{audioBandwidthLimit:64e3,videoBandwidthLimit:1e6,enableExperimentalGroupCallingSupport:!1,hangupIfLastActive:{call:!0,meeting:!1}}}});t(Bj);var zj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StatsStream=t.StatsFilter=t.remoteParticipant=t.boolToStatus=t.Call=t.phoneEvents=void 0,Object.defineProperty(t,"phoneEvents",{enumerable:!0,get:function(){return Fj.events}}),Object.defineProperty(t,"Call",{enumerable:!0,get:function(){return i(xj).default}}),Object.defineProperty(t,"boolToStatus",{enumerable:!0,get:function(){return i(BN).default}}),Object.defineProperty(t,"remoteParticipant",{enumerable:!0,get:function(){return VN.remoteParticipant}}),Object.defineProperty(t,"StatsFilter",{enumerable:!0,get:function(){return i(Dj).default}}),Object.defineProperty(t,"StatsStream",{enumerable:!0,get:function(){return i(jj).default}});var r=i(Fj),n=i(Bj);function i(e){return e&&e.__esModule?e:{default:e}}t.default=r.default,(0,eI.registerPlugin)("phone",r.default,{config:n.default})});t(zj);zj.StatsStream,zj.StatsFilter,zj.remoteParticipant,zj.boolToStatus,zj.Call,zj.phoneEvents;var Hj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(MS),n=a(_y),i=a(NS),o=a(DS);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return(0,n.default)(this,t),(0,i.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,o.default)(t,e),t}(a(qb).default);t.default=new s});t(Hj);var Wj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.AUDIO="audio",t.AUDIO_BANDWIDTH_LIMIT="64000",t.AUDIO_INPUT="audioinput",t.AUDIO_STATUS="audioStatus",t.ALTERNATE_REDIRECT_TRUE="alternateRedirect=true",t.ANSWER="ANSWER",t.ALERT="alert",t.ACTIVE="ACTIVE",t.BUSY="BUSY",t.CALL="call",t.CREATED="CREATED",t.CONFLICT="CONFLICT",t.CORRELATION_ID="correlationId",t.CONVERSATION_URL="CONVERSATION_URL",t.CONVERSATIONS="conversations",t.CALENDAR="calendar",t.CALENDAR_EVENTS_API="calendarEvents",t.CMR_MEETINGS="cmrmeetings",t.CLAIM="claim",t.CONTROLS="controls",t.CONTENT="content",t.DEVELOPMENT="development",t.DECLINE="decline",t.ERROR="ERROR",t.GET="GET",t.HECATE="hecate",t.IDLE="IDLE",t.ICE_TIMEOUT=1e3,t.ICE_FAIL_TIMEOUT=3e3,t.IN_LOBBY="IN_LOBBY",t.IN_MEETING="IN_MEETING",t.INCOMING="INCOMING",t.INTENT_TO_JOIN=2423005,t.JOINED="JOINED",t.LEAVE="leave",t.LOCAL="local",t.LOCI="loci",t.LOCUS_ID="LOCUS_ID",t.LOCUS_URL="locusUrl",t.LEFT="LEFT",t.MEETING_LINK="MEETING_LINK",t.MEETINGS="Meetings",t.MEETING="MEETING",t.MEETING_CENTER="MEETING_CENTER",t.MEETING_ID="MEETING_ID",t.MEETINGINFO="meetingInfo",t.MEDIA_SIP_URI="MEDIA_SIP_URI",t.MEDIA="media",t.MODERATOR_TRUE=!0,t.MODERATOR_FALSE=!1,t.MEDIA_PEER_CONNECTION_NAME="MediaPeerConnection",t.NOT_IN_MEETING="NOT_IN_MEETING",t.NONE="NONE",t.ONE_ON_ONE="ONE_ON_ONE",t.OFFER="OFFER",t.OBSERVE="OBSERVE",t.OUTGOING="OUTGOING",t.ONLINE="online",t.OTHER="OTHER",t.PARTICIPANT="participant",t.PERSONAL_ROOM="PERSONAL_ROOM",t.PUT="PUT",t.POST="POST",t.RETRY_TIMEOUT=3e3,t.REMOTE="remote",t.REQUESTED="REQUESTED",t._ANSWER_="answer",t._ERROR_="error",t._DATA_="data",t._CLOSED_="closed",t.RTC_CONFIGURATION_FIREFOX={iceServers:[],bundlePolicy:"max-compat"},t.RTC_CONFIGURATION={iceServers:[]},t.RESOURCE_ROOM="RESOURCE_ROOM",t.READY="ready",t.RECEIVE_ONLY="RECVONLY",t.SIP_URI="SIP_URI",t.STOP="STOP",t.SHARE_PEER_CONNECTION_NAME="SharePeerConnection",t.SELF="SELF",t.SEND_RECEIVE="SENDRECV",t.TEMP_SIP_URI="TEMP_SIP_URI",t.TYPE="type",t.USE_URI_LOOKUP_FALSE="useUriLookup=false",t.USER="USER",t.UNKNOWN="UNKNOWN",t.VALID_PMR_ADDRESS=/([a-z0-9][-a-z0-9, '.']{0,62})@([a-z0-9][-a-z0-9, '.']{0,62})\.webex\.com/i,t.VALID_PMR_LINK=/(https:\/\/)?([a-z0-9][-a-z0-9, '.']{0,62})\.webex\.com\/(meet|join)\/([a-z0-9][-a-z0-9, '.']{0,62})\/?/i,t.VALID_PIN=/([0-9]{4,6})/,t.VIDEO="video",t.VIDEO_BANDWIDTH_LIMIT="4000000",t.VIDEO_INPUT="videoinput",t.VIDEO_STATUS="videoStatus",t.WEBEX_DOT_COM="webex.com",t.WEBEX_MEETING="WEBEX_MEETING",t.WAIT="WAIT",t.ERROR_DICTIONARY={INTENT_TO_JOIN:{NAME:"IntentToJoinError",MESSAGE:"The meeting is locked. This is expected behavior. Call #join again with hostPin and/or moderator option",CODE:1},JOIN_MEETING:{NAME:"JoinMeetingError",MESSAGE:"Meeting:index#join --\x3e Error joining the call on getLocalMedia",CODE:2},RECONNECTION:{NAME:"ReconnectionError",MESSAGE:"There was an error in the reconnection flow, the call may not reconnect, disconnect and dial again.",CODE:3}},t.API={CALLIOPEDISCOVERY:"calliopeDiscovery",LOCUS:"locus"},t.DIALER_REGEX={SIP_ADDRESS:/^(sips?)?:?(?:([^\s>:@]+)(?::([^\s@>]+))?@)([\w\-.]+)(?::(\d+))?((?:;[^\s=?>;]+(?:=[^\s?;]+)?)*)(?:\?(([^\s&=>]+=[^\s&=>]+)(&[^\s&=>]+=[^\s&=>]+)*))?$/,PHONE_NUMBER:/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/},t.CALENDAR_EVENTS={CREATE:"event:calendar.meeting.create",UPDATE:"event:calendar.meeting.update",CREATE_MINIMAL:"event:calendar.meeting.create.minimal",UPDATE_MINIMAL:"event:calendar.meeting.update.minimal",DELETE:"event:calendar.meeting.delete"},t.FLOOR_ACTION={GRANTED:"GRANTED",RELEASED:"RELEASED"},t.MEETING_STATE_MACHINE={TRANSITIONS:{ERROR:"error",START:"start",JOIN:"join",JOINED:"joined",LOCAL:"local",CONNECT:"connect",ESTABLISH:"establish",LEAVE:"leave",END:"end",CLEAN:"clean"},STATES:{IDLE:"IDLE",INCOMING:"INCOMING",DIALING:"DIALING",ON_GOING:"ON_GOING",CONNECTING_MEDIA_LOCAL:"CONNECTING_MEDIA_LOCAL",CONNECTING_MEDIA_REMOTE:"CONNECTING_MEDIA_REMOTE",ESTABLISHED_MEDIA:"ESTABLISHED_MEDIA",TERMINATING:"TERMINATING",ENDED:"ENDED",ERROR:"ERROR"}},t.LOCUS={STATE:{INACTIVE:"inactive"},SEQUENCE:{UN_DEF:"undef",EMPTY:"empty",DEF:"def",NA:"na",RANGE_START:"rangeStart",RANGE_END:"rangeEnd"},SYNCDEBUG:"sync_debug"},t.LOCUSEVENT={LOCUS_MERCURY:"event:locus",CONTROLS_UPDATED:"locus.controls_updated",DIFFERENCE:"locus.difference",FLOOR_GRANTED:"locus.floor_granted",FLOOR_RELEASED:"locus.floor_released",MESSAGE_ROAP:"locus.message.roap",PARTICIPANT_JOIN:"locus.participant_joined",PARTICIPANT_LEFT:"locus.participant_left",PARTICIPANT_DECLINED:"locus.participant_declined",PARTICIPANT_UPDATED:"locus.participant_updated",PARTICIPANT_CONTROLS_UPDATED:"locus.participant_controls_updated",PARTICIPANT_ROLES_UPDATED:"locus.participant_roles_updated",PARTICIPANT_AUDIO_MUTED:"locus.participant_audio_muted",PARTICIPANT_AUDIO_UNMUTED:"locus.participant_audio_unmuted",PARTICIPANT_VIDEO_MUTED:"locus.participant_video_muted",PARTICIPANT_VIDEO_UNMUTED:"locus.participant_video_unmuted",RECORDING_STARTED:"locus.recording_started",RECORDING_START_FAILED:"locus.recording_start_failed",RECORDING_STOPPED:"locus.recording_stopped",SELF_CHANGED:"locus.self_changed"},t.RECONNECTION={STATE:{IN_PROGRESS:"IN_PROGRESS",COMPLETE:"COMPLETE",FAILURE:"FAILURE",DEFAULT_TRY_COUNT:0,DEFAULT_STATUS:""}},t.EVENT_TRIGGERS={MEETINGS_READY:"meetings:ready",MEDIA_AUDIO_CHANGED:"media:audioChanged",MEDIA_VIDEO_CHANGED:"media:videoChanged",MEDIA_READY:"media:ready",MEDIA_STOPPED:"media:stopped",MEDIA_UPDATE:"media:update",STATS_UPDATE:"stats:update",MEETING_ADDED:"meeting:added",MEETING_REMOVED:"meeting:removed",MEETING_RINGING:"meeting:ringing",MEETING_SELF_LOBBY_WAITING:"meeting:self:lobbyWaiting",MEETING_SELF_GUEST_ADMITTED:"meeting:self:guestAdmitted",MEMBERS_UPDATE:"members:update",MEMBERS_CONTENT_UPDATE:"members:content:update",MEMBERS_HOST_UPDATE:"members:host:update",MEMBERS_SELF_UPDATE:"members:self:update",MEETING_RECONNECTION_STARTING:"meeting:reconnectionStarting",MEETING_RECONNECTION_SUCCESS:"meeting:reconnectionSuccess",MEETING_RECONNECTION_FAILURE:"meeting:reconnectionFailure"},t.EVENT_STATS_MAP={BYTES_SENT:"bytesSent",BYTES_RECEIVED:"bytesReceived"},t.EVENT_TYPES={SELF:"self",OTHER:"other",LOCAL:"local",REMOTE:"remote",REMOTE_SHARE:"remoteShare",LOCAL_SHARE:"localShare",ERROR:"error"},t.DELTAEVENT={GT:"GT",CF:"CF",EQ:"EQ",LT:"LT"},t.MEETING_AUDIO_STATE_MACHINE={TRANSITIONS:{TOGGLE:"toggle",INIT:"init"},STATES:{MUTE_SELF:"SELF_AUDIO_OFF",UNMUTE_SELF:"SELF_AUDIO_ON"}},t.MEETING_VIDEO_STATE_MACHINE={TRANSITIONS:{TOGGLE:"toggle",INIT:"init"},STATES:{MUTE_SELF:"SELF_VIDEO_OFF",UNMUTE_SELF:"SELF_VIDEO_ON"}},t.SDP={A_CONTENT_SLIDES:"a=content:slides",ROLLBACK:"rollback",HAVE_LOCAL_OFFER:"have-local-offer",STABLE:"stable",OFFER:"offer",M_LINE:"m=",MAX_FS_8160:"max-fs=8160",B_LINE:"b=TIAS",CARRIAGE_RETURN:"\r\n",BAD_MEDIA_PORTS:[9,0]},t.ICE_STATE={CHECKING:"checking",CONNECTED:"connected",FAILED:"failed",DISCONNECTED:"disconnected"},t.RESOURCE={CLUSTERS:"clusters",REACHABILITY:"reachability",LOCI:"loci"},t.REACHABILITY={localStorage:"reachability.result"},t.ROAP={ROAP_TRANSITIONS:{STEP:"step"},ROAP_TYPES:{OFFER:"OFFER",ANSWER:"ANSWER",OK:"OK",ERROR:"ERROR",SHUTDOWN:"SHUTDOWN",OFFER_REQUEST:"OFFER_REQUEST"},ROAP_STATE:{INIT:"INIT",WAIT_RX_OFFER:"WAIT_RX_OFFER",WAIT_RX_ANSWER:"WAIT_RX_ANSWER",WAIT_RX_OK:"WAIT_RX_OK",WAIT_TX_OFFER:"WAIT_TX_OFFER",WAIT_TX_ANSWER:"WAIT_TX_ANSWER",WAIT_TX_OK:"WAIT_TX_OK",IDLE_LOCAL_OFFER:"IDLE_LOCAL_OFFER",IDLE_REMOTE_OFFER:"IDLE_REMOTE_OFFER",GLARE:"GLARE",ERROR:"ERROR"},ROAP_SIGNAL:{RX_OFFER:"RX_OFFER",TX_OFFER:"TX_OFFER",RX_ANSWER:"RX_ANSWER",TX_ANSWER:"TX_ANSWER",RX_OK:"RX_OK",TX_OK:"TX_OK",GLARE_RESOLVED:"GLARE_RESOLVED"},RECEIVE_ROAP_MSG:"RECEIVE_ROAP_MSG",SEND_ROAP_MSG:"SEND_ROAP_MSG",SEND_ROAP_MSG_SUCCESS:"SEND_ROAP_MSG_SUCCESS",RESET_ROAP_STATE:"RESET_ROAP_STATE",RECEIVE_CALL_LEAVE:"RECEIVE_CALL_LEAVE",ROAP_MERCURY:"event:locus.message.roap",ROAP_VERSION:"2",RX_:"RX_",TX_:"TX_"},t.EVENTS={ROAP_OK:"ROAP_OK",ROAP_ANSWER:"ROAP_ANSWER",SELF_UNADMITTED_GUEST:"SELF_UNADMITTED_GUEST",SELF_ADMITTED_GUEST:"SELF_ADMITTED_GUEST",CONVERSATION_URL_UPDATE:"CONVERSATION_URL_UPDATE",DESTROY_MEETING_DECLINE_1_1:"DESTROY_MEETING_DECLINE_1_1",LOCUS_INFO_UPDATE_PARTICIPANTS:"LOCUS_INFO_UPDATE_PARTICIPANTS",LOCUS_INFO_UPDATE_HOST:"LOCUS_INFO_UPDATE_HOST",LOCUS_INFO_UPDATE_MEDIA_SHARES:"LOCUS_INFO_UPDATE_MEDIA_SHARES",LOCUS_INFO_UPDATE_SELF:"LOCUS_INFO_UPDATE_SELF",LOCUS_INFO_UPDATE_URL:"LOCUS_INFO_UPDATE_URL"},t.DEFAULT_GET_STATS_FILTER={types:["track","transport","candidate-pair","outbound-rtp","outboundrtp","inbound-rtp","inboundrtp"]},t.DEFAULT_EVENT_VIDEO_SEND_KEYS=["rtpOutVideo","rtcOutVideo","rtcTransVideo"],t.DEFAULT_EVENT_AUDIO_SEND_KEYS=["rtpOutAudio","rtcOutAudio","rtcTransAudio"],t.DEFAULT_EVENT_VIDEO_RECEIVE_KEYS=["rtpInVideo","rtcInVideo","rtcTransVideo"],t.DEFAULT_EVENT_AUDIO_RECEIVE_KEYS=["rtpInAudio","rtcInAudio","rtcTransAudio"],t.DEFAULT_TRANSFORM_KEYS=["rtpOutVideo","rtpOutAudio","rtpInVideo","rtpInAudio","rtcOutAudio","rtcOutVideo","rtcInAudio","rtcInVideo","rtcTransAudio","rtcTransVideo","rtcCandidatePairAudio","rtcCandidatePairVideo"],t.DEFAULT_TRANSFORM_REGEX={rtpOutVideo:{regex:new RegExp("^(?:RTC)?[Oo]utbound_?[Rr][Tt][Pp]_?[Vv]ideo")},rtpOutAudio:{regex:new RegExp("^(?:RTC)?[Oo]utbound_?[Rr][Tt][Pp]_?[Aa]udio")},rtpInVideo:{regex:new RegExp("^(?:RTC)?[Ii]nbound_?[Rr][Tt][Pp]_?[Vv]ideo")},rtpInAudio:{regex:new RegExp("^(?:RTC)?[Ii]nbound_?[Rr][Tt][Pp]_?[Aa]udio")},rtcOutAudio:{regex:new RegExp("^RTCMediaStreamTrack_(?:local|sender)_"),profiler:{type:"kind",value:"audio"}},rtcOutVideo:{regex:new RegExp("^RTCMediaStreamTrack_(?:local|sender)_"),profiler:{type:"kind",value:"video"}},rtcInAudio:{regex:new RegExp("^RTCMediaStreamTrack_(?:remote|receiver)_"),profiler:{type:"kind",value:"audio"}},rtcInVideo:{regex:new RegExp("^RTCMediaStreamTrack_(?:remote|receiver)_"),profiler:{type:"kind",value:"video"}},rtcTransAudio:{regex:new RegExp("^RTCTransport_[Aa]udio")},rtcTransVideo:{regex:new RegExp("^RTCTransport_[Vv]ideo")},rtcCandidatePairAudio:{regex:new RegExp("^RTCIceCandidatePair_"),decider:"nominated",selector:!0,profiler:{type:"transportId",value:"audio"}},rtcCandidatePairVideo:{regex:new RegExp("^RTCIceCandidatePair_"),decider:"nominated",selector:!0,profiler:{type:"transportId",value:"video"}}},t.DEFAULT_STATS_INTERVAL=1e3,t.DEFAULT_STATS_HISTORY_MAX=1800,t.DEFAULT_EXCLUDED_STATS=["timestamp","ssrc","priority"]});t(Wj);Wj.AUDIO,Wj.AUDIO_BANDWIDTH_LIMIT,Wj.AUDIO_INPUT,Wj.AUDIO_STATUS,Wj.ALTERNATE_REDIRECT_TRUE,Wj.ANSWER,Wj.ALERT,Wj.ACTIVE,Wj.BUSY,Wj.CALL,Wj.CREATED,Wj.CONFLICT,Wj.CORRELATION_ID,Wj.CONVERSATION_URL,Wj.CONVERSATIONS,Wj.CALENDAR,Wj.CALENDAR_EVENTS_API,Wj.CMR_MEETINGS,Wj.CLAIM,Wj.CONTROLS,Wj.CONTENT,Wj.DEVELOPMENT,Wj.DECLINE,Wj.ERROR,Wj.GET,Wj.HECATE,Wj.IDLE,Wj.ICE_TIMEOUT,Wj.ICE_FAIL_TIMEOUT,Wj.IN_LOBBY,Wj.IN_MEETING,Wj.INCOMING,Wj.INTENT_TO_JOIN,Wj.JOINED,Wj.LEAVE,Wj.LOCAL,Wj.LOCI,Wj.LOCUS_ID,Wj.LOCUS_URL,Wj.LEFT,Wj.MEETING_LINK,Wj.MEETINGS,Wj.MEETING,Wj.MEETING_CENTER,Wj.MEETING_ID,Wj.MEETINGINFO,Wj.MEDIA_SIP_URI,Wj.MEDIA,Wj.MODERATOR_TRUE,Wj.MODERATOR_FALSE,Wj.MEDIA_PEER_CONNECTION_NAME,Wj.NOT_IN_MEETING,Wj.NONE,Wj.ONE_ON_ONE,Wj.OFFER,Wj.OBSERVE,Wj.OUTGOING,Wj.ONLINE,Wj.OTHER,Wj.PARTICIPANT,Wj.PERSONAL_ROOM,Wj.PUT,Wj.POST,Wj.RETRY_TIMEOUT,Wj.REMOTE,Wj.REQUESTED,Wj._ANSWER_,Wj._ERROR_,Wj._DATA_,Wj._CLOSED_,Wj.RTC_CONFIGURATION_FIREFOX,Wj.RTC_CONFIGURATION,Wj.RESOURCE_ROOM,Wj.READY,Wj.RECEIVE_ONLY,Wj.SIP_URI,Wj.STOP,Wj.SHARE_PEER_CONNECTION_NAME,Wj.SELF,Wj.SEND_RECEIVE,Wj.TEMP_SIP_URI,Wj.TYPE,Wj.USE_URI_LOOKUP_FALSE,Wj.USER,Wj.UNKNOWN,Wj.VALID_PMR_ADDRESS,Wj.VALID_PMR_LINK,Wj.VALID_PIN,Wj.VIDEO,Wj.VIDEO_BANDWIDTH_LIMIT,Wj.VIDEO_INPUT,Wj.VIDEO_STATUS,Wj.WEBEX_DOT_COM,Wj.WEBEX_MEETING,Wj.WAIT,Wj.ERROR_DICTIONARY,Wj.API,Wj.DIALER_REGEX,Wj.CALENDAR_EVENTS,Wj.FLOOR_ACTION,Wj.MEETING_STATE_MACHINE,Wj.LOCUS,Wj.LOCUSEVENT,Wj.RECONNECTION,Wj.EVENT_TRIGGERS,Wj.EVENT_STATS_MAP,Wj.EVENT_TYPES,Wj.DELTAEVENT,Wj.MEETING_AUDIO_STATE_MACHINE,Wj.MEETING_VIDEO_STATE_MACHINE,Wj.SDP,Wj.ICE_STATE,Wj.RESOURCE,Wj.REACHABILITY,Wj.ROAP,Wj.EVENTS,Wj.DEFAULT_GET_STATS_FILTER,Wj.DEFAULT_EVENT_VIDEO_SEND_KEYS,Wj.DEFAULT_EVENT_AUDIO_SEND_KEYS,Wj.DEFAULT_EVENT_VIDEO_RECEIVE_KEYS,Wj.DEFAULT_EVENT_AUDIO_RECEIVE_KEYS,Wj.DEFAULT_TRANSFORM_KEYS,Wj.DEFAULT_TRANSFORM_REGEX,Wj.DEFAULT_STATS_INTERVAL,Wj.DEFAULT_STATS_HISTORY_MAX,Wj.DEFAULT_EXCLUDED_STATS;var Yj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=SI)&&r.__esModule?r:{default:r};var i={meetingInfos:{},get:function(e){return this.meetingInfos[e]?this.meetingInfos[e]:(0,n.default)(this.meetingInfos,function(t){return t.sipUrl===e||t.locusId===e||t.userId===e||t.meetingLink===e})},set:function(e,t){return this.meetingInfos[e]=t,this.meetingInfos[e]},getAll:function(){return this.meetingInfos}};t.default=i});t(Yj);var Xj=r(function(e){!function(){e.exports=function(e){return(e instanceof Ng?e:Ng.from(e.toString(),"binary")).toString("base64")}}()}),Jj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=Xj)&&r.__esModule?r:{default:r};var i={isMeetingLink:function(e){var t=/(.*).webex.com\/(?:meet|m)\/(.*)/.exec(e);return null!==t&&3===t.length},isSipUri:function(e){return Wj.DIALER_REGEX.SIP_ADDRESS.exec(e)},isPhoneNumber:function(e){return Wj.DIALER_REGEX.PHONE_NUMBER.test(e)},generateOptions:function(e){var t=e.destination,r=e.type,n=e.conversationServiceUrl;if(r)return{destination:t,type:r};var o={};return i.isMeetingLink(t)?(o.type=Wj.MEETING_LINK,o.destination=t):i.isSipUri(t)?(o.type=Wj.SIP_URI,o.destination=t):i.isPhoneNumber(t)?(o.type=Wj.SIP_URI,o.destination=t):(o.type=Wj.CONVERSATION_URL,o.destination=n+"/"+Wj.CONVERSATIONS+"/"+t),o},getResourceUrl:function(e,t){var r="/"+Wj.LOCI+"/"+Wj.MEETINGINFO,i=Wj.GET;switch(e){case Wj.SIP_URI:case Wj.PERSONAL_ROOM:case Wj.MEETING_ID:r="/"+Wj.LOCI+"/"+Wj.MEETINGINFO+"/"+t+"?"+Wj.TYPE+"="+e+"&"+Wj.USE_URI_LOOKUP_FALSE;break;case Wj.CONVERSATION_URL:i=Wj.PUT;break;case Wj.LOCUS_ID:r="/"+Wj.LOCI+"/"+t+"/"+Wj.MEETINGINFO,i=Wj.PUT;break;case Wj.MEETING_LINK:r="$/"+Wj.LOCI+"/"+Wj.MEETINGINFO+"/"+(0,n.default)(t)+"?"+Wj.TYPE+"="+Wj.MEETING_LINK+"&"+Wj.USE_URI_LOOKUP_FALSE}return{resource:r,method:i}},getRequestParams:function(e,t,r,n){var i={method:e.method,api:n,resource:e.resource};return e.method===Wj.GET?i.resource=i.resource.concat("&"+Wj.ALTERNATE_REDIRECT_TRUE):t!==Wj.LOCUS_ID&&(i.body={value:r,lookupType:t,alternateRedirect:!0}),i},getMeetingInfoAPIFormat:function(e){return{type:e.type,value:e.destination}}};t.default=i});t(Jj);var Kj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(MS),n=u(_y),i=u(Ty),o=u(NS),a=u(DS),s=u(Jj);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){var e,i,a,s;(0,n.default)(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=a=(0,o.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(c))),a.namespace=Wj.MEETINGS,s=i,(0,o.default)(a,s)}return(0,a.default)(t,e),(0,i.default)(t,[{key:"fetchMeetingInfo",value:function(e){if(!e||!e.type||!e.destination)throw new Error("MeetingInfo should be fetched with a type and destination specified, see list of valid types and their corresponding values in constants");var t=s.default.getMeetingInfoAPIFormat(e),r=s.default.getResourceUrl(t.type,t.value),n=s.default.getRequestParams(r,t.type,t.value,Wj.API.LOCUS);return this.request(n)}}]),t}(eI.StatelessSparkPlugin);t.default=c});t(Kj);var $j=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(MS),n=l(_y),i=l(Ty),o=l(NS),a=l(DS),s=l(Yj),u=l(Kj),c=l(Jj);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e,i){(0,n.default)(this,t);var a=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{},i));return a.namespace=Wj.MEETINGS,a.meetingInfoRequest=new u.default({},i),a}return(0,a.default)(t,e),(0,i.default)(t,[{key:"fetchMeetingInfo",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=c.default.generateOptions({destination:e,type:r,conversationServiceUrl:this.spark.internal.device.services.conversationServiceUrl});return this.meetingInfoRequest.fetchMeetingInfo(n).then(function(e){return t.setMeetingInfo(e.id,e),e}).catch(function(e){return e})}}],[{key:"getMeetingInfo",value:function(e){return s.default.get(e)}},{key:"setMeetingInfo",value:function(e,t){s.default.set(e,t)}}]),t}(eI.StatelessSparkPlugin);t.default=f});t($j);var Qj=function(e,t){if(null==e)return{};var r=uf(jp(e),function(e){return[e]});return t=_I(t),Kk(e,r,function(e,r){return t(e,r[0])})},Zj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(SI),n=i(Qj);function i(e){return e&&e.__esModule?e:{default:e}}var o={meetings:{},get:function(e){return this.meetings[e]},set:function(e){return this.meetings[e.id]=e,this.meetings[e.id]},remove:function(e){var t=this.meetings[e];return delete this.meetings[e],t},getAll:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{active:!1}).active?(0,n.default)(this.meetings,function(e){return e.active}):this.meetings},getByKey:function(e,t){return e&&t?(0,r.default)(this.meetings,function(r){return r[e]===t}):null}};t.default=o});t(Zj);var ex=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(Xk),n=a(Xl),i=a(tM),o=a(eM);function a(e){return e&&e.__esModule?e:{default:e}}var s={},u=function(e,t){var r=void 0;return r=-1!==e[t].search(Wj.AUDIO)?Wj.AUDIO_BANDWIDTH_LIMIT:Wj.VIDEO_BANDWIDTH_LIMIT,e.splice(t+1,0,Wj.SDP.B_LINE+":"+r),e},c=function(e){var t=e,r=e.match(/\na=fmtp:(\d+).*level-asymmetry-allowed=1.*/g);return r&&r.forEach(function(e){t=t.replace(e,e+";"+Wj.SDP.MAX_FS_8160)}),t},l=function(e){var t=e.match(/\nm=video.*/g),r=e.match(/\na=rtpmap:\d+\sH264.*/g);return!t||!!r},f=function(e){o.default.parse(e).media.forEach(function(e){return e.candidates&&0===e.candidates.length?(console.error("iceCandidate: Ice candadate never completed"),!1):Wj.SDP.BAD_MEDIA_PORTS.includes(e.port)?(console.error("iceCandidate: Found invalid port number for the ice candidate"),!1):!(!e.icePwd||!e.iceUfrag)||(console.error("iceCandidate: ice ufrag and password not found"),!1)})},d=function(e){for(var t=e,r=t.split(Wj.SDP.CARRIAGE_RETURN),n=0;n<r.length;n+=1)-1!==r[n].search(Wj.SDP.M_LINE)&&(r=u(r,n));return t=r.join(Wj.SDP.CARRIAGE_RETURN)};s.iceFailListener=function(e,t,r){e&&(e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case Wj.ICE_STATE.FAILED:case Wj.ICE_STATE.DISCONNECTED:console.error(r+" Interactive Connectivity Establishment(ICE)"+e.iceConnectionState+"!",new Date),setTimeout(function(){switch(e.iceConnectionState){case Wj.ICE_STATE.FAILED:case Wj.ICE_STATE.DISCONNECTED:t()}},Wj.ICE_FAIL_TIMEOUT)}})},s.detectFailures=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){console.error("Ice failed, no function to reconnect with.")};s.iceFailListener(e,r,Wj.MEDIA_PEER_CONNECTION_NAME),s.iceFailListener(t,r,Wj.SHARE_PEER_CONNECTION_NAME)},s.setContentSlides=function(e){return e&&e.sdp&&(e.sdp+=""+Wj.SDP.A_CONTENT_SLIDES+Wj.SDP.CARRIAGE_RETURN),e},s.iceCandidate=function(e){return new n.default(function(t){var r=setTimeout(function(){e.sdp=d(e.localDescription.sdp),e.sdp=c(e.sdp),e.sdp=e.sdp.replace(/\na=extmap.*/g,""),f(e.sdp)?t(e):setTimeout(function(){t(e)},Wj.RETRY_TIMEOUT)},Wj.ICE_TIMEOUT);e.onicecandidate=function(n){n.candidate||e.sdp||(e.sdp=d(e.localDescription.sdp),e.sdp=c(e.sdp),e.sdp=e.sdp.replace(/\na=extmap.*/g,""),null===n.candidate&&(f(e.sdp),clearTimeout(r),t(e)))}})},s.replaceTrack=function(e,t){try{var r=e.getSenders();r.length>0&&r.forEach(function(e){e.track&&e.track.kind===t.kind&&e.replaceTrack(t)})}catch(e){console.error("replaceTrack: Error while replacing Tracks ",e)}},s.addStream=function(e,t){console.info("addStream: adding streams to peerconnection");try{if(t&&!i.default.msedge){if(e.getSenders&&e.getSenders().find(function(e){return null!=e.track}))return void t.getTracks().forEach(function(t){s.replaceTrack(e,t)});t.getTracks().forEach(function(r){e.addTrack(r,t)})}else i.default.msedge?e.addStream(t):console.error("addStream: No streams to add")}catch(e){console.error("addStream: Error while adding Stream ",e)}},s.setRemoteSessionDetails=function(e,t,r){var i=e.sharePeerConnection;console.info("Setting the remote description type: "+t+"State: "+e.signalingState);var o=[],a=r,s=(a=a.replace(/\na=extmap.*/g,"")).split(Wj.SDP.M_LINE);if(4===s.length&&i){a=""+s[0]+Wj.SDP.M_LINE+s[1]+Wj.SDP.M_LINE+s[2];var u=""+s[0]+Wj.SDP.M_LINE+s[3];o.push(i.setRemoteDescription(new window.RTCSessionDescription({type:t,sdp:u})))}return(e.signalingState===Wj.SDP.HAVE_LOCAL_OFFER||e.signalingState===Wj.SDP.STABLE&&t===Wj.SDP.OFFER)&&o.push(e.setRemoteDescription(new window.RTCSessionDescription({type:t,sdp:a}))),n.default.all(o).catch(function(e){return console.error("Error setting the remoteDescription",e),n.default.reject(e)})},s.createOffer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.info("createOffer: creating a new offer");try{var t=e.peerConnection||new window.RTCPeerConnection(i.default.firefox?Wj.RTC_CONFIGURATION_FIREFOX:Wj.RTC_CONFIGURATION);e.streams&&(Array.isArray(e.streams)?s.addStream(t,e.streams[0]):s.addStream(t,e.streams));var r={offerToReceiveAudio:e.receiveAudio,offerToReceiveVideo:e.receiveVideo};return t.createOffer(r).then(function(e){return t.setLocalDescription(e)}).then(function(){return s.iceCandidate(t)}).then(function(){if(t.sdp=d(t.localDescription.sdp),t.sdp=c(t.sdp),!l(t.sdp))throw new Error("openH264 is downloading please Wait. Upload logs if not working on second try");return t.sdp=t.sdp.replace(/\na=extmap.*/g,""),t}).catch(function(e){throw s.close(t),e})}catch(e){throw console.error("createOffer: error while creating a offer ",e),e}},s.rollBackLocalDescription=function(e){return console.info("rollBackLocalDescription: rollingbacking peerconnection"),e.setLocalDescription(new RTCSessionDescription({type:Wj.SDP.ROLLBACK})).then(function(){return e}).catch(function(e){return console.error("rollBackLocalDescription: Error while setting the Local Description ",e),n.default.error(e)})},s.updatePeerConnection=function(e){console.info("updatePeerConnection: updating the pc");var t=e.pc,i=e.sharePeerConnection,o={offerToReceiveAudio:!1,offerToReceiveVideo:!0},a={offerToReceiveAudio:e.offerToReceiveAudio,offerToReceiveVideo:e.offerToReceiveVideo};return void 0===t&&i?s.createAnswer({pc:i,screenConstraints:o,offerSdp:e.offerSdp[0]}).then(function(e){return e.sdp+=""+Wj.SDP.A_CONTENT_SLIDES+Wj.SDP.CARRIAGE_RETURN,[e.sdp]}):n.default.all([s.createAnswer({pc:t,sdpConstraints:a,offerSdp:e.offerSdp[0]}),s.createAnswer({pc:i,offerSdp:e.offerSdp[1],sdpConstraints:o})]).then(function(e){var t=(0,r.default)(e,2),n=t[0],o=t[1];return i.sdp+=""+Wj.SDP.A_CONTENT_SLIDES+Wj.SDP.CARRIAGE_RETURN,[n.sdp,o.sdp]})},s.createAnswer=function(e){var t=e.pc;return"have-remote-offer"===t.signalingState?n.default.resolve(t):s.setRemoteSessionDetails(t,"offer",e.offerSdp).then(function(){return t.createAnswer(e.sdpConstraints)}).then(function(e){return t.setLocalDescription(e)}).then(function(){return s.iceCandidate(t)}).then(function(){if(t.sdp=d(t.localDescription.sdp),t.sdp=c(t.sdp),!l(t.sdp))throw new Error("openH264 is downloading please Wait. Upload logs if not working on second try");return t.sdp=t.sdp.replace(/\na=extmap.*/g,""),t}).catch(function(e){console.error("updatePeerConnection: error while updating the PC ",e)})},s.close=function(e){return console.info("PC: close() -> closing the mediaPeerConnection"),n.default.resolve().then(function(){e&&e.close?e.close():console.warn("Peer connection has no close")}).catch(function(e){console.error("Error Cleaning Up the PeerConnection",e)})},t.default=s});t(ex);var tx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(Xl),n=i(ex);function i(e){return e&&e.__esModule?e:{default:e}}var o={},a=Wj.ANSWER.toLowerCase();o.shouldHandleMedia=function(e){var t=e.mediaProperties.mediaPeerConnection&&e.mediaProperties.mediaPeerConnection.signalingState===Wj.SDP.HAVE_LOCAL_OFFER,r=e.mediaProperties.sharePeerConnection&&e.mediaProperties.sharePeerConnection.signalingState===Wj.SDP.HAVE_LOCAL_OFFER;return!t&&!r},o.handleError=function(e){return n.default.rollBackLocalDescription({mediaPeerConnection:e}).then(function(){return r.default.resolve(!0)}).catch(function(e){return r.default.reject(e)})},o.findError=function(e,t,r){return(r===Wj.ROAP.RECEIVE_ROAP_MSG||r===Wj.ROAP.SEND_ROAP_MSG)&&e===Wj.ERROR&&t===Wj.CONFLICT},o.ensureMeeting=function(e,t){return!!(t!==Wj.ROAP.RECEIVE_ROAP_MSG&&t!==Wj.ROAP.SEND_ROAP_MSG&&t!==Wj.ROAP.SEND_ROAP_MSG_SUCCESS||e)},o.compareLastRemoteOffer=function(e,t){var r=void 0,n=void 0,i=!1;return t.length>0&&t.length===e.length&&(console.log("previous offer",t[0].slice(0,20)),console.log("current offer",e[0].slice(0,20)),t.forEach(function(t,o){r=t.indexOf("IN"),n=e[o].indexOf("IN"),t.substring(r)!==e[o].substring(n)&&(i=!0)})),i},o.updatePeerConnection=function(e,t){if(!o.compareLastRemoteOffer(t.OFFER.sdps,e.roap.lastRoapOffer)){var i=[];return e.mediaProperties.mediaPeerConnection&&i.push(e.mediaProperties.mediaPeerConnection.sdp),e.mediaProperties.sharePeerConnection&&i.push(e.mediaProperties.sharePeerConnection.sdp),r.default.resolve(i)}return n.default.updatePeerConnection({offerSdp:t.OFFER.sdps,pc:e.mediaProperties.mediaPeerConnection,sharePeerConnection:e.mediaProperties.sharePeerConnection,offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(function(r){return e.roap.lastRoapOffer=t.OFFER.sdps,r})},o.setRemoteDescription=function(e,t){if(console.info("Call-RoapHandler: Transmite WAIT_TX_OK",e.correlationId),!e||!e.mediaProperties.mediaPeerConnection&&!e.mediaProperties.sharePeerConnection)return console.error("Call-RoapHandler: DANGER no media or screen peer connection",e.correlationId),r.default.reject(new Error("Must provide a media or screen peer connection"));var i=void 0;return e.mediaProperties.mediaPeerConnection&&e.mediaProperties.sharePeerConnection?i=r.default.all([n.default.setRemoteSessionDetails(e.mediaProperties.mediaPeerConnection,a,t.ANSWER.sdps[0],e.clientIdentifiers),n.default.setRemoteSessionDetails(e.mediaProperties.sharePeerConnection,a,t.ANSWER.sdps[1],e.clientIdentifiers)]):e.mediaProperties.sharePeerConnection&&(i=n.default.setRemoteSessionDetails(e.mediaProperties.sharePeerConnection,a,t.ANSWER.sdps[0],e.clientIdentifiers)),i.then(function(){return console.info("Call-RoapHandler: setRemote Description successfull",e.correlationId),{seq:t.ANSWER.seq,locusId:e.locusId,locusSelfId:e.locusInfo.self.id,mediaId:e.mediaId,correlationId:e.correlationId}}).catch(function(e){throw console.error("Call-RoapHandler: Error setting remote and sending Roap Message",e),e})},t.default=o});t(tx);var rx=r(function(e,t){var r;r=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){e.exports=function(e,t){var r,n,i;for(r=1;r<arguments.length;r++)for(i in n=arguments[r])n.hasOwnProperty(i)&&(e[i]=n[i]);return e}},function(e,t,r){var n=r(0);e.exports={build:function(e,t){var r,i,o,a=t.plugins;for(r=0,i=a.length;r<i;r++)(o=a[r]).methods&&n(e,o.methods),o.properties&&Object.defineProperties(e,o.properties)},hook:function(e,t,r){var n,i,o,a,s=e.config.plugins,u=[e.context];for(r&&(u=u.concat(r)),n=0,i=s.length;n<i;n++)a=s[n],(o=s[n][t])&&o.apply(a,u)}}},function(e,t,r){function n(e){if(0===e.length)return e;var t,r,n=e.split(/[_-]/);if(1===n.length&&n[0][0].toLowerCase()===n[0][0])return e;for(r=n[0].toLowerCase(),t=1;t<n.length;t++)r=r+n[t].charAt(0).toUpperCase()+n[t].substring(1).toLowerCase();return r}n.prepended=function(e,t){return e+(t=n(t))[0].toUpperCase()+t.substring(1)},e.exports=n},function(e,t,r){var n=r(0),i=r(2);function o(e,t){e=e||{},this.options=e,this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}n(o.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=i.prepended("onEnter",e),this.lifecycle.onLeave[e]=i.prepended("onLeave",e),this.lifecycle.on[e]=i.prepended("on",e)},addTransition:function(e){this.transitions.indexOf(e)<0&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=i.prepended("onBefore",e),this.lifecycle.onAfter[e]=i.prepended("onAfter",e),this.lifecycle.on[e]=i.prepended("on",e)},mapTransition:function(e){var t=e.name,r=e.from,n=e.to;return this.addState(r),"function"!=typeof n&&this.addState(n),this.addTransition(t),this.map[r][t]=e,e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"==typeof e?this.mapTransition(n({},this.defaults.init,{to:e,active:!0})):"object"==typeof e?this.mapTransition(n({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"==typeof e?e:"object"==typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var r,n,i;for(r=0,n=(e=e||[]).length;r<n;r++)"function"==typeof(i=e[r])&&(e[r]=i=i()),i.configure&&i.configure(this);return e},configureTransitions:function(e){var t,r,n,i,o,a=this.defaults.wildcard;for(r=0;r<e.length;r++)for(n=e[r],i=Array.isArray(n.from)?n.from:[n.from||a],o=n.to||a,t=0;t<i.length;t++)this.mapTransition({name:n.name,from:i[t],to:o})},transitionFor:function(e,t){var r=this.defaults.wildcard;return this.map[e][t]||this.map[r][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=o},function(e,t,r){var n=r(0),i=r(6),o=r(1),a=[null,[]];function s(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}n(s.prototype,{init:function(e){if(n(this.context,this.config.data.apply(this.context,e)),o.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?e.indexOf(this.state)>=0:this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var r=this.config.defaults.wildcard,n=this.config.transitionFor(this.state,e),i=n&&n.to;return"function"==typeof i?i.apply(this.context,t):i===r?this.state:i},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,r,n){var i=this.config.lifecycle,o=this.config.options.observeUnchangedState||t!==r;return r?this.isPending()?this.context.onPendingTransition(e,t,r):(this.config.addState(r),this.beginTransit(),n.unshift({transition:e,from:t,to:r,fsm:this.context}),this.observeEvents([this.observersForEvent(i.onBefore.transition),this.observersForEvent(i.onBefore[e]),o?this.observersForEvent(i.onLeave.state):a,o?this.observersForEvent(i.onLeave[t]):a,this.observersForEvent(i.on.transition),o?["doTransit",[this]]:a,o?this.observersForEvent(i.onEnter.state):a,o?this.observersForEvent(i.onEnter[r]):a,o?this.observersForEvent(i.on[r]):a,this.observersForEvent(i.onAfter.transition),this.observersForEvent(i.onAfter[e]),this.observersForEvent(i.on[e])],n)):this.context.onInvalidTransition(e,t,r)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,r=0,n=this.observers.length,i=[];r<n;r++)(t=this.observers[r])[e]&&i.push(t);return[e,i,!0]},observeEvents:function(e,t,r,n){if(0===e.length)return this.endTransit(void 0===n||n);var i=e[0][0],a=e[0][1],s=e[0][2];if(t[0].event=i,i&&s&&i!==r&&o.hook(this,"lifecycle",t),0===a.length)return e.shift(),this.observeEvents(e,t,i,n);var u=a.shift(),c=u[i].apply(u,t);return c&&"function"==typeof c.then?c.then(this.observeEvents.bind(this,e,t,i)).catch(this.failTransit.bind(this)):!1===c?this.endTransit(!1):this.observeEvents(e,t,i,c)},onInvalidTransition:function(e,t,r){throw new i("transition is invalid in current state",e,t,r,this.state)},onPendingTransition:function(e,t,r){throw new i("transition is invalid while previous transition is still in progress",e,t,r,this.state)}}),e.exports=s},function(e,t,r){var n=r(0),i=r(2),o=r(1),a=r(3),s=r(4),u={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,r){return this._fsm.onInvalidTransition(e,t,r)},onPendingTransition:function(e,t,r){return this._fsm.onPendingTransition(e,t,r)}},c={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};function l(e){return f(this||{},e)}function f(e,t){return d(e,new a(t,l)),e._fsm(),e}function d(e,t){if("object"!=typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");o.build(e,t),Object.defineProperties(e,c),n(e,u),n(e,t.methods),t.allTransitions().forEach(function(t){e[i(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}}),e._fsm=function(){this._fsm=new s(this,t),this._fsm.init(arguments)}}l.version="3.0.1",l.factory=function(){var e,t;"function"==typeof arguments[0]?(e=arguments[0],t=arguments[1]||{}):(e=function(){this._fsm.apply(this,arguments)},t=arguments[0]||{});var r=new a(t,l);return d(e.prototype,r),e.prototype._fsm.config=r,e},l.apply=f,l.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=l},function(e,t,r){e.exports=function(e,t,r,n,i){this.message=e,this.transition=t,this.from=r,this.to=n,this.current=i}}])},e.exports=r()});t(rx);var nx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=rx)&&r.__esModule?r:{default:r};var i={createState:function(){return new(n.default.factory({init:Wj.ROAP.ROAP_STATE.INIT,transitions:[{name:Wj.ROAP.ROAP_TRANSITIONS.STEP,from:"*",to:function(e,t,r){var n=this.state;return function(e,t){var r=e.msg.messageType;if(t){if(r===Wj.OFFER&&e.remote&&t.shareStatus===Wj.REQUESTED)return!1;if(!t.mediaProperties.mediaPeerConnection&&!t.mediaProperties.sharePeerConnection&&r===Wj.ANSWER)return!1}return console.info("Call-RoapHandler: success save proceeding with transition, ",e.msg),!0}(r,t)?function(e,t,r){switch(e){case Wj.ROAP.ROAP_STATE.INIT:return t===Wj.ROAP.ROAP_SIGNAL.RX_OFFER?Wj.ROAP.ROAP_STATE.WAIT_TX_ANSWER:t===Wj.ROAP.ROAP_SIGNAL.TX_OFFER?Wj.ROAP.ROAP_STATE.WAIT_RX_ANSWER:e;case Wj.ROAP.ROAP_STATE.WAIT_RX_OFFER:return e;case Wj.ROAP.ROAP_STATE.WAIT_RX_ANSWER:return t===Wj.ROAP.ROAP_SIGNAL.RX_ANSWER?r.mediaId?Wj.ROAP.ROAP_STATE.WAIT_TX_OK:(console.error("Call-RoapHandler#Race Condition no mediaId"),e):t===Wj.ROAP.ROAP_SIGNAL.RX_OFFER?Wj.ROAP.ROAP_STATE.GLARE:e;case Wj.ROAP.ROAP_STATE.WAIT_TX_OFFER:return e;case Wj.ROAP.ROAP_STATE.WAIT_TX_ANSWER:return t===Wj.ROAP.ROAP_SIGNAL.TX_ANSWER?Wj.ROAP.ROAP_STATE.WAIT_RX_OK:e;case Wj.ROAP.ROAP_STATE.WAIT_TX_OK:return t===Wj.ROAP.ROAP_SIGNAL.TX_OK?Wj.ROAP.ROAP_STATE.INIT:e;case Wj.ROAP.ROAP_STATE.WAIT_RX_OK:return t===Wj.ROAP.ROAP_SIGNAL.RX_OK?Wj.ROAP.ROAP_STATE.INIT:e;case Wj.ROAP.ROAP_STATE.ERROR:return Wj.ROAP.ROAP_STATE.INIT;case Wj.ROAP.ROAP_STATE.GLARE:return Wj.ROAP.ROAP_STATE.WAIT_RX_ANSWER;default:return e}}(n,e,t):n}}],methods:{onAfterStep:function(e){console.log("roap:state#onAfterStep->"+e.event+" fired! State changed from '"+e.from+"' to '"+e.to+"' with transition '"+e.transition+"''.")}}}))}};t.default=i});t(nx);var ix=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=nx)&&r.__esModule?r:{default:r};var i={sessions:{},getSession:function(e){return this.sessions[e]||(this.sessions[e]={}),this.sessions[e]},deleteSession:function(e){this.getSession(e)&&delete this.sessions[e]},getSessionSequence:function(e,t){var r=this.getSession(e);return r[t]||(r[t]={},r[t].state=n.default.createState()),r[t]},deleteSessionSequence:function(e,t){this.getSessionSequence(e,t)&&delete this.sessions[e][t]}};t.default=i});t(ix);var ox=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=d(MS),n=d(_y),i=d(Ty),o=d(NS),a=d(DS),s=d(sf),u=d(Zj),c=d(Hj),l=d(tx),f=d(ix);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(){return(0,n.default)(this,t),(0,o.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),(0,i.default)(t,[{key:"perform",value:function(e,t,r){var n=this;switch(e.state.state){case Wj.ROAP.ROAP_STATE.WAIT_TX_ANSWER:l.default.shouldHandleMedia(t)&&l.default.updatePeerConnection(t,e).then(function(r){c.default.emit(Wj.EVENTS.ROAP_ANSWER,{locusId:t.locusId,locusSelfId:t.locusInfo.self.id,mediaId:t.mediaId,sdps:r,seq:e.OFFER.seq,correlationId:t.correlationId,audioMuted:t.isAudioMuted(),videoMuted:t.isVideoMuted()})}).catch(function(e){n.logger.error(e)});break;case Wj.ROAP.ROAP_STATE.WAIT_TX_OK:l.default.setRemoteDescription(t,e).then(function(e){c.default.emit(Wj.EVENTS.ROAP_OK,e)});break;case Wj.ROAP.ROAP_STATE.ERROR:this.logger.error("Call-RoapHandler#ERROR state=error",e);break;case Wj.ROAP.ROAP_STATE.GLARE:e.GLARE_OFFER.tieBreaker=e.GLARE_OFFER.tieBreaker||0,e.OFFER.tieBreaker=e.OFFER.tieBreaker||0,this.logger.error("Resolve the GLARE condition"),e.GLARE_OFFER.tieBreaker<e.OFFER.tieBreaker?this.logger.error("local offer wins"):this.logger.error("remote offer wins",e),e.state.step(Wj.ROAP.ROAP_SIGNAL.GLARE_RESOLVED,t,r),this.perform(e,t)}}},{key:"execute",value:function(e,t,r,n,i){t&&t.state&&(!function(e,t){var r=e.msg,n=r.seq,i=r.messageType;t.OFFER&&i===Wj.OFFER?(t.GLARE_OFFER=e.msg,t.GLARE_OFFER.remote=!!e.remote,console.info("Its a GLARE condition seq:"+n+" new mercury event")):(console.info("Save OFFER/ANSWER seq:"+n+" new mercury event "+i+"local state: "+(0,s.default)(t.state.state,null,2)),t[i]=e.msg,t[i].remote=!!e.remote)}(r,t),e=Wj.ROAP.ROAP_SIGNAL[""+i+r.msg.messageType],t.state.step(e,n,r),this.perform(t,n,r))}},{key:"handleAction",value:function(e,t,r,n){var i=void 0;switch(t.type){case Wj.ROAP.RECEIVE_ROAP_MSG:t.remote=!0,this.execute(i,e,t,r,Wj.ROAP.RX_);break;case Wj.ROAP.SEND_ROAP_MSG:t.local=!0,this.execute(i,e,t,r,Wj.ROAP.TX_);break;case Wj.ROAP.SEND_ROAP_MSG_SUCCESS:f.default.getSessionSequence(n,t.seq).ANSWER&&(i=Wj.ROAP.ROAP_SIGNAL.RX_ANSWER);break;case"RECEIVE_CALL_LEAVE":f.default.deleteSession(n),console.info("Call-this#RECEIVE_CALL_LEAVE: cleaning up the RoapHandler",n);break;case Wj.ROAP.RESET_ROAP_STATE:f.default.deleteSessionSequence(n,t.msg.seq),console.info("Call-RoapHandler#RESET_ROAP_STATE: resetting the RoapHandler state",t.msg.seq);break;default:return!0}return!0}},{key:"submit",value:function(e){var t=e.correlationId,r=f.default.getSessionSequence(t,e.seq||e.msg.seq),n=u.default.get(t);return!!function(e,t,r){if(e&&e.type){if(e.msg&&e.msg.messageType&&e.msg.errorType&&l.default.findError(e.msg.messageType,e.msg.errorType,e.type))return l.default.handleError(t.mediaProperties.mediaPeerConnection).then(function(t){t&&f.default.deleteSessionSequence(r,e.msg.seq)}).catch(function(e){(void 0).logger.info("Cannot reset the peer connection",e)}),!0;if(!l.default.ensureMeeting(t,e.type))return!0}return!1}(e,n,t)||this.handleAction(r,e,n,t)}}]),t}(eI.StatelessSparkPlugin);t.default=p});t(ox);var ax=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(sf),n=l(Xl),i=l(Ow),o=l(MS),a=l(_y),s=l(Ty),u=l(NS),c=l(DS);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,a.default)(this,t),(0,u.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,s.default)(t,[{key:"attachRechabilityData",value:function(e){var t=window.localStorage.getItem(Wj.REACHABILITY.localStorage);if(t)try{var r=JSON.parse(t);r&&(0,i.default)(r).length&&(e.reachability=r)}catch(e){console.error("Exception in parsing reachability data : "+e)}return e}},{key:"joinMeetingWithRoap",value:function(e){var t=this;return this.logger.info("Call->Locus: Join locus with roap"),this.logger.info("Call-local SDP",e.roapMessage),n.default.resolve().then(function(){var n="",i={deviceUrl:t.spark.internal.device.url,usingResource:e.resourceId||null,correlationId:e.correlationId,localMedias:[{localSdp:(0,r.default)(t.attachRechabilityData({roapMessage:e.roapMessage,audioMuted:!1,videoMuted:!1}))}]};if(e.locusUrl)n=e.locusUrl+"/"+Wj.PARTICIPANT;else{if(!e.sipUrl)throw new Error("Must provide a locusUrl or sipTarget");n=t.spark.internal.device.services.locusServiceUrl+"/"+Wj.LOCI+"/"+Wj.CALL,i.invitee={address:e.sipTarget}}return t.spark.request({method:Wj.POST,uri:n,body:i}).then(function(r){var n=r.body.locus;return n.roapSeq=e.roapMessage.seq,n.id=n.url.split("/").pop(),t.logger.info("Call-Locus->App: Joined locus ["+n.id+"]["+n.fullState.lastActive+"]"),n}).catch(function(e){throw t.logger.error("MeetingAdapter#joinMeetingWithRoap failed",e),e})})}},{key:"sendRoap",value:function(e){var t=this,n=e.roapMessage,i=e.locusId,o=e.locusSelfId,a=e.mediaId,s=e.correlationId;a||this.logger.info("Race Condition /call mediaID not present");var u=Wj.LOCI+"/"+i+"/"+Wj.PARTICIPANT+"/"+o+"/"+Wj.MEDIA,c=this.spark.internal.device.url;return this.logger.info("Call-sendRoap: "+u+" \n "+n.messageType+" \n seq:"+n.seq),this.spark.request({api:Wj.API.LOCUS,resource:u,method:Wj.PUT,body:{deviceUrl:c,correlationId:s,localMedias:[{localSdp:(0,r.default)(this.attachRechabilityData({roapMessage:n,audioMuted:!!e.audioMuted,videoMuted:!!e.audioVideo})),mediaId:e.mediaId}]}}).then(function(n){var i=n.body.mediaConnections&&n.body.mediaConnections.length>0&&n.body.mediaConnections[0];t.logger.info("Call-sendRoap:response:"+(0,r.default)(i,null,2)+"'\n StatusCode:'"+n.statusCode);var o=n.body.locus;return o.roapSeq=e.roapMessage.seq,o}).catch(function(i){throw t.logger.error("Call-sendRoap Error:"+(0,r.default)(i,null,2)),t.logger.error("Call-sendRoap errorBody:"+(0,r.default)(n,null,2)+" + '\\n mediaId:'"+e.mediaId),i})}}]),t}(eI.StatelessSparkPlugin);t.default=f});t(ax);var sx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=h(aR),n=h(Xl),i=h(sf),o=h(MS),a=h(_y),s=h(Ty),u=h(NS),c=h(DS),l=h(Zj),f=h(Hj),d=h(ox),p=h(ax);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e,r){(0,a.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,o.default)(t)).call(this,{},r));return n.roapHandler=new d.default({},r),n.roapRequest=new p.default({},r),n.lastRoapOffer={},f.default.on(Wj.EVENTS.ROAP_OK,n.sendRoapOK.bind(n)),f.default.on(Wj.EVENTS.ROAP_ANSWER,n.sendRoapAnswer.bind(n)),n}return(0,c.default)(t,e),(0,s.default)(t,[{key:"roapEvent",value:function(e){var t=e.message,r=e.correlationId;console.log("Call-Mercury->-App: receives Roap Message ["+(0,i.default)(t,null,2)+"]"),this.roapHandler.submit({type:Wj.ROAP.RECEIVE_ROAP_MSG,msg:t,correlationId:r})}},{key:"stop",value:function(e,t){return this.roapHandler.submit({type:Wj.ROAP.RECEIVE_CALL_LEAVE,seq:t,correlationId:e}),n.default.resolve()}},{key:"sendRoapOK",value:function(e){var t=this;return n.default.resolve().then(function(){var r=l.default.get(e.correlationId),n={messageType:Wj.ROAP.ROAP_TYPES.OK,version:Wj.ROAP.ROAP_VERSION,seq:e.seq};return console.log("ROAP:sendRoapOK ",e.seq),t.roapRequest.sendRoap({roapMessage:n,locusId:e.locusId,locusSelfId:e.locusSelfId,mediaId:e.mediaId,correlationId:e.correlationId,audioMuted:r.isAudioMuted(),videoMuted:r.isVideoMuted()}).then(function(){t.roapHandler.submit({type:Wj.ROAP.SEND_ROAP_MSG,msg:n,correlationId:e.correlationId}),console.log("ROAP:sendRoapOK out",e.seq),r.setRoapSeq(e.seq)})})}},{key:"sendRoapAnswer",value:function(e){var t=this,r=l.default.get(e.correlationId),n={messageType:Wj.ROAP.ROAP_TYPES.ANSWER,sdps:e.sdps,version:Wj.ROAP.ROAP_VERSION,seq:e.seq};return this.roapRequest.sendRoap({roapMessage:n,locusId:e.locusId,locusSelfId:e.locusSelfId,mediaId:e.mediaId,correlationId:e.correlationId,audioMuted:e.audioMuted,videoMuted:e.videoMuted}).then(function(){r.setRoapSeq(e.seq),t.roapHandler.submit({type:Wj.ROAP.SEND_ROAP_MSG,msg:n,correlationId:e.correlationId})})}},{key:"sendRoapError",value:function(e,t,r){var n={messageType:Wj.ROAP.ROAP_TYPES.ERROR,version:Wj.ROAP.ROAP_VERSION,errorType:r,seq:e.OFFER.seq};return this.roapRequest.sendRoap(n,t)}},{key:"sendRoapMediaRequest",value:function(e){var t=this,n=e.meeting,i={messageType:Wj.ROAP.ROAP_TYPES.OFFER,sdps:e.sdps,version:Wj.ROAP.ROAP_VERSION,seq:"number"!=typeof e.roapSeq&&(0,r.default)(parseFloat(e.roapSeq))?0:e.roapSeq+1,tieBreaker:4294967294};return this.roapHandler.submit({type:Wj.ROAP.SEND_ROAP_MSG,msg:i,correlationId:n.correlationId}),this.roapRequest.sendRoap({roapMessage:i,correlationId:n.correlationId,locusId:n.locusId,locusSelfId:n.selfId,mediaId:n.mediaId,audioMuted:n.isAudioMuted(),videoMuted:n.isVideoMuted()}).then(function(e){return t.roapHandler.submit({type:Wj.ROAP.SEND_ROAP_MSG_SUCCESS,seq:i.seq,correlationId:n.correlationId}),n.setRoapSeq(i.seq),e})}}]),t}(eI.StatelessSparkPlugin);t.default=v});t(sx);var ux=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Xl),n=o(sf),i=o(Xk);function o(e){return e&&e.__esModule?e:{default:e}}var a={setLocalTracks:function(e,t,r){a.setLocalAudioTracks(e,r),a.setLocalVideoTracks(t,r)},setLocalAudioTracks:function(e,t){if(t&&t.getAudioTracks){var r=t.getAudioTracks(),n=(0,i.default)(r,1)[0];if(n)return n.enabled=!e.mute,!0}return!1},setLocalVideoTracks:function(e,t){if(t&&t.getVideoTracks){var r=t.getVideoTracks(),n=(0,i.default)(r,1)[0];if(n)return n.enabled=!e.mute,!0}return!1},generateLocalMedias:function(e,t,r){return e?[{localSdp:(0,n.default)({audioMuted:t.mute,videoMuted:r.mute}),mediaId:e}]:[]},getLocalMedia:function(e){var t=e.sendAudio,n=e.sendVideo,i=e.sendShare;return t||n?a.getMedia(t,n):i?a.getDisplayMedia({sendAudio:!1,sendShare:!0}):r.default.resolve(void 0)},attachMedia:function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=[];return e.receiveVideo||e.receiveAudio||n?a.push(t.createOffer({receiveAudio:e.receiveAudio,receiveVideo:e.receiveVideo,streams:n,peerConnection:o.mediaPeerConnection})):a.push(void 0),(e.receiveShare||i)&&a.push(t.createOffer({receiveAudio:!1,receiveVideo:e.receiveShare,streams:i,peerConnection:o.sharePeerConnection})),r.default.all(a)},getDisplayMedia:function(e){return navigator.mediaDevices.getDisplayMedia({audio:e.sendAudio,video:e.sendScreen})},getMedia:function(e,t){var n={audio:e,video:t};return new r.default(function(e,t){navigator.mediaDevices.getUserMedia(n).then(function(t){e(t)}).catch(function(e){t(new Error({name:e.name,localMediaFailed:!0,cameraFailed:e===n.permissionDenied}))})})},getSupportedDevice:function(e){var t=e.sendAudio,n=e.sendVideo;return r.default.resolve().then(function(){return navigator.mediaDevices&&void 0!==navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(function(e){var r={audio:e.filter(function(e){return e.kind===Wj.AUDIO_INPUT}).length>0,video:e.filter(function(e){return e.kind===Wj.VIDEO_INPUT}).length>0};return{sendAudio:r.audio&&t||!0,sendVideo:r.video&&n||!0}}):{sendAudio:!0,sendVideo:!0}})},toggleStream:function(){},stopStream:function(e){return e?r.default.resolve().then(function(){e.getTracks?e.getTracks().forEach(function(e){e.stop()}):e.stop&&e.stop()}):r.default.resolve()},getUserMedia:function(e){return a.getLocalMedia({sendAudio:e.sendAudio,sendVideo:e.sendVideo}).then(function(t){return a.getLocalMedia({sendShare:e.sendShare}).then(function(e){return[t,e]})})}};t.default=a});t(ux);var cx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(_y),n=i(Ty);function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.default)(this,e),this.namespace=Wj.MEETINGS,this.mediaDirection=t.mediaDirection,this.mediaPeerConnection=t.mediaPeerConnection,this.sharePeerConnection=t.sharePeerConnection,this.localStream=t.localStream,this.localShare=t.localShare,this.remoteStream=t.remoteStream,this.remoteShare=t.remoteShare}return(0,n.default)(e,[{key:"setAll",value:function(e,t,r,n,i,o,a){this.setMediaDirection(e),this.setMediaPeerConnection(t),this.setSharePeerConnection(r),this.setLocalStream(n),this.setLocalShare(i),this.setRemoteStream(o),this.setRemoteShare(a)}},{key:"setMediaDirection",value:function(e){this.mediaDirection=e}},{key:"setMediaPeerConnection",value:function(e){this.mediaPeerConnection=e}},{key:"setSharePeerConnection",value:function(e){this.sharePeerConnection=e}},{key:"setPeerConnections",value:function(e,t){this.setMediaPeerConnection(e),this.setSharePeerConnection(t)}},{key:"setLocalStream",value:function(e){this.localStream=e}},{key:"setLocalShare",value:function(e){this.localShare=e}},{key:"setRemoteStream",value:function(e){this.remoteStream=e}},{key:"setRemoteShare",value:function(e){this.remoteShare=e}},{key:"unsetMediaPeerConnection",value:function(){this.mediaPeerConnection=null}},{key:"unsetSharePeerConnection",value:function(){this.sharePeerConnection=null}},{key:"unsetLocalStream",value:function(){this.localStream=null}},{key:"unsetLocalShare",value:function(){this.localShare=null}},{key:"unsetRemoteStream",value:function(){this.remoteStream=null}},{key:"unsetRemoteShare",value:function(){this.remoteShare=null}},{key:"unsetPeerConnections",value:function(){this.unsetMediaPeerConnection(),this.unsetSharePeerConnection()}},{key:"unsetLocalStreams",value:function(){this.unsetLocalStream(),this.unsetLocalShare()}},{key:"unsetRemoteStreams",value:function(){this.unsetRemoteStream(),this.unsetRemoteShare()}},{key:"unsetShareStreams",value:function(){this.unsetLocalShare(),this.unsetRemoteShare()}},{key:"unsetMediaStreams",value:function(){this.unsetLocalStream(),this.unsetRemoteStream()}}]),e}();t.default=o});t(cx);var lx=r(function(e,t){var r;r=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){function n(e){if(0===e.length)return e;var t,r,n=e.split(/[_-]/);if(1===n.length&&n[0][0].toLowerCase()===n[0][0])return e;for(r=n[0].toLowerCase(),t=1;t<n.length;t++)r=r+n[t].charAt(0).toUpperCase()+n[t].substring(1).toLowerCase();return r}n.prepended=function(e,t){return e+(t=n(t))[0].toUpperCase()+t.substring(1)},e.exports=n},function(e,t,r){var n=r(0);e.exports=function(e){var t=n((e=e||{}).name||e.past||"history"),r=n(e.future||"future"),i=n.prepended("clear",t),o=n.prepended(t,"back"),a=n.prepended(t,"forward"),s=n.prepended("can",o),u=n.prepended("can",a),c=e.max,l={configure:function(e){e.addTransitionLifecycleNames(o),e.addTransitionLifecycleNames(a)},init:function(e){e[t]=[],e[r]=[]},lifecycle:function(e,n){"onEnterState"===n.event&&(e[t].push(n.to),c&&e[t].length>c&&e[t].shift(),n.transition!==o&&n.transition!==a&&(e[r].length=0))},methods:{},properties:{}};return l.methods[i]=function(){this[t].length=0,this[r].length=0},l.properties[s]={get:function(){return this[t].length>1}},l.properties[u]={get:function(){return this[r].length>0}},l.methods[o]=function(){if(!this[s])throw Error("no history");var e=this[t].pop(),n=this[t].pop();this[r].push(e),this._fsm.transit(o,e,n,[])},l.methods[a]=function(){if(!this[u])throw Error("no history");var e=this.state,t=this[r].pop();this._fsm.transit(a,e,t,[])},l}}])},e.exports=r()});t(lx);var fx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(rx),n=i(lx);function i(e){return e&&e.__esModule?e:{default:e}}var o={create:function(e){var t=this;return new r.default({init:Wj.MEETING_STATE_MACHINE.STATES.IDLE,transitions:[{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.START,from:Wj.MEETING_STATE_MACHINE.STATES.IDLE,to:Wj.MEETING_STATE_MACHINE.STATES.ON_GOING},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.START,from:Wj.MEETING_STATE_MACHINE.STATES.IDLE,to:Wj.MEETING_STATE_MACHINE.STATES.INCOMING},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.JOIN,from:Wj.MEETING_STATE_MACHINE.STATES.IDLE,to:Wj.MEETING_STATE_MACHINE.STATES.DIALING},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.JOIN,from:Wj.MEETING_STATE_MACHINE.STATES.ON_GOING,to:Wj.MEETING_STATE_MACHINE.STATES.DIALING},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.JOIN,from:Wj.MEETING_STATE_MACHINE.STATES.INCOMING,to:Wj.MEETING_STATE_MACHINE.STATES.DIALING},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.LOCAL,from:Wj.MEETING_STATE_MACHINE.STATES.DIALING,to:Wj.MEETING_STATE_MACHINE.STATES.CONNECTING_MEDIA_LOCAL},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.CONNECT,from:Wj.MEETING_STATE_MACHINE.STATES.CONNECTING_MEDIA_LOCAL,to:Wj.MEETING_STATE_MACHINE.STATES.CONNECTING_MEDIA_REMOTE},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.ESTABLISH,from:Wj.MEETING_STATE_MACHINE.STATES.CONNECTING_MEDIA_REMOTE,to:Wj.MEETING_STATE_MACHINE.STATES.ESTABLISHED_MEDIA},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.LEAVE,from:Wj.MEETING_STATE_MACHINE.STATES.ESTABLISHED_MEDIA,to:Wj.MEETING_STATE_MACHINE.STATES.TERMINATING},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.END,from:Wj.MEETING_STATE_MACHINE.STATES.TERMINATING,to:Wj.MEETING_STATE_MACHINE.STATES.ENDED},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.CLEAN,from:Wj.MEETING_STATE_MACHINE.STATES.ENDED,to:Wj.MEETING_STATE_MACHINE.STATES.IDLE},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.CLEAN,from:Wj.MEETING_STATE_MACHINE.STATES.ERROR,to:Wj.MEETING_STATE_MACHINE.STATES.IDLE},{name:Wj.MEETING_STATE_MACHINE.TRANSITIONS.ERROR,from:"*",to:Wj.MEETING_STATE_MACHINE.STATES.ERROR}],methods:{onInit:function(r){e.logger.log("Meeting:index#onInit->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onError:function(r){e.logger.log("Meeting:index#onError->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onClean:function(r){e.logger.log("Meeting:index#onClean->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onJoin:function(r){e.logger.log("Meeting:index#onJoin->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onLocal:function(r){e.logger.log("Meeting:index#onLocal->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onConnect:function(r){e.logger.log("Meeting:index#onConnect->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onEstablish:function(r){e.logger.log("Meeting:index#onEstablish->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")}},plugins:[new n.default({max:25})]})}};t.default=o});t(fx);var dx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Xl),n=o(Bv),i=o(ux);function o(e){return e&&e.__esModule?e:{default:e}}var a={parseLocusJoin:function(e){var t={};return t.locus=e.body.locus,t.mediaConnections=e.body.mediaConnections,t.locusUrl=t.locus.url,t.locusId=t.locus.url.split("/").pop(),t.selfId=t.locus.self.id,t.mediaConnections.forEach(function(e){e.mediaId&&(t.mediaId=e.mediaId)}),t},getLocusPartner:function(e,t){return e.find(function(r){return t&&r.identity!==t.identity&&(e.length<=2||r.type===Wj.USER&&!r.removed)})||(void 0).partner},remoteUpdateAudioVideo:function(e,t,o){if(!o)return r.default.reject(new Error("You need a meeting object."));var a=i.default.generateLocalMedias(o.mediaId,e,t);return(0,n.default)(a)?r.default.reject(new Error("You need a media id on the meeting to change remote audio.")):o.meetingRequest.remoteAudioVideoToggle({locusUrl:o.locusUrl,selfId:o.selfId,localMedias:a,deviceUrl:o.deviceUrl,correlationId:o.correlationId})},leaveMeeting:function(e){return e?e.meetingRequest.leaveMeeting({locusUrl:e.locusUrl,selfId:e.selfId,correlationId:e.correlationId,resourceId:null,deviceUrl:e.deviceUrl}):r.default.reject(new Error("You need a meeting object."))},cleanOptions:function(e,t,r,n){return a.hasOwner(t)&&(a.isOwnerSelf(r,n)?(e.hostPin&&delete e.hostPin,e.moderator=Wj.MODERATOR_TRUE):e.moderator=Wj.MODERATOR_FALSE),e},hasOwner:function(e){return e&&e.owner},isOwnerSelf:function(e,t){return e===t},isPinOrGuest:function(e){return!(!e||!e.body||e.body.errorCode!==Wj.INTENT_TO_JOIN)},joinMeeting:function(e,t){return e?e.meetingRequest.joinMeeting({sipUri:e.sipUri,deviceUrl:e.deviceUrl,locusUrl:e.locusUrl,correlationId:e.id,resourceId:e.resourceId,moderator:t.moderator,hostPin:t.hostPin}).then(function(e){return a.parseLocusJoin(e)}):r.default.reject(new Error("You need a meeting object."))},getSdps:function(e){var t=[];return e.mediaProperties.mediaPeerConnection&&t.push(e.mediaProperties.mediaPeerConnection.sdp),e.mediaProperties.sharePeerConnection&&t.push(e.mediaProperties.sharePeerConnection.sdp),t}};t.default=a});t(dx);var px=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(Xl),n=s(rx),i=s(lx),o=s(ux),a=s(dx);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,r,n,i){e.trigger(n,{type:i,status:t.state,muted:t.muted,result:r})},c={create:function(e,t){return e.sendAudio?new n.default({transitions:[{name:Wj.MEETING_AUDIO_STATE_MACHINE.TRANSITIONS.TOGGLE,from:"*",to:function(e){return function(e){return e.mute&&e.self?Wj.MEETING_AUDIO_STATE_MACHINE.STATES.MUTE_SELF:!e.mute&&e.self?Wj.MEETING_AUDIO_STATE_MACHINE.STATES.UNMUTE_SELF:null}(e)||this.state}}],data:{muted:!1,self:!0},methods:{isMuted:function(){return this.muted},isSelf:function(){return this.self},setData:function(e){this.muted=e.mute,this.self=e.self},onBeforeToggle:function(e,n){return e.from!==e.to&&function(e,t,n,i){a.default.remoteUpdateAudioVideo(n,{mute:i.video.muted},i).then(function(s){try{o.default.setLocalTracks(n,{mute:i.video.muted},i.mediaProperties.localStream)}catch(n){return a.default.remoteUpdateAudioVideo({mute:e.muted},{mute:i.video.muted},i).catch(function(e){console.log("audio:state#onBeforeToggle->"+t.event+" fired! State failed to change with transition '"+t.transition+"''. After local audio toggle failed, resetting remote also failed, meeting audio in bad state with error: "+e+".")}),u(i,e,n,Wj.EVENT_TRIGGERS.MEDIA_AUDIO_CHANGED,Wj.EVENT_TYPES.ERROR),console.log("audio:state#onBeforeToggle->"+t.event+" fired! State failed to change with transition '"+t.transition+"''. State has been reset and toggling has been reversed."),r.default.reject(n)}return u(i,e,s,Wj.EVENT_TRIGGERS.MEDIA_AUDIO_CHANGED,Wj.EVENT_TYPES.LOCAL),console.log("audio:state#onAfterToggle->"+t.event+" fired! State changed from '"+t.from+"' to '"+t.to+"' with transition '"+t.transition+"''."),r.default.resolve(s)}).catch(function(n){return u(i,e,n,Wj.EVENT_TRIGGERS.MEDIA_AUDIO_CHANGED,Wj.EVENT_TYPES.ERROR),console.log("audio:state#onAfterHistoryBack->"+t.event+" fired! State failed to change with transition '"+t.transition+"''. State has been reset and toggling has been reversed."),r.default.reject(n)})}(this,e,n,t),r.default.resolve(this.data)},onAfterToggle:function(e,t){return this.setData(t),r.default.resolve(this.data)},plugins:[new i.default({max:5})]}}):null}};t.default=c});t(px);var hx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(Xl),n=s(rx),i=s(lx),o=s(ux),a=s(dx);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,r,n,i){e.trigger(n,{type:i,status:t.state,muted:t.muted,result:r})},c={create:function(e,t){if(e.sendVideo)return new n.default({transitions:[{name:Wj.MEETING_VIDEO_STATE_MACHINE.TRANSITIONS.TOGGLE,from:"*",to:function(e){return function(e){return e.mute&&e.self?Wj.MEETING_VIDEO_STATE_MACHINE.STATES.MUTE_SELF:!e.mute&&e.self?Wj.MEETING_VIDEO_STATE_MACHINE.STATES.UNMUTE_SELF:null}(e)||this.state}}],data:{muted:!1,self:!0},methods:{isMuted:function(){return this.muted},isSelf:function(){return this.self},setData:function(e){this.muted=e.mute,this.self=e.self},onBeforeToggle:function(e,n){return e.from!==e.to&&function(e,t,n,i){a.default.remoteUpdateAudioVideo({mute:i.audio.muted},n,i).then(function(s){try{o.default.setLocalTracks({mute:i.audio.muted},n,i.mediaProperties.localStream)}catch(n){return a.default.remoteUpdateAudioVideo({mute:i.audio.muted},{mute:e.muted},i).catch(function(e){console.log("video:state#onBeforeTogglek->"+t.event+" fired! State failed to change with transition "+t.transition+". After local video toggle failed, resetting remote also failed, meeting video in bad state with error: "+e+".")}),u(i,e,n,Wj.EVENT_TRIGGERS.MEDIA_VIDEO_CHANGED,Wj.EVENT_TYPES.ERROR),console.log("video:state#onBeforeTogglek->"+t.event+" fired! State failed to change with transition '"+t.transition+"''. State has been reset and toggling has been reversed."),r.default.reject(n)}return u(i,e,s,Wj.EVENT_TRIGGERS.MEDIA_VIDEO_CHANGED,Wj.EVENT_TYPES.LOCAL),console.log("video:state#onAfterToggle->"+t.event+" fired! State changed from '"+t.from+"' to '"+t.to+"' with transition '"+t.transition+"''."),r.default.resolve(s)}).catch(function(n){return u(i,e,n,Wj.EVENT_TRIGGERS.MEDIA_VIDEO_CHANGED,Wj.EVENT_TYPES.ERROR),console.log("video:state#onAfterHistoryBack->"+t.event+" fired! State failed to change with transition '"+t.transition+"''. State has been reset and toggling has been reversed."),r.default.reject(n)})}(this,e,n,t),r.default.resolve(this.data)},onAfterToggle:function(e,t){return this.setData(t),r.default.resolve(this.data)},plugins:[new i.default({max:5})]}})}};t.default=c});t(hx);var vx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={parse:function(e){return{policy:r.parsePolicy(e),type:r.parseMeetingType(e),sipUri:e.sipUri}},parsePolicy:function(e){var t={};return e.displayHints&&e.displayHints.joined&&e.displayHints.joined.length>0&&e.displayHints.joined.forEach(function(e){t[e]=!0}),t},parseMeetingType:function(e){var t=Wj.UNKNOWN;return e.locusTags&&e.locusTags.indexOf(Wj.ONE_ON_ONE)>=0?Wj.ONE_ON_ONE:(e.locusTags&&e.locusTags.indexOf(Wj.MEETING)>=0&&(t=Wj.MEETING),e.webexServiceType===Wj.MEETING_CENTER||e.isPmr?Wj.WEBEX_MEETING:t)}};t.default=r});t(vx);var gx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={parse:function(e,t){return e?{muted:r.getMuted(e),guest:e.guest,moderator:e.moderator,mediaStatus:r.getStatus(e.status),state:e.state,joinedWith:e.devices.some(function(e){return t===e.Url})?Wj.SELF:Wj.OTHER,creator:e.isCreator,id:r.getId(e)}:null},getSelves:function(e,t,n){var i=e&&r.parse(e,n),o=t&&r.parse(t,n);return{previous:i,current:o,updates:{isUnadmittedGuest:r.isUnadmittedGuest(o),isAdmittedGuest:r.isAdmittedGuest(i,o)}}},getId:function(e){return e&&e.person?e.person.id:null},getMuted:function(e){return e&&e.controls&&e.controls.audio?e.controls.audio.muted:null},getStatus:function(e){return{audio:e.audioStatus,video:e.videoStatus,slides:e.videoSlidesStatus}},isLocusGuestUnadmitted:function(e){return e&&e.guest&&e.state===Wj.IDLE},isLocusGuestAdmitted:function(e){return e&&e.guest&&e.state===Wj.JOINED},isUnadmittedGuest:function(e){if(!e)throw new TypeError("self must be defined to determine if self is unadmitted as guest.");return r.isLocusGuestUnadmitted(e)},isAdmittedGuest:function(e,t){if(!e)return!1;if(!t)throw new TypeError("New self must be defined to determine if self transitioned to admitted as guest.");return r.isLocusGuestUnadmitted(e)&&r.isLocusGuestAdmitted(t)},getSipUrl:function(e,t,r){var n=t.find(function(r){return e&&r.identity!==e.identity&&(t.length<=2||r.type===Wj.USER&&!r.removed)});return n&&r.type===Wj.ONE_ON_ONE?{sipUri:n.person.sipUrl||n.person.emailAddress||n.person.email}:{sipUri:r.sipUri}}};t.default=r});t(gx);var mx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={parse:function(e){return e?{id:r.getId(e)}:null},getHosts:function(e,t){var n=e&&r.parse(e),i=t&&r.parse(t);return{previous:n,current:i,updates:{isNewHost:!n||!i||r.isDifferentHosts(n.id,i.id)}}},isDifferentHosts:function(e,t){return e!==t},getId:function(e){return e?e.id:null}};t.default=r});t(mx);var yx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={parse:function(e){return e?{contentId:r.getContentId(e),disposition:r.getDisposition(e)}:null},getMediaShares:function(e,t){return{previous:e&&r.parse(e),current:t&&r.parse(t)}},getDisposition:function(e){var t=r.extractContentFloor(e);return t?t.disposition:null},extractContent:function(e){if(!e||!e.length)return null;var t=e[0];return t&&t.name===Wj.CONTENT?t:null},extractFloor:function(e){return e?e.floor:null},extractContentFloor:function(e){var t=r.extractContent(e);return r.extractFloor(t)},getContentId:function(e){var t=r.extractContentFloor(e);return t&&t.beneficiary?t.beneficiary.id:null}};t.default=r});t(yx);var _x=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(pD),n=i(vD);function i(e){return e&&e.__esModule?e:{default:e}}var o={compareLocus:function(e,t){var i=Math.min(e.rangeStart,(0,n.default)(e.entries)),a=Math.max(e.rangeEnd,(0,r.default)(e.entries)),s=Math.min(t.rangeStart,(0,n.default)(t.entries)),u=Math.max(t.rangeEnd,(0,r.default)(t.entries)),c=o.calculateUnique(e,t),l=o.calculateUnique(t,e),f=!(0===e.rangeStart&&0===e.rangeEnd),d=!(0===t.rangeStart&&0===t.rangeEnd);return i>u?Wj.DELTAEVENT.GT:a<s?Wj.DELTAEVENT.LT:c.length||l.length?c.length&&!l.length?Wj.DELTAEVENT.GT:l.length&&!c.length?Wj.DELTAEVENT.LT:!f&&!d||o.hasUniqueButInRange(c,s,u)||o.hasUniqueButInRange(l,i,a)?Wj.DELTAEVENT.CF:(0,n.default)(c)>(0,n.default)(l)?Wj.DELTAEVENT.GT:Wj.DELTAEVENT.LT:e.rangeEnd-i>t.rangeEnd-s?Wj.DELTAEVENT.GT:e.rangeEnd-i<t.rangeEnd-s?Wj.DELTAEVENT.LT:Wj.DELTAEVENT.EQ},generateSyncDebugFlag:function(e,t){var r=t.baseSequence,n=e.locusInfo.sequence,i=t.sequence,a=["","","","","",""],s=function(e){return e?o.isEmptySequence(e)?Wj.LOCUS.SEQUENCE.EMPTY:Wj.LOCUS.SEQUENCE.DEF:Wj.LOCUS.SEQUENCE.UN_DEF};a[0]=s(r),a[1]=s(n),a[2]=s(i),a[3]=r&&n?o.compareLocus(r,n).toLowerCase():Wj.LOCUS.SEQUENCE.NA,a[4]=n&&i?o.compareLocus(n,i).toLowerCase():Wj.LOCUS.SEQUENCE.NA,a[5]=r&&i?o.compareLocus(r,i).toLowerCase():Wj.LOCUS.SEQUENCE.NA,e.desync=a.toString()},calculateUnique:function(e,t){var r=[];return e.entries.forEach(function(e){(e<t.rangeStart||e>t.rangeEnd)&&-1===t.entries.indexOf(e)&&r.push(e)}),r},isEmptySequence:function(e){return!!(Object.prototype.hasOwnProperty.call(e,Wj.LOCUS.SEQUENCE.RANGE_START)&&0===e.rangeStart&&Object.prototype.hasOwnProperty.call(e,Wj.LOCUS.SEQUENCE.RANGE_END)&&0===e.rangeEnd&&e.entries&&0===e.entries.length)},hasUniqueButInRange:function(e,t,r){return e.some(function(e){return e>t&&e<r})}};t.default=o});t(_x);var Ex=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(vD),n=i(_x);function i(e){return e&&e.__esModule?e:{default:e}}var o={updateWithDeltaLocus:function(e,t){if(!(e.sequence&&e.sequence.rangeStart<=e.sequence.rangeEnd&&e.sequence.rangeEnd<=(0,r.default)(e.sequence.entries)))return null;if(!t.locusInfo.baseSequence)return t.meetingRequest.getFullLocus({desync:!0,locusUrl:t.locusUrl}).then(function(r){return r.body.baseSequence=e.baseSequence,t.locusInfo.onFullLocus(r.body),Wj.DELTAEVENT.EQ});e.sequence;var i=void 0,a=void 0;switch((i=n.default.compareLocus(e.sequence,t.locusInfo.sequence))===Wj.DELTAEVENT.GT&&e.baseSequence&&t.locusInfo.syncUrl&&((a=n.default.compareLocus(e.baseSequence,t.locusInfo.sequence))!==Wj.DELTAEVENT.LT&&a!==Wj.DELTAEVENT.CF||(i=Wj.DELTAEVENT.CF)),e.baseSequence||i!==Wj.DELTAEVENT.EQ||"INITIALIZING"!==e.fullState.state||0!==e.sequence.rangeStart||0!==e.sequence.rangeEnd||0!==e.sequence.entries.length||(i=Wj.DELTAEVENT.GT,console.log("Special case for OBTP")),console.log("RESULT :",i),i){case Wj.DELTAEVENT.LT:case Wj.DELTAEVENT.EQ:t.locusDesync=!1,t.needToGetFullLocus=!1;break;case Wj.DELTAEVENT.CF:n.default.generateSyncDebugFlag(t,e),t.locusDesync?t.meetingRequest.getFullLocus({desync:!0,locusUrl:t.locusUrl}).then(function(e){t.locusInfo.onFullLocus(e.body)}):(t.locusDesync=!0,o.syncMeeting(t,e));break;case Wj.DELTAEVENT.GT:console.info("MeetingAmpstate#updateWithDeltaLocus: MeetingConstants.deltaLocusResult.GT"),t.locusInfo.onDeltaLocus(e),t.locusDesync=!1,t.needToGetFullLocus=!1}return i},syncMeeting:function(e,t){e&&e.locusInfo&&e.locusInfo.syncUrl&&e.locusInfo.fullState&&e.locusInfo.fullState.state!==Wj.LOCUS.STATE.INACTIVE?e.meetingRequest.syncMeeting({syncUrl:t.syncUrl,desync:e.desync}).then(function(t){e.locusInfo.onDeltaLocus(t.body),console.log("meeting-adapter#syncMeeting: performing sync for uri: "+e.locusInfo.syncUrl+" and state: "+e.locusInfo.fullState.state)}).catch(function(e){console.error("Error syncing the locus",e)}):e&&e.locusInfo&&e.locusInfo.syncUrl&&e.locusInfo.fullState&&console.error("meeting-adapter#syncMeeting: skip sync for url: "+e.locusInfo.syncUrl+" and state: "+e.locusInfo.fullState.state)}};t.default=o});t(Ex);var bx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=f(_y),n=f(Ty),i=f(LO),o=f(Hj),a=f(vx),s=f(gx),u=f(mx),c=f(yx),l=f(Ex);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2];(0,r.default)(this,e),this.updateMeeting=t,this.controls=n.controls||null,this.conversationUrl=n.conversationUrl||null,this.created=n.created||null,this.fullState=n.fullState||null,this.host=n.host||null,this.mediaShares=n.mediaShares||null,this.participantsUrl=n.participantsUrl||null,this.replaces=n.replaces||null,this.url=n.url||null,this.aclUrl=n.aclUrl||null,this.baseSequence=n.baseSequence||null,this.sequence=n.sequence||null,this.membership=n.membership||null,this.identities=n.identities||null,this.emitChange=!1,this.parsedLocus={},this.spark=i,this.updateMeetingInfo(n.info),this.updateSelf(n.self,n.participants)}return(0,n.default)(e,[{key:"initialSetup",value:function(e,t){t?l.default.updateWithDeltaLocus(e,t):this.onFullLocus(e),this.emitChange=!0}},{key:"parse",value:function(e,t){switch(t.eventType){case Wj.LOCUSEVENT.PARTICIPANT_JOIN:case Wj.LOCUSEVENT.PARTICIPANT_LEFT:case Wj.LOCUSEVENT.CONTROLS_UPDATED:case Wj.LOCUSEVENT.PARTICIPANT_AUDIO_MUTED:case Wj.LOCUSEVENT.PARTICIPANT_AUDIO_UNMUTED:case Wj.LOCUSEVENT.PARTICIPANT_VIDEO_MUTED:case Wj.LOCUSEVENT.PARTICIPANT_VIDEO_UNMUTED:case Wj.LOCUSEVENT.SELF_CHANGED:case Wj.LOCUSEVENT.PARTICIPANT_UPDATED:case Wj.LOCUSEVENT.PARTICIPANT_CONTROLS_UPDATED:case Wj.LOCUSEVENT.PARTICIPANT_ROLES_UPDATED:case Wj.LOCUSEVENT.PARTICIPANT_DECLINED:case Wj.LOCUSEVENT.FLOOR_GRANTED:case Wj.LOCUSEVENT.FLOOR_RELEASED:this.onFullLocus(t.locus);break;case Wj.LOCUSEVENT.DIFFERENCE:l.default.updateWithDeltaLocus(t.locus,e);break;default:l.default.updateWithDeltaLocus(t.locus,e)}}},{key:"emitChanges",value:function(e,t){o.default.emit(e,t)}},{key:"onFullLocus",value:function(e){this.updateLocusInfo(e),this.updateParticipants(e.participants)}},{key:"onDeltaLocus",value:function(e){this.updateLocusInfo(e),this.updateParticipants(e.participants,!0)}},{key:"updateLocusInfo",value:function(e){this.updateControls(e.controls),this.updateConversationUrl(e.conversationUrl),this.updateCreated(e.created),this.updateFullState(e.state),this.updateHostInfo(e.host),this.updateMeetingInfo(e.info),this.updateMediaShares(e.mediaShares),this.updateParticipantsUrl(e.participantsUrl),this.updateReplace(e.replace),this.updateSelf(e.self,e.participants),this.updateLocusUrl(e.url),this.updateAclUrl(e.aclUrl),this.updateBasequence(e.baseSequence),this.updateSequence(e.sequence),this.updateMemberShip(e.membership),this.updateIdentifiers(e.identities)}},{key:"updateParticipants",value:function(e,t){t?console.log("Delta participants came through"):console.log("Full locus participants came through"),this.emitChanges(Wj.EVENTS.LOCUS_INFO_UPDATE_PARTICIPANTS,{participants:e,selfId:this.parsedLocus.self.id,hostId:this.parsedLocus.host.id})}},{key:"updateControls",value:function(e){e&&!(0,i.default)(this.controls,e)&&(this.controls=e,console.info("LocusInfo:controls got updated"))}},{key:"updateConversationUrl",value:function(e){e&&!(0,i.default)(this.conversationUrl,e)&&(this.conversationUrl=e,this.emitChanges(Wj.EVENTS.CONVERSATION_URL_UPDATE,e),console.info("LocusInfo:conversationUrl got updated"))}},{key:"updateCreated",value:function(e){e&&!(0,i.default)(this.created,e)&&(this.created=e,console.info("LocusInfo:created got updated"))}},{key:"updateFullState",value:function(e){e&&!(0,i.default)(this.fullState,e)&&(this.fullState=e,console.info("LocusInfo:fullState got updated"))}},{key:"updateHostInfo",value:function(e){if(e&&!(0,i.default)(this.host,e)){var t=u.default.getHosts(this.host,e);this.updateMeeting(t.current),this.parsedLocus.host=t.current,t.updates.isNewHost&&this.emitChanges(Wj.EVENTS.LOCUS_INFO_UPDATE_HOST,{newHost:t.current,oldHost:t.previous}),this.host=e,console.info("LocusInfo:host got updated")}}},{key:"updateMeetingInfo",value:function(e){if(e&&!(0,i.default)(this.info,e)){this.info=e;var t=a.default.parse(e);this.parsedLocus.info=t,this.updateMeeting(t),console.info("LocusInfo:info got updated"),this.emitChanges("infoUpdated")}}},{key:"updateMediaShares",value:function(e){if(e&&!(0,i.default)(this.mediaShares,e)){var t=c.default.getMediaShares(this.mediaShares,e);this.updateMeeting(t.current),this.emitChanges(Wj.EVENTS.LOCUS_INFO_UPDATE_MEDIA_SHARES,{current:t.current,previous:t.previous}),this.parsedLocus.mediaShares=t.current,this.mediaShares=e,console.info("LocusInfo:mediaShares got updated")}}},{key:"updateParticipantsUrl",value:function(e){e&&!(0,i.default)(this.participantsUrl,e)&&(this.participantsUrl=e,console.info("LocusInfo:participantsUrl got updated"))}},{key:"updateReplace",value:function(e){e&&!(0,i.default)(this.replace,e)&&(this.replace=e,console.info("LocusInfo:replace got updated"))}},{key:"updateSelf",value:function(e,t){if(e&&!(0,i.default)(this.self,e)){var r=s.default.getSelves(this.self,e,this.spark);this.updateMeeting(r.current),this.updateMeeting(s.default.getSipUrl(e,t,this.parsedLocus.info)),r.updates.isUnadmittedGuest&&this.emitChanges(Wj.EVENTS.SELF_UNADMITTED_GUEST,e),r.updates.isAdmittedGuest&&this.emitChanges(Wj.EVENTS.SELF_ADMITTED_GUEST,e),this.emitChanges(Wj.EVENTS.LOCUS_INFO_UPDATE_SELF,{oldSelf:r.previous,newSelf:r.current}),this.parsedLocus.self=r.current,this.self=e,console.info("LocusInfo:self got updated")}}},{key:"updateLocusUrl",value:function(e){e&&this.url!==e&&(this.url=e,this.emitChanges(Wj.EVENTS.LOCUS_INFO_UPDATE_URL,e),console.info("LocusInfo:url got updated"))}},{key:"updateAclUrl",value:function(e){e&&!(0,i.default)(this.aclUrl,e)&&(this.aclUrl=e,console.info("LocusInfo:aclUrl got updated"))}},{key:"updateBasequence",value:function(e){e&&!(0,i.default)(this.baseSequence,e)&&(this.baseSequence=e,console.info("LocusInfo:baseSequence got updated"))}},{key:"updateSequence",value:function(e){e&&!(0,i.default)(this.sequence,e)&&(this.sequence=e,console.info("LocusInfo:sequence got updated"))}},{key:"updateMemberShip",value:function(e){e&&!(0,i.default)(this.membership,e)&&(this.membership=e,console.info("LocusInfo:membership got updated"))}},{key:"updateIdentifiers",value:function(e){e&&!(0,i.default)(this.identities,e)&&(this.identities=e,console.info("LocusInfo:identities got updated"))}}]),e}();t.default=d});t(bx);var Sx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(vS),n=l(_S),i=l(SS),o=l(PS),a=l(MS),s=l(_y),u=l(NS),c=l(DS);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wj.ERROR_DICTIONARY.RECONNECTION.MESSAGE;(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,r));return n.name=Wj.ERROR_DICTIONARY.RECONNECTION.NAME,n.sdkMessage=Wj.ERROR_DICTIONARY.RECONNECTION.MESSAGE,n.error=e,n.code=Wj.ERROR_DICTIONARY.RECONNECTION.CODE,n}return(0,c.default)(t,e),t}(function(e){function t(){var t=(0,o.default)(e,(0,i.default)(arguments));return(0,n.default)(t,(0,a.default)(this)),t}return t.prototype=(0,r.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n.default?(0,n.default)(t,e):t.__proto__=e,t}(Error));t.default=f});t(Sx);var Tx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(Xl),n=s(_y),i=s(Ty),o=s(Sx),a=s(ex);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),this.status=Wj.RECONNECTION.STATE.DEFAULT_STATUS,this.tryCount=Wj.RECONNECTION.STATE.DEFAULT_TRY_COUNT,this.configure(t)}return(0,i.default)(e,[{key:"configure",value:function(e){this.backOff=e.config.reconnection.retry.backOff.start}},{key:"reset",value:function(){this.status=Wj.RECONNECTION.STATE.DEFAULT_STATUS,this.tryCount=Wj.RECONNECTION.STATE.DEFAULT_TRY_COUNT}},{key:"validate",value:function(e){return e.config.reconnection.enabled?e.locusInfo&&e.locusInfo.fullState&&e.locusInfo.fullState.state===Wj.ACTIVE&&e.locusInfo.fullState.active?e.spark.internal.mercury.connected?this.status!==Wj.RECONNECTION.STATE.DEFAULT_STATUS||this.status!==Wj.RECONNECTION.STATE.COMPLETE||new o.default(new Error("Multiple reconnections cannot occur concurrently")):new o.default(new Error("mercury is not connected, cannot reconnect")):new o.default(new Error("locus server for this call is not active, cannot reconnect")):new o.default(new Error("Reconnection is not enabled."))}},{key:"reconnect",value:function(e){var t=this.validate(e);return!0===t?this.execute(e):r.default.reject(t)}},{key:"execute",value:function(e){var t=this;return this.status=Wj.RECONNECTION.STATE.IN_PROGRESS,this.media(e).then(function(e){return console.info("Reconnection->Media reestablished at: "+new Date),t.status=Wj.RECONNECTION.STATE.COMPLETE,r.default.resolve(e)}).catch(function(n){if(console.info("Reconnection->Media reestablishment failed at: "+new Date),t.tryCount>e.config.reconnection.retry.times)return t.status=Wj.RECONNECTION.STATE.FAILURE,r.default.reject(new o.default(n));setTimeout(function(){return t.reconnect(e)},t.backOff*=e.config.reconnection.retry.backOff.rate)})}},{key:"media",value:function(t){return this.tryCount+=1,console.info("Reconnection->Re-establishing media at: "+new Date),t.addMedia({mediaSettings:t.mediaProperties.mediaDirection}).then(function(e){return r.default.resolve(e)}).catch(function(r){return console.error("Could not re use peer connections for the media.",r),e.cleanup(t),t.addMedia({mediaSettings:t.mediaProperties.mediaDirection,localStream:t.mediaProperties.localStream,localShare:t.mediaProperties.localShare})})}}],[{key:"cleanup",value:function(e){a.default.close(e.mediaProperties.mediaPeerConnection),a.default.close(e.mediaProperties.sharePeerConnection),e.mediaProperties.unsetPeerConnections()}}]),e}();t.default=u});t(Tx);var wx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(Xl),n=u(MS),i=u(_y),o=u(Ty),a=u(NS),s=u(DS);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"joinMeeting",value:function(e){var t=e.sipUri,r=e.deviceUrl,n=e.locusUrl,i=e.resourceId,o=e.correlationId,a=e.ensureConversation,s=e.moderator,u=e.hostPin,c="",l={deviceUrl:r,usingResource:i||null,correlationId:o,respOnlySdp:!0,allowMultiDevice:!0,ensureConversation:a||!1,supportsNativeLobby:1};return void 0!==s&&(l.moderator=s),void 0!==u&&(l.hostPIN=u),n?c=n+"/"+Wj.PARTICIPANT:t&&(c=this.spark.internal.device.services.locusServiceUrl+"/"+Wj.LOCI+"/"+Wj.CALL,l.invitee={address:t}),i===t&&(l.callPreferences={requestedMedia:["SLIDES"]}),this.spark.request({method:Wj.POST,uri:c,qs:{alternateRedirect:!0},body:l})}},{key:"syncMeeting",value:function(e){var t=e.desync,r=e.syncUrl;return t&&(r=r.concat(r.split("?")[1]?"&":"?").concat(Wj.LOCUS.SYNCDEBUG+"="+t)),this.request({method:Wj.GET,uri:r}).catch(function(e){return e})}},{key:"getFullLocus",value:function(e){var t=e.locusUrl,n=e.desync;return t?(n&&(t+="?"+Wj.LOCUS.SYNCDEBUG+"="+n),this.request({method:Wj.GET,uri:t}).catch(function(e){console.error("error getting full locus object",e)})):r.default.reject()}},{key:"leaveMeeting",value:function(e){var t=e.locusUrl+"/"+Wj.PARTICIPANT+"/"+e.selfId+"/"+Wj.LEAVE,r={deviceUrl:e.deviceUrl,usingResource:e.resourceId,correlationId:e.correlationId};return this.request({method:Wj.PUT,uri:t,body:r})}},{key:"acknowledgeMeeting",value:function(e){var t=e.locusUrl+"/"+Wj.PARTICIPANT+"/"+Wj.ALERT,r={deviceUrl:e.deviceUrl,correlationId:e.id};return this.request({method:Wj.PUT,uri:t,body:r})}},{key:"declineMeeting",value:function(e){var t=e.locusUrl+"/"+Wj.PARTICIPANT+"/"+Wj.DECLINE,r={deviceUrl:e.deviceUrl,reason:e.reason};return this.request({method:Wj.PUT,uri:t,body:r})}},{key:"remoteAudioVideoToggle",value:function(e){var t=e.locusUrl+"/"+Wj.PARTICIPANT+"/"+e.selfId+"/"+Wj.MEDIA,r={deviceUrl:e.deviceUrl,usingResource:e.resourceId||null,correlationId:e.correlationId,respOnlySdp:!0,localMedias:e.localMedias};return this.request({method:Wj.PUT,uri:t,body:r})}},{key:"changeMeetingFloor",value:function(e){var t={disposition:e.disposition};return e.disposition===Wj.FLOOR_ACTION.GRANTED&&(t={beneficiary:{url:e.personUrl,devices:[{url:e.deviceUrl}]},disposition:e.disposition,requester:{url:e.personUrl}}),this.request({uri:e.uri,method:Wj.PUT,body:{floor:t,resourceUrl:e.resourceUrl}})}}]),t}(eI.StatelessSparkPlugin);t.default=c});t(wx);var Ox=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={isUser:function(e){return e&&e.type===Wj.USER},isGuest:function(e){return e&&e.guest},isDevice:function(e){return e&&e.type===Wj.RESOURCE_ROOM},isSame:function(e,t){return e&&(e.id===t||e.person&&e.person.id===t)},isAssociatedSame:function(e,t){return e&&e.associatedUsers&&e.associatedUsers.some(function(e){return e.id===t||e.person&&e.person.id===t})},isNotAdmitted:function(e,t,r){return e&&e.guest&&e.devices&&e.devices[0]&&e.devices[0].intent&&e.devices[0].intent.type===Wj.WAIT&&t&&r===Wj.IN_LOBBY},isAudioMuted:function(e){if(!e)throw new Error("Audio could not be processed, participant is undefined.");var t=r.isMuted(e.status,Wj.AUDIO_STATUS);if(e.controls&&e.controls.audio){if(e.controls.audio.muted)return!0;if(t)return!0}return!1},isVideoMuted:function(e){if(!e)throw new Error("Video could not be processed, participant is undefined.");return r.isMuted(e.status,Wj.VIDEO_STATUS)},isMuted:function(e,t){if(e){if(e[t]===Wj.RECEIVE_ONLY)return!0;if(e[t]===Wj.SEND_RECEIVE)return!1}return null},isRecording:function(e){if(!e)throw new Error("Recording could not be processed, participant is undefined.");return!(!e.controls||!e.controls.localRecord)&&e.controls.localRecord.recording},extractStatus:function(e){if(!(e&&e.devices&&e.devices.length))return Wj.NOT_IN_MEETING;var t=e&&e.devices?e.devices[0]:null;if(t){if(t.state===Wj.JOINED&&(!t.intent||t.intent.type===Wj.NONE))return Wj.IN_MEETING;if(t.state===Wj.IDLE&&t.intent&&(t.intent.type===Wj.WAIT||t.intent.type===Wj.OBSERVE))return Wj.IN_LOBBY;if(t.state===Wj.LEFT||t.state===Wj.IDLE&&(!t.intent||t.intent.type===Wj.NONE))return Wj.NOT_IN_MEETING}return Wj.NOT_IN_MEETING},extractId:function(e){return e?e.id:null},extractName:function(e){return e&&e.person?e.person.name:null}};t.default=r});t(Ox);var kx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(_y),n=o(Ty),i=o(Ox);function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.default)(this,e),this.namespace=Wj.MEETINGS,this.participant=null,this.id=null,this.name=null,this.isAudioMuted=null,this.isVideoMuted=null,this.isSelf=null,this.isHost=null,this.isGuest=null,this.isInLobby=null,this.isInMeeting=null,this.isNotAdmitted=null,this.isContentSharing=null,this.status=null,this.isDevice=null,this.isUser=null,this.associatedUser=null,this.isRecording=null,this.processParticipant(t),this.processParticipantOptions(t,n)}return(0,n.default)(e,[{key:"processParticipant",value:function(e){this.participant=e,e&&(this.id=i.default.extractId(e),this.name=i.default.extractName(e),this.isAudioMuted=i.default.isAudioMuted(e),this.isVideoMuted=i.default.isVideoMuted(e),this.isRecording=i.default.isRecording(e),this.isGuest=i.default.isGuest(e),this.isUser=i.default.isUser(e),this.isDevice=i.default.isDevice(e),this.processStatus(e),this.isNotAdmitted=i.default.isNotAdmitted(e,this.isGuest,this.status))}},{key:"processParticipantOptions",value:function(e,t){e&&t&&(this.processIsSelf(e,t.selfId),this.processIsHost(e,t.hostId),this.processIsContentSharing(e,t.contentSharingId))}},{key:"processStatus",value:function(e){switch(this.status=i.default.extractStatus(e),this.status){case Wj.IN_LOBBY:this.isInLobby=!0,this.isInMeeting=!1;break;case Wj.IN_MEETING:this.isInLobby=!1,this.isInMeeting=!0;break;case Wj.NOT_IN_MEETING:this.isInLobby=!1,this.isInMeeting=!1;break;default:this.isInLobby=!1,this.isInMeeting=!1}}},{key:"setIsContentSharing",value:function(e){this.isContentSharing=e}},{key:"setIsHost",value:function(e){this.isHost=e}},{key:"setIsSelf",value:function(e){this.isSelf=e}},{key:"processIsContentSharing",value:function(e,t){i.default.isUser(e)?this.isContentSharing=i.default.isSame(e,t):i.default.isDevice(e)&&(this.isContentSharing=i.default.isAssociatedSame(e,t))}},{key:"processIsSelf",value:function(e,t){i.default.isUser(e)?this.isSelf=i.default.isSame(e,t):i.default.isDevice(e)&&(this.isSelf=i.default.isAssociatedSame(e,t),this.associatedUser=t)}},{key:"processIsHost",value:function(e,t){i.default.isUser(e)?this.isHost=i.default.isSame(e,t):i.default.isDevice(e)&&(this.isHost=i.default.isAssociatedSame(e,t))}}]),e}();t.default=a});t(kx);var Rx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(_y),n=i(Ty);function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this.namespace=Wj.MEETINGS,this.members={}}return(0,n.default)(e,[{key:"set",value:function(e,t){this.members[e]=t}},{key:"setAll",value:function(e){this.members=e}},{key:"get",value:function(e){return this.members[e]}},{key:"getAll",value:function(){return this.members}}]),e}();t.default=o});t(Rx);var Ax=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={generateAddMemberOptions:function(e,t,r){return{invitee:e,locusUrl:t,alertIfActive:r}},generateAdmitMemberOptions:function(e,t){return{locusUrl:t,memberIds:e}},getAddMemberBody:function(e){return{invitees:[{address:e.invitee.emailAddress||e.invitee.email}],alertIfActive:e.alertIfActive}},getAdmitMemberRequestBody:function(e){return{admit:{memberIds:e.memberIds}}},getAdmitMemberRequestParams:function(e){var t=r.getAdmitMemberRequestBody(e);return{method:Wj.PUT,uri:e.locusUrl+"/"+Wj.CONTROLS,body:t}},getAddMemberRequestParams:function(e){var t=r.getAddMemberBody(e);return{method:Wj.PUT,uri:e.locusUrl,body:t}}};t.default=r});t(Ax);var Ix=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(MS),n=u(_y),i=u(Ty),o=u(NS),a=u(DS),s=u(Ax);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){var e,i,a,s;(0,n.default)(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=a=(0,o.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(c))),a.namespace=Wj.MEETINGS,s=i,(0,o.default)(a,s)}return(0,a.default)(t,e),(0,i.default)(t,[{key:"addMembers",value:function(e){if(e&&e.invitee&&e.invitee.emailAddress&&e.invitee.email&&e.locusUrl)throw new Error("invitee must be passed and the associated locus url for this meeting object must be defined.");var t=s.default.getAddMemberRequestParams(e);return this.request(t)}},{key:"admitMember",value:function(e){if(!e||!e.locusUrl||!e.participantIds)throw new Error("memberIds must be an array passed and the associated locus url for this meeting object must be defined.");var t=s.default.getAdmitMemberRequestParams(e);return this.request(t)}}]),t}(eI.StatelessSparkPlugin);t.default=c});t(Ix);var Px=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=h(Xl),n=h(MS),i=h(_y),o=h(Ty),a=h(NS),s=h(DS),u=h(Bv),c=h(Hj),l=h(kx),f=h(Rx),d=h(Ix),p=h(Ax);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e,r){(0,i.default)(this,t);var o=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,{},r));return o.namespace=Wj.MEETINGS,o.membersRequest=new d.default({},r),o.membersCollection=new f.default,o.locusUrl=null,o.hostId=null,o.selfId=null,o.mediaShareContentId=null,o.setUpLocusInfoListeners(),o}return(0,s.default)(t,e),(0,o.default)(t,[{key:"setUpLocusInfoListeners",value:function(){this.setUpLocusUrlListener(),this.setUpLocusHostListener(),this.setUpLocusSelfListener(),this.setUpLocusParticipantsListener(),this.setUpLocusMediaSharesListener()}},{key:"setUpLocusSelfListener",value:function(){var e=this;c.default.on(Wj.EVENTS.LOCUS_INFO_UPDATE_SELF,function(t){var r=null,n=null;if(t&&(t.newSelf&&(r=t.newSelf.id),t.oldSelf&&(n=t.oldSelf.id)),r){var i=e.membersCollection.get(r);i&&i.setIsSelf(!0)}if(n){var o=e.membersCollection.get(n);o&&o.setIsSelf(!1)}e.selfId=r,e.trigger(Wj.EVENT_TRIGGERS.MEMBERS_SELF_UPDATE,{activeSelfId:r,endedSelfId:n})})}},{key:"setUpLocusHostListener",value:function(){var e=this;c.default.on(Wj.EVENTS.LOCUS_INFO_UPDATE_HOST,function(t){var r=null,n=null;if(t&&(t.newHost&&(r=t.newHost.id),t.oldHost&&(n=t.oldHost.id)),r){var i=e.membersCollection.get(r);i&&i.setIsHost(!0)}if(n){var o=e.membersCollection.get(n);o&&o.setIsHost(!1)}e.hostId=r,e.trigger(Wj.EVENT_TRIGGERS.MEMBERS_HOST_UPDATE,{activeHostId:r,endedHostId:n})})}},{key:"setUpLocusParticipantsListener",value:function(){var e=this;c.default.on(Wj.EVENTS.LOCUS_INFO_UPDATE_PARTICIPANTS,function(t){e.handleParticipantsPayload(t)})}},{key:"handleParticipantsPayload",value:function(e){if(e){var t=this.handleLocusInfoUpdatedParticipants(e),r=this.handleMembersUpdate(t);this.trigger(Wj.EVENT_TRIGGERS.MEMBERS_UPDATE,{delta:t,full:r})}}},{key:"handleMembersUpdate",value:function(e){return e&&(e.updated&&this.constructMembers(e.updated),e.added&&this.constructMembers(e.added)),this.membersCollection.getAll()}},{key:"constructMembers",value:function(e){var t=this;e.forEach(function(e){t.membersCollection.set(e.id,e)})}},{key:"setUpLocusMediaSharesListener",value:function(){var e=this;c.default.on(Wj.EVENTS.LOCUS_INFO_UPDATE_MEDIA_SHARES,function(t){var r=t.current,n=null,i=null;if(r&&r.contentId&&(r.disposition===Wj.FLOOR_ACTION.GRANTED?n=r.contentId:r.disposition===Wj.FLOOR_ACTION.RELEASED&&(i=r.contentId)),n){var o=e.membersCollection.get(n);o&&o.setIsContentSharing(!0)}if(i){var a=e.membersCollection.get(i);a&&a.setIsContentSharing(!1)}e.mediaShareContentId=n,e.trigger(Wj.EVENT_TRIGGERS.MEMBERS_CONTENT_UPDATE,{activeContentSharingId:n,endedContentSharingId:i})})}},{key:"setUpLocusUrlListener",value:function(){var e=this;c.default.on(Wj.EVENTS.LOCUS_INFO_UPDATE_URL,function(t){t&&e.setLocusUrl(null,t)})}},{key:"handleLocusInfoUpdatedParticipants",value:function(e){if(this.hostId=e.hostId||this.hostId,this.selfId=e.selfId||this.selfId,!e.participants)throw new Error("Members update could not occur, participants payload was not present.");return this.update(e.participants)}},{key:"setLocusUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)this.locusUrl=t;else{if(!e||!e.locusUrl&&!e.url)throw new Error("Setting locusUrl for the Members module should be done with a locus object or locusUrl");this.locusUrl=e.locusUrl||e.url}}},{key:"setHostId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)this.hostId=t;else{if(!e)throw new Error("Setting hostid for the Members module should be done with a locus object or hostId");this.hostId=e&&e.owner&&e.owner.info?e.owner.info:null}}},{key:"setSelfId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)this.selfId=t;else{if(!e)throw new Error("Setting selfid for the Members module should be done with a locus object or selfId");this.selfId=e&&e.self&&e.self.person&&e.self.person.id?e.self.person.id:null}}},{key:"setMediaShareContentId",value:function(e,t){if(t)this.mediaShareContentId=t;else{if(!e)throw new Error("Setting hostid for the Members module should be done with a locus object or hostId");this.mediaShareContentId=e&&e.mediaShares&&e.mediaShares.length&&e.mediaShares[0]&&e.mediaShares[0].name===Wj.CONTENT&&e.mediaShares[0].floor&&e.mediaShares[0].floor.beneficiary?e.mediaShares[0].floor.beneficiary.id:null}}},{key:"update",value:function(e){var t=this,r={added:[],updated:[]};return e&&e.forEach(function(e){e.hideInRoster||(t.membersCollection.get(e.id)?r.updated.push(new l.default(e,{selfId:t.selfId,hostId:t.hostId,contentSharingId:t.mediaShareContentId})):r.added.push(new l.default(e,{selfId:t.selfId,hostId:t.hostId,contentSharingId:t.mediaShareContentId})))}),r}},{key:"addMember",value:function(e,t){if(e&&e.emailAddress&&e.email&&this.locusUrl)return r.default.reject(new Error("invitee must be passed and the associated locus url for this meeting object must be defined."));var n=p.default.generateAddMemberOptions(e,this.locusUrl,t);return this.membersRequest.addMember(n).then(function(e){return e}).catch(function(e){return e})}},{key:"admitMembers",value:function(e){if((0,u.default)(e))return r.default.reject(new Error("No member ids provided to admit."));var t=p.default.generateAdmitMemberOptions(e,this.locusUrl);return this.membersRequest.admitMember(t).then(function(e){return e}).catch(function(e){return e})}}]),t}(eI.StatelessSparkPlugin);t.default=v});t(Px);var Cx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(_y),n=i(Ty);function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this.history=[]}return(0,n.default)(e,[{key:"get",value:function(){return this.history}},{key:"clearHistory",value:function(){this.history=[]}},{key:"getHistoryAt",value:function(e){return this.history[e]}},{key:"getMostRecent",value:function(){return this.history.length>1?this.history[1]:void 0}},{key:"addHistory",value:function(e){var t=void 0;return this.history.length>=Wj.DEFAULT_STATS_HISTORY_MAX&&(t=this.history.pop()),this.history.unshift(e),t}}]),e}();t.default=o});t(Cx);var Mx=Of.isFinite;var Nx=function(e){return"number"==typeof e&&Mx(e)},Dx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(Nx),n=i(hp);function i(e){return e&&e.__esModule?e:{default:e}}var o={interval:function(e,t){if(!e||!e.data||!e.data.getData||0===(0,n.default)(e.data.getData()).length)return t;var i={};return(0,n.default)(t.data.getData()).forEach(function(o){i[o]=i[o]?i[o]:{},(0,n.default)(t.data.getData()[o]).forEach(function(n){var a=t.data.getData()[o][n];!(0,r.default)(a)||Wj.DEFAULT_EXCLUDED_STATS.includes(n)&&0!==a||(e.data.getData()[o]&&e.data.getData()[o][n]?(a-=e.data.getData()[o][n],i[o][n]=a):i[o][n]=a)})}),i},aggregate:function(e,t){var i=t;return(0,n.default)(e.data.getData()).forEach(function(t){(0,n.default)(e.data.getData()[t]).forEach(function(n){var o=e.data.getData()[t][n];!(0,r.default)(o)||Wj.DEFAULT_EXCLUDED_STATS.includes(n)&&0!==o||(i[t][n]?i[t][n]+=o:i[t][n]=o)})}),i}};t.default=o});t(Dx);var jx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(_y),n=a(Ty),i=a(hp),o=a(Dx);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{format:Wj.DEFAULT_TRANSFORM_KEYS,summary:{}};(0,r.default)(this,e),this.summary=n.summary,0===(0,i.default)(n.summary).length&&n.format.forEach(function(e){t.summary[e]={}})}return(0,n.default)(e,[{key:"setFormat",value:function(e){var t=this;this.clearSummary(),e.forEach(function(e){t.summary[e]={}})}},{key:"get",value:function(){return this.summary}},{key:"clear",value:function(){this.summary={}}},{key:"aggregate",value:function(e){this.summary=o.default.aggregate(e,this.summary)}}]),e}();t.default=s});t(jx);var xx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(_y),n=o(Ty),i=o(Dx);function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{previous:void 0,updated:void 0,interval:{}};(0,r.default)(this,e),this.previous=t.previous,this.updated=t.updated,this.interval=t.interval}return(0,n.default)(e,[{key:"setPrevious",value:function(e){this.previous=e}},{key:"setUpdated",value:function(e){this.updated=e}},{key:"getPrevious",value:function(){return this.previous}},{key:"getUpdated",value:function(){return this.updated}},{key:"get",value:function(){return this.interval}},{key:"calculateInterval",value:function(){this.interval=i.default.interval(this.getPrevious(),this.getUpdated())}},{key:"updateInterval",value:function(e){return this.setPrevious(this.updated),this.setUpdated(e),this.calculateInterval(),this.get()}}]),e}();t.default=a});t(xx);var Lx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(MS),n=u(_y),i=u(Ty),o=u(NS),a=u(DS),s=u(zy);function u(e){return e&&e.__esModule?e:{default:e}}var c=new s.default,l=new s.default,f=new s.default,d=new s.default,p=function(e){function t(e){(0,n.default)(this,t);var i=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{objectMode:!0}));c.has(e)||c.set(e,new qb.EventEmitter);var a=c.get(e);return f.has(i)||f.set(i,a),l.has(a)||l.set(a,e),a.once(Wj._ERROR_,function(e){i.emit(Wj._ERROR_,e)}),i}return(0,a.default)(t,e),(0,i.default)(t,[{key:"_read",value:function(){var e=this,t=f.get(this);t.once(Wj._DATA_,function(t){e.isPaused()||e.push(t)}),d.has(t)||function e(t){var r=(0,Aw.safeSetTimeout)(function(){var r=l.get(t);r&&r.getStats().then(function(n){t.emit(Wj._DATA_,n),r.signalingState!==Wj._CLOSED_&&r.connectionState!==Wj._CLOSED_&&e(t)}).catch(function(e){t.emit(Wj._ERROR_,e)})},Wj.DEFAULT_STATS_INTERVAL);d.set(t,r)}(t)}}]),t}(Nj.Readable);t.default=p});t(Lx);var Ux=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(ek),n=o(SI),i=o(hp);function o(e){return e&&e.__esModule?e:{default:e}}var a={simplify:function(e){return(0,n.default)((0,i.default)(Wj.DEFAULT_TRANSFORM_REGEX),function(t){var r=!!Wj.DEFAULT_TRANSFORM_REGEX[t].regex.test(e.id)&&t;if(r){if(Wj.DEFAULT_TRANSFORM_REGEX[r].profiler&&(!e[Wj.DEFAULT_TRANSFORM_REGEX[r].profiler.type].includes(Wj.DEFAULT_TRANSFORM_REGEX[r].profiler.value)||!r.toLowerCase().includes(Wj.DEFAULT_TRANSFORM_REGEX[r].profiler.value)))return r=!1;if(Wj.DEFAULT_TRANSFORM_REGEX[r].decider&&e[Wj.DEFAULT_TRANSFORM_REGEX[r].decider]!==Wj.DEFAULT_TRANSFORM_REGEX[r].selector)return r=!1}return r})},parse:function(e){var t={};return e&&e.forEach&&e.size>0&&e.forEach(function(e){e&&e.type&&Wj.DEFAULT_GET_STATS_FILTER.types.includes(e.type)&&(t[e.id]=e)}),t},convert:function(e,t){if(t.simplifyFn)return t.simplifyFn(e);var n={};return(0,r.default)(e,function(e){var t=a.simplify(e);t&&(n[t]=e)}),n},transform:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{simplifyFn:void 0},r=a.parse(e);return Wj.DEFAULT_TRANSFORM_REGEX?a.convert(r,t):r}};t.default=a});t(Ux);var Fx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(_y),n=o(Ty),i=o(MA);function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){(0,r.default)(this,e),this.data=t,this.id=i.default.v4()}return(0,n.default)(e,[{key:"getId",value:function(){return this.id}},{key:"getData",value:function(){return this.data}}]),e}();t.default=a});t(Fx);var Gx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(MS),n=c(_y),i=c(Ty),o=c(NS),a=c(DS),s=c(Ux),u=c(Fx);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,n.default)(this,t),(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{objectMode:!0}))}return(0,a.default)(t,e),(0,i.default)(t,[{key:"_transform",value:function(e,t,r){if(e){var n=s.default.transform(e),i=new u.default(n);this.push({data:i}),r()}else r()}}]),t}(Nj.Transform);t.default=l});t(Gx);var qx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(MS),n=s(_y),i=s(Ty),o=s(NS),a=s(DS);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,r,n,i){var o={};return o.found=r.some(function(r){return!!(e[r]&&e[r][n]&&e[r][n]>0)&&(o.match={type:t,key:r,data:e[r],stat:n,kind:i},!0)}),o},c=function(e){function t(e,i){(0,n.default)(this,t);var a=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{},i));return a.namespace=Wj.MEETINGS,a.sentFirstVideoBytes=void 0,a.receivedFirstVideoBytes=void 0,a.sentFirstAudioBytes=void 0,a.receivedFirstAudioBytes=void 0,a}return(0,a.default)(t,e),(0,i.default)(t,[{key:"receiveEventAudio",value:function(e){if(e&&e.data&&e.data.getData()){var t=e.data.getData();if(t&&!this.receivedFirstAudioBytes){var r=u(t,Wj.EVENT_TYPES.REMOTE,Wj.DEFAULT_EVENT_AUDIO_RECEIVE_KEYS,Wj.EVENT_STATS_MAP.BYTES_RECEIVED,Wj.VIDEO);r&&r.found&&r.match&&(this.receivedFirstAudioBytes=r.match,this.trigger(Wj.EVENT_TRIGGERS.STATS_UPDATE,this.receivedFirstAudioBytes))}}return this.receivedFirstVideoBytes}},{key:"receiveEventVideo",value:function(e){if(e&&e.data&&e.data.getData()){var t=e.data.getData();if(t&&!this.receivedFirstVideoBytes){var r=u(t,Wj.EVENT_TYPES.REMOTE,Wj.DEFAULT_EVENT_VIDEO_RECEIVE_KEYS,Wj.EVENT_STATS_MAP.BYTES_RECEIVED,Wj.VIDEO);r&&r.found&&r.match&&(this.receivedFirstVideoBytes=r.match,this.trigger(Wj.EVENT_TRIGGERS.STATS_UPDATE,this.receivedFirstVideoBytes))}}return this.receivedFirstVideoBytes}},{key:"sendEventVideo",value:function(e){if(e&&e.data&&e.data.getData()){var t=e.data.getData();if(t&&!this.sentFirstVideoBytes){var r=u(t,Wj.EVENT_TYPES.LOCAL,Wj.DEFAULT_EVENT_VIDEO_SEND_KEYS,Wj.EVENT_STATS_MAP.BYTES_SENT,Wj.VIDEO);r&&r.found&&r.match&&(this.sentFirstVideoBytes=r.match,this.trigger(Wj.EVENT_TRIGGERS.STATS_UPDATE,this.sentFirstVideoBytes))}}return this.sentFirstVideoBytes}},{key:"sendEventAudio",value:function(e){if(e&&e.data&&e.data.getData()){var t=e.data.getData();if(t&&!this.sentFirstAudioBytes){var r=u(t,Wj.EVENT_TYPES.LOCAL,Wj.DEFAULT_EVENT_AUDIO_SEND_KEYS,Wj.EVENT_STATS_MAP.BYTES_SENT,Wj.AUDIO);r&&r.found&&r.match&&(this.sentFirstAudioBytes=r.match,this.trigger(Wj.EVENT_TRIGGERS.STATS_UPDATE,this.sentFirstAudioBytes))}}return this.sentFirstVideoBytes}},{key:"event",value:function(e){return{sentFirstVideoBytes:this.sendEventVideo(e),receivedFirstVideoBytes:this.receiveEventVideo(e),sentFirstAudioBytes:this.sendEventAudio(e),receivedFirstAudioBytes:this.receiveEventAudio(e)}}}]),t}(eI.StatelessSparkPlugin);t.default=c});t(qx);var Vx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=h(MS),n=h(_y),i=h(Ty),o=h(NS),a=h(DS),s=h(MA),u=h(Cx),c=h(jx),l=h(xx),f=h(Lx),d=h(Gx),p=h(qx);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e,i,a){(0,n.default)(this,t);var s=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{},i));return s.namespace=Wj.MEETINGS,s.attrs=e,s.options=i,s.history=void 0,s.interval=void 0,s.aggregator=void 0,s.stream=void 0,s.filter=void 0,s.events=void 0,s.id=void 0,a&&a.history&&s.withHistory(),a&&a.interval&&s.withInterval(),a&&a.aggregator&&s.withAggregator(),a&&a.filter&&!a.stream&&s.withFilter(a.filter),a&&a.stream&&!a.filter&&s.withStream(a.stream),a&&a.events&&s.withEvents(a.events),a&&a.id&&s.withId(),s}return(0,a.default)(t,e),(0,i.default)(t,[{key:"doHistory",value:function(e){this.history&&this.history.addHistory(e)}},{key:"doInterval",value:function(e){this.interval&&this.interval.updateInterval(e)}},{key:"doAggregator",value:function(e){this.aggregator&&this.aggregator.aggregate(e)}},{key:"doEvents",value:function(e){this.events&&this.events.event(e)}},{key:"onData",value:function(e){var t=this;if(!this.filter)throw new Error("The stats peer connection filter must be set up before data can be worked upon.");this.filter.on("data",function(r){t.doHistory(r),t.doInterval(r),t.doAggregator(r),t.doEvents(r),e&&e(r)})}},{key:"withEvents",value:function(){var e=new p.default(this.attrs,this.options);return this.setEvents(e),this}},{key:"withHistory",value:function(){var e=new u.default;return this.setHistory(e),this}},{key:"withAggregator",value:function(){var e=new c.default;return this.setAggregator(e),this}},{key:"withInterval",value:function(){var e=new l.default;return this.setInterval(e),this}},{key:"withStream",value:function(e){var t=new f.default(e);return this.setStream(t),this}},{key:"withFilter",value:function(e){var t=new f.default(e);this.setStream(t);var r=new d.default;return this.setFilter(r),t.pipe(r),this}},{key:"withId",value:function(e){if(e)return this.setId(e),this;var t=s.default.v4();return this.setId(t),this}},{key:"build",value:function(){return this}},{key:"setId",value:function(e){this.id=e}},{key:"setHistory",value:function(e){this.history=e}},{key:"setInterval",value:function(e){this.interval=e}},{key:"setAggregator",value:function(e){this.aggregator=e}},{key:"setEvents",value:function(e){this.events=e}},{key:"setStream",value:function(e){this.stream=e}},{key:"setFilter",value:function(e){this.filter=e}},{key:"getId",value:function(){return this.id}},{key:"getHistory",value:function(){return this.history}},{key:"getInterval",value:function(){return this.interval}},{key:"getAggregator",value:function(){return this.aggregator}},{key:"getEvents",value:function(){return this.events}},{key:"getStream",value:function(){return this.stream}},{key:"getFilter",value:function(){return this.filter}}]),t}(eI.StatelessSparkPlugin);t.default=v});t(Vx);var Bx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(MS),n=u(_y),i=u(Ty),o=u(NS),a=u(DS),s=u(Vx);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,i,a){(0,n.default)(this,t);var s=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{},i));return s.namespace=Wj.MEETINGS,s.attrs=e,s.options=i,s.media=void 0,s.screen=void 0,a&&a.media&&s.withMedia(a.media),a&&a.screen&&s.withScreen(a.screen),s}return(0,a.default)(t,e),(0,i.default)(t,[{key:"build",value:function(){return this}},{key:"withMedia",value:function(e){return this.media=new s.default(this.attrs,this.options,e),this}},{key:"withScreen",value:function(e){return this.screen=new s.default(this.attrs,this.options,e),this}},{key:"setMedia",value:function(e){this.media=e}},{key:"setScreen",value:function(e){this.screen=e}},{key:"getMedia",value:function(){return this.media}},{key:"getScreen",value:function(){return this.screen}}]),t}(eI.StatelessSparkPlugin);t.default=c});t(Bx);var zx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(vS),n=l(_S),i=l(SS),o=l(PS),a=l(MS),s=l(_y),u=l(NS),c=l(DS);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wj.ERROR_DICTIONARY.INTENT_TO_JOIN.MESSAGE;(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,r));return n.name=Wj.ERROR_DICTIONARY.INTENT_TO_JOIN.NAME,n.sdkMessage=Wj.ERROR_DICTIONARY.INTENT_TO_JOIN.MESSAGE,n.error=e,n.joinIntentRequired=!0,n.code=Wj.ERROR_DICTIONARY.INTENT_TO_JOIN.CODE,n}return(0,c.default)(t,e),t}(function(e){function t(){var t=(0,o.default)(e,(0,i.default)(arguments));return(0,n.default)(t,(0,a.default)(this)),t}return t.prototype=(0,r.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n.default?(0,n.default)(t,e):t.__proto__=e,t}(Error));t.default=f});t(zx);var Hx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(vS),n=l(_S),i=l(SS),o=l(PS),a=l(MS),s=l(_y),u=l(NS),c=l(DS);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wj.ERROR_DICTIONARY.JOIN_MEETING.MESSAGE;(0,s.default)(this,t);var i=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,n));return i.name=Wj.ERROR_DICTIONARY.JOIN_MEETING.NAME,i.sdkMessage=Wj.ERROR_DICTIONARY.JOIN_MEETING.MESSAGE,i.error=e,i.joinOptions=r,i.code=Wj.ERROR_DICTIONARY.JOIN_MEETING.CODE,i}return(0,c.default)(t,e),t}(function(e){function t(){var t=(0,o.default)(e,(0,i.default)(arguments));return(0,n.default)(t,(0,a.default)(this)),t}return t.prototype=(0,r.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n.default?(0,n.default)(t,e):t.__proto__=e,t}(Error));t.default=f});t(Hx);var Wx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=I(Zl),n=I(Xl),i=I(Xk),o=I(Ow),a=I(MS),s=I(_y),u=I(Ty),c=I(NS),l=I(DS),f=I(MA),d=I(Hj),p=I(sx),h=I(ux),v=I(cx),g=I(fx),m=I(px),y=I(hx),_=I(bx),E=I(ex),b=I(Tx),S=I(wx),T=I(Px),w=I(dx),O=I(Bx),k=I(zx),R=I(Hx),A=I(Sx);function I(e){return e&&e.__esModule?e:{default:e}}var P=function(e){function t(e,r){(0,s.default)(this,t);var n=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this,{},r));return n.namespace=Wj.MEETINGS,n.getMediaStreams=function(e){return h.default.getUserMedia(e)},n.attrs=e,n.options=r,n.id=f.default.v4(),n.userId=e.userId,n.resource=e.resource,n.deviceUrl=e.deviceUrl,n.roapSeq=0,n.meetingInfo={},n.members=new T.default({},{parent:n.spark}),n.roap=new p.default({},r),n.reconnectionManager=null,n.audio=null,n.video=null,n.state=g.default.create(n),n.stats=null,n.convoId=null,n.locusUrl=e.locus&&e.locus.url||null,n.sipUri=null,n.partner=null,n.type=null,n.owner=null,n.hostId=null,n.policy=null,n.meetingRequest=new S.default({},r),n.locusInfo=new _.default(n.updateMeetingObject.bind(n),e.locus?e.locus:{},n.spark),n.mediaProperties=new v.default,n.setUpLocusInfoListeners(),n}return(0,l.default)(t,e),(0,u.default)(t,[{key:"setUpLocusInfoListeners",value:function(){this.setUpLocusInfoSelfListener()}},{key:"setUpLocusInfoSelfListener",value:function(){var e=this;d.default.on(Wj.EVENTS.SELF_UNADMITTED_GUEST,function(t){t&&e.trigger(Wj.EVENT_TRIGGERS.MEETING_SELF_LOBBY_WAITING,{payload:t})}),d.default.on(Wj.EVENTS.SELF_ADMITTED_GUEST,function(t){t&&e.trigger(Wj.EVENT_TRIGGERS.MEETING_SELF_GUEST_ADMITTED,{payload:t})})}},{key:"updateMeetingObject",value:function(e){var t=this;e&&(0,o.default)(e).length&&(0,o.default)(e).forEach(function(r){t[r]=e[r]})}},{key:"invite",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.members.addMember(e,t)}},{key:"admit",value:function(e){return this.members.admitMembers(e)}},{key:"getMembers",value:function(){return this.members}},{key:"getStats",value:function(e){return this.stats?this.stats:this.createStats(e)}},{key:"createStats",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.stats=new O.default(this.attrs,this.options,e),this.stats}},{key:"isAudioMuted",value:function(){return this.audio&&this.audio.isMuted()}},{key:"isAudioSelf",value:function(){return this.audio&&this.audio.isSelf()}},{key:"isVideoMuted",value:function(){return this.video&&this.video.isMuted()}},{key:"isVideoSelf",value:function(){return this.video&&this.video.isSelf()}},{key:"parseMeetingInfo",value:function(e){!e||e.errors&&e.errors.length>0||(this.convoId=e.convoId||this.convoId,this.locusUrl=e.locusUrl||this.locusUrl,this.sipUri=e.sipMeetingUri||this.sipUri,this.owner=e.owner||this.owner)}},{key:"parseLocus",value:function(e){e&&(this.locusUrl=e.url,this.setLocus(e),e.participants&&e.self&&(this.partner=w.default.getLocusPartner(e.participants,e.self)),!this.sipUri&&this.partner&&this.type===Wj.ONE_ON_ONE&&(this.sipUri=this.partner.person.sipUrl||this.partner.person.emailAddress||this.partner.person.email))}},{key:"setSipUri",value:function(e){this.sipUri=e}},{key:"setRoapSeq",value:function(e){e&&(this.roapSeq=e)}},{key:"setLocus",value:function(e){var t=e.locus||e;this.mediaConnections=e.mediaConnections,this.locusUrl=e.locusUrl||e.url,this.locusId=e.locusId,this.selfId=e.selfId,this.mediaId=e.mediaId,this.hostId=t.host?t.host.id:this.hostId,this.locusInfo.initialSetup(t)}},{key:"setRemoteStream",value:function(e){var t=this;e&&(e.ontrack=function(e){var r=(0,i.default)(e.streams,1);t.mediaProperties.remoteStream=r[0],t.trigger(Wj.EVENT_TRIGGERS.MEDIA_READY,{type:Wj.EVENT_TYPES.REMOTE,stream:t.mediaProperties.remoteStream})})}},{key:"unsetRemoteStream",value:function(){this.mediaProperties.unsetRemoteStream()}},{key:"closeRemoteStream",value:function(){var e=this;return h.default.stopStream(this.mediaProperties.remoteStream).then(function(){e.trigger(Wj.EVENT_TRIGGERS.MEDIA_STOPPED,{type:Wj.EVENT_TYPES.REMOTE})})}},{key:"setShareStream",value:function(e){var t=this;e&&(e.ontrack=function(e){var r=(0,i.default)(e.streams,1);t.mediaProperties.remoteShare=r[0],t.trigger(Wj.EVENT_TRIGGERS.MEDIA_READY,{type:Wj.EVENT_TYPES.REMOTE_SHARE,stream:t.mediaProperties.remoteShare})})}},{key:"setLocalStream",value:function(e){e&&(this.mediaProperties.setLocalStream(e),this.trigger(Wj.EVENT_TRIGGERS.MEDIA_READY,{type:Wj.EVENT_TYPES.LOCAL,stream:this.mediaProperties.localStream}))}},{key:"setLocalShare",value:function(e){var t=this;e&&(this.mediaProperties.setLocalShare(e),this.mediaProperties.localShare.getVideoTracks().forEach(function(e){e.onended=function(){t.stopShare()}}),this.trigger(Wj.EVENT_TRIGGERS.MEDIA_READY,{type:Wj.EVENT_TYPES.LOCAL_SHARE,stream:this.mediaProperties.localShare}))}},{key:"closeLocalStream",value:function(){var e=this;return h.default.stopStream(this.mediaProperties.localStream).then(function(){e.trigger(Wj.EVENT_TRIGGERS.MEDIA_STOPPED,{type:Wj.EVENT_TYPES.LOCAL})})}},{key:"closeLocalShare",value:function(){var e=this;return h.default.stopStream(this.mediaProperties.localShare).then(function(){e.trigger(Wj.EVENT_TRIGGERS.MEDIA_STOPPED,{type:Wj.EVENT_TYPES.LOCAL_SHARE})})}},{key:"unsetLocalStream",value:function(){this.mediaProperties.unsetLocalStream()}},{key:"unsetLocalShare",value:function(){this.mediaProperties.unsetLocalShare()}},{key:"setPeerConnections",value:function(e,t){var r=this;this.mediaProperties.setPeerConnections(e,t),this.config.reconnection.detection&&(this.reconnectionManager=new b.default(this),E.default.detectFailures(this.mediaProperties.mediaPeerConnection,this.mediaProperties.sharePeerConnection,this.reconnect),this.spark.internal.mercury.on(Wj.ONLINE,function(){r.reconnect()}))}},{key:"closePeerConnections",value:function(){return n.default.all([E.default.close(this.mediaProperties.mediaPeerConnection),E.default.close(this.mediaProperties.sharePeerConnection)])}},{key:"unsetPeerConnections",value:function(){this.mediaProperties.unsetPeerConnections(),this.config.reconnection.detection&&this.spark.internal.mercury.off(Wj.ONLINE)}},{key:"setCorrelationId",value:function(e){this.correlationId=e}},{key:"muteAudio",value:function(){return!this.audio||this.audio&&!this.audio.toggle?n.default.reject(new Error("no audio control associated to the meeting")):this.audio.toggle({mute:!0,self:!0})}},{key:"unmuteAudio",value:function(){return!this.audio||this.audio&&!this.audio.toggle?n.default.reject(new Error("no audio control associated to the meeting")):this.audio.toggle({mute:!1,self:!0})}},{key:"muteVideo",value:function(){return!this.video||this.video&&!this.video.toggle?n.default.reject(new Error("no video control associated to the meeting")):this.video.toggle({mute:!0,self:!0})}},{key:"unmuteVideo",value:function(){return!this.video||this.video&&!this.video.toggle?n.default.reject(new Error("no audio control associated to the meeting")):this.video.toggle({mute:!1,self:!0})}},{key:"joinWithMedia",value:function(e,t,r){var o=this;this.join(e).then(function(e){return o.getMediaStreams(r).then(function(r){var a=(0,i.default)(r,2),s=a[0],u=a[1];return o.addMedia({mediaSettings:t,localShare:u,localStream:s}).then(function(t){n.default.resolve({join:e,media:t,local:[s,u]})})})}).catch(function(e){return n.default.reject(e)})}},{key:"reconnect",value:function(){var e=this;if(!this.reconnectionManager||!this.reconnectionManager.reconnect)throw new Error("Cannot reconnect, ReconnectionManager must first be defined.");return this.reconnectionManager.reconnect(this).then(function(t){return e.trigger(Wj.EVENT_TRIGGERS.MEETING_RECONNECTION_SUCCESS,{reconnect:t}),n.default.resolve(t)}).catch(function(t){return e.trigger(Wj.EVENT_TRIGGERS.MEETING_RECONNECTION_FAILURE,{error:new A.default(t)}),n.default.reject(new A.default(t))}).finally(function(t){return e.reconnectionManager.reset(),n.default.resolve(t)})}},{key:"join",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.ringing(Wj.STOP,!1),this.resourceId=this.resourceId||t.resourceId,this.setCorrelationId(this.id),t=w.default.cleanOptions(t,this.meetingInfo,this.owner,this.userId),w.default.joinMeeting(this,t).then(function(t){return e.setLocus(t),t}).catch(function(r){return w.default.isPinOrGuest(r)?w.default.hasOwner(e.meetingInfo)?w.default.joinMeeting(e,t).then(function(t){return e.setLocus(t),t}):n.default.reject(new k.default(r)):(e.logger.log("Meeting:index#join --\x3e Error joining the call on getLocalMedia, ",r),n.default.reject(new R.default(r,t)))})}},{key:"addMedia",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.localStream,o=t.localShare;return this.mediaProperties.setMediaDirection((0,r.default)(this.config.mediaSettings,t.mediaSettings)),this.audio=this.audio||m.default.create(this.mediaProperties.mediaDirection,this),this.video=this.video||y.default.create(this.mediaProperties.mediaDirection,this),this.setLocalStream(n),this.setLocalShare(o),h.default.attachMedia(this.mediaProperties.mediaDirection,E.default,n,o,{mediaPeerConnection:this.mediaProperties.mediaPeerConnection,sharePeerConnection:this.mediaProperties.sharePeerConnection}).then(function(t){var r=(0,i.default)(t,2),n=r[0],o=r[1],a=E.default.setContentSlides(o);e.setPeerConnections(n,a),e.setRemoteStream(e.mediaProperties.mediaPeerConnection),e.setShareStream(e.mediaProperties.sharePeerConnection)}).catch(function(t){throw e.logger.log("Meeting:index#join --\x3e Error joining the call on roap initialization, ",t),t}).then(function(){return e.roap.sendRoapMediaRequest({sdps:w.default.getSdps(e),roapSeq:e.roapSeq,meeting:e}).catch(function(t){throw e.logger.error("Meeting:index#join --\x3e Error joining the call on send roap media request, ",t),t})}).then(function(){})}},{key:"ringing",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.trigger(Wj.EVENT_TRIGGERS.MEETING_RINGING,{type:e,ringing:t})}},{key:"acknowledge",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e?e===Wj.INCOMING?this.meetingRequest.acknowledgeMeeting({locusUrl:this.locusUrl,deviceUrl:this.deviceUrl,id:this.id}).then(function(e){return n.default.resolve(e)}).then(function(i){return t.ringing(e,r),n.default.resolve({message:"Meeting type: "+e+" is acknowledged. Triggered ringing with: "+r+".",ringing:r,response:i})}):n.default.resolve({message:"noop"}):n.default.reject(new Error("Type must be set to acknowledge the meeting."))}},{key:"decline",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wj.BUSY;return this.meetingRequest.declineMeeting({locusUrl:this.locusUrl,deviceUrl:this.deviceUrl,reason:t}).then(function(t){e.ringing(Wj.STOP,!1),d.default.emit(Wj.EVENTS.DESTROY_MEETING_1_1,{meeting:e,response:t,type:Wj.EVENTS.DESTROY_MEETING_1_1})})}},{key:"leave",value:function(){var e=this;return this.meetingRequest.leaveMeeting({locusUrl:this.locusUrl,selfId:this.selfId,correlationId:this.correlationId,resourceId:null,deviceUrl:this.deviceUrl}).then(function(){return e.closeLocalStream()}).then(function(){return e.closeLocalShare()}).then(function(){return e.closePeerConnections()}).then(function(){e.unsetLocalStream(),e.unsetLocalShare(),e.unsetRemoteStream(),e.unsetPeerConnections()}).then(function(){e.roap.stop(e.correlationId,e.roapSeq)}).then(function(){e.state.end()}).catch(function(t){e.state.error(),e.logger.error("An error occured while trying to leave meeting with an id of "+e.id,t)}).finally(function(){e.state.clean()})}},{key:"share",value:function(){var e=this.locusInfo.mediaShares.find(function(e){return e.name===Wj.CONTENT});return e?this.meetingRequest.changeMeetingFloor({disposition:Wj.FLOOR_ACTION.GRANTED,personUrl:this.locusInfo.self.url,deviceUrl:this.deviceUrl,uri:e.url,resourceUrl:this.resourceUrl}):n.default.reject(new Error("Cannot share without content."))}},{key:"stopShare",value:function(){var e=this.locusInfo.mediaShares.find(function(e){return e.name===Wj.CONTENT});return e?this.meetingRequest.changeMeetingFloor({disposition:Wj.FLOOR_ACTION.RELEASED,personUrl:this.locusInfo.self.url,deviceUrl:this.deviceUrl,uri:e.url,resourceUrl:this.resourceUrl}):n.default.reject(new Error("Cannot stop share without content"))}}]),t}(eI.StatelessSparkPlugin);t.default=P});t(Wx);var Yx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={getClaimPmrLink:function(e){var t=Wj.VALID_PMR_ADDRESS.test(e);return t?e:(t=e.match(Wj.VALID_PMR_LINK))?t[4]+"@"+t[2]+"."+Wj.WEBEX_DOT_COM:null},getClaimPmrPin:function(e){return Wj.VALID_PIN.test(e)?e:null},getClaimedRequestParams:function(e,t,r){return{method:Wj.POST,api:Wj.HECATE,resource:"/"+Wj.CMR_MEETINGS+"/"+Wj.CLAIM,body:{userId:r.userId,passcode:t,preferred:r.preferred,meetingAddress:e}}}};t.default=r});t(Yx);var Xx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(Xl),n=c(MS),i=c(_y),o=c(Ty),a=c(NS),s=c(DS),u=c(Yx);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e,r,o,s;(0,i.default)(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return r=o=(0,a.default)(this,(e=t.__proto__||(0,n.default)(t)).call.apply(e,[this].concat(c))),o.namespace=Wj.MEETINGS,s=r,(0,a.default)(o,s)}return(0,s.default)(t,e),(0,o.default)(t,[{key:"claimPmr",value:function(e){if(!(e&&e.userId&&e.passcode&&e.meetingAddress&&e.preferred))throw new Error("Claiming a PMR should be done with userId, passcode, preferred, and meetingAddress in options.");var t=u.default.getClaimPmrPin(e.passcode);if(!t)return r.default.reject(new Error("The host pin provided was of an invalid format"));var n=u.default.getClaimPmrLink(e.meetingAddress);if(!n)return r.default.reject(new Error("The PMR link provided was of an invalid format"));var i=u.default.getClaimedRequestParams(n,t,e);return this.request(i)}}]),t}(eI.StatelessSparkPlugin);t.default=l});t(Xx);var Jx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(Xl),n=l(MS),i=l(_y),o=l(Ty),a=l(NS),s=l(DS),u=l(Kj),c=l(Xx);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e,r){(0,i.default)(this,t);var o=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,{},r));return o.namespace=Wj.MEETINGS,o.pmr=null,o.sipUri=null,o.link=null,o.userId=null,o.name=null,o.meetingInfoRequest=new u.default({},r),o.personalMeetingRoomRequest=new c.default({},r),o}return(0,s.default)(t,e),(0,o.default)(t,[{key:"claim",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={userId:this.spark.internal.device.userId,passcode:t,meetingAddress:e,preferred:i};return this.personalMeetingRoomRequest.claimPmr(o).then(function(e){return e&&e.body?(n.set(e.body),e.body):r.default.reject(new Error("No PMR body provided. PMR values not updated."))})}},{key:"set",value:function(e){this.pmr=e,this.sipUri=e.sipMeetingUri,this.meetingLink=e.webExMeetingLink||e.meetingLink,this.userId=e.owner,this.name=e.meetingName,this.number=e.meetingNumber}},{key:"get",value:function(){var e=this,t={type:Wj.PERSONAL_ROOM,destination:this.spark.internal.device.userId};return this.meetingInfoRequest.fetchMeetingInfo(t).then(function(t){return t&&t.body&&t.body.isPmr?(e.set(t.body),t.body):r.default.reject(new Error("The PMR requested is NOT a PMR. PMR values not set."))})}}]),t}(eI.StatelessSparkPlugin);t.default=f});t(Jx);var Kx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=u(Ow),n=u(sf),i=u(MS),o=u(_y),a=u(NS),s=u(DS);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){var e,s,u,c;(0,o.default)(this,t);for(var l=arguments.length,f=Array(l),d=0;d<l;d++)f[d]=arguments[d];return s=u=(0,a.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(f))),u.getClusters=function(){return u.request({method:Wj.GET,shouldRefreshAccessToken:!1,api:Wj.API.CALLIOPEDISCOVERY,resource:Wj.RESOURCE.CLUSTERS}).then(function(e){var t=e.body.clusters;return console.info("get clusters successful:"+(0,n.default)(t)),(0,r.default)(t)})},u.remoteSDPForClusters=function(e){return u.request({method:Wj.POST,shouldRefreshAccessToken:!1,api:Wj.API.CALLIOPEDISCOVERY,resource:Wj.RESOURCE.REACHABILITY,body:{offers:e}}).then(function(e){return console.info("Remote SDPs got succcessfully"),e.body})},c=s,(0,a.default)(u,c)}return(0,s.default)(t,e),t}(eI.StatelessSparkPlugin);t.default=c});t(Kx);var $x=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=d(Yk),n=d(Ow),i=d(Xl),o=d(sf),a=d(MS),s=d(_y),u=d(NS),c=d(DS),l=d(ex),f=d(Kx);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e,c){(0,s.default)(this,t);var d=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,{},c));return d.namespace=Wj.MEETINGS,d.setup=function(){d.processedClusterResults=[],d.peerConnectionMap={}},d.gatherReachability=function(){d.setup();try{return window.localStorage.setItem(Wj.REACHABILITY.localStorage,(0,o.default)({})),d.reachabilityRequest.getClusters().then(function(e){return d.performReachabilityCheck(e).then(function(e){return window.localStorage.setItem(Wj.REACHABILITY.localStorage,(0,o.default)(e)),e})}).catch(function(e){return console.info("Error in calling getClusters() :"+e),{}})}catch(e){return console.log("There was an error while accessing LocalStorage",e),{}}},d.performReachabilityCheck=function(e){if(!e||!e.length)return i.default.resolve({});var t=[];return new i.default(function(r){d.getLocalSDPForClusters(e).then(function(e){e&&(0,n.default)(e).length&&e.localSDPList&&e.peerConnection||(console.info("Local SDP is empty or has missing elements..returning."),r({})),d.peerConnectionMap=e.peerConnection,t=e.localSDPList,d.setRemoteOfferForEachCluster(t).then(function(e){r(e)})}).catch(function(e){console.error("Error in getLocalSDPForClusters :"+e),r({})})})},d.setRemoteOfferForEachCluster=function(e){var t={};return new i.default(function(r){d.reachabilityRequest.remoteSDPForClusters(e).then(function(e){var n=e.answers;n&&n.length||(console.info("Remote SDP is empty "),d.cleanUpPeerConnections(d.peerConnectionMap),r({})),n.forEach(function(e){var i=e,a=i.clusterId;if(i&&i.sdp){var s=d.peerConnectionMap[a];d.setIceCallBackHandlers(s).then(function(e){if(e.clusterId=a,d.processedClusterResults.push(e.clusterId),t[e.clusterId]={start:e.iceStats.start,stop:e.iceStats.stop},d.processedClusterResults.length===n.length){var i=d.parseIceResultToReachabilityResult(t);console.info("Returning reachability result"+(0,o.default)(i)),r(i)}}).catch(function(e){console.error("Error setIceCallBackHandlers : "+e),d.cleanUpPeerConnections(d.peerConnectionMap),r({})}),l.default.setRemoteSessionDetails(s,Wj._ANSWER_,i.sdp)}else console.info(a+" : Error in getting remote sdp :Error  : "),d.processedClusterResults.push(a),d.processedClusterResults.length===n.length&&(d.cleanUpPeerConnections(d.peerConnectionMap),r({}))})}).catch(function(e){console.error("Error in remoteSDPForClusters!:"+e),d.cleanUpPeerConnections(d.peerConnectionMap),r({})})})},d.getLocalSDPForClusters=function(e){var t={},r=[],n={};return new i.default(function(i,o){e.forEach(function(a){var s=a;l.default.createOffer({receiveAudio:!0,receiveVideo:!1}).then(function(o){n[s]=o;var a={sdp:o.sdp,clusterId:s};r.push(a),r.length===e.length&&(t.peerConnection=n,t.localSDPList=r,i(t))}).catch(function(e){o(new Error("Error in getLocalSDP : "+e)),console.error("Error in getLocalSDP : "+e)})})})},d.parseIceResultToReachabilityResult=function(e){if(!e||!(0,n.default)(e).length)return{};var t={},i=!0,o=!1,a=void 0;try{for(var s,u=(0,r.default)((0,n.default)(e));!(i=(s=u.next()).done);i=!0){var c=s.value,l={};if(e[c].start>0&&e[c].stop>0)l={reachable:!0,latencyInMilliseconds:e[c].stop-e[c].start};else l={reachable:!1};t[c]={udp:l}}}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return t},d.cleanUpPeerConnections=function(e){var t=!0,i=!1,o=void 0;try{for(var a,s=(0,r.default)((0,n.default)(e));!(t=(a=s.next()).done);t=!0){var u=a.value,c=e[u];c&&(console.info("Cleaning up peer connection created for cluster : "+u),c.close())}}catch(e){i=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw o}}},d.setIceCallBackHandlers=function(e){var t=null,r={start:0,stop:0};return new i.default(function(n){function i(t,r,i){t&&r&&(window.clearTimeout(r),r=void 0),e.close(),n({iceStats:i})}t=window.setTimeout(function(){console.info(d.clusterId+" : onTimer, ice timeout!"),i(!1,t,r)},5e3),e.oniceconnectionstatechange=function(){e&&(e.iceConnectionState===Wj.ICE_STATE.CHECKING&&(r.start=Date.now()),e.iceConnectionState===Wj.ICE_STATE.CONNECTED&&(r.stop=Date.now(),i(!0,t,r)),e.iceConnectionState===Wj.ICE_STATE.FAILED&&i(!1,t,r))}})},d.getClusters=function(){return d.reachabilityRequest.getClusters()},d.reachabilityRequest=new f.default({},c),d}return(0,c.default)(t,e),t}(eI.StatelessSparkPlugin);t.default=p});t($x);var Qx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(Ek),n=c(Xl),i=c(MS),o=c(_y),a=c(Ty),s=c(NS),u=c(DS);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"getActiveMeetings",value:function(){var e=this;return this.request({api:Wj.API.LOCUS,resource:Wj.RESOURCE.LOCI}).then(function(t){return e.determineRedirections(t.body)}).catch(function(e){console.error("meeting-adapter: failed to get locus details error: ",e)})}},{key:"determineRedirections",value:function(e){var t=this;return e.remoteLocusClusterUrls&&e.remoteLocusClusterUrls.length?n.default.all(e.remoteLocusClusterUrls.map(function(n){return t.request({method:Wj.GET,url:n,runWhitelistedDomains:!0}).then(function(t){var n,i;(n=e.loci).push.apply(n,(0,r.default)(t.body.loci)),(i=e.locusUrls).push.apply(i,(0,r.default)(t.body.locusUrls))}).catch(function(e){console.error("failed to get locus details from: ",n," Reason: ",e)})})).then(function(){return n.default.resolve(e)}):n.default.resolve(e)}}]),t}(eI.StatelessSparkPlugin);t.default=l});t(Qx);var Zx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=Zj)&&r.__esModule?r:{default:r};var i={extractDestination:function(e,t){var r=e;if(t===Wj.LOCUS_ID){if(!e||!e.url)throw new Error("You cannot create a meeting by locus without a locus.url defined");var n=e.url.split("/");r=n[n.length-1]}return r},getMeetingAddedType:function(e){return e===Wj.LOCUS_ID?Wj.INCOMING:Wj.CREATED},handleRoapMercury:function(e){var t=e.data;if(t.eventType===Wj.LOCUSEVENT.MESSAGE_ROAP){var r=n.default.getByKey(Wj.CORRELATION_ID,t.correlationId);r?r.roap.roapEvent(t):console.error("no meeting associated to roap event")}}};t.default=i});t(Zx);var eL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=v(MS),n=v(_y),i=v(Ty),o=v(NS),a=v(DS),s=v(Hj),u=v($j),c=v(Wx),l=v(Jx),f=v($x),d=v(Qx),p=v(Zj),h=v(Zx);function v(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(){var e;(0,n.default)(this,t);for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];var c=(0,o.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(a)));return c.namespace=Wj.MEETINGS,c.meetingInfo=new u.default({},{parent:c.spark}),c.request=new d.default({},{parent:c.spark}),c.personalMeetingRoom=new l.default({},{parent:c.spark}),c.reachability=null,c.onReady(),c}return(0,a.default)(t,e),(0,i.default)(t,[{key:"handleLocusEvent",value:function(e){var t=null;(t=p.default.getByKey(Wj.LOCUS_URL,e.locusUrl))?t.locusInfo.parse(t,e):this.create(e.locus,Wj.LOCUS_ID).then(function(r){e.eventType===Wj.LOCUSEVENT.DIFFERENCE?r.locusInfo.initialSetup(e.locus,t):r.locusInfo.initialSetup(e.locus)})}},{key:"handleLocusMercury",value:function(e){var t=e.data,r=t.eventType;r&&r!==Wj.LOCUSEVENT.MESSAGE_ROAP&&this.handleLocusEvent(t)}},{key:"listenForEvents",value:function(){var e=this;this.spark.internal.mercury.on(Wj.LOCUSEVENT.LOCUS_MERCURY,function(t){e.handleLocusMercury(t)}),this.spark.internal.mercury.on(Wj.ROAP.ROAP_MERCURY,function(e){h.default.handleRoapMercury(e)})}},{key:"listenInternal",value:function(){var e=this;s.default.on(Wj.EVENTS.DESTROY_MEETING_DECLINE_1_1,function(t){t&&e.destroy(t.meeting,t.response,t.type)})}},{key:"onReady",value:function(){var e=this;this.spark.once(Wj.READY,function(){e.spark.canAuthorize&&(e.listenForEvents(),e.listenInternal(),e.trigger(Wj.EVENT_TRIGGERS.MEETINGS_READY))})}},{key:"setReachability",value:function(){this.reachability=new f.default({},{parent:this.spark})}},{key:"getReachability",value:function(){return this.reachability}},{key:"startReachability",value:function(){this.reachability||this.setReachability(),this.getReachability().gatherReachability()}},{key:"getPersonalMeetingRoom",value:function(){return this.personalMeetingRoom}},{key:"destroy",value:function(e,t,r){if(!e||!e.id)throw new Error("Cannot remove a meeting without an id from the MeetingCollection.");return p.default.remove(e.id),this.trigger(Wj.EVENT_TRIGGERS.MEETING_REMOVED,{meeting:e,response:t,type:r}),t}},{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.createMeeting(e,t)}},{key:"createMeeting",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new c.default({userId:this.spark.internal.device.userId,deviceUrl:this.spark.internal.device.url,roapSeq:0,locus:r===Wj.LOCUS_ID?e:null},{parent:this.spark});return p.default.set(n),this.meetingInfo.fetchMeetingInfo(h.default.extractDestination(e,r),r).then(function(e){n.parseMeetingInfo(e),n.meetingInfo=e}).catch(function(e){console.error(e)}).then(function(){n.sipUri||n.setSipUri(e);var i=h.default.getMeetingAddedType(r);return t.trigger(Wj.EVENT_TRIGGERS.MEETING_ADDED,{meeting:n,type:i}),n})}},{key:"syncMeetings",value:function(){var e=this;return this.request.getActiveMeetings().then(function(t){t.loci&&t.loci.length>0&&t.loci.forEach(function(t){var r=p.default.getByKey(Wj.LOCUS_URL,t.url);r?r.locusInfo.onFullLocus(t):e.create(t,Wj.LOCUS_ID).then(function(e){e.locusInfo.initialSetup(t)})})})}}],[{key:"getMeetingByType",value:function(e,t){return p.default.getByKey(e,t)}},{key:"getAllMeetings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p.default.getAll(e)}},{key:"getActiveMeetings",value:function(){return p.default.getAll({active:!0})}}]),t}(eI.SparkPlugin);t.default=g});t(eL);var tL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={meetings:{mediaSettings:{sendAudio:!0,sendVideo:!0,receiveAudio:!0,receiveVideo:!0,pstn:!1,sendShare:!1,receiveShare:!1},reconnection:{enabled:!0,detection:!0,retry:{times:2,backOff:{start:1e3,rate:2}}}}}});t(tL),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(eL),n=i(tL);function i(e){return e&&e.__esModule?e:{default:e}}(0,eI.registerPlugin)("meetings",r.default,{config:n.default}),t.default=r.default}));var rL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(_k),n=o(Fu),i=o(Hd);function o(e){return e&&e.__esModule?e:{default:e}}var a=eI.SparkPlugin.extend({create:function(e){var t="body";e.file&&(this.logger.warn("Supplying a single `file` property is deprecated; please supply a `files` array"),e.files=[e.file],(0,n.default)(e,"file")),(0,i.default)(e.files)&&e.files.reduce(function(e,t){return e||"string"!=typeof t},!1)&&(t="formData");var o=(0,r.default)({method:"POST",service:"hydra",resource:"messages"},t,e);return this.request(o).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"messages/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"messages",qs:e}).then(function(e){return new eI.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"messages/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},version:"1.50.2"});t.default=a});t(rL),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=rL)&&r.__esModule?r:{default:r};(0,eI.registerPlugin)("messages",n.default),t.default=n.default}));var nL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=eI.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"memberships",body:e}).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"memberships/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"memberships",qs:e}).then(function(e){return new eI.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"memberships/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id||e;return this.request({method:"PUT",service:"hydra",resource:"memberships/"+t,body:e}).then(function(e){return e.body})},version:"1.50.2"});t.default=r});t(nL),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=nL)&&r.__esModule?r:{default:r};(0,eI.registerPlugin)("memberships",n.default),t.default=n.default}));var iL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=eI.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"rooms",body:e}).then(function(e){return e.body})},get:function(e,t){var r=e.id||e;return this.request({service:"hydra",resource:"rooms/"+r,qs:t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"rooms/",qs:e}).then(function(e){return new eI.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"rooms/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id;return this.request({method:"PUT",service:"hydra",resource:"rooms/"+t,body:e}).then(function(e){return e.body})},version:"1.50.2"});t.default=r});t(iL),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=iL)&&r.__esModule?r:{default:r};(0,eI.registerPlugin)("rooms",n.default),t.default=n.default}));var oL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=eI.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"teams",body:e}).then(function(e){return e.body})},get:function(e,t){var r=e.id||e;return this.request({service:"hydra",resource:"teams/"+r,qs:t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"teams/",qs:e}).then(function(e){return new eI.Page(e,t.spark)})},update:function(e){var t=e.id;return this.request({method:"PUT",service:"hydra",resource:"teams/"+t,body:e}).then(function(e){return e.body})},version:"1.50.2"});t.default=r});t(oL),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=oL)&&r.__esModule?r:{default:r};(0,eI.registerPlugin)("teams",n.default),t.default=n.default}));var aL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=eI.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"team/memberships",body:e}).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"team/memberships/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"team/memberships",qs:e}).then(function(e){return new eI.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"team/memberships/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id||e;return this.request({method:"PUT",service:"hydra",resource:"team/memberships/"+t,body:e}).then(function(e){return e.body})},version:"1.50.2"});t.default=r});t(aL),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=aL)&&r.__esModule?r:{default:r};(0,eI.registerPlugin)("teamMemberships",n.default),t.default=n.default}));var sL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=eI.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"webhooks",body:e}).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"webhooks/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"webhooks/",qs:e}).then(function(e){return new eI.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"webhooks/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id;return this.request({method:"PUT",service:"hydra",resource:"webhooks/"+t,body:e}).then(function(e){return e.body})},version:"1.50.2"});t.default=r});t(sL),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=sL)&&r.__esModule?r:{default:r};(0,eI.registerPlugin)("webhooks",n.default),t.default=n.default}));var uL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(Fu),n=u(Xl),i=u(sf),o=u(_y),a=u(Ty),s=u(zy);function u(e){return e&&e.__esModule?e:{default:e}}var c=new s.default,l=new s.default,f=function(){function e(t){(0,o.default)(this,e),this.Bound=function(){function e(t,r){(0,o.default)(this,e),c.set(this,t),l.set(this,r.logger)}return(0,a.default)(e,[{key:"_getRawData",value:function(){var e=localStorage.getItem(t);return e?JSON.parse(e):{}}},{key:"_load",value:function(){return this._getRawData()[c.get(this)]||{}}},{key:"_save",value:function(e){var r=this._getRawData();r[c.get(this)]=e,localStorage.setItem(t,(0,i.default)(r))}},{key:"clear",value:function(){return l.get(this).info("local-storage-store-adapter: clearing localStorage"),n.default.resolve(localStorage.removeItem(t))}},{key:"del",value:function(e){var t=this;return new n.default(function(n){l.get(t).info("local-storage-store-adapter: deleting `"+e+"`");var i=t._load();(0,r.default)(i,e),t._save(i),n()})}},{key:"get",value:function(e){var t=this;return new n.default(function(r,n){l.get(t).info("local-storage-store-adapter: reading `"+e+"`");var i=t._load()[e];return void 0!==i?r(i):n(new eI.NotFoundError("No value found for "+e))})}},{key:"put",value:function(e,t){var r=this;return new n.default(function(n){l.get(r).info("local-storage-store-adapter: writing `"+e+"`");var i=r._load();i[e]=t,r._save(i),n()})}}]),e}()}return(0,a.default)(e,[{key:"bind",value:function(e,t){return t=t||{},e?t.logger?(t.logger.info("local-storage-store-adapter: returning binding"),n.default.resolve(new this.Bound(e,t))):n.default.reject(new Error("`options.logger` is required")):n.default.reject(new Error("`namespace` is required"))}}]),e}();t.default=f});t(uL);var cL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=uL)&&r.__esModule?r:{default:r};t.default={boundedAdapter:new n.default("ciscospark"),unboundedAdapter:eI.MemoryStoreAdapter}});t(cL);var lL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=cL)&&r.__esModule?r:{default:r};t.default={hydraServiceUrl:ru.env.HYDRA_SERVICE_URL||"https://api.ciscospark.com/v1",credentials:{clientType:"confidential"},device:{ephemeral:!0},storage:n.default}});t(lL);var fL=eI.default.extend({ciscospark:!0,version:"1.50.2"});fL.version="1.50.2",fL.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.config=_A({},lL,e.config),new fL(e)};var dL=fL;e._babelPolyfill;var pL=dL;return window.ciscospark=pL}();
