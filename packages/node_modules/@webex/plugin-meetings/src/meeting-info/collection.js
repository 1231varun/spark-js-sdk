import {find} from 'lodash';

import Collection from '../common/collection';
import {MEETINGS} from '../constants';

/**
 * @class MeetingInfoCollection
 */
export default class MeetingInfoCollection extends Collection {
  namespace = MEETINGS;

  /**
   * @memberof MeetingInfoCollection
   * @constructor
   * @public
   */
  constructor() {
    super('meetingInfos');
  }

  /**
   * @param {String} id ID of the meeting info you wish to retreive
   * @returns {MeetingInfo} returns a meeting info instance
   * @public
   * @memberof MeetingInfoCollection
   */
  get(id) {
    if (this.meetingInfos[id]) {
      return this.meetingInfos[id];
    }
    return find(
      this.meetingInfos,
      (info) => info.sipUrl === id || info.locusId === id || info.userId === id || info.meetingLink === id
    );
  },

  /**
   *
   * @param {String} id the id of the meeting info instance to add to the collection
   * @param {Object} info the full meeting info object
   * @returns {MeetingInfo} returns the meeting info instance that was added to the collection
   */
  set(id, info) {
    this.meetingInfos[id] = info;

    return this.meetingInfos[id];
  },

  /**
   * @returns {Object} returns an object map of MeetingInfo instances
   */
  getAll() {
    return this.meetingInfos;
  }
}
