machine:
  node:
    version: 4

# Note the use of /home/ubuntu instead of $HOME. I think there's a bug in
# Circle's cd command.

dependencies:
  cache_directories:
    - node_modules
    - packages/*/node_modules
    -  /home/ubuntu/spark-js-sdk--test-users
  pre:
    - pwd
    - ls spark-js-sdk--test-users 2&>1 || git clone git@github.com:ianwremmel/spark-js-sdk--test-users.git:
        pwd: /home/ubuntu
    - npm link:
        pwd: /home/ubuntu/spark-js-sdk--test-users
    - npm link spark-js-sdk--test-users
    # - npm link spark-js-sdk--test-users
    # pwd:
  post:
    - npm run bootstrap

test:
  override:
    - ./node_modules/.bin/grunt --gruntfile Gruntfile.circle.js static-analysis
